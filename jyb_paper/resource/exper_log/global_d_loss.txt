['/content/drive/My Drive/drive/gan/gan_git-02/gan_git/compare_gan/gans', '/env/python', '/usr/lib/python36.zip', '/usr/lib/python3.6', '/usr/lib/python3.6/lib-dynload', '/usr/local/lib/python3.6/dist-packages', '/usr/lib/python3/dist-packages', '/content/drive/My Drive/drive/gan/gan_git-02/gan_git/compare_gan/', '/content/drive/My Drive/drive/gan/gan_git-02/gan_git/']
2020-04-10 01:17:01.380973: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.1
WARNING:tensorflow:From /usr/local/lib/python3.6/dist-packages/tensorflow_gan/python/estimator/tpu_gan_estimator.py:42: The name tf.estimator.tpu.TPUEstimator is deprecated. Please use tf.compat.v1.estimator.tpu.TPUEstimator instead.

['/content/drive/My Drive/drive/gan/gan_git-02/gan_git/compare_gan/gans', '/env/python', '/usr/lib/python36.zip', '/usr/lib/python3.6', '/usr/lib/python3.6/lib-dynload', '/usr/local/lib/python3.6/dist-packages', '/usr/lib/python3/dist-packages', '/content/drive/My Drive/drive/gan/gan_git-02/gan_git/compare_gan/', '/content/drive/My Drive/drive/gan/gan_git-02/gan_git/', '/usr/local/lib/python3.6/dist-packages/IPython/extensions', '/content/drive/My Drive/drive/gan/gan_git-02/gan_git/compare_gan/tpu/', '/content/drive/My Drive/drive/gan/gan_git-02/gan_git/compare_gan/metrics/', '/content/drive/My Drive/drive/gan/gan_git-02/gan_git/compare_gan/architectures/', '/content/drive/My Drive/drive/gan/gan_git-02/gan_git/compare_gan/', '/content/drive/My Drive/drive/gan/gan_git-02/gan_git/']
['/content/drive/My Drive/drive/gan/gan_git-02/gan_git/compare_gan/gans', '/env/python', '/usr/lib/python36.zip', '/usr/lib/python3.6', '/usr/lib/python3.6/lib-dynload', '/usr/local/lib/python3.6/dist-packages', '/usr/lib/python3/dist-packages', '/content/drive/My Drive/drive/gan/gan_git-02/gan_git/compare_gan/', '/content/drive/My Drive/drive/gan/gan_git-02/gan_git/', '/usr/local/lib/python3.6/dist-packages/IPython/extensions', '/content/drive/My Drive/drive/gan/gan_git-02/gan_git/compare_gan/tpu/', '/content/drive/My Drive/drive/gan/gan_git-02/gan_git/compare_gan/metrics/', '/content/drive/My Drive/drive/gan/gan_git-02/gan_git/compare_gan/architectures/', '/content/drive/My Drive/drive/gan/gan_git-02/gan_git/compare_gan/', '/content/drive/My Drive/drive/gan/gan_git-02/gan_git/', '/content/drive/My Drive/drive/gan/gan_git-02/gan_git/compare_gan/architectures/', '/content/drive/My Drive/drive/gan/gan_git-02/gan_git/compare_gan/', '/content/drive/My Drive/drive/gan/gan_git-02/gan_git/']
Running tests under Python 3.6.9: /usr/bin/python3
[ RUN      ] S3GANTest.testSingleTrainingStepArchitectures
WARNING:tensorflow:From /content/drive/My Drive/drive/gan/gan_git-02/gan_git/compare_gan/test_utils.py:59: flatten (from tensorflow.python.layers.core) is deprecated and will be removed in a future version.
Instructions for updating:
Use keras.layers.Flatten instead.
W0410 01:17:17.415027 139691431679872 deprecation.py:323] From /content/drive/My Drive/drive/gan/gan_git-02/gan_git/compare_gan/test_utils.py:59: flatten (from tensorflow.python.layers.core) is deprecated and will be removed in a future version.
Instructions for updating:
Use keras.layers.Flatten instead.
WARNING:tensorflow:From /usr/local/lib/python3.6/dist-packages/tensorflow/python/layers/core.py:332: Layer.apply (from tensorflow.python.keras.engine.base_layer_v1) is deprecated and will be removed in a future version.
Instructions for updating:
Please use `layer.__call__` method instead.
W0410 01:17:17.419944 139691431679872 deprecation.py:323] From /usr/local/lib/python3.6/dist-packages/tensorflow/python/layers/core.py:332: Layer.apply (from tensorflow.python.keras.engine.base_layer_v1) is deprecated and will be removed in a future version.
Instructions for updating:
Please use `layer.__call__` method instead.
-----------------------testSingleTrainingStepArchitectures,s
I0410 01:17:17.429465 139691431679872 datasets.py:104] ImageDatasetV2(name=RotorWinding_128, tfds_name=RotorWinding2020, resolution=128, colors=3, num_classes=2, eval_test_samples=1742, seed=547)
-----------------------tf.estimator.TrainSpec
-----------------------tf.estimator.EvalSpec
-----------------------gan.as_estimator
--------------------------------------------modular_gan.py/as_estimator,s
--------------------------------------------modular_gan.py/as_estimator,e
INFO:tensorflow:Using config: {'_model_dir': '/tmp/absl_testing/429596', '_tf_random_seed': None, '_save_summary_steps': 100, '_save_checkpoints_steps': 200, '_save_checkpoints_secs': None, '_session_config': gpu_options {
  per_process_gpu_memory_fraction: 0.9
}
allow_soft_placement: true
, '_keep_checkpoint_max': 1, '_keep_checkpoint_every_n_hours': 10000, '_log_step_count_steps': 100, '_train_distribute': None, '_device_fn': None, '_protocol': None, '_eval_distribute': None, '_experimental_distribute': None, '_experimental_max_worker_delay_secs': None, '_session_creation_timeout_secs': 7200, '_service': None, '_cluster_spec': ClusterSpec({}), '_task_type': 'worker', '_task_id': 0, '_global_id_in_cluster': 0, '_master': '', '_evaluation_master': '', '_is_chief': True, '_num_ps_replicas': 0, '_num_worker_replicas': 1}
I0410 01:17:17.430475 139691431679872 estimator.py:191] Using config: {'_model_dir': '/tmp/absl_testing/429596', '_tf_random_seed': None, '_save_summary_steps': 100, '_save_checkpoints_steps': 200, '_save_checkpoints_secs': None, '_session_config': gpu_options {
  per_process_gpu_memory_fraction: 0.9
}
allow_soft_placement: true
, '_keep_checkpoint_max': 1, '_keep_checkpoint_every_n_hours': 10000, '_log_step_count_steps': 100, '_train_distribute': None, '_device_fn': None, '_protocol': None, '_eval_distribute': None, '_experimental_distribute': None, '_experimental_max_worker_delay_secs': None, '_session_creation_timeout_secs': 7200, '_service': None, '_cluster_spec': ClusterSpec({}), '_task_type': 'worker', '_task_id': 0, '_global_id_in_cluster': 0, '_master': '', '_evaluation_master': '', '_is_chief': True, '_num_ps_replicas': 0, '_num_worker_replicas': 1}
-----------------------tf.estimator.train_and_evaluate
INFO:tensorflow:Not using Distribute Coordinator.
I0410 01:17:17.430890 139691431679872 estimator_training.py:186] Not using Distribute Coordinator.
INFO:tensorflow:Running training and evaluation locally (non-distributed).
I0410 01:17:17.431092 139691431679872 training.py:612] Running training and evaluation locally (non-distributed).
INFO:tensorflow:Start train and evaluate loop. The evaluate will happen after every checkpoint. Checkpoint frequency is determined based on RunConfig arguments: save_checkpoints_steps 200 or save_checkpoints_secs None.
I0410 01:17:17.431332 139691431679872 training.py:700] Start train and evaluate loop. The evaluate will happen after every checkpoint. Checkpoint frequency is determined based on RunConfig arguments: save_checkpoints_steps 200 or save_checkpoints_secs None.
WARNING:tensorflow:From /usr/local/lib/python3.6/dist-packages/tensorflow/python/ops/resource_variable_ops.py:1666: calling BaseResourceVariable.__init__ (from tensorflow.python.ops.resource_variable_ops) with constraint is deprecated and will be removed in a future version.
Instructions for updating:
If using Keras pass *_constraint arguments to layers.
W0410 01:17:17.435423 139691431679872 deprecation.py:506] From /usr/local/lib/python3.6/dist-packages/tensorflow/python/ops/resource_variable_ops.py:1666: calling BaseResourceVariable.__init__ (from tensorflow.python.ops.resource_variable_ops) with constraint is deprecated and will be removed in a future version.
Instructions for updating:
If using Keras pass *_constraint arguments to layers.
WARNING:tensorflow:From /usr/local/lib/python3.6/dist-packages/tensorflow/python/training/training_util.py:236: Variable.initialized_value (from tensorflow.python.ops.variables) is deprecated and will be removed in a future version.
Instructions for updating:
Use Variable.read_value. Variables in 2.X are initialized automatically both in eager and graph (inside tf.defun) contexts.
W0410 01:17:17.435796 139691431679872 deprecation.py:323] From /usr/local/lib/python3.6/dist-packages/tensorflow/python/training/training_util.py:236: Variable.initialized_value (from tensorflow.python.ops.variables) is deprecated and will be removed in a future version.
Instructions for updating:
Use Variable.read_value. Variables in 2.X are initialized automatically both in eager and graph (inside tf.defun) contexts.
2020-04-10 01:17:17.447699: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2020-04-10 01:17:17.504051: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-04-10 01:17:17.504708: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:00:04.0 name: Tesla P4 computeCapability: 6.1
coreClock: 1.1135GHz coreCount: 20 deviceMemorySize: 7.43GiB deviceMemoryBandwidth: 178.99GiB/s
2020-04-10 01:17:17.504753: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.1
2020-04-10 01:17:17.504851: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10
2020-04-10 01:17:17.504892: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcufft.so.10
2020-04-10 01:17:17.504938: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcurand.so.10
2020-04-10 01:17:17.504968: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusolver.so.10
2020-04-10 01:17:17.523676: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusparse.so.10
2020-04-10 01:17:17.523753: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudnn.so.7
2020-04-10 01:17:17.523877: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-04-10 01:17:17.524482: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-04-10 01:17:17.525119: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1703] Adding visible gpu devices: 0
--------------------------------------------modular_gan.py/input_fn,s/e
--------------------------------------------datasets.py/input_fn,s/e
--------------------------------------------datasets.py/train_input_fn,s
W0410 01:17:17.539407 139691431679872 datasets.py:170] No TPUContext, using unmodified dataset seed 547.
I0410 01:17:17.539549 139691431679872 datasets.py:304] train_input_fn(): params={'use_tpu': False, 'train_batch_size': 8, 'batch_size': 8} seed=547
--------------------------------------------datasets.py/_load_dataset,s
!!!!!!!!!!!!!!!!!!!!!!----load_local_datasets,  _local_train_ds_dir= /content/drive/My Drive/drive/gan/train
-----------------------------------------get_local_datasets,s
-----------------------------------------get_local_datasets,e
WARNING:tensorflow:From /usr/local/lib/python3.6/dist-packages/tensorflow/python/ops/image_ops_impl.py:2827: sample_distorted_bounding_box (from tensorflow.python.ops.image_ops_impl) is deprecated and will be removed in a future version.
Instructions for updating:
`seed2` arg is deprecated.Use sample_distorted_bounding_box_v2 instead.
W0410 01:18:09.277375 139691431679872 deprecation.py:323] From /usr/local/lib/python3.6/dist-packages/tensorflow/python/ops/image_ops_impl.py:2827: sample_distorted_bounding_box (from tensorflow.python.ops.image_ops_impl) is deprecated and will be removed in a future version.
Instructions for updating:
`seed2` arg is deprecated.Use sample_distorted_bounding_box_v2 instead.
--------------------------------------------modular_gan.py/_preprocess_fn,s
I0410 01:18:10.748395 139691431679872 api.py:587] _preprocess_fn(): images=Tensor("args_0:0", shape=(128, 128, 3), dtype=float32), labels=Tensor("args_1:0", shape=(), dtype=int32), seed=547
--------------------------------------------modular_gan.py/_preprocess_fn,e
WARNING:tensorflow:From /content/drive/My Drive/drive/gan/gan_git-02/gan_git/compare_gan/tpu/tpu_random.py:65: enumerate_dataset (from tensorflow.python.data.experimental.ops.enumerate_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.data.Dataset.enumerate()
W0410 01:18:13.303265 139691431679872 deprecation.py:323] From /content/drive/My Drive/drive/gan/gan_git-02/gan_git/compare_gan/tpu/tpu_random.py:65: enumerate_dataset (from tensorflow.python.data.experimental.ops.enumerate_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.data.Dataset.enumerate()
I0410 01:18:13.423307 139691431679872 api.py:587] Passing random offset: Tensor("Cast:0", shape=(), dtype=int32) with data ({'images': <tf.Tensor 'args_1:0' shape=(128, 128, 3) dtype=float32>, 'z': <tf.Tensor 'args_3:0' shape=(120,) dtype=float32>, 'sampled_labels': <tf.Tensor 'args_2:0' shape=() dtype=int32>}, <tf.Tensor 'args_4:0' shape=() dtype=int32>).
--------------------------------------------datasets.py/train_input_fn,e
INFO:tensorflow:Calling model_fn.
I0410 01:18:13.446093 139691431679872 estimator.py:1169] Calling model_fn.
--------------------------------------------modular_gan.py/model_fn,s
I0410 01:18:13.446259 139691431679872 modular_gan.py:589] model_fn(): features={'images': <tf.Tensor 'IteratorGetNext:1' shape=(8, 128, 128, 3) dtype=float32>, 'z': <tf.Tensor 'IteratorGetNext:3' shape=(8, 120) dtype=float32>, 'sampled_labels': <tf.Tensor 'IteratorGetNext:2' shape=(8,) dtype=int32>, '_RANDOM_OFFSET': <tf.Tensor 'IteratorGetNext:0' shape=(8,) dtype=int32>}, labels=Tensor("IteratorGetNext:4", shape=(8,), dtype=int32),mode=train, params={'use_tpu': False, 'train_batch_size': 8, 'batch_size': 8}
#Clean old summaries from previous calls to model_fn().
# Get features and labels for each sub-step.
--------------------------------------------modular_gan.py/_split_inputs_and_generate_samples,s
I0410 01:18:13.453638 139691431679872 resnet_biggan.py:236] [Generator] inputs are z=(8, 120), y=(8, 2)
I0410 01:18:13.465064 139691431679872 resnet_biggan.py:262] [Generator] z0=(8, 20), z_per_block=['(8, 20)', '(8, 20)', '(8, 20)', '(8, 20)', '(8, 20)'], y_per_block=['(8, 148)', '(8, 148)', '(8, 148)', '(8, 148)', '(8, 148)']
I0410 01:18:13.518882 139691431679872 resnet_biggan.py:150] [Block] (8, 4, 4, 1536) (z=(8, 20), y=(8, 148)) -> (8, 8, 8, 1536)
I0410 01:18:13.566762 139691431679872 resnet_biggan.py:150] [Block] (8, 8, 8, 1536) (z=(8, 20), y=(8, 148)) -> (8, 16, 16, 768)
I0410 01:18:13.605843 139691431679872 resnet_biggan.py:150] [Block] (8, 16, 16, 768) (z=(8, 20), y=(8, 148)) -> (8, 32, 32, 384)
I0410 01:18:13.649764 139691431679872 resnet_biggan.py:150] [Block] (8, 32, 32, 384) (z=(8, 20), y=(8, 148)) -> (8, 64, 64, 192)
I0410 01:18:13.649950 139691431679872 resnet_biggan.py:289] [Generator] Applying non-local block to (8, 64, 64, 192)
WARNING:tensorflow:From /content/drive/My Drive/drive/gan/gan_git-02/gan_git/compare_gan/architectures/arch_ops.py:741: max_pooling2d (from tensorflow.python.layers.pooling) is deprecated and will be removed in a future version.
Instructions for updating:
Use keras.layers.MaxPooling2D instead.
W0410 01:18:13.663765 139691431679872 deprecation.py:323] From /content/drive/My Drive/drive/gan/gan_git-02/gan_git/compare_gan/architectures/arch_ops.py:741: max_pooling2d (from tensorflow.python.layers.pooling) is deprecated and will be removed in a future version.
Instructions for updating:
Use keras.layers.MaxPooling2D instead.
I0410 01:18:13.732096 139691431679872 resnet_biggan.py:150] [Block] (8, 64, 64, 192) (z=(8, 20), y=(8, 148)) -> (8, 128, 128, 96)
I0410 01:18:13.732259 139691431679872 resnet_biggan.py:294] [Generator] before final processing: (8, 128, 128, 96)
I0410 01:18:13.765553 139691431679872 resnet_biggan.py:300] [Generator] after final processing: (8, 128, 128, 3)
--------------------------------------------modular_gan.py/_split_inputs_and_generate_samples,e
##################################################  mode == tf.estimator.ModeKeys.TRAIN ########################
#simpeler train_disc_fn
#simpeler train_gen_fn
#confirm train_gen_fn
# Train D.(train d_steps)
I0410 01:18:13.771857 139691431679872 tpu_random.py:86] Got global random offset: Tensor("disc_step_1/strided_slice:0", shape=(), dtype=int32)
---------------------------------------------------s3gan.py/create_loss,s
W0410 01:18:13.774380 139691431679872 s3gan.py:237] Computing fake images for every sub step separately.
I0410 01:18:13.774575 139691431679872 resnet_biggan.py:236] [Generator] inputs are z=(8, 120), y=(8, 2)
I0410 01:18:13.779823 139691431679872 resnet_biggan.py:262] [Generator] z0=(8, 20), z_per_block=['(8, 20)', '(8, 20)', '(8, 20)', '(8, 20)', '(8, 20)'], y_per_block=['(8, 148)', '(8, 148)', '(8, 148)', '(8, 148)', '(8, 148)']
I0410 01:18:13.799599 139691431679872 resnet_biggan.py:150] [Block] (8, 4, 4, 1536) (z=(8, 20), y=(8, 148)) -> (8, 8, 8, 1536)
I0410 01:18:13.816752 139691431679872 resnet_biggan.py:150] [Block] (8, 8, 8, 1536) (z=(8, 20), y=(8, 148)) -> (8, 16, 16, 768)
I0410 01:18:13.834494 139691431679872 resnet_biggan.py:150] [Block] (8, 16, 16, 768) (z=(8, 20), y=(8, 148)) -> (8, 32, 32, 384)
I0410 01:18:13.851140 139691431679872 resnet_biggan.py:150] [Block] (8, 32, 32, 384) (z=(8, 20), y=(8, 148)) -> (8, 64, 64, 192)
I0410 01:18:13.851312 139691431679872 resnet_biggan.py:289] [Generator] Applying non-local block to (8, 64, 64, 192)
I0410 01:18:13.889388 139691431679872 resnet_biggan.py:150] [Block] (8, 64, 64, 192) (z=(8, 20), y=(8, 148)) -> (8, 128, 128, 96)
I0410 01:18:13.889588 139691431679872 resnet_biggan.py:294] [Generator] before final processing: (8, 128, 128, 96)
I0410 01:18:13.904629 139691431679872 resnet_biggan.py:300] [Generator] after final processing: (8, 128, 128, 3)
I0410 01:18:13.906587 139691431679872 s3gan.py:249] bs=8, rotated_bs=4, num_rot_examples=1
---------------------------------------------------s3gan.py/merge_with_rotation_data,s
---------------------------------------------------s3gan.py/merge_with_rotation_data,e
--------------------------------------------------------------------s3gan.py/discriminator_with_additonal_heads,s
I0410 01:18:13.933697 139691431679872 resnet_biggan.py:379] [Discriminator] inputs are x=(22, 128, 128, 3), y=(22, 2)
I0410 01:18:13.969140 139691431679872 resnet_biggan.py:150] [Block] (22, 128, 128, 3) (z=None, y=(22, 2)) -> (22, 64, 64, 96)
I0410 01:18:13.969292 139691431679872 resnet_biggan.py:398] [Discriminator] Applying non-local block to (22, 64, 64, 96)
I0410 01:18:14.040602 139691431679872 resnet_biggan.py:150] [Block] (22, 64, 64, 96) (z=None, y=(22, 2)) -> (22, 32, 32, 192)
I0410 01:18:14.074995 139691431679872 resnet_biggan.py:150] [Block] (22, 32, 32, 192) (z=None, y=(22, 2)) -> (22, 16, 16, 384)
I0410 01:18:14.106869 139691431679872 resnet_biggan.py:150] [Block] (22, 16, 16, 384) (z=None, y=(22, 2)) -> (22, 8, 8, 768)
I0410 01:18:14.138863 139691431679872 resnet_biggan.py:150] [Block] (22, 8, 8, 768) (z=None, y=(22, 2)) -> (22, 4, 4, 1536)
I0410 01:18:14.159261 139691431679872 resnet_biggan.py:150] [Block] (22, 4, 4, 1536) (z=None, y=(22, 2)) -> (22, 4, 4, 1536)
I0410 01:18:14.159411 139691431679872 resnet_biggan.py:403] [Discriminator] before final processing: (22, 4, 4, 1536)
I0410 01:18:14.169933 139691431679872 resnet_biggan.py:407] [Discriminator] after final processing: (22, 4, 4, 1536)
I0410 01:18:14.176597 139691431679872 resnet_biggan.py:422] [Discriminator] embedded_y for projection: (22, 1536)
I0410 01:18:14.189757 139691431679872 s3gan.py:133] [Discriminator] rotation head (22, 1536) -> Tensor("disc_step_1/discriminator_rotation/score_classify/add:0", shape=(22, 4), dtype=float32)
I0410 01:18:14.202777 139691431679872 s3gan.py:154] [Discriminator] (22, 2) -> aux_logits=(22, 2), y_predicted=(22, 2)
---------------------------------------------------s3gan.py/get_class_embedding,s
I0410 01:18:14.209410 139691431679872 s3gan.py:175] [Discriminator] embedded_y for projection: (22, 1536)
---------------------------------------------------s3gan.py/get_class_embedding,e
---------------------------------------------------s3gan.py/discriminator_with_additonal_heads,e
---------------------------------------------------s3gan.py/create_loss,e
# Train G.(train one step)
I0410 01:18:15.172583 139691431679872 tpu_random.py:86] Got global random offset: Tensor("gen_step/strided_slice:0", shape=(), dtype=int32)
---------------------------------------------------s3gan.py/create_loss,s
W0410 01:18:15.175855 139691431679872 s3gan.py:237] Computing fake images for every sub step separately.
I0410 01:18:15.176113 139691431679872 resnet_biggan.py:236] [Generator] inputs are z=(8, 120), y=(8, 2)
I0410 01:18:15.182150 139691431679872 resnet_biggan.py:262] [Generator] z0=(8, 20), z_per_block=['(8, 20)', '(8, 20)', '(8, 20)', '(8, 20)', '(8, 20)'], y_per_block=['(8, 148)', '(8, 148)', '(8, 148)', '(8, 148)', '(8, 148)']
I0410 01:18:15.203011 139691431679872 resnet_biggan.py:150] [Block] (8, 4, 4, 1536) (z=(8, 20), y=(8, 148)) -> (8, 8, 8, 1536)
I0410 01:18:15.221733 139691431679872 resnet_biggan.py:150] [Block] (8, 8, 8, 1536) (z=(8, 20), y=(8, 148)) -> (8, 16, 16, 768)
I0410 01:18:15.239273 139691431679872 resnet_biggan.py:150] [Block] (8, 16, 16, 768) (z=(8, 20), y=(8, 148)) -> (8, 32, 32, 384)
I0410 01:18:15.257561 139691431679872 resnet_biggan.py:150] [Block] (8, 32, 32, 384) (z=(8, 20), y=(8, 148)) -> (8, 64, 64, 192)
I0410 01:18:15.257752 139691431679872 resnet_biggan.py:289] [Generator] Applying non-local block to (8, 64, 64, 192)
I0410 01:18:15.294698 139691431679872 resnet_biggan.py:150] [Block] (8, 64, 64, 192) (z=(8, 20), y=(8, 148)) -> (8, 128, 128, 96)
I0410 01:18:15.294916 139691431679872 resnet_biggan.py:294] [Generator] before final processing: (8, 128, 128, 96)
I0410 01:18:15.309954 139691431679872 resnet_biggan.py:300] [Generator] after final processing: (8, 128, 128, 3)
I0410 01:18:15.311726 139691431679872 s3gan.py:249] bs=8, rotated_bs=4, num_rot_examples=1
---------------------------------------------------s3gan.py/merge_with_rotation_data,s
---------------------------------------------------s3gan.py/merge_with_rotation_data,e
--------------------------------------------------------------------s3gan.py/discriminator_with_additonal_heads,s
I0410 01:18:15.337193 139691431679872 resnet_biggan.py:379] [Discriminator] inputs are x=(22, 128, 128, 3), y=(22, 2)
I0410 01:18:15.346935 139691431679872 resnet_biggan.py:150] [Block] (22, 128, 128, 3) (z=None, y=(22, 2)) -> (22, 64, 64, 96)
I0410 01:18:15.347115 139691431679872 resnet_biggan.py:398] [Discriminator] Applying non-local block to (22, 64, 64, 96)
I0410 01:18:15.374790 139691431679872 resnet_biggan.py:150] [Block] (22, 64, 64, 96) (z=None, y=(22, 2)) -> (22, 32, 32, 192)
I0410 01:18:15.387305 139691431679872 resnet_biggan.py:150] [Block] (22, 32, 32, 192) (z=None, y=(22, 2)) -> (22, 16, 16, 384)
I0410 01:18:15.397378 139691431679872 resnet_biggan.py:150] [Block] (22, 16, 16, 384) (z=None, y=(22, 2)) -> (22, 8, 8, 768)
I0410 01:18:15.407649 139691431679872 resnet_biggan.py:150] [Block] (22, 8, 8, 768) (z=None, y=(22, 2)) -> (22, 4, 4, 1536)
I0410 01:18:15.414151 139691431679872 resnet_biggan.py:150] [Block] (22, 4, 4, 1536) (z=None, y=(22, 2)) -> (22, 4, 4, 1536)
I0410 01:18:15.414315 139691431679872 resnet_biggan.py:403] [Discriminator] before final processing: (22, 4, 4, 1536)
I0410 01:18:15.417328 139691431679872 resnet_biggan.py:407] [Discriminator] after final processing: (22, 4, 4, 1536)
I0410 01:18:15.419049 139691431679872 resnet_biggan.py:422] [Discriminator] embedded_y for projection: (22, 1536)
I0410 01:18:15.424880 139691431679872 s3gan.py:133] [Discriminator] rotation head (22, 1536) -> Tensor("gen_step/discriminator_rotation/score_classify/add:0", shape=(22, 4), dtype=float32)
I0410 01:18:15.430991 139691431679872 s3gan.py:154] [Discriminator] (22, 2) -> aux_logits=(22, 2), y_predicted=(22, 2)
---------------------------------------------------s3gan.py/get_class_embedding,s
I0410 01:18:15.432300 139691431679872 s3gan.py:175] [Discriminator] embedded_y for projection: (22, 1536)
---------------------------------------------------s3gan.py/get_class_embedding,e
---------------------------------------------------s3gan.py/discriminator_with_additonal_heads,e
---------------------------------------------------s3gan.py/create_loss,e
#add loss to summary
I0410 01:18:16.705673 139691431679872 utils.py:174] 
Generator variables:
+--------------------------------------------------+--------------------+------------+---------+
| Name                                             | Shape              | Size       | Type    |
+--------------------------------------------------+--------------------+------------+---------+
| generator/embed_y/kernel:0                       |           (2, 128) |        256 | float32 |
| generator/fc_noise/kernel:0                      |        (20, 24576) |    491,520 | float32 |
| generator/fc_noise/bias:0                        |           (24576,) |     24,576 | float32 |
| generator/B1/up_conv1/kernel:0                   | (3, 3, 1536, 1536) | 21,233,664 | float32 |
| generator/B1/up_conv1/bias:0                     |            (1536,) |      1,536 | float32 |
| generator/B1/same_conv2/kernel:0                 | (3, 3, 1536, 1536) | 21,233,664 | float32 |
| generator/B1/same_conv2/bias:0                   |            (1536,) |      1,536 | float32 |
| generator/B1/up_conv_shortcut/kernel:0           | (1, 1, 1536, 1536) |  2,359,296 | float32 |
| generator/B1/up_conv_shortcut/bias:0             |            (1536,) |      1,536 | float32 |
| generator/B2/up_conv1/kernel:0                   |  (3, 3, 1536, 768) | 10,616,832 | float32 |
| generator/B2/up_conv1/bias:0                     |             (768,) |        768 | float32 |
| generator/B2/same_conv2/kernel:0                 |   (3, 3, 768, 768) |  5,308,416 | float32 |
| generator/B2/same_conv2/bias:0                   |             (768,) |        768 | float32 |
| generator/B2/up_conv_shortcut/kernel:0           |  (1, 1, 1536, 768) |  1,179,648 | float32 |
| generator/B2/up_conv_shortcut/bias:0             |             (768,) |        768 | float32 |
| generator/B3/up_conv1/kernel:0                   |   (3, 3, 768, 384) |  2,654,208 | float32 |
| generator/B3/up_conv1/bias:0                     |             (384,) |        384 | float32 |
| generator/B3/same_conv2/kernel:0                 |   (3, 3, 384, 384) |  1,327,104 | float32 |
| generator/B3/same_conv2/bias:0                   |             (384,) |        384 | float32 |
| generator/B3/up_conv_shortcut/kernel:0           |   (1, 1, 768, 384) |    294,912 | float32 |
| generator/B3/up_conv_shortcut/bias:0             |             (384,) |        384 | float32 |
| generator/B4/up_conv1/kernel:0                   |   (3, 3, 384, 192) |    663,552 | float32 |
| generator/B4/up_conv1/bias:0                     |             (192,) |        192 | float32 |
| generator/B4/same_conv2/kernel:0                 |   (3, 3, 192, 192) |    331,776 | float32 |
| generator/B4/same_conv2/bias:0                   |             (192,) |        192 | float32 |
| generator/B4/up_conv_shortcut/kernel:0           |   (1, 1, 384, 192) |     73,728 | float32 |
| generator/B4/up_conv_shortcut/bias:0             |             (192,) |        192 | float32 |
| generator/non_local_block/conv2d_theta/kernel:0  |    (1, 1, 192, 24) |      4,608 | float32 |
| generator/non_local_block/conv2d_phi/kernel:0    |    (1, 1, 192, 24) |      4,608 | float32 |
| generator/non_local_block/conv2d_g/kernel:0      |    (1, 1, 192, 96) |     18,432 | float32 |
| generator/non_local_block/sigma:0                |                 () |          1 | float32 |
| generator/non_local_block/conv2d_attn_g/kernel:0 |    (1, 1, 96, 192) |     18,432 | float32 |
| generator/B5/up_conv1/kernel:0                   |    (3, 3, 192, 96) |    165,888 | float32 |
| generator/B5/up_conv1/bias:0                     |              (96,) |         96 | float32 |
| generator/B5/same_conv2/kernel:0                 |     (3, 3, 96, 96) |     82,944 | float32 |
| generator/B5/same_conv2/bias:0                   |              (96,) |         96 | float32 |
| generator/B5/up_conv_shortcut/kernel:0           |    (1, 1, 192, 96) |     18,432 | float32 |
| generator/B5/up_conv_shortcut/bias:0             |              (96,) |         96 | float32 |
| generator/final_norm/gamma:0                     |              (96,) |         96 | float32 |
| generator/final_norm/beta:0                      |              (96,) |         96 | float32 |
| generator/final_conv/kernel:0                    |      (3, 3, 96, 3) |      2,592 | float32 |
| generator/final_conv/bias:0                      |               (3,) |          3 | float32 |
+--------------------------------------------------+--------------------+------------+---------+
Total: 68,118,212
I0410 01:18:16.706647 139691431679872 utils.py:174] 
Discriminator variables:
+------------------------------------------------------+--------------------+------------+---------+
| Name                                                 | Shape              | Size       | Type    |
+------------------------------------------------------+--------------------+------------+---------+
| discriminator/B1/same_conv1/kernel:0                 |      (3, 3, 3, 96) |      2,592 | float32 |
| discriminator/B1/same_conv1/bias:0                   |              (96,) |         96 | float32 |
| discriminator/B1/down_conv2/kernel:0                 |     (3, 3, 96, 96) |     82,944 | float32 |
| discriminator/B1/down_conv2/bias:0                   |              (96,) |         96 | float32 |
| discriminator/B1/down_conv_shortcut/kernel:0         |      (1, 1, 3, 96) |        288 | float32 |
| discriminator/B1/down_conv_shortcut/bias:0           |              (96,) |         96 | float32 |
| discriminator/non_local_block/conv2d_theta/kernel:0  |     (1, 1, 96, 12) |      1,152 | float32 |
| discriminator/non_local_block/conv2d_phi/kernel:0    |     (1, 1, 96, 12) |      1,152 | float32 |
| discriminator/non_local_block/conv2d_g/kernel:0      |     (1, 1, 96, 48) |      4,608 | float32 |
| discriminator/non_local_block/sigma:0                |                 () |          1 | float32 |
| discriminator/non_local_block/conv2d_attn_g/kernel:0 |     (1, 1, 48, 96) |      4,608 | float32 |
| discriminator/B2/same_conv1/kernel:0                 |    (3, 3, 96, 192) |    165,888 | float32 |
| discriminator/B2/same_conv1/bias:0                   |             (192,) |        192 | float32 |
| discriminator/B2/down_conv2/kernel:0                 |   (3, 3, 192, 192) |    331,776 | float32 |
| discriminator/B2/down_conv2/bias:0                   |             (192,) |        192 | float32 |
| discriminator/B2/down_conv_shortcut/kernel:0         |    (1, 1, 96, 192) |     18,432 | float32 |
| discriminator/B2/down_conv_shortcut/bias:0           |             (192,) |        192 | float32 |
| discriminator/B3/same_conv1/kernel:0                 |   (3, 3, 192, 384) |    663,552 | float32 |
| discriminator/B3/same_conv1/bias:0                   |             (384,) |        384 | float32 |
| discriminator/B3/down_conv2/kernel:0                 |   (3, 3, 384, 384) |  1,327,104 | float32 |
| discriminator/B3/down_conv2/bias:0                   |             (384,) |        384 | float32 |
| discriminator/B3/down_conv_shortcut/kernel:0         |   (1, 1, 192, 384) |     73,728 | float32 |
| discriminator/B3/down_conv_shortcut/bias:0           |             (384,) |        384 | float32 |
| discriminator/B4/same_conv1/kernel:0                 |   (3, 3, 384, 768) |  2,654,208 | float32 |
| discriminator/B4/same_conv1/bias:0                   |             (768,) |        768 | float32 |
| discriminator/B4/down_conv2/kernel:0                 |   (3, 3, 768, 768) |  5,308,416 | float32 |
| discriminator/B4/down_conv2/bias:0                   |             (768,) |        768 | float32 |
| discriminator/B4/down_conv_shortcut/kernel:0         |   (1, 1, 384, 768) |    294,912 | float32 |
| discriminator/B4/down_conv_shortcut/bias:0           |             (768,) |        768 | float32 |
| discriminator/B5/same_conv1/kernel:0                 |  (3, 3, 768, 1536) | 10,616,832 | float32 |
| discriminator/B5/same_conv1/bias:0                   |            (1536,) |      1,536 | float32 |
| discriminator/B5/down_conv2/kernel:0                 | (3, 3, 1536, 1536) | 21,233,664 | float32 |
| discriminator/B5/down_conv2/bias:0                   |            (1536,) |      1,536 | float32 |
| discriminator/B5/down_conv_shortcut/kernel:0         |  (1, 1, 768, 1536) |  1,179,648 | float32 |
| discriminator/B5/down_conv_shortcut/bias:0           |            (1536,) |      1,536 | float32 |
| discriminator/B6/same_conv1/kernel:0                 | (3, 3, 1536, 1536) | 21,233,664 | float32 |
| discriminator/B6/same_conv1/bias:0                   |            (1536,) |      1,536 | float32 |
| discriminator/B6/same_conv2/kernel:0                 | (3, 3, 1536, 1536) | 21,233,664 | float32 |
| discriminator/B6/same_conv2/bias:0                   |            (1536,) |      1,536 | float32 |
| discriminator/final_fc/kernel:0                      |          (1536, 1) |      1,536 | float32 |
| discriminator/final_fc/bias:0                        |               (1,) |          1 | float32 |
| discriminator/embedding_fc/kernel:0                  |          (2, 1536) |      3,072 | float32 |
| discriminator_rotation/score_classify/kernel:0       |          (1536, 4) |      6,144 | float32 |
| discriminator_rotation/score_classify/bias:0         |               (4,) |          4 | float32 |
| discriminator_predictor/predictor_linear/kernel:0    |          (1536, 2) |      3,072 | float32 |
| discriminator_predictor/predictor_linear/bias:0      |               (2,) |          2 | float32 |
| discriminator_projection/kernel:0                    |          (2, 1536) |      3,072 | float32 |
+------------------------------------------------------+--------------------+------------+---------+
Total: 86,461,736
--------------------------------------------modular_gan.py/model_fn,e
INFO:tensorflow:Done calling model_fn.
I0410 01:18:16.707135 139691431679872 estimator.py:1171] Done calling model_fn.
INFO:tensorflow:Create CheckpointSaverHook.
I0410 01:18:16.708107 139691431679872 basic_session_run_hooks.py:546] Create CheckpointSaverHook.
INFO:tensorflow:Graph was finalized.
I0410 01:18:17.568681 139691431679872 monitored_session.py:246] Graph was finalized.
2020-04-10 01:18:17.569122: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX512F
2020-04-10 01:18:17.581274: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2000165000 Hz
2020-04-10 01:18:17.581477: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x28692c0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-04-10 01:18:17.581509: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-04-10 01:18:17.713788: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-04-10 01:18:17.714560: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0xa0ee000 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2020-04-10 01:18:17.714596: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Tesla P4, Compute Capability 6.1
2020-04-10 01:18:17.715640: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-04-10 01:18:17.717121: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:00:04.0 name: Tesla P4 computeCapability: 6.1
coreClock: 1.1135GHz coreCount: 20 deviceMemorySize: 7.43GiB deviceMemoryBandwidth: 178.99GiB/s
2020-04-10 01:18:17.717179: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.1
2020-04-10 01:18:17.717210: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10
2020-04-10 01:18:17.717229: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcufft.so.10
2020-04-10 01:18:17.717246: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcurand.so.10
2020-04-10 01:18:17.717261: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusolver.so.10
2020-04-10 01:18:17.717301: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusparse.so.10
2020-04-10 01:18:17.717318: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudnn.so.7
2020-04-10 01:18:17.717401: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-04-10 01:18:17.717823: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-04-10 01:18:17.718214: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1703] Adding visible gpu devices: 0
2020-04-10 01:18:17.721308: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.1
2020-04-10 01:18:24.099246: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-04-10 01:18:24.099300: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      0 
2020-04-10 01:18:24.099319: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1121] 0:   N 
2020-04-10 01:18:24.099719: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-04-10 01:18:24.100243: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-04-10 01:18:24.100625: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:39] Overriding allow_growth setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2020-04-10 01:18:24.100677: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1247] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 6850 MB memory) -> physical GPU (device: 0, name: Tesla P4, pci bus id: 0000:00:04.0, compute capability: 6.1)
INFO:tensorflow:Running local_init_op.
I0410 01:18:27.946085 139691431679872 session_manager.py:505] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
I0410 01:18:28.003001 139691431679872 session_manager.py:508] Done running local_init_op.
INFO:tensorflow:Calling checkpoint listeners before saving checkpoint 0...
I0410 01:18:30.455584 139691431679872 basic_session_run_hooks.py:614] Calling checkpoint listeners before saving checkpoint 0...
INFO:tensorflow:Saving checkpoints for 0 into /tmp/absl_testing/429596/model.ckpt.
I0410 01:18:30.455863 139691431679872 basic_session_run_hooks.py:618] Saving checkpoints for 0 into /tmp/absl_testing/429596/model.ckpt.
INFO:tensorflow:Calling checkpoint listeners after saving checkpoint 0...
I0410 01:18:46.586125 139691431679872 basic_session_run_hooks.py:626] Calling checkpoint listeners after saving checkpoint 0...
2020-04-10 01:18:57.481034: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10
2020-04-10 01:19:09.251521: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:184] Filling up shuffle buffer (this may take a while): 26 of 1000
2020-04-10 01:19:19.083105: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:184] Filling up shuffle buffer (this may take a while): 53 of 1000
2020-04-10 01:19:29.563797: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:184] Filling up shuffle buffer (this may take a while): 80 of 1000
2020-04-10 01:19:39.268583: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:184] Filling up shuffle buffer (this may take a while): 107 of 1000
2020-04-10 01:19:49.208609: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:184] Filling up shuffle buffer (this may take a while): 135 of 1000
2020-04-10 01:19:59.069668: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:184] Filling up shuffle buffer (this may take a while): 162 of 1000
2020-04-10 01:20:09.214206: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:184] Filling up shuffle buffer (this may take a while): 180 of 1000
2020-04-10 01:20:19.151291: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:184] Filling up shuffle buffer (this may take a while): 206 of 1000
2020-04-10 01:20:29.334527: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:184] Filling up shuffle buffer (this may take a while): 237 of 1000
2020-04-10 01:20:39.212676: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:184] Filling up shuffle buffer (this may take a while): 259 of 1000
2020-04-10 01:20:49.031724: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:184] Filling up shuffle buffer (this may take a while): 286 of 1000
2020-04-10 01:20:59.149099: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:184] Filling up shuffle buffer (this may take a while): 314 of 1000
2020-04-10 01:21:09.222040: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:184] Filling up shuffle buffer (this may take a while): 344 of 1000
2020-04-10 01:21:19.387915: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:184] Filling up shuffle buffer (this may take a while): 373 of 1000
2020-04-10 01:21:29.072559: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:184] Filling up shuffle buffer (this may take a while): 400 of 1000
2020-04-10 01:21:39.235770: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:184] Filling up shuffle buffer (this may take a while): 424 of 1000
2020-04-10 01:21:49.098312: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:184] Filling up shuffle buffer (this may take a while): 448 of 1000
2020-04-10 01:21:59.253553: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:184] Filling up shuffle buffer (this may take a while): 469 of 1000
2020-04-10 01:22:09.146955: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:184] Filling up shuffle buffer (this may take a while): 499 of 1000
2020-04-10 01:22:25.833939: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:184] Filling up shuffle buffer (this may take a while): 520 of 1000
2020-04-10 01:22:29.142240: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:184] Filling up shuffle buffer (this may take a while): 524 of 1000
2020-04-10 01:22:39.392820: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:184] Filling up shuffle buffer (this may take a while): 555 of 1000
2020-04-10 01:22:49.143610: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:184] Filling up shuffle buffer (this may take a while): 581 of 1000
2020-04-10 01:22:59.094935: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:184] Filling up shuffle buffer (this may take a while): 602 of 1000
2020-04-10 01:23:09.294719: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:184] Filling up shuffle buffer (this may take a while): 630 of 1000
2020-04-10 01:23:19.347260: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:184] Filling up shuffle buffer (this may take a while): 659 of 1000
2020-04-10 01:23:29.301556: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:184] Filling up shuffle buffer (this may take a while): 687 of 1000
2020-04-10 01:23:39.355013: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:184] Filling up shuffle buffer (this may take a while): 714 of 1000
2020-04-10 01:23:49.076524: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:184] Filling up shuffle buffer (this may take a while): 738 of 1000
2020-04-10 01:23:59.365840: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:184] Filling up shuffle buffer (this may take a while): 768 of 1000
2020-04-10 01:24:12.044318: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:184] Filling up shuffle buffer (this may take a while): 794 of 1000
2020-04-10 01:24:19.066860: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:184] Filling up shuffle buffer (this may take a while): 814 of 1000
2020-04-10 01:24:29.049316: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:184] Filling up shuffle buffer (this may take a while): 843 of 1000
2020-04-10 01:24:39.166887: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:184] Filling up shuffle buffer (this may take a while): 874 of 1000
2020-04-10 01:24:49.035049: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:184] Filling up shuffle buffer (this may take a while): 900 of 1000
2020-04-10 01:24:59.239467: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:184] Filling up shuffle buffer (this may take a while): 931 of 1000
2020-04-10 01:25:09.045346: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:184] Filling up shuffle buffer (this may take a while): 952 of 1000
2020-04-10 01:25:19.358780: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:184] Filling up shuffle buffer (this may take a while): 981 of 1000
2020-04-10 01:25:25.816966: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:233] Shuffle buffer filled.
2020-04-10 01:25:28.057877: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudnn.so.7
2020-04-10 01:25:36.712956: W tensorflow/core/common_runtime/bfc_allocator.cc:245] Allocator (GPU_0_bfc) ran out of memory trying to allocate 2.82GiB with freed_by_count=0. The caller indicates that this is not a failure, but may mean that there could be performance gains if more memory were available.
INFO:tensorflow:loss = 72.36852, step = 0
I0410 01:25:39.498007 139691431679872 basic_session_run_hooks.py:262] loss = 72.36852, step = 0
INFO:tensorflow:global_step/sec: 0.347257
I0410 01:30:27.468639 139691431679872 basic_session_run_hooks.py:702] global_step/sec: 0.347257
INFO:tensorflow:loss = 3.4286404, step = 100 (287.972 sec)
I0410 01:30:27.469739 139691431679872 basic_session_run_hooks.py:260] loss = 3.4286404, step = 100 (287.972 sec)
INFO:tensorflow:Calling checkpoint listeners before saving checkpoint 200...
I0410 01:35:21.740266 139691431679872 basic_session_run_hooks.py:614] Calling checkpoint listeners before saving checkpoint 200...
INFO:tensorflow:Saving checkpoints for 200 into /tmp/absl_testing/429596/model.ckpt.
I0410 01:35:21.740519 139691431679872 basic_session_run_hooks.py:618] Saving checkpoints for 200 into /tmp/absl_testing/429596/model.ckpt.
WARNING:tensorflow:From /usr/local/lib/python3.6/dist-packages/tensorflow/python/training/saver.py:971: remove_checkpoint (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to delete files with this prefix.
W0410 01:35:36.559686 139691431679872 deprecation.py:323] From /usr/local/lib/python3.6/dist-packages/tensorflow/python/training/saver.py:971: remove_checkpoint (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to delete files with this prefix.
INFO:tensorflow:Calling checkpoint listeners after saving checkpoint 200...
I0410 01:35:37.137248 139691431679872 basic_session_run_hooks.py:626] Calling checkpoint listeners after saving checkpoint 200...
--------------------------------------------datasets.py/eval_input_fn,s
W0410 01:35:37.267127 139691431679872 datasets.py:170] No TPUContext, using unmodified dataset seed 547.
I0410 01:35:37.267286 139691431679872 datasets.py:348] eval_input_fn(): params={'use_tpu': False, 'train_batch_size': 8, 'batch_size': 8} seed=547
--------befor self._load_dataset------------------split = validation self._eval_split= validation
--------------------------------------------datasets.py/_load_dataset,s
!!!!!!!!!!!!!!!!!!!!!!----load_local_datasets,  _local_test_ds_dir= /content/drive/My Drive/drive/gan/test
-----------------------------------------get_local_datasets,s
-----------------------------------------get_local_datasets,e
--------------------------------------------modular_gan.py/_preprocess_fn,s
I0410 01:35:46.268111 139691431679872 api.py:587] _preprocess_fn(): images=Tensor("args_0:0", shape=(128, 128, 3), dtype=float32), labels=Tensor("args_1:0", shape=(), dtype=int32), seed=547
--------------------------------------------modular_gan.py/_preprocess_fn,e
I0410 01:35:46.296825 139691431679872 api.py:587] Passing random offset: Tensor("Cast:0", shape=(), dtype=int32) with data ({'images': <tf.Tensor 'args_1:0' shape=(128, 128, 3) dtype=float32>, 'z': <tf.Tensor 'args_3:0' shape=(120,) dtype=float32>, 'sampled_labels': <tf.Tensor 'args_2:0' shape=() dtype=int32>}, <tf.Tensor 'args_4:0' shape=() dtype=int32>).
--------------------------------------------datasets.py/eval_input_fn,e
INFO:tensorflow:Calling model_fn.
I0410 01:35:46.313086 139691431679872 estimator.py:1169] Calling model_fn.
--------------------------------------------modular_gan.py/model_fn,s
I0410 01:35:46.313236 139691431679872 modular_gan.py:589] model_fn(): features={'images': <tf.Tensor 'IteratorGetNext:1' shape=(8, 128, 128, 3) dtype=float32>, 'z': <tf.Tensor 'IteratorGetNext:3' shape=(8, 120) dtype=float32>, 'sampled_labels': <tf.Tensor 'IteratorGetNext:2' shape=(8,) dtype=int32>, '_RANDOM_OFFSET': <tf.Tensor 'IteratorGetNext:0' shape=(8,) dtype=int32>}, labels=Tensor("IteratorGetNext:4", shape=(8,), dtype=int32),mode=eval, params={'use_tpu': False, 'train_batch_size': 8, 'batch_size': 8}
#Clean old summaries from previous calls to model_fn().
# Get features and labels for each sub-step.
--------------------------------------------modular_gan.py/_split_inputs_and_generate_samples,s
I0410 01:35:46.321415 139691431679872 resnet_biggan.py:236] [Generator] inputs are z=(8, 120), y=(8, 2)
I0410 01:35:46.334512 139691431679872 resnet_biggan.py:262] [Generator] z0=(8, 20), z_per_block=['(8, 20)', '(8, 20)', '(8, 20)', '(8, 20)', '(8, 20)'], y_per_block=['(8, 148)', '(8, 148)', '(8, 148)', '(8, 148)', '(8, 148)']
I0410 01:35:46.387611 139691431679872 resnet_biggan.py:150] [Block] (8, 4, 4, 1536) (z=(8, 20), y=(8, 148)) -> (8, 8, 8, 1536)
I0410 01:35:46.425737 139691431679872 resnet_biggan.py:150] [Block] (8, 8, 8, 1536) (z=(8, 20), y=(8, 148)) -> (8, 16, 16, 768)
I0410 01:35:46.463373 139691431679872 resnet_biggan.py:150] [Block] (8, 16, 16, 768) (z=(8, 20), y=(8, 148)) -> (8, 32, 32, 384)
I0410 01:35:46.501726 139691431679872 resnet_biggan.py:150] [Block] (8, 32, 32, 384) (z=(8, 20), y=(8, 148)) -> (8, 64, 64, 192)
I0410 01:35:46.501928 139691431679872 resnet_biggan.py:289] [Generator] Applying non-local block to (8, 64, 64, 192)
I0410 01:35:46.586727 139691431679872 resnet_biggan.py:150] [Block] (8, 64, 64, 192) (z=(8, 20), y=(8, 148)) -> (8, 128, 128, 96)
I0410 01:35:46.586960 139691431679872 resnet_biggan.py:294] [Generator] before final processing: (8, 128, 128, 96)
I0410 01:35:46.619672 139691431679872 resnet_biggan.py:300] [Generator] after final processing: (8, 128, 128, 3)
--------------------------------------------modular_gan.py/_split_inputs_and_generate_samples,e
---------------------------------------------------modular_gan.py/create_logits,s
I0410 01:35:46.623205 139691431679872 tpu_random.py:86] Got global random offset: Tensor("strided_slice:0", shape=(), dtype=int32)
---------------------------------------------------s3gan.py/create_loss,s
W0410 01:35:46.625776 139691431679872 s3gan.py:237] Computing fake images for every sub step separately.
I0410 01:35:46.625997 139691431679872 resnet_biggan.py:236] [Generator] inputs are z=(8, 120), y=(8, 2)
I0410 01:35:46.632077 139691431679872 resnet_biggan.py:262] [Generator] z0=(8, 20), z_per_block=['(8, 20)', '(8, 20)', '(8, 20)', '(8, 20)', '(8, 20)'], y_per_block=['(8, 148)', '(8, 148)', '(8, 148)', '(8, 148)', '(8, 148)']
I0410 01:35:46.650572 139691431679872 resnet_biggan.py:150] [Block] (8, 4, 4, 1536) (z=(8, 20), y=(8, 148)) -> (8, 8, 8, 1536)
I0410 01:35:46.666464 139691431679872 resnet_biggan.py:150] [Block] (8, 8, 8, 1536) (z=(8, 20), y=(8, 148)) -> (8, 16, 16, 768)
I0410 01:35:46.685066 139691431679872 resnet_biggan.py:150] [Block] (8, 16, 16, 768) (z=(8, 20), y=(8, 148)) -> (8, 32, 32, 384)
I0410 01:35:46.700956 139691431679872 resnet_biggan.py:150] [Block] (8, 32, 32, 384) (z=(8, 20), y=(8, 148)) -> (8, 64, 64, 192)
I0410 01:35:46.701110 139691431679872 resnet_biggan.py:289] [Generator] Applying non-local block to (8, 64, 64, 192)
I0410 01:35:46.735071 139691431679872 resnet_biggan.py:150] [Block] (8, 64, 64, 192) (z=(8, 20), y=(8, 148)) -> (8, 128, 128, 96)
I0410 01:35:46.735234 139691431679872 resnet_biggan.py:294] [Generator] before final processing: (8, 128, 128, 96)
I0410 01:35:46.750331 139691431679872 resnet_biggan.py:300] [Generator] after final processing: (8, 128, 128, 3)
I0410 01:35:46.751980 139691431679872 s3gan.py:249] bs=8, rotated_bs=4, num_rot_examples=1
---------------------------------------------------s3gan.py/merge_with_rotation_data,s
---------------------------------------------------s3gan.py/merge_with_rotation_data,e
--------------------------------------------------------------------s3gan.py/discriminator_with_additonal_heads,s
I0410 01:35:46.776649 139691431679872 resnet_biggan.py:379] [Discriminator] inputs are x=(22, 128, 128, 3), y=(22, 2)
I0410 01:35:46.809227 139691431679872 resnet_biggan.py:150] [Block] (22, 128, 128, 3) (z=None, y=(22, 2)) -> (22, 64, 64, 96)
I0410 01:35:46.809373 139691431679872 resnet_biggan.py:398] [Discriminator] Applying non-local block to (22, 64, 64, 96)
I0410 01:35:46.879187 139691431679872 resnet_biggan.py:150] [Block] (22, 64, 64, 96) (z=None, y=(22, 2)) -> (22, 32, 32, 192)
I0410 01:35:46.911103 139691431679872 resnet_biggan.py:150] [Block] (22, 32, 32, 192) (z=None, y=(22, 2)) -> (22, 16, 16, 384)
I0410 01:35:46.941258 139691431679872 resnet_biggan.py:150] [Block] (22, 16, 16, 384) (z=None, y=(22, 2)) -> (22, 8, 8, 768)
I0410 01:35:46.972682 139691431679872 resnet_biggan.py:150] [Block] (22, 8, 8, 768) (z=None, y=(22, 2)) -> (22, 4, 4, 1536)
I0410 01:35:46.992150 139691431679872 resnet_biggan.py:150] [Block] (22, 4, 4, 1536) (z=None, y=(22, 2)) -> (22, 4, 4, 1536)
I0410 01:35:46.992296 139691431679872 resnet_biggan.py:403] [Discriminator] before final processing: (22, 4, 4, 1536)
I0410 01:35:47.002379 139691431679872 resnet_biggan.py:407] [Discriminator] after final processing: (22, 4, 4, 1536)
I0410 01:35:47.009084 139691431679872 resnet_biggan.py:422] [Discriminator] embedded_y for projection: (22, 1536)
I0410 01:35:47.022494 139691431679872 s3gan.py:133] [Discriminator] rotation head (22, 1536) -> Tensor("discriminator_rotation/score_classify/add:0", shape=(22, 4), dtype=float32)
I0410 01:35:47.035566 139691431679872 s3gan.py:154] [Discriminator] (22, 2) -> aux_logits=(22, 2), y_predicted=(22, 2)
---------------------------------------------------s3gan.py/get_class_embedding,s
I0410 01:35:47.043537 139691431679872 s3gan.py:175] [Discriminator] embedded_y for projection: (22, 1536)
---------------------------------------------------s3gan.py/get_class_embedding,e
---------------------------------------------------s3gan.py/discriminator_with_additonal_heads,e
---------------------------------------------------s3gan.py/create_loss,e
---------------------------------------------------modular_gan.py/create_logits,e
################################################## mode == tf.estimator.ModeKeys.EVAL  ########################
INFO:tensorflow:Done calling model_fn.
I0410 01:35:47.132645 139691431679872 estimator.py:1171] Done calling model_fn.
INFO:tensorflow:Starting evaluation at 2020-04-10T01:35:47Z
I0410 01:35:47.148746 139691431679872 evaluation.py:255] Starting evaluation at 2020-04-10T01:35:47Z
INFO:tensorflow:Graph was finalized.
I0410 01:35:47.288825 139691431679872 monitored_session.py:246] Graph was finalized.
2020-04-10 01:35:47.290140: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-04-10 01:35:47.290423: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:00:04.0 name: Tesla P4 computeCapability: 6.1
coreClock: 1.1135GHz coreCount: 20 deviceMemorySize: 7.43GiB deviceMemoryBandwidth: 178.99GiB/s
2020-04-10 01:35:47.290469: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.1
2020-04-10 01:35:47.290510: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10
2020-04-10 01:35:47.290538: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcufft.so.10
2020-04-10 01:35:47.290555: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcurand.so.10
2020-04-10 01:35:47.290570: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusolver.so.10
2020-04-10 01:35:47.290621: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusparse.so.10
2020-04-10 01:35:47.290635: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudnn.so.7
2020-04-10 01:35:47.290716: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-04-10 01:35:47.291025: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-04-10 01:35:47.291261: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1703] Adding visible gpu devices: 0
2020-04-10 01:35:47.291319: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-04-10 01:35:47.291332: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      0 
2020-04-10 01:35:47.291341: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1121] 0:   N 
2020-04-10 01:35:47.291427: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-04-10 01:35:47.291705: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-04-10 01:35:47.291964: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1247] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 6850 MB memory) -> physical GPU (device: 0, name: Tesla P4, pci bus id: 0000:00:04.0, compute capability: 6.1)
INFO:tensorflow:Restoring parameters from /tmp/absl_testing/429596/model.ckpt-200
I0410 01:35:47.292841 139691431679872 saver.py:1293] Restoring parameters from /tmp/absl_testing/429596/model.ckpt-200
INFO:tensorflow:Running local_init_op.
I0410 01:35:47.719007 139691431679872 session_manager.py:505] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
I0410 01:35:47.739959 139691431679872 session_manager.py:508] Done running local_init_op.
INFO:tensorflow:Evaluation [1/10]
I0410 01:35:52.792166 139691431679872 evaluation.py:167] Evaluation [1/10]
INFO:tensorflow:Evaluation [2/10]
I0410 01:35:55.733026 139691431679872 evaluation.py:167] Evaluation [2/10]
INFO:tensorflow:Evaluation [3/10]
I0410 01:36:00.455223 139691431679872 evaluation.py:167] Evaluation [3/10]
INFO:tensorflow:Evaluation [4/10]
I0410 01:36:03.070943 139691431679872 evaluation.py:167] Evaluation [4/10]
INFO:tensorflow:Evaluation [5/10]
I0410 01:36:05.619964 139691431679872 evaluation.py:167] Evaluation [5/10]
INFO:tensorflow:Evaluation [6/10]
I0410 01:36:08.644342 139691431679872 evaluation.py:167] Evaluation [6/10]
INFO:tensorflow:Evaluation [7/10]
I0410 01:36:11.387020 139691431679872 evaluation.py:167] Evaluation [7/10]
INFO:tensorflow:Evaluation [8/10]
I0410 01:36:14.183452 139691431679872 evaluation.py:167] Evaluation [8/10]
INFO:tensorflow:Evaluation [9/10]
I0410 01:36:16.998475 139691431679872 evaluation.py:167] Evaluation [9/10]
INFO:tensorflow:Evaluation [10/10]
I0410 01:36:19.682529 139691431679872 evaluation.py:167] Evaluation [10/10]
INFO:tensorflow:Inference Time : 32.67670s
I0410 01:36:19.825616 139691431679872 evaluation.py:273] Inference Time : 32.67670s
INFO:tensorflow:Finished evaluation at 2020-04-10-01:36:19
I0410 01:36:19.825868 139691431679872 evaluation.py:276] Finished evaluation at 2020-04-10-01:36:19
INFO:tensorflow:Saving dict for global step 200: accuracy = 1.0, global_step = 200, loss = 0.12575667
I0410 01:36:19.826037 139691431679872 estimator.py:2066] Saving dict for global step 200: accuracy = 1.0, global_step = 200, loss = 0.12575667
INFO:tensorflow:Saving 'checkpoint_path' summary for global step 200: /tmp/absl_testing/429596/model.ckpt-200
I0410 01:36:20.062213 139691431679872 estimator.py:2127] Saving 'checkpoint_path' summary for global step 200: /tmp/absl_testing/429596/model.ckpt-200
INFO:tensorflow:global_step/sec: 0.282457
I0410 01:36:21.504281 139691431679872 basic_session_run_hooks.py:702] global_step/sec: 0.282457
INFO:tensorflow:loss = 0.607743, step = 200 (354.036 sec)
I0410 01:36:21.505343 139691431679872 basic_session_run_hooks.py:260] loss = 0.607743, step = 200 (354.036 sec)
INFO:tensorflow:global_step/sec: 0.338641
I0410 01:41:16.802692 139691431679872 basic_session_run_hooks.py:702] global_step/sec: 0.338641
INFO:tensorflow:loss = 0.10291315, step = 300 (295.299 sec)
I0410 01:41:16.803920 139691431679872 basic_session_run_hooks.py:260] loss = 0.10291315, step = 300 (295.299 sec)
INFO:tensorflow:Calling checkpoint listeners before saving checkpoint 400...
I0410 01:45:54.833354 139691431679872 basic_session_run_hooks.py:614] Calling checkpoint listeners before saving checkpoint 400...
INFO:tensorflow:Saving checkpoints for 400 into /tmp/absl_testing/429596/model.ckpt.
I0410 01:45:54.833641 139691431679872 basic_session_run_hooks.py:618] Saving checkpoints for 400 into /tmp/absl_testing/429596/model.ckpt.
INFO:tensorflow:Calling checkpoint listeners after saving checkpoint 400...
I0410 01:46:10.634240 139691431679872 basic_session_run_hooks.py:626] Calling checkpoint listeners after saving checkpoint 400...
--------------------------------------------datasets.py/eval_input_fn,s
W0410 01:46:10.743514 139691431679872 datasets.py:170] No TPUContext, using unmodified dataset seed 547.
I0410 01:46:10.743710 139691431679872 datasets.py:348] eval_input_fn(): params={'use_tpu': False, 'train_batch_size': 8, 'batch_size': 8} seed=547
--------befor self._load_dataset------------------split = validation self._eval_split= validation
--------------------------------------------datasets.py/_load_dataset,s
!!!!!!!!!!!!!!!!!!!!!!----load_local_datasets,  _local_test_ds_dir= /content/drive/My Drive/drive/gan/test
-----------------------------------------get_local_datasets,s
-----------------------------------------get_local_datasets,e
--------------------------------------------modular_gan.py/_preprocess_fn,s
I0410 01:46:11.613444 139691431679872 api.py:587] _preprocess_fn(): images=Tensor("args_0:0", shape=(128, 128, 3), dtype=float32), labels=Tensor("args_1:0", shape=(), dtype=int32), seed=547
--------------------------------------------modular_gan.py/_preprocess_fn,e
I0410 01:46:11.679883 139691431679872 api.py:587] Passing random offset: Tensor("Cast:0", shape=(), dtype=int32) with data ({'images': <tf.Tensor 'args_1:0' shape=(128, 128, 3) dtype=float32>, 'z': <tf.Tensor 'args_3:0' shape=(120,) dtype=float32>, 'sampled_labels': <tf.Tensor 'args_2:0' shape=() dtype=int32>}, <tf.Tensor 'args_4:0' shape=() dtype=int32>).
--------------------------------------------datasets.py/eval_input_fn,e
INFO:tensorflow:Calling model_fn.
I0410 01:46:11.712833 139691431679872 estimator.py:1169] Calling model_fn.
--------------------------------------------modular_gan.py/model_fn,s
I0410 01:46:11.713021 139691431679872 modular_gan.py:589] model_fn(): features={'images': <tf.Tensor 'IteratorGetNext:1' shape=(8, 128, 128, 3) dtype=float32>, 'z': <tf.Tensor 'IteratorGetNext:3' shape=(8, 120) dtype=float32>, 'sampled_labels': <tf.Tensor 'IteratorGetNext:2' shape=(8,) dtype=int32>, '_RANDOM_OFFSET': <tf.Tensor 'IteratorGetNext:0' shape=(8,) dtype=int32>}, labels=Tensor("IteratorGetNext:4", shape=(8,), dtype=int32),mode=eval, params={'use_tpu': False, 'train_batch_size': 8, 'batch_size': 8}
#Clean old summaries from previous calls to model_fn().
# Get features and labels for each sub-step.
--------------------------------------------modular_gan.py/_split_inputs_and_generate_samples,s
I0410 01:46:11.719673 139691431679872 resnet_biggan.py:236] [Generator] inputs are z=(8, 120), y=(8, 2)
I0410 01:46:11.729946 139691431679872 resnet_biggan.py:262] [Generator] z0=(8, 20), z_per_block=['(8, 20)', '(8, 20)', '(8, 20)', '(8, 20)', '(8, 20)'], y_per_block=['(8, 148)', '(8, 148)', '(8, 148)', '(8, 148)', '(8, 148)']
I0410 01:46:11.777880 139691431679872 resnet_biggan.py:150] [Block] (8, 4, 4, 1536) (z=(8, 20), y=(8, 148)) -> (8, 8, 8, 1536)
I0410 01:46:11.818512 139691431679872 resnet_biggan.py:150] [Block] (8, 8, 8, 1536) (z=(8, 20), y=(8, 148)) -> (8, 16, 16, 768)
I0410 01:46:11.856220 139691431679872 resnet_biggan.py:150] [Block] (8, 16, 16, 768) (z=(8, 20), y=(8, 148)) -> (8, 32, 32, 384)
I0410 01:46:11.897638 139691431679872 resnet_biggan.py:150] [Block] (8, 32, 32, 384) (z=(8, 20), y=(8, 148)) -> (8, 64, 64, 192)
I0410 01:46:11.897789 139691431679872 resnet_biggan.py:289] [Generator] Applying non-local block to (8, 64, 64, 192)
I0410 01:46:11.978131 139691431679872 resnet_biggan.py:150] [Block] (8, 64, 64, 192) (z=(8, 20), y=(8, 148)) -> (8, 128, 128, 96)
I0410 01:46:11.978322 139691431679872 resnet_biggan.py:294] [Generator] before final processing: (8, 128, 128, 96)
I0410 01:46:12.009638 139691431679872 resnet_biggan.py:300] [Generator] after final processing: (8, 128, 128, 3)
--------------------------------------------modular_gan.py/_split_inputs_and_generate_samples,e
---------------------------------------------------modular_gan.py/create_logits,s
I0410 01:46:12.013721 139691431679872 tpu_random.py:86] Got global random offset: Tensor("strided_slice:0", shape=(), dtype=int32)
---------------------------------------------------s3gan.py/create_loss,s
W0410 01:46:12.016201 139691431679872 s3gan.py:237] Computing fake images for every sub step separately.
I0410 01:46:12.016412 139691431679872 resnet_biggan.py:236] [Generator] inputs are z=(8, 120), y=(8, 2)
I0410 01:46:12.021916 139691431679872 resnet_biggan.py:262] [Generator] z0=(8, 20), z_per_block=['(8, 20)', '(8, 20)', '(8, 20)', '(8, 20)', '(8, 20)'], y_per_block=['(8, 148)', '(8, 148)', '(8, 148)', '(8, 148)', '(8, 148)']
I0410 01:46:12.040576 139691431679872 resnet_biggan.py:150] [Block] (8, 4, 4, 1536) (z=(8, 20), y=(8, 148)) -> (8, 8, 8, 1536)
I0410 01:46:12.060849 139691431679872 resnet_biggan.py:150] [Block] (8, 8, 8, 1536) (z=(8, 20), y=(8, 148)) -> (8, 16, 16, 768)
I0410 01:46:12.079362 139691431679872 resnet_biggan.py:150] [Block] (8, 16, 16, 768) (z=(8, 20), y=(8, 148)) -> (8, 32, 32, 384)
I0410 01:46:12.095424 139691431679872 resnet_biggan.py:150] [Block] (8, 32, 32, 384) (z=(8, 20), y=(8, 148)) -> (8, 64, 64, 192)
I0410 01:46:12.095574 139691431679872 resnet_biggan.py:289] [Generator] Applying non-local block to (8, 64, 64, 192)
I0410 01:46:12.130676 139691431679872 resnet_biggan.py:150] [Block] (8, 64, 64, 192) (z=(8, 20), y=(8, 148)) -> (8, 128, 128, 96)
I0410 01:46:12.130864 139691431679872 resnet_biggan.py:294] [Generator] before final processing: (8, 128, 128, 96)
I0410 01:46:12.145052 139691431679872 resnet_biggan.py:300] [Generator] after final processing: (8, 128, 128, 3)
I0410 01:46:12.146744 139691431679872 s3gan.py:249] bs=8, rotated_bs=4, num_rot_examples=1
---------------------------------------------------s3gan.py/merge_with_rotation_data,s
---------------------------------------------------s3gan.py/merge_with_rotation_data,e
--------------------------------------------------------------------s3gan.py/discriminator_with_additonal_heads,s
I0410 01:46:12.171454 139691431679872 resnet_biggan.py:379] [Discriminator] inputs are x=(22, 128, 128, 3), y=(22, 2)
I0410 01:46:12.203464 139691431679872 resnet_biggan.py:150] [Block] (22, 128, 128, 3) (z=None, y=(22, 2)) -> (22, 64, 64, 96)
I0410 01:46:12.203662 139691431679872 resnet_biggan.py:398] [Discriminator] Applying non-local block to (22, 64, 64, 96)
I0410 01:46:12.279872 139691431679872 resnet_biggan.py:150] [Block] (22, 64, 64, 96) (z=None, y=(22, 2)) -> (22, 32, 32, 192)
I0410 01:46:12.310911 139691431679872 resnet_biggan.py:150] [Block] (22, 32, 32, 192) (z=None, y=(22, 2)) -> (22, 16, 16, 384)
I0410 01:46:12.342165 139691431679872 resnet_biggan.py:150] [Block] (22, 16, 16, 384) (z=None, y=(22, 2)) -> (22, 8, 8, 768)
I0410 01:46:12.372835 139691431679872 resnet_biggan.py:150] [Block] (22, 8, 8, 768) (z=None, y=(22, 2)) -> (22, 4, 4, 1536)
I0410 01:46:12.395275 139691431679872 resnet_biggan.py:150] [Block] (22, 4, 4, 1536) (z=None, y=(22, 2)) -> (22, 4, 4, 1536)
I0410 01:46:12.395450 139691431679872 resnet_biggan.py:403] [Discriminator] before final processing: (22, 4, 4, 1536)
I0410 01:46:12.405608 139691431679872 resnet_biggan.py:407] [Discriminator] after final processing: (22, 4, 4, 1536)
I0410 01:46:12.411511 139691431679872 resnet_biggan.py:422] [Discriminator] embedded_y for projection: (22, 1536)
I0410 01:46:12.423555 139691431679872 s3gan.py:133] [Discriminator] rotation head (22, 1536) -> Tensor("discriminator_rotation/score_classify/add:0", shape=(22, 4), dtype=float32)
I0410 01:46:12.436194 139691431679872 s3gan.py:154] [Discriminator] (22, 2) -> aux_logits=(22, 2), y_predicted=(22, 2)
---------------------------------------------------s3gan.py/get_class_embedding,s
I0410 01:46:12.442189 139691431679872 s3gan.py:175] [Discriminator] embedded_y for projection: (22, 1536)
---------------------------------------------------s3gan.py/get_class_embedding,e
---------------------------------------------------s3gan.py/discriminator_with_additonal_heads,e
---------------------------------------------------s3gan.py/create_loss,e
---------------------------------------------------modular_gan.py/create_logits,e
################################################## mode == tf.estimator.ModeKeys.EVAL  ########################
INFO:tensorflow:Done calling model_fn.
I0410 01:46:12.530916 139691431679872 estimator.py:1171] Done calling model_fn.
INFO:tensorflow:Starting evaluation at 2020-04-10T01:46:12Z
I0410 01:46:12.552760 139691431679872 evaluation.py:255] Starting evaluation at 2020-04-10T01:46:12Z
INFO:tensorflow:Graph was finalized.
I0410 01:46:12.698316 139691431679872 monitored_session.py:246] Graph was finalized.
2020-04-10 01:46:12.699037: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-04-10 01:46:12.699369: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:00:04.0 name: Tesla P4 computeCapability: 6.1
coreClock: 1.1135GHz coreCount: 20 deviceMemorySize: 7.43GiB deviceMemoryBandwidth: 178.99GiB/s
2020-04-10 01:46:12.699427: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.1
2020-04-10 01:46:12.699452: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10
2020-04-10 01:46:12.699471: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcufft.so.10
2020-04-10 01:46:12.699487: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcurand.so.10
2020-04-10 01:46:12.699504: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusolver.so.10
2020-04-10 01:46:12.699548: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusparse.so.10
2020-04-10 01:46:12.699564: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudnn.so.7
2020-04-10 01:46:12.699644: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-04-10 01:46:12.699966: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-04-10 01:46:12.700182: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1703] Adding visible gpu devices: 0
2020-04-10 01:46:12.700227: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-04-10 01:46:12.700263: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      0 
2020-04-10 01:46:12.700276: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1121] 0:   N 
2020-04-10 01:46:12.700385: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-04-10 01:46:12.700640: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-04-10 01:46:12.700870: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1247] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 6850 MB memory) -> physical GPU (device: 0, name: Tesla P4, pci bus id: 0000:00:04.0, compute capability: 6.1)
INFO:tensorflow:Restoring parameters from /tmp/absl_testing/429596/model.ckpt-400
I0410 01:46:12.701782 139691431679872 saver.py:1293] Restoring parameters from /tmp/absl_testing/429596/model.ckpt-400
INFO:tensorflow:Running local_init_op.
I0410 01:46:13.101288 139691431679872 session_manager.py:505] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
I0410 01:46:13.121951 139691431679872 session_manager.py:508] Done running local_init_op.
INFO:tensorflow:Evaluation [1/10]
I0410 01:46:17.671491 139691431679872 evaluation.py:167] Evaluation [1/10]
INFO:tensorflow:Evaluation [2/10]
I0410 01:46:20.031878 139691431679872 evaluation.py:167] Evaluation [2/10]
INFO:tensorflow:Evaluation [3/10]
I0410 01:46:22.237316 139691431679872 evaluation.py:167] Evaluation [3/10]
INFO:tensorflow:Evaluation [4/10]
I0410 01:46:24.407496 139691431679872 evaluation.py:167] Evaluation [4/10]
INFO:tensorflow:Evaluation [5/10]
I0410 01:46:26.615164 139691431679872 evaluation.py:167] Evaluation [5/10]
INFO:tensorflow:Evaluation [6/10]
I0410 01:46:29.884104 139691431679872 evaluation.py:167] Evaluation [6/10]
INFO:tensorflow:Evaluation [7/10]
I0410 01:46:32.712895 139691431679872 evaluation.py:167] Evaluation [7/10]
INFO:tensorflow:Evaluation [8/10]
I0410 01:46:35.301594 139691431679872 evaluation.py:167] Evaluation [8/10]
INFO:tensorflow:Evaluation [9/10]
I0410 01:46:37.898037 139691431679872 evaluation.py:167] Evaluation [9/10]
INFO:tensorflow:Evaluation [10/10]
I0410 01:46:40.567944 139691431679872 evaluation.py:167] Evaluation [10/10]
INFO:tensorflow:Inference Time : 28.16416s
I0410 01:46:40.717104 139691431679872 evaluation.py:273] Inference Time : 28.16416s
INFO:tensorflow:Finished evaluation at 2020-04-10-01:46:40
I0410 01:46:40.717304 139691431679872 evaluation.py:276] Finished evaluation at 2020-04-10-01:46:40
INFO:tensorflow:Saving dict for global step 400: accuracy = 1.0, global_step = 400, loss = 0.6478859
I0410 01:46:40.717439 139691431679872 estimator.py:2066] Saving dict for global step 400: accuracy = 1.0, global_step = 400, loss = 0.6478859
INFO:tensorflow:Saving 'checkpoint_path' summary for global step 400: /tmp/absl_testing/429596/model.ckpt-400
I0410 01:46:40.717859 139691431679872 estimator.py:2127] Saving 'checkpoint_path' summary for global step 400: /tmp/absl_testing/429596/model.ckpt-400
INFO:tensorflow:global_step/sec: 0.307344
I0410 01:46:42.171416 139691431679872 basic_session_run_hooks.py:702] global_step/sec: 0.307344
INFO:tensorflow:loss = 0.72297984, step = 400 (325.369 sec)
I0410 01:46:42.172457 139691431679872 basic_session_run_hooks.py:260] loss = 0.72297984, step = 400 (325.369 sec)
INFO:tensorflow:global_step/sec: 0.374637
I0410 01:51:09.096542 139691431679872 basic_session_run_hooks.py:702] global_step/sec: 0.374637
INFO:tensorflow:loss = 0.13981006, step = 500 (266.925 sec)
I0410 01:51:09.097422 139691431679872 basic_session_run_hooks.py:260] loss = 0.13981006, step = 500 (266.925 sec)
INFO:tensorflow:Calling checkpoint listeners before saving checkpoint 600...
I0410 01:55:50.822591 139691431679872 basic_session_run_hooks.py:614] Calling checkpoint listeners before saving checkpoint 600...
INFO:tensorflow:Saving checkpoints for 600 into /tmp/absl_testing/429596/model.ckpt.
I0410 01:55:50.822897 139691431679872 basic_session_run_hooks.py:618] Saving checkpoints for 600 into /tmp/absl_testing/429596/model.ckpt.
INFO:tensorflow:Calling checkpoint listeners after saving checkpoint 600...
I0410 01:56:08.642332 139691431679872 basic_session_run_hooks.py:626] Calling checkpoint listeners after saving checkpoint 600...
INFO:tensorflow:Skip the current checkpoint eval due to throttle secs (600 secs).
I0410 01:56:08.642762 139691431679872 training.py:528] Skip the current checkpoint eval due to throttle secs (600 secs).
INFO:tensorflow:global_step/sec: 0.332201
I0410 01:56:10.118843 139691431679872 basic_session_run_hooks.py:702] global_step/sec: 0.332201
INFO:tensorflow:loss = 0.08278292, step = 600 (301.022 sec)
I0410 01:56:10.119842 139691431679872 basic_session_run_hooks.py:260] loss = 0.08278292, step = 600 (301.022 sec)
INFO:tensorflow:global_step/sec: 0.373372
I0410 02:00:37.948370 139691431679872 basic_session_run_hooks.py:702] global_step/sec: 0.373372
INFO:tensorflow:loss = 0.49472085, step = 700 (267.830 sec)
I0410 02:00:37.949368 139691431679872 basic_session_run_hooks.py:260] loss = 0.49472085, step = 700 (267.830 sec)
INFO:tensorflow:Calling checkpoint listeners before saving checkpoint 800...
I0410 02:05:18.048346 139691431679872 basic_session_run_hooks.py:614] Calling checkpoint listeners before saving checkpoint 800...
INFO:tensorflow:Saving checkpoints for 800 into /tmp/absl_testing/429596/model.ckpt.
I0410 02:05:18.048605 139691431679872 basic_session_run_hooks.py:618] Saving checkpoints for 800 into /tmp/absl_testing/429596/model.ckpt.
INFO:tensorflow:Calling checkpoint listeners after saving checkpoint 800...
I0410 02:05:34.003945 139691431679872 basic_session_run_hooks.py:626] Calling checkpoint listeners after saving checkpoint 800...
--------------------------------------------datasets.py/eval_input_fn,s
W0410 02:05:34.388400 139691431679872 datasets.py:170] No TPUContext, using unmodified dataset seed 547.
I0410 02:05:34.388629 139691431679872 datasets.py:348] eval_input_fn(): params={'use_tpu': False, 'train_batch_size': 8, 'batch_size': 8} seed=547
--------befor self._load_dataset------------------split = validation self._eval_split= validation
--------------------------------------------datasets.py/_load_dataset,s
!!!!!!!!!!!!!!!!!!!!!!----load_local_datasets,  _local_test_ds_dir= /content/drive/My Drive/drive/gan/test
-----------------------------------------get_local_datasets,s
-----------------------------------------get_local_datasets,e
--------------------------------------------modular_gan.py/_preprocess_fn,s
I0410 02:05:34.628822 139691431679872 api.py:587] _preprocess_fn(): images=Tensor("args_0:0", shape=(128, 128, 3), dtype=float32), labels=Tensor("args_1:0", shape=(), dtype=int32), seed=547
--------------------------------------------modular_gan.py/_preprocess_fn,e
I0410 02:05:34.664446 139691431679872 api.py:587] Passing random offset: Tensor("Cast:0", shape=(), dtype=int32) with data ({'images': <tf.Tensor 'args_1:0' shape=(128, 128, 3) dtype=float32>, 'z': <tf.Tensor 'args_3:0' shape=(120,) dtype=float32>, 'sampled_labels': <tf.Tensor 'args_2:0' shape=() dtype=int32>}, <tf.Tensor 'args_4:0' shape=() dtype=int32>).
--------------------------------------------datasets.py/eval_input_fn,e
INFO:tensorflow:Calling model_fn.
I0410 02:05:34.680315 139691431679872 estimator.py:1169] Calling model_fn.
--------------------------------------------modular_gan.py/model_fn,s
I0410 02:05:34.680484 139691431679872 modular_gan.py:589] model_fn(): features={'images': <tf.Tensor 'IteratorGetNext:1' shape=(8, 128, 128, 3) dtype=float32>, 'z': <tf.Tensor 'IteratorGetNext:3' shape=(8, 120) dtype=float32>, 'sampled_labels': <tf.Tensor 'IteratorGetNext:2' shape=(8,) dtype=int32>, '_RANDOM_OFFSET': <tf.Tensor 'IteratorGetNext:0' shape=(8,) dtype=int32>}, labels=Tensor("IteratorGetNext:4", shape=(8,), dtype=int32),mode=eval, params={'use_tpu': False, 'train_batch_size': 8, 'batch_size': 8}
#Clean old summaries from previous calls to model_fn().
# Get features and labels for each sub-step.
--------------------------------------------modular_gan.py/_split_inputs_and_generate_samples,s
I0410 02:05:34.687027 139691431679872 resnet_biggan.py:236] [Generator] inputs are z=(8, 120), y=(8, 2)
I0410 02:05:34.697676 139691431679872 resnet_biggan.py:262] [Generator] z0=(8, 20), z_per_block=['(8, 20)', '(8, 20)', '(8, 20)', '(8, 20)', '(8, 20)'], y_per_block=['(8, 148)', '(8, 148)', '(8, 148)', '(8, 148)', '(8, 148)']
I0410 02:05:34.746972 139691431679872 resnet_biggan.py:150] [Block] (8, 4, 4, 1536) (z=(8, 20), y=(8, 148)) -> (8, 8, 8, 1536)
I0410 02:05:34.788947 139691431679872 resnet_biggan.py:150] [Block] (8, 8, 8, 1536) (z=(8, 20), y=(8, 148)) -> (8, 16, 16, 768)
I0410 02:05:34.826076 139691431679872 resnet_biggan.py:150] [Block] (8, 16, 16, 768) (z=(8, 20), y=(8, 148)) -> (8, 32, 32, 384)
I0410 02:05:34.865415 139691431679872 resnet_biggan.py:150] [Block] (8, 32, 32, 384) (z=(8, 20), y=(8, 148)) -> (8, 64, 64, 192)
I0410 02:05:34.865587 139691431679872 resnet_biggan.py:289] [Generator] Applying non-local block to (8, 64, 64, 192)
I0410 02:05:34.941215 139691431679872 resnet_biggan.py:150] [Block] (8, 64, 64, 192) (z=(8, 20), y=(8, 148)) -> (8, 128, 128, 96)
I0410 02:05:34.941405 139691431679872 resnet_biggan.py:294] [Generator] before final processing: (8, 128, 128, 96)
I0410 02:05:34.973085 139691431679872 resnet_biggan.py:300] [Generator] after final processing: (8, 128, 128, 3)
--------------------------------------------modular_gan.py/_split_inputs_and_generate_samples,e
---------------------------------------------------modular_gan.py/create_logits,s
I0410 02:05:34.976345 139691431679872 tpu_random.py:86] Got global random offset: Tensor("strided_slice:0", shape=(), dtype=int32)
---------------------------------------------------s3gan.py/create_loss,s
W0410 02:05:34.979082 139691431679872 s3gan.py:237] Computing fake images for every sub step separately.
I0410 02:05:34.979283 139691431679872 resnet_biggan.py:236] [Generator] inputs are z=(8, 120), y=(8, 2)
I0410 02:05:34.985445 139691431679872 resnet_biggan.py:262] [Generator] z0=(8, 20), z_per_block=['(8, 20)', '(8, 20)', '(8, 20)', '(8, 20)', '(8, 20)'], y_per_block=['(8, 148)', '(8, 148)', '(8, 148)', '(8, 148)', '(8, 148)']
I0410 02:05:35.003984 139691431679872 resnet_biggan.py:150] [Block] (8, 4, 4, 1536) (z=(8, 20), y=(8, 148)) -> (8, 8, 8, 1536)
I0410 02:05:35.021334 139691431679872 resnet_biggan.py:150] [Block] (8, 8, 8, 1536) (z=(8, 20), y=(8, 148)) -> (8, 16, 16, 768)
I0410 02:05:35.037429 139691431679872 resnet_biggan.py:150] [Block] (8, 16, 16, 768) (z=(8, 20), y=(8, 148)) -> (8, 32, 32, 384)
I0410 02:05:35.056458 139691431679872 resnet_biggan.py:150] [Block] (8, 32, 32, 384) (z=(8, 20), y=(8, 148)) -> (8, 64, 64, 192)
I0410 02:05:35.056612 139691431679872 resnet_biggan.py:289] [Generator] Applying non-local block to (8, 64, 64, 192)
I0410 02:05:35.099109 139691431679872 resnet_biggan.py:150] [Block] (8, 64, 64, 192) (z=(8, 20), y=(8, 148)) -> (8, 128, 128, 96)
I0410 02:05:35.099291 139691431679872 resnet_biggan.py:294] [Generator] before final processing: (8, 128, 128, 96)
I0410 02:05:35.114299 139691431679872 resnet_biggan.py:300] [Generator] after final processing: (8, 128, 128, 3)
I0410 02:05:35.115975 139691431679872 s3gan.py:249] bs=8, rotated_bs=4, num_rot_examples=1
---------------------------------------------------s3gan.py/merge_with_rotation_data,s
---------------------------------------------------s3gan.py/merge_with_rotation_data,e
--------------------------------------------------------------------s3gan.py/discriminator_with_additonal_heads,s
I0410 02:05:35.141340 139691431679872 resnet_biggan.py:379] [Discriminator] inputs are x=(22, 128, 128, 3), y=(22, 2)
I0410 02:05:35.176183 139691431679872 resnet_biggan.py:150] [Block] (22, 128, 128, 3) (z=None, y=(22, 2)) -> (22, 64, 64, 96)
I0410 02:05:35.176377 139691431679872 resnet_biggan.py:398] [Discriminator] Applying non-local block to (22, 64, 64, 96)
I0410 02:05:35.251721 139691431679872 resnet_biggan.py:150] [Block] (22, 64, 64, 96) (z=None, y=(22, 2)) -> (22, 32, 32, 192)
I0410 02:05:35.284626 139691431679872 resnet_biggan.py:150] [Block] (22, 32, 32, 192) (z=None, y=(22, 2)) -> (22, 16, 16, 384)
I0410 02:05:35.316971 139691431679872 resnet_biggan.py:150] [Block] (22, 16, 16, 384) (z=None, y=(22, 2)) -> (22, 8, 8, 768)
I0410 02:05:35.348374 139691431679872 resnet_biggan.py:150] [Block] (22, 8, 8, 768) (z=None, y=(22, 2)) -> (22, 4, 4, 1536)
I0410 02:05:35.370922 139691431679872 resnet_biggan.py:150] [Block] (22, 4, 4, 1536) (z=None, y=(22, 2)) -> (22, 4, 4, 1536)
I0410 02:05:35.371073 139691431679872 resnet_biggan.py:403] [Discriminator] before final processing: (22, 4, 4, 1536)
I0410 02:05:35.381525 139691431679872 resnet_biggan.py:407] [Discriminator] after final processing: (22, 4, 4, 1536)
I0410 02:05:35.387466 139691431679872 resnet_biggan.py:422] [Discriminator] embedded_y for projection: (22, 1536)
I0410 02:05:35.400254 139691431679872 s3gan.py:133] [Discriminator] rotation head (22, 1536) -> Tensor("discriminator_rotation/score_classify/add:0", shape=(22, 4), dtype=float32)
I0410 02:05:35.413436 139691431679872 s3gan.py:154] [Discriminator] (22, 2) -> aux_logits=(22, 2), y_predicted=(22, 2)
---------------------------------------------------s3gan.py/get_class_embedding,s
I0410 02:05:35.423267 139691431679872 s3gan.py:175] [Discriminator] embedded_y for projection: (22, 1536)
---------------------------------------------------s3gan.py/get_class_embedding,e
---------------------------------------------------s3gan.py/discriminator_with_additonal_heads,e
---------------------------------------------------s3gan.py/create_loss,e
---------------------------------------------------modular_gan.py/create_logits,e
################################################## mode == tf.estimator.ModeKeys.EVAL  ########################
INFO:tensorflow:Done calling model_fn.
I0410 02:05:35.505398 139691431679872 estimator.py:1171] Done calling model_fn.
INFO:tensorflow:Starting evaluation at 2020-04-10T02:05:35Z
I0410 02:05:35.522919 139691431679872 evaluation.py:255] Starting evaluation at 2020-04-10T02:05:35Z
INFO:tensorflow:Graph was finalized.
I0410 02:05:35.678202 139691431679872 monitored_session.py:246] Graph was finalized.
2020-04-10 02:05:35.678955: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-04-10 02:05:35.679279: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:00:04.0 name: Tesla P4 computeCapability: 6.1
coreClock: 1.1135GHz coreCount: 20 deviceMemorySize: 7.43GiB deviceMemoryBandwidth: 178.99GiB/s
2020-04-10 02:05:35.679332: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.1
2020-04-10 02:05:35.679360: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10
2020-04-10 02:05:35.679377: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcufft.so.10
2020-04-10 02:05:35.679395: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcurand.so.10
2020-04-10 02:05:35.679414: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusolver.so.10
2020-04-10 02:05:35.679461: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusparse.so.10
2020-04-10 02:05:35.679481: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudnn.so.7
2020-04-10 02:05:35.679563: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-04-10 02:05:35.679911: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-04-10 02:05:35.680164: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1703] Adding visible gpu devices: 0
2020-04-10 02:05:35.680213: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-04-10 02:05:35.680229: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      0 
2020-04-10 02:05:35.680239: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1121] 0:   N 
2020-04-10 02:05:35.680335: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-04-10 02:05:35.680632: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-04-10 02:05:35.680937: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1247] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 6850 MB memory) -> physical GPU (device: 0, name: Tesla P4, pci bus id: 0000:00:04.0, compute capability: 6.1)
INFO:tensorflow:Restoring parameters from /tmp/absl_testing/429596/model.ckpt-800
I0410 02:05:35.681899 139691431679872 saver.py:1293] Restoring parameters from /tmp/absl_testing/429596/model.ckpt-800
INFO:tensorflow:Running local_init_op.
I0410 02:05:36.087827 139691431679872 session_manager.py:505] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
I0410 02:05:36.110856 139691431679872 session_manager.py:508] Done running local_init_op.
INFO:tensorflow:Evaluation [1/10]
I0410 02:05:40.746199 139691431679872 evaluation.py:167] Evaluation [1/10]
INFO:tensorflow:Evaluation [2/10]
I0410 02:05:45.175759 139691431679872 evaluation.py:167] Evaluation [2/10]
INFO:tensorflow:Evaluation [3/10]
I0410 02:05:47.332725 139691431679872 evaluation.py:167] Evaluation [3/10]
INFO:tensorflow:Evaluation [4/10]
I0410 02:05:49.588284 139691431679872 evaluation.py:167] Evaluation [4/10]
INFO:tensorflow:Evaluation [5/10]
I0410 02:05:51.597769 139691431679872 evaluation.py:167] Evaluation [5/10]
INFO:tensorflow:Evaluation [6/10]
I0410 02:05:54.458435 139691431679872 evaluation.py:167] Evaluation [6/10]
INFO:tensorflow:Evaluation [7/10]
I0410 02:05:56.539569 139691431679872 evaluation.py:167] Evaluation [7/10]
INFO:tensorflow:Evaluation [8/10]
I0410 02:05:59.153669 139691431679872 evaluation.py:167] Evaluation [8/10]
INFO:tensorflow:Evaluation [9/10]
I0410 02:06:01.252489 139691431679872 evaluation.py:167] Evaluation [9/10]
INFO:tensorflow:Evaluation [10/10]
I0410 02:06:04.025098 139691431679872 evaluation.py:167] Evaluation [10/10]
INFO:tensorflow:Inference Time : 28.58526s
I0410 02:06:04.108322 139691431679872 evaluation.py:273] Inference Time : 28.58526s
INFO:tensorflow:Finished evaluation at 2020-04-10-02:06:04
I0410 02:06:04.108525 139691431679872 evaluation.py:276] Finished evaluation at 2020-04-10-02:06:04
INFO:tensorflow:Saving dict for global step 800: accuracy = 1.0, global_step = 800, loss = 0.038997244
I0410 02:06:04.108688 139691431679872 estimator.py:2066] Saving dict for global step 800: accuracy = 1.0, global_step = 800, loss = 0.038997244
INFO:tensorflow:Saving 'checkpoint_path' summary for global step 800: /tmp/absl_testing/429596/model.ckpt-800
I0410 02:06:04.109191 139691431679872 estimator.py:2127] Saving 'checkpoint_path' summary for global step 800: /tmp/absl_testing/429596/model.ckpt-800
INFO:tensorflow:global_step/sec: 0.305234
I0410 02:06:05.566242 139691431679872 basic_session_run_hooks.py:702] global_step/sec: 0.305234
INFO:tensorflow:loss = 0.31494063, step = 800 (327.618 sec)
I0410 02:06:05.567254 139691431679872 basic_session_run_hooks.py:260] loss = 0.31494063, step = 800 (327.618 sec)
INFO:tensorflow:global_step/sec: 0.374533
I0410 02:10:32.565285 139691431679872 basic_session_run_hooks.py:702] global_step/sec: 0.374533
INFO:tensorflow:loss = 0.014851068, step = 900 (266.999 sec)
I0410 02:10:32.566349 139691431679872 basic_session_run_hooks.py:260] loss = 0.014851068, step = 900 (266.999 sec)
INFO:tensorflow:Calling checkpoint listeners before saving checkpoint 1000...
I0410 02:15:11.254469 139691431679872 basic_session_run_hooks.py:614] Calling checkpoint listeners before saving checkpoint 1000...
INFO:tensorflow:Saving checkpoints for 1000 into /tmp/absl_testing/429596/model.ckpt.
I0410 02:15:11.254729 139691431679872 basic_session_run_hooks.py:618] Saving checkpoints for 1000 into /tmp/absl_testing/429596/model.ckpt.
INFO:tensorflow:Calling checkpoint listeners after saving checkpoint 1000...
I0410 02:15:28.851241 139691431679872 basic_session_run_hooks.py:626] Calling checkpoint listeners after saving checkpoint 1000...
INFO:tensorflow:Skip the current checkpoint eval due to throttle secs (600 secs).
I0410 02:15:28.851501 139691431679872 training.py:528] Skip the current checkpoint eval due to throttle secs (600 secs).
INFO:tensorflow:global_step/sec: 0.335854
I0410 02:15:30.313858 139691431679872 basic_session_run_hooks.py:702] global_step/sec: 0.335854
INFO:tensorflow:loss = 0.2653651, step = 1000 (297.749 sec)
I0410 02:15:30.314868 139691431679872 basic_session_run_hooks.py:260] loss = 0.2653651, step = 1000 (297.749 sec)
INFO:tensorflow:global_step/sec: 0.365288
I0410 02:20:04.070487 139691431679872 basic_session_run_hooks.py:702] global_step/sec: 0.365288
INFO:tensorflow:loss = 0.08586647, step = 1100 (273.757 sec)
I0410 02:20:04.071513 139691431679872 basic_session_run_hooks.py:260] loss = 0.08586647, step = 1100 (273.757 sec)
INFO:tensorflow:Calling checkpoint listeners before saving checkpoint 1200...
I0410 02:24:44.263353 139691431679872 basic_session_run_hooks.py:614] Calling checkpoint listeners before saving checkpoint 1200...
INFO:tensorflow:Saving checkpoints for 1200 into /tmp/absl_testing/429596/model.ckpt.
I0410 02:24:44.263668 139691431679872 basic_session_run_hooks.py:618] Saving checkpoints for 1200 into /tmp/absl_testing/429596/model.ckpt.
INFO:tensorflow:Calling checkpoint listeners after saving checkpoint 1200...
I0410 02:25:03.763451 139691431679872 basic_session_run_hooks.py:626] Calling checkpoint listeners after saving checkpoint 1200...
--------------------------------------------datasets.py/eval_input_fn,s
W0410 02:25:03.850538 139691431679872 datasets.py:170] No TPUContext, using unmodified dataset seed 547.
I0410 02:25:03.850684 139691431679872 datasets.py:348] eval_input_fn(): params={'use_tpu': False, 'train_batch_size': 8, 'batch_size': 8} seed=547
--------befor self._load_dataset------------------split = validation self._eval_split= validation
--------------------------------------------datasets.py/_load_dataset,s
!!!!!!!!!!!!!!!!!!!!!!----load_local_datasets,  _local_test_ds_dir= /content/drive/My Drive/drive/gan/test
-----------------------------------------get_local_datasets,s
-----------------------------------------get_local_datasets,e
--------------------------------------------modular_gan.py/_preprocess_fn,s
I0410 02:25:03.940309 139691431679872 api.py:587] _preprocess_fn(): images=Tensor("args_0:0", shape=(128, 128, 3), dtype=float32), labels=Tensor("args_1:0", shape=(), dtype=int32), seed=547
--------------------------------------------modular_gan.py/_preprocess_fn,e
I0410 02:25:03.967882 139691431679872 api.py:587] Passing random offset: Tensor("Cast:0", shape=(), dtype=int32) with data ({'images': <tf.Tensor 'args_1:0' shape=(128, 128, 3) dtype=float32>, 'z': <tf.Tensor 'args_3:0' shape=(120,) dtype=float32>, 'sampled_labels': <tf.Tensor 'args_2:0' shape=() dtype=int32>}, <tf.Tensor 'args_4:0' shape=() dtype=int32>).
--------------------------------------------datasets.py/eval_input_fn,e
INFO:tensorflow:Calling model_fn.
I0410 02:25:03.990285 139691431679872 estimator.py:1169] Calling model_fn.
--------------------------------------------modular_gan.py/model_fn,s
I0410 02:25:03.990433 139691431679872 modular_gan.py:589] model_fn(): features={'images': <tf.Tensor 'IteratorGetNext:1' shape=(8, 128, 128, 3) dtype=float32>, 'z': <tf.Tensor 'IteratorGetNext:3' shape=(8, 120) dtype=float32>, 'sampled_labels': <tf.Tensor 'IteratorGetNext:2' shape=(8,) dtype=int32>, '_RANDOM_OFFSET': <tf.Tensor 'IteratorGetNext:0' shape=(8,) dtype=int32>}, labels=Tensor("IteratorGetNext:4", shape=(8,), dtype=int32),mode=eval, params={'use_tpu': False, 'train_batch_size': 8, 'batch_size': 8}
#Clean old summaries from previous calls to model_fn().
# Get features and labels for each sub-step.
--------------------------------------------modular_gan.py/_split_inputs_and_generate_samples,s
I0410 02:25:03.997029 139691431679872 resnet_biggan.py:236] [Generator] inputs are z=(8, 120), y=(8, 2)
I0410 02:25:04.006966 139691431679872 resnet_biggan.py:262] [Generator] z0=(8, 20), z_per_block=['(8, 20)', '(8, 20)', '(8, 20)', '(8, 20)', '(8, 20)'], y_per_block=['(8, 148)', '(8, 148)', '(8, 148)', '(8, 148)', '(8, 148)']
I0410 02:25:04.060002 139691431679872 resnet_biggan.py:150] [Block] (8, 4, 4, 1536) (z=(8, 20), y=(8, 148)) -> (8, 8, 8, 1536)
I0410 02:25:04.100221 139691431679872 resnet_biggan.py:150] [Block] (8, 8, 8, 1536) (z=(8, 20), y=(8, 148)) -> (8, 16, 16, 768)
I0410 02:25:04.137954 139691431679872 resnet_biggan.py:150] [Block] (8, 16, 16, 768) (z=(8, 20), y=(8, 148)) -> (8, 32, 32, 384)
I0410 02:25:04.176244 139691431679872 resnet_biggan.py:150] [Block] (8, 32, 32, 384) (z=(8, 20), y=(8, 148)) -> (8, 64, 64, 192)
I0410 02:25:04.176425 139691431679872 resnet_biggan.py:289] [Generator] Applying non-local block to (8, 64, 64, 192)
I0410 02:25:04.259732 139691431679872 resnet_biggan.py:150] [Block] (8, 64, 64, 192) (z=(8, 20), y=(8, 148)) -> (8, 128, 128, 96)
I0410 02:25:04.259944 139691431679872 resnet_biggan.py:294] [Generator] before final processing: (8, 128, 128, 96)
I0410 02:25:04.290128 139691431679872 resnet_biggan.py:300] [Generator] after final processing: (8, 128, 128, 3)
--------------------------------------------modular_gan.py/_split_inputs_and_generate_samples,e
---------------------------------------------------modular_gan.py/create_logits,s
I0410 02:25:04.293440 139691431679872 tpu_random.py:86] Got global random offset: Tensor("strided_slice:0", shape=(), dtype=int32)
---------------------------------------------------s3gan.py/create_loss,s
W0410 02:25:04.295921 139691431679872 s3gan.py:237] Computing fake images for every sub step separately.
I0410 02:25:04.296115 139691431679872 resnet_biggan.py:236] [Generator] inputs are z=(8, 120), y=(8, 2)
I0410 02:25:04.301361 139691431679872 resnet_biggan.py:262] [Generator] z0=(8, 20), z_per_block=['(8, 20)', '(8, 20)', '(8, 20)', '(8, 20)', '(8, 20)'], y_per_block=['(8, 148)', '(8, 148)', '(8, 148)', '(8, 148)', '(8, 148)']
I0410 02:25:04.319333 139691431679872 resnet_biggan.py:150] [Block] (8, 4, 4, 1536) (z=(8, 20), y=(8, 148)) -> (8, 8, 8, 1536)
I0410 02:25:04.337293 139691431679872 resnet_biggan.py:150] [Block] (8, 8, 8, 1536) (z=(8, 20), y=(8, 148)) -> (8, 16, 16, 768)
I0410 02:25:04.353511 139691431679872 resnet_biggan.py:150] [Block] (8, 16, 16, 768) (z=(8, 20), y=(8, 148)) -> (8, 32, 32, 384)
I0410 02:25:04.369406 139691431679872 resnet_biggan.py:150] [Block] (8, 32, 32, 384) (z=(8, 20), y=(8, 148)) -> (8, 64, 64, 192)
I0410 02:25:04.369544 139691431679872 resnet_biggan.py:289] [Generator] Applying non-local block to (8, 64, 64, 192)
I0410 02:25:04.400923 139691431679872 resnet_biggan.py:150] [Block] (8, 64, 64, 192) (z=(8, 20), y=(8, 148)) -> (8, 128, 128, 96)
I0410 02:25:04.401072 139691431679872 resnet_biggan.py:294] [Generator] before final processing: (8, 128, 128, 96)
I0410 02:25:04.415878 139691431679872 resnet_biggan.py:300] [Generator] after final processing: (8, 128, 128, 3)
I0410 02:25:04.417528 139691431679872 s3gan.py:249] bs=8, rotated_bs=4, num_rot_examples=1
---------------------------------------------------s3gan.py/merge_with_rotation_data,s
---------------------------------------------------s3gan.py/merge_with_rotation_data,e
--------------------------------------------------------------------s3gan.py/discriminator_with_additonal_heads,s
I0410 02:25:04.442213 139691431679872 resnet_biggan.py:379] [Discriminator] inputs are x=(22, 128, 128, 3), y=(22, 2)
I0410 02:25:04.474085 139691431679872 resnet_biggan.py:150] [Block] (22, 128, 128, 3) (z=None, y=(22, 2)) -> (22, 64, 64, 96)
I0410 02:25:04.474236 139691431679872 resnet_biggan.py:398] [Discriminator] Applying non-local block to (22, 64, 64, 96)
I0410 02:25:04.545573 139691431679872 resnet_biggan.py:150] [Block] (22, 64, 64, 96) (z=None, y=(22, 2)) -> (22, 32, 32, 192)
I0410 02:25:04.575609 139691431679872 resnet_biggan.py:150] [Block] (22, 32, 32, 192) (z=None, y=(22, 2)) -> (22, 16, 16, 384)
I0410 02:25:04.605392 139691431679872 resnet_biggan.py:150] [Block] (22, 16, 16, 384) (z=None, y=(22, 2)) -> (22, 8, 8, 768)
I0410 02:25:04.635958 139691431679872 resnet_biggan.py:150] [Block] (22, 8, 8, 768) (z=None, y=(22, 2)) -> (22, 4, 4, 1536)
I0410 02:25:04.659074 139691431679872 resnet_biggan.py:150] [Block] (22, 4, 4, 1536) (z=None, y=(22, 2)) -> (22, 4, 4, 1536)
I0410 02:25:04.659223 139691431679872 resnet_biggan.py:403] [Discriminator] before final processing: (22, 4, 4, 1536)
I0410 02:25:04.669830 139691431679872 resnet_biggan.py:407] [Discriminator] after final processing: (22, 4, 4, 1536)
I0410 02:25:04.676640 139691431679872 resnet_biggan.py:422] [Discriminator] embedded_y for projection: (22, 1536)
I0410 02:25:04.689266 139691431679872 s3gan.py:133] [Discriminator] rotation head (22, 1536) -> Tensor("discriminator_rotation/score_classify/add:0", shape=(22, 4), dtype=float32)
I0410 02:25:04.701493 139691431679872 s3gan.py:154] [Discriminator] (22, 2) -> aux_logits=(22, 2), y_predicted=(22, 2)
---------------------------------------------------s3gan.py/get_class_embedding,s
I0410 02:25:04.708739 139691431679872 s3gan.py:175] [Discriminator] embedded_y for projection: (22, 1536)
---------------------------------------------------s3gan.py/get_class_embedding,e
---------------------------------------------------s3gan.py/discriminator_with_additonal_heads,e
---------------------------------------------------s3gan.py/create_loss,e
---------------------------------------------------modular_gan.py/create_logits,e
################################################## mode == tf.estimator.ModeKeys.EVAL  ########################
INFO:tensorflow:Done calling model_fn.
I0410 02:25:04.793190 139691431679872 estimator.py:1171] Done calling model_fn.
INFO:tensorflow:Starting evaluation at 2020-04-10T02:25:04Z
I0410 02:25:04.808831 139691431679872 evaluation.py:255] Starting evaluation at 2020-04-10T02:25:04Z
INFO:tensorflow:Graph was finalized.
I0410 02:25:04.946078 139691431679872 monitored_session.py:246] Graph was finalized.
2020-04-10 02:25:04.946704: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-04-10 02:25:04.947058: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:00:04.0 name: Tesla P4 computeCapability: 6.1
coreClock: 1.1135GHz coreCount: 20 deviceMemorySize: 7.43GiB deviceMemoryBandwidth: 178.99GiB/s
2020-04-10 02:25:04.947109: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.1
2020-04-10 02:25:04.947132: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10
2020-04-10 02:25:04.947148: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcufft.so.10
2020-04-10 02:25:04.947164: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcurand.so.10
2020-04-10 02:25:04.947178: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusolver.so.10
2020-04-10 02:25:04.947229: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusparse.so.10
2020-04-10 02:25:04.947245: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudnn.so.7
2020-04-10 02:25:04.947321: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-04-10 02:25:04.947584: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-04-10 02:25:04.947788: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1703] Adding visible gpu devices: 0
2020-04-10 02:25:04.947838: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-04-10 02:25:04.947851: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      0 
2020-04-10 02:25:04.947860: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1121] 0:   N 
2020-04-10 02:25:04.947951: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-04-10 02:25:04.948225: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-04-10 02:25:04.948441: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1247] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 6850 MB memory) -> physical GPU (device: 0, name: Tesla P4, pci bus id: 0000:00:04.0, compute capability: 6.1)
INFO:tensorflow:Restoring parameters from /tmp/absl_testing/429596/model.ckpt-1200
I0410 02:25:04.949280 139691431679872 saver.py:1293] Restoring parameters from /tmp/absl_testing/429596/model.ckpt-1200
INFO:tensorflow:Running local_init_op.
I0410 02:25:05.344060 139691431679872 session_manager.py:505] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
I0410 02:25:05.364392 139691431679872 session_manager.py:508] Done running local_init_op.
INFO:tensorflow:Evaluation [1/10]
I0410 02:25:11.154940 139691431679872 evaluation.py:167] Evaluation [1/10]
INFO:tensorflow:Evaluation [2/10]
I0410 02:25:13.179502 139691431679872 evaluation.py:167] Evaluation [2/10]
INFO:tensorflow:Evaluation [3/10]
I0410 02:25:15.658640 139691431679872 evaluation.py:167] Evaluation [3/10]
INFO:tensorflow:Evaluation [4/10]
I0410 02:25:18.229178 139691431679872 evaluation.py:167] Evaluation [4/10]
INFO:tensorflow:Evaluation [5/10]
I0410 02:25:19.965468 139691431679872 evaluation.py:167] Evaluation [5/10]
INFO:tensorflow:Evaluation [6/10]
I0410 02:25:22.231664 139691431679872 evaluation.py:167] Evaluation [6/10]
INFO:tensorflow:Evaluation [7/10]
I0410 02:25:23.924951 139691431679872 evaluation.py:167] Evaluation [7/10]
INFO:tensorflow:Evaluation [8/10]
I0410 02:25:26.339044 139691431679872 evaluation.py:167] Evaluation [8/10]
INFO:tensorflow:Evaluation [9/10]
I0410 02:25:28.448825 139691431679872 evaluation.py:167] Evaluation [9/10]
INFO:tensorflow:Evaluation [10/10]
I0410 02:25:31.277956 139691431679872 evaluation.py:167] Evaluation [10/10]
INFO:tensorflow:Inference Time : 27.14058s
I0410 02:25:31.949585 139691431679872 evaluation.py:273] Inference Time : 27.14058s
INFO:tensorflow:Finished evaluation at 2020-04-10-02:25:31
I0410 02:25:31.949791 139691431679872 evaluation.py:276] Finished evaluation at 2020-04-10-02:25:31
INFO:tensorflow:Saving dict for global step 1200: accuracy = 1.0, global_step = 1200, loss = 0.0031971473
I0410 02:25:31.949988 139691431679872 estimator.py:2066] Saving dict for global step 1200: accuracy = 1.0, global_step = 1200, loss = 0.0031971473
INFO:tensorflow:Saving 'checkpoint_path' summary for global step 1200: /tmp/absl_testing/429596/model.ckpt-1200
I0410 02:25:31.963205 139691431679872 estimator.py:2127] Saving 'checkpoint_path' summary for global step 1200: /tmp/absl_testing/429596/model.ckpt-1200
INFO:tensorflow:global_step/sec: 0.30363
I0410 02:25:33.418757 139691431679872 basic_session_run_hooks.py:702] global_step/sec: 0.30363
INFO:tensorflow:loss = 0.12331876, step = 1200 (329.348 sec)
I0410 02:25:33.419726 139691431679872 basic_session_run_hooks.py:260] loss = 0.12331876, step = 1200 (329.348 sec)
INFO:tensorflow:global_step/sec: 0.409558
I0410 02:29:37.584464 139691431679872 basic_session_run_hooks.py:702] global_step/sec: 0.409558
INFO:tensorflow:loss = 0.02935047, step = 1300 (244.166 sec)
I0410 02:29:37.585741 139691431679872 basic_session_run_hooks.py:260] loss = 0.02935047, step = 1300 (244.166 sec)
INFO:tensorflow:Calling checkpoint listeners before saving checkpoint 1400...
I0410 02:34:18.280982 139691431679872 basic_session_run_hooks.py:614] Calling checkpoint listeners before saving checkpoint 1400...
INFO:tensorflow:Saving checkpoints for 1400 into /tmp/absl_testing/429596/model.ckpt.
I0410 02:34:18.281209 139691431679872 basic_session_run_hooks.py:618] Saving checkpoints for 1400 into /tmp/absl_testing/429596/model.ckpt.
INFO:tensorflow:Calling checkpoint listeners after saving checkpoint 1400...
I0410 02:34:34.864117 139691431679872 basic_session_run_hooks.py:626] Calling checkpoint listeners after saving checkpoint 1400...
INFO:tensorflow:Skip the current checkpoint eval due to throttle secs (600 secs).
I0410 02:34:34.864559 139691431679872 training.py:528] Skip the current checkpoint eval due to throttle secs (600 secs).
INFO:tensorflow:global_step/sec: 0.334596
I0410 02:34:36.452328 139691431679872 basic_session_run_hooks.py:702] global_step/sec: 0.334596
INFO:tensorflow:loss = 0.0012434886, step = 1400 (298.868 sec)
I0410 02:34:36.453324 139691431679872 basic_session_run_hooks.py:260] loss = 0.0012434886, step = 1400 (298.868 sec)
INFO:tensorflow:global_step/sec: 0.374911
I0410 02:39:03.182285 139691431679872 basic_session_run_hooks.py:702] global_step/sec: 0.374911
INFO:tensorflow:loss = 0.009968757, step = 1500 (266.730 sec)
I0410 02:39:03.183503 139691431679872 basic_session_run_hooks.py:260] loss = 0.009968757, step = 1500 (266.730 sec)
INFO:tensorflow:Calling checkpoint listeners before saving checkpoint 1600...
I0410 02:43:44.053759 139691431679872 basic_session_run_hooks.py:614] Calling checkpoint listeners before saving checkpoint 1600...
INFO:tensorflow:Saving checkpoints for 1600 into /tmp/absl_testing/429596/model.ckpt.
I0410 02:43:44.054066 139691431679872 basic_session_run_hooks.py:618] Saving checkpoints for 1600 into /tmp/absl_testing/429596/model.ckpt.
INFO:tensorflow:Calling checkpoint listeners after saving checkpoint 1600...
I0410 02:44:02.690395 139691431679872 basic_session_run_hooks.py:626] Calling checkpoint listeners after saving checkpoint 1600...
--------------------------------------------datasets.py/eval_input_fn,s
W0410 02:44:03.428899 139691431679872 datasets.py:170] No TPUContext, using unmodified dataset seed 547.
I0410 02:44:03.429052 139691431679872 datasets.py:348] eval_input_fn(): params={'use_tpu': False, 'train_batch_size': 8, 'batch_size': 8} seed=547
--------befor self._load_dataset------------------split = validation self._eval_split= validation
--------------------------------------------datasets.py/_load_dataset,s
!!!!!!!!!!!!!!!!!!!!!!----load_local_datasets,  _local_test_ds_dir= /content/drive/My Drive/drive/gan/test
-----------------------------------------get_local_datasets,s
-----------------------------------------get_local_datasets,e
--------------------------------------------modular_gan.py/_preprocess_fn,s
I0410 02:44:03.518187 139691431679872 api.py:587] _preprocess_fn(): images=Tensor("args_0:0", shape=(128, 128, 3), dtype=float32), labels=Tensor("args_1:0", shape=(), dtype=int32), seed=547
--------------------------------------------modular_gan.py/_preprocess_fn,e
I0410 02:44:03.546507 139691431679872 api.py:587] Passing random offset: Tensor("Cast:0", shape=(), dtype=int32) with data ({'images': <tf.Tensor 'args_1:0' shape=(128, 128, 3) dtype=float32>, 'z': <tf.Tensor 'args_3:0' shape=(120,) dtype=float32>, 'sampled_labels': <tf.Tensor 'args_2:0' shape=() dtype=int32>}, <tf.Tensor 'args_4:0' shape=() dtype=int32>).
--------------------------------------------datasets.py/eval_input_fn,e
INFO:tensorflow:Calling model_fn.
I0410 02:44:03.562414 139691431679872 estimator.py:1169] Calling model_fn.
--------------------------------------------modular_gan.py/model_fn,s
I0410 02:44:03.562582 139691431679872 modular_gan.py:589] model_fn(): features={'images': <tf.Tensor 'IteratorGetNext:1' shape=(8, 128, 128, 3) dtype=float32>, 'z': <tf.Tensor 'IteratorGetNext:3' shape=(8, 120) dtype=float32>, 'sampled_labels': <tf.Tensor 'IteratorGetNext:2' shape=(8,) dtype=int32>, '_RANDOM_OFFSET': <tf.Tensor 'IteratorGetNext:0' shape=(8,) dtype=int32>}, labels=Tensor("IteratorGetNext:4", shape=(8,), dtype=int32),mode=eval, params={'use_tpu': False, 'train_batch_size': 8, 'batch_size': 8}
#Clean old summaries from previous calls to model_fn().
# Get features and labels for each sub-step.
--------------------------------------------modular_gan.py/_split_inputs_and_generate_samples,s
I0410 02:44:03.569098 139691431679872 resnet_biggan.py:236] [Generator] inputs are z=(8, 120), y=(8, 2)
I0410 02:44:03.578902 139691431679872 resnet_biggan.py:262] [Generator] z0=(8, 20), z_per_block=['(8, 20)', '(8, 20)', '(8, 20)', '(8, 20)', '(8, 20)'], y_per_block=['(8, 148)', '(8, 148)', '(8, 148)', '(8, 148)', '(8, 148)']
I0410 02:44:03.625429 139691431679872 resnet_biggan.py:150] [Block] (8, 4, 4, 1536) (z=(8, 20), y=(8, 148)) -> (8, 8, 8, 1536)
I0410 02:44:03.666422 139691431679872 resnet_biggan.py:150] [Block] (8, 8, 8, 1536) (z=(8, 20), y=(8, 148)) -> (8, 16, 16, 768)
I0410 02:44:03.714262 139691431679872 resnet_biggan.py:150] [Block] (8, 16, 16, 768) (z=(8, 20), y=(8, 148)) -> (8, 32, 32, 384)
I0410 02:44:03.752286 139691431679872 resnet_biggan.py:150] [Block] (8, 32, 32, 384) (z=(8, 20), y=(8, 148)) -> (8, 64, 64, 192)
I0410 02:44:03.752487 139691431679872 resnet_biggan.py:289] [Generator] Applying non-local block to (8, 64, 64, 192)
I0410 02:44:03.828146 139691431679872 resnet_biggan.py:150] [Block] (8, 64, 64, 192) (z=(8, 20), y=(8, 148)) -> (8, 128, 128, 96)
I0410 02:44:03.828369 139691431679872 resnet_biggan.py:294] [Generator] before final processing: (8, 128, 128, 96)
I0410 02:44:03.859768 139691431679872 resnet_biggan.py:300] [Generator] after final processing: (8, 128, 128, 3)
--------------------------------------------modular_gan.py/_split_inputs_and_generate_samples,e
---------------------------------------------------modular_gan.py/create_logits,s
I0410 02:44:03.863230 139691431679872 tpu_random.py:86] Got global random offset: Tensor("strided_slice:0", shape=(), dtype=int32)
---------------------------------------------------s3gan.py/create_loss,s
W0410 02:44:03.865759 139691431679872 s3gan.py:237] Computing fake images for every sub step separately.
I0410 02:44:03.865979 139691431679872 resnet_biggan.py:236] [Generator] inputs are z=(8, 120), y=(8, 2)
I0410 02:44:03.871589 139691431679872 resnet_biggan.py:262] [Generator] z0=(8, 20), z_per_block=['(8, 20)', '(8, 20)', '(8, 20)', '(8, 20)', '(8, 20)'], y_per_block=['(8, 148)', '(8, 148)', '(8, 148)', '(8, 148)', '(8, 148)']
I0410 02:44:03.889652 139691431679872 resnet_biggan.py:150] [Block] (8, 4, 4, 1536) (z=(8, 20), y=(8, 148)) -> (8, 8, 8, 1536)
I0410 02:44:03.906162 139691431679872 resnet_biggan.py:150] [Block] (8, 8, 8, 1536) (z=(8, 20), y=(8, 148)) -> (8, 16, 16, 768)
I0410 02:44:03.923937 139691431679872 resnet_biggan.py:150] [Block] (8, 16, 16, 768) (z=(8, 20), y=(8, 148)) -> (8, 32, 32, 384)
I0410 02:44:03.940134 139691431679872 resnet_biggan.py:150] [Block] (8, 32, 32, 384) (z=(8, 20), y=(8, 148)) -> (8, 64, 64, 192)
I0410 02:44:03.940312 139691431679872 resnet_biggan.py:289] [Generator] Applying non-local block to (8, 64, 64, 192)
I0410 02:44:03.977867 139691431679872 resnet_biggan.py:150] [Block] (8, 64, 64, 192) (z=(8, 20), y=(8, 148)) -> (8, 128, 128, 96)
I0410 02:44:03.978035 139691431679872 resnet_biggan.py:294] [Generator] before final processing: (8, 128, 128, 96)
I0410 02:44:03.991930 139691431679872 resnet_biggan.py:300] [Generator] after final processing: (8, 128, 128, 3)
I0410 02:44:03.993613 139691431679872 s3gan.py:249] bs=8, rotated_bs=4, num_rot_examples=1
---------------------------------------------------s3gan.py/merge_with_rotation_data,s
---------------------------------------------------s3gan.py/merge_with_rotation_data,e
--------------------------------------------------------------------s3gan.py/discriminator_with_additonal_heads,s
I0410 02:44:04.019184 139691431679872 resnet_biggan.py:379] [Discriminator] inputs are x=(22, 128, 128, 3), y=(22, 2)
I0410 02:44:04.052156 139691431679872 resnet_biggan.py:150] [Block] (22, 128, 128, 3) (z=None, y=(22, 2)) -> (22, 64, 64, 96)
I0410 02:44:04.052364 139691431679872 resnet_biggan.py:398] [Discriminator] Applying non-local block to (22, 64, 64, 96)
I0410 02:44:04.122200 139691431679872 resnet_biggan.py:150] [Block] (22, 64, 64, 96) (z=None, y=(22, 2)) -> (22, 32, 32, 192)
I0410 02:44:04.152612 139691431679872 resnet_biggan.py:150] [Block] (22, 32, 32, 192) (z=None, y=(22, 2)) -> (22, 16, 16, 384)
I0410 02:44:04.183437 139691431679872 resnet_biggan.py:150] [Block] (22, 16, 16, 384) (z=None, y=(22, 2)) -> (22, 8, 8, 768)
I0410 02:44:04.213758 139691431679872 resnet_biggan.py:150] [Block] (22, 8, 8, 768) (z=None, y=(22, 2)) -> (22, 4, 4, 1536)
I0410 02:44:04.232934 139691431679872 resnet_biggan.py:150] [Block] (22, 4, 4, 1536) (z=None, y=(22, 2)) -> (22, 4, 4, 1536)
I0410 02:44:04.233115 139691431679872 resnet_biggan.py:403] [Discriminator] before final processing: (22, 4, 4, 1536)
I0410 02:44:04.243482 139691431679872 resnet_biggan.py:407] [Discriminator] after final processing: (22, 4, 4, 1536)
I0410 02:44:04.250015 139691431679872 resnet_biggan.py:422] [Discriminator] embedded_y for projection: (22, 1536)
I0410 02:44:04.262436 139691431679872 s3gan.py:133] [Discriminator] rotation head (22, 1536) -> Tensor("discriminator_rotation/score_classify/add:0", shape=(22, 4), dtype=float32)
I0410 02:44:04.279359 139691431679872 s3gan.py:154] [Discriminator] (22, 2) -> aux_logits=(22, 2), y_predicted=(22, 2)
---------------------------------------------------s3gan.py/get_class_embedding,s
I0410 02:44:04.285623 139691431679872 s3gan.py:175] [Discriminator] embedded_y for projection: (22, 1536)
---------------------------------------------------s3gan.py/get_class_embedding,e
---------------------------------------------------s3gan.py/discriminator_with_additonal_heads,e
---------------------------------------------------s3gan.py/create_loss,e
---------------------------------------------------modular_gan.py/create_logits,e
################################################## mode == tf.estimator.ModeKeys.EVAL  ########################
INFO:tensorflow:Done calling model_fn.
I0410 02:44:04.369963 139691431679872 estimator.py:1171] Done calling model_fn.
INFO:tensorflow:Starting evaluation at 2020-04-10T02:44:04Z
I0410 02:44:04.385952 139691431679872 evaluation.py:255] Starting evaluation at 2020-04-10T02:44:04Z
INFO:tensorflow:Graph was finalized.
I0410 02:44:04.529394 139691431679872 monitored_session.py:246] Graph was finalized.
2020-04-10 02:44:04.530212: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-04-10 02:44:04.530594: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:00:04.0 name: Tesla P4 computeCapability: 6.1
coreClock: 1.1135GHz coreCount: 20 deviceMemorySize: 7.43GiB deviceMemoryBandwidth: 178.99GiB/s
2020-04-10 02:44:04.530661: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.1
2020-04-10 02:44:04.530688: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10
2020-04-10 02:44:04.530714: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcufft.so.10
2020-04-10 02:44:04.530730: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcurand.so.10
2020-04-10 02:44:04.530744: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusolver.so.10
2020-04-10 02:44:04.535025: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusparse.so.10
2020-04-10 02:44:04.535086: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudnn.so.7
2020-04-10 02:44:04.535187: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-04-10 02:44:04.535464: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-04-10 02:44:04.535667: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1703] Adding visible gpu devices: 0
2020-04-10 02:44:04.535716: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-04-10 02:44:04.535729: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      0 
2020-04-10 02:44:04.535747: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1121] 0:   N 
2020-04-10 02:44:04.535866: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-04-10 02:44:04.536132: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-04-10 02:44:04.536349: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1247] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 6850 MB memory) -> physical GPU (device: 0, name: Tesla P4, pci bus id: 0000:00:04.0, compute capability: 6.1)
INFO:tensorflow:Restoring parameters from /tmp/absl_testing/429596/model.ckpt-1600
I0410 02:44:04.537169 139691431679872 saver.py:1293] Restoring parameters from /tmp/absl_testing/429596/model.ckpt-1600
INFO:tensorflow:Running local_init_op.
I0410 02:44:04.961090 139691431679872 session_manager.py:505] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
I0410 02:44:04.986263 139691431679872 session_manager.py:508] Done running local_init_op.
INFO:tensorflow:Evaluation [1/10]
I0410 02:44:08.744463 139691431679872 evaluation.py:167] Evaluation [1/10]
INFO:tensorflow:Evaluation [2/10]
I0410 02:44:11.053436 139691431679872 evaluation.py:167] Evaluation [2/10]
INFO:tensorflow:Evaluation [3/10]
I0410 02:44:13.347495 139691431679872 evaluation.py:167] Evaluation [3/10]
INFO:tensorflow:Evaluation [4/10]
I0410 02:44:15.544100 139691431679872 evaluation.py:167] Evaluation [4/10]
INFO:tensorflow:Evaluation [5/10]
I0410 02:44:17.699965 139691431679872 evaluation.py:167] Evaluation [5/10]
INFO:tensorflow:Evaluation [6/10]
I0410 02:44:19.983227 139691431679872 evaluation.py:167] Evaluation [6/10]
INFO:tensorflow:Evaluation [7/10]
I0410 02:44:22.317270 139691431679872 evaluation.py:167] Evaluation [7/10]
INFO:tensorflow:Evaluation [8/10]
I0410 02:44:23.985905 139691431679872 evaluation.py:167] Evaluation [8/10]
INFO:tensorflow:Evaluation [9/10]
I0410 02:44:26.163316 139691431679872 evaluation.py:167] Evaluation [9/10]
INFO:tensorflow:Evaluation [10/10]
I0410 02:44:27.996794 139691431679872 evaluation.py:167] Evaluation [10/10]
INFO:tensorflow:Inference Time : 24.27733s
I0410 02:44:28.663464 139691431679872 evaluation.py:273] Inference Time : 24.27733s
INFO:tensorflow:Finished evaluation at 2020-04-10-02:44:28
I0410 02:44:28.663677 139691431679872 evaluation.py:276] Finished evaluation at 2020-04-10-02:44:28
INFO:tensorflow:Saving dict for global step 1600: accuracy = 1.0, global_step = 1600, loss = 0.042578675
I0410 02:44:28.663840 139691431679872 estimator.py:2066] Saving dict for global step 1600: accuracy = 1.0, global_step = 1600, loss = 0.042578675
INFO:tensorflow:Saving 'checkpoint_path' summary for global step 1600: /tmp/absl_testing/429596/model.ckpt-1600
I0410 02:44:28.664339 139691431679872 estimator.py:2127] Saving 'checkpoint_path' summary for global step 1600: /tmp/absl_testing/429596/model.ckpt-1600
INFO:tensorflow:global_step/sec: 0.305866
I0410 02:44:30.122557 139691431679872 basic_session_run_hooks.py:702] global_step/sec: 0.305866
INFO:tensorflow:loss = 0.0094793225, step = 1600 (326.940 sec)
I0410 02:44:30.123574 139691431679872 basic_session_run_hooks.py:260] loss = 0.0094793225, step = 1600 (326.940 sec)
INFO:tensorflow:global_step/sec: 0.683968
I0410 02:46:56.328317 139691431679872 basic_session_run_hooks.py:702] global_step/sec: 0.683968
INFO:tensorflow:loss = 0.085156456, step = 1700 (146.206 sec)
I0410 02:46:56.329539 139691431679872 basic_session_run_hooks.py:260] loss = 0.085156456, step = 1700 (146.206 sec)
INFO:tensorflow:Calling checkpoint listeners before saving checkpoint 1800...
I0410 02:49:21.934996 139691431679872 basic_session_run_hooks.py:614] Calling checkpoint listeners before saving checkpoint 1800...
INFO:tensorflow:Saving checkpoints for 1800 into /tmp/absl_testing/429596/model.ckpt.
I0410 02:49:21.935262 139691431679872 basic_session_run_hooks.py:618] Saving checkpoints for 1800 into /tmp/absl_testing/429596/model.ckpt.
INFO:tensorflow:Calling checkpoint listeners after saving checkpoint 1800...
I0410 02:49:37.824156 139691431679872 basic_session_run_hooks.py:626] Calling checkpoint listeners after saving checkpoint 1800...
INFO:tensorflow:Skip the current checkpoint eval due to throttle secs (600 secs).
I0410 02:49:37.824414 139691431679872 training.py:528] Skip the current checkpoint eval due to throttle secs (600 secs).
INFO:tensorflow:global_step/sec: 0.61359
I0410 02:49:39.303443 139691431679872 basic_session_run_hooks.py:702] global_step/sec: 0.61359
INFO:tensorflow:loss = 0.24142218, step = 1800 (162.975 sec)
I0410 02:49:39.304453 139691431679872 basic_session_run_hooks.py:260] loss = 0.24142218, step = 1800 (162.975 sec)
INFO:tensorflow:global_step/sec: 0.68039
I0410 02:52:06.277956 139691431679872 basic_session_run_hooks.py:702] global_step/sec: 0.68039
INFO:tensorflow:loss = 0.55858994, step = 1900 (146.975 sec)
I0410 02:52:06.279008 139691431679872 basic_session_run_hooks.py:260] loss = 0.55858994, step = 1900 (146.975 sec)
INFO:tensorflow:Calling checkpoint listeners before saving checkpoint 2000...
I0410 02:54:32.022526 139691431679872 basic_session_run_hooks.py:614] Calling checkpoint listeners before saving checkpoint 2000...
INFO:tensorflow:Saving checkpoints for 2000 into /tmp/absl_testing/429596/model.ckpt.
I0410 02:54:32.022835 139691431679872 basic_session_run_hooks.py:618] Saving checkpoints for 2000 into /tmp/absl_testing/429596/model.ckpt.
INFO:tensorflow:Calling checkpoint listeners after saving checkpoint 2000...
I0410 02:54:47.965310 139691431679872 basic_session_run_hooks.py:626] Calling checkpoint listeners after saving checkpoint 2000...
--------------------------------------------datasets.py/eval_input_fn,s
W0410 02:54:51.762031 139691431679872 datasets.py:170] No TPUContext, using unmodified dataset seed 547.
I0410 02:54:51.762182 139691431679872 datasets.py:348] eval_input_fn(): params={'use_tpu': False, 'train_batch_size': 8, 'batch_size': 8} seed=547
--------befor self._load_dataset------------------split = validation self._eval_split= validation
--------------------------------------------datasets.py/_load_dataset,s
!!!!!!!!!!!!!!!!!!!!!!----load_local_datasets,  _local_test_ds_dir= /content/drive/My Drive/drive/gan/test
-----------------------------------------get_local_datasets,s
-----------------------------------------get_local_datasets,e
--------------------------------------------modular_gan.py/_preprocess_fn,s
I0410 02:54:51.844547 139691431679872 api.py:587] _preprocess_fn(): images=Tensor("args_0:0", shape=(128, 128, 3), dtype=float32), labels=Tensor("args_1:0", shape=(), dtype=int32), seed=547
--------------------------------------------modular_gan.py/_preprocess_fn,e
I0410 02:54:51.873981 139691431679872 api.py:587] Passing random offset: Tensor("Cast:0", shape=(), dtype=int32) with data ({'images': <tf.Tensor 'args_1:0' shape=(128, 128, 3) dtype=float32>, 'z': <tf.Tensor 'args_3:0' shape=(120,) dtype=float32>, 'sampled_labels': <tf.Tensor 'args_2:0' shape=() dtype=int32>}, <tf.Tensor 'args_4:0' shape=() dtype=int32>).
--------------------------------------------datasets.py/eval_input_fn,e
INFO:tensorflow:Calling model_fn.
I0410 02:54:51.894742 139691431679872 estimator.py:1169] Calling model_fn.
--------------------------------------------modular_gan.py/model_fn,s
I0410 02:54:51.894920 139691431679872 modular_gan.py:589] model_fn(): features={'images': <tf.Tensor 'IteratorGetNext:1' shape=(8, 128, 128, 3) dtype=float32>, 'z': <tf.Tensor 'IteratorGetNext:3' shape=(8, 120) dtype=float32>, 'sampled_labels': <tf.Tensor 'IteratorGetNext:2' shape=(8,) dtype=int32>, '_RANDOM_OFFSET': <tf.Tensor 'IteratorGetNext:0' shape=(8,) dtype=int32>}, labels=Tensor("IteratorGetNext:4", shape=(8,), dtype=int32),mode=eval, params={'use_tpu': False, 'train_batch_size': 8, 'batch_size': 8}
#Clean old summaries from previous calls to model_fn().
# Get features and labels for each sub-step.
--------------------------------------------modular_gan.py/_split_inputs_and_generate_samples,s
I0410 02:54:51.901542 139691431679872 resnet_biggan.py:236] [Generator] inputs are z=(8, 120), y=(8, 2)
I0410 02:54:51.911491 139691431679872 resnet_biggan.py:262] [Generator] z0=(8, 20), z_per_block=['(8, 20)', '(8, 20)', '(8, 20)', '(8, 20)', '(8, 20)'], y_per_block=['(8, 148)', '(8, 148)', '(8, 148)', '(8, 148)', '(8, 148)']
I0410 02:54:51.956665 139691431679872 resnet_biggan.py:150] [Block] (8, 4, 4, 1536) (z=(8, 20), y=(8, 148)) -> (8, 8, 8, 1536)
I0410 02:54:51.996464 139691431679872 resnet_biggan.py:150] [Block] (8, 8, 8, 1536) (z=(8, 20), y=(8, 148)) -> (8, 16, 16, 768)
I0410 02:54:52.033701 139691431679872 resnet_biggan.py:150] [Block] (8, 16, 16, 768) (z=(8, 20), y=(8, 148)) -> (8, 32, 32, 384)
I0410 02:54:52.070353 139691431679872 resnet_biggan.py:150] [Block] (8, 32, 32, 384) (z=(8, 20), y=(8, 148)) -> (8, 64, 64, 192)
I0410 02:54:52.070498 139691431679872 resnet_biggan.py:289] [Generator] Applying non-local block to (8, 64, 64, 192)
I0410 02:54:52.151798 139691431679872 resnet_biggan.py:150] [Block] (8, 64, 64, 192) (z=(8, 20), y=(8, 148)) -> (8, 128, 128, 96)
I0410 02:54:52.151980 139691431679872 resnet_biggan.py:294] [Generator] before final processing: (8, 128, 128, 96)
I0410 02:54:52.182256 139691431679872 resnet_biggan.py:300] [Generator] after final processing: (8, 128, 128, 3)
--------------------------------------------modular_gan.py/_split_inputs_and_generate_samples,e
---------------------------------------------------modular_gan.py/create_logits,s
I0410 02:54:52.185636 139691431679872 tpu_random.py:86] Got global random offset: Tensor("strided_slice:0", shape=(), dtype=int32)
---------------------------------------------------s3gan.py/create_loss,s
W0410 02:54:52.188225 139691431679872 s3gan.py:237] Computing fake images for every sub step separately.
I0410 02:54:52.188429 139691431679872 resnet_biggan.py:236] [Generator] inputs are z=(8, 120), y=(8, 2)
I0410 02:54:52.195564 139691431679872 resnet_biggan.py:262] [Generator] z0=(8, 20), z_per_block=['(8, 20)', '(8, 20)', '(8, 20)', '(8, 20)', '(8, 20)'], y_per_block=['(8, 148)', '(8, 148)', '(8, 148)', '(8, 148)', '(8, 148)']
I0410 02:54:52.213710 139691431679872 resnet_biggan.py:150] [Block] (8, 4, 4, 1536) (z=(8, 20), y=(8, 148)) -> (8, 8, 8, 1536)
I0410 02:54:52.229115 139691431679872 resnet_biggan.py:150] [Block] (8, 8, 8, 1536) (z=(8, 20), y=(8, 148)) -> (8, 16, 16, 768)
I0410 02:54:52.245123 139691431679872 resnet_biggan.py:150] [Block] (8, 16, 16, 768) (z=(8, 20), y=(8, 148)) -> (8, 32, 32, 384)
I0410 02:54:52.261076 139691431679872 resnet_biggan.py:150] [Block] (8, 32, 32, 384) (z=(8, 20), y=(8, 148)) -> (8, 64, 64, 192)
I0410 02:54:52.261222 139691431679872 resnet_biggan.py:289] [Generator] Applying non-local block to (8, 64, 64, 192)
I0410 02:54:52.294885 139691431679872 resnet_biggan.py:150] [Block] (8, 64, 64, 192) (z=(8, 20), y=(8, 148)) -> (8, 128, 128, 96)
I0410 02:54:52.295038 139691431679872 resnet_biggan.py:294] [Generator] before final processing: (8, 128, 128, 96)
I0410 02:54:52.310147 139691431679872 resnet_biggan.py:300] [Generator] after final processing: (8, 128, 128, 3)
I0410 02:54:52.312076 139691431679872 s3gan.py:249] bs=8, rotated_bs=4, num_rot_examples=1
---------------------------------------------------s3gan.py/merge_with_rotation_data,s
---------------------------------------------------s3gan.py/merge_with_rotation_data,e
--------------------------------------------------------------------s3gan.py/discriminator_with_additonal_heads,s
I0410 02:54:52.337220 139691431679872 resnet_biggan.py:379] [Discriminator] inputs are x=(22, 128, 128, 3), y=(22, 2)
I0410 02:54:52.367319 139691431679872 resnet_biggan.py:150] [Block] (22, 128, 128, 3) (z=None, y=(22, 2)) -> (22, 64, 64, 96)
I0410 02:54:52.367461 139691431679872 resnet_biggan.py:398] [Discriminator] Applying non-local block to (22, 64, 64, 96)
I0410 02:54:52.435024 139691431679872 resnet_biggan.py:150] [Block] (22, 64, 64, 96) (z=None, y=(22, 2)) -> (22, 32, 32, 192)
I0410 02:54:52.465271 139691431679872 resnet_biggan.py:150] [Block] (22, 32, 32, 192) (z=None, y=(22, 2)) -> (22, 16, 16, 384)
I0410 02:54:52.497017 139691431679872 resnet_biggan.py:150] [Block] (22, 16, 16, 384) (z=None, y=(22, 2)) -> (22, 8, 8, 768)
I0410 02:54:52.527175 139691431679872 resnet_biggan.py:150] [Block] (22, 8, 8, 768) (z=None, y=(22, 2)) -> (22, 4, 4, 1536)
I0410 02:54:52.545975 139691431679872 resnet_biggan.py:150] [Block] (22, 4, 4, 1536) (z=None, y=(22, 2)) -> (22, 4, 4, 1536)
I0410 02:54:52.546123 139691431679872 resnet_biggan.py:403] [Discriminator] before final processing: (22, 4, 4, 1536)
I0410 02:54:52.556796 139691431679872 resnet_biggan.py:407] [Discriminator] after final processing: (22, 4, 4, 1536)
I0410 02:54:52.562608 139691431679872 resnet_biggan.py:422] [Discriminator] embedded_y for projection: (22, 1536)
I0410 02:54:52.574542 139691431679872 s3gan.py:133] [Discriminator] rotation head (22, 1536) -> Tensor("discriminator_rotation/score_classify/add:0", shape=(22, 4), dtype=float32)
I0410 02:54:52.587184 139691431679872 s3gan.py:154] [Discriminator] (22, 2) -> aux_logits=(22, 2), y_predicted=(22, 2)
---------------------------------------------------s3gan.py/get_class_embedding,s
I0410 02:54:52.593447 139691431679872 s3gan.py:175] [Discriminator] embedded_y for projection: (22, 1536)
---------------------------------------------------s3gan.py/get_class_embedding,e
---------------------------------------------------s3gan.py/discriminator_with_additonal_heads,e
---------------------------------------------------s3gan.py/create_loss,e
---------------------------------------------------modular_gan.py/create_logits,e
################################################## mode == tf.estimator.ModeKeys.EVAL  ########################
INFO:tensorflow:Done calling model_fn.
I0410 02:54:52.677486 139691431679872 estimator.py:1171] Done calling model_fn.
INFO:tensorflow:Starting evaluation at 2020-04-10T02:54:52Z
I0410 02:54:52.692723 139691431679872 evaluation.py:255] Starting evaluation at 2020-04-10T02:54:52Z
INFO:tensorflow:Graph was finalized.
I0410 02:54:52.830469 139691431679872 monitored_session.py:246] Graph was finalized.
2020-04-10 02:54:52.831153: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-04-10 02:54:52.831463: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:00:04.0 name: Tesla P4 computeCapability: 6.1
coreClock: 1.1135GHz coreCount: 20 deviceMemorySize: 7.43GiB deviceMemoryBandwidth: 178.99GiB/s
2020-04-10 02:54:52.831513: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.1
2020-04-10 02:54:52.831539: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10
2020-04-10 02:54:52.831556: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcufft.so.10
2020-04-10 02:54:52.831572: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcurand.so.10
2020-04-10 02:54:52.831587: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusolver.so.10
2020-04-10 02:54:52.831637: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusparse.so.10
2020-04-10 02:54:52.831654: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudnn.so.7
2020-04-10 02:54:52.831730: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-04-10 02:54:52.832044: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-04-10 02:54:52.832257: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1703] Adding visible gpu devices: 0
2020-04-10 02:54:52.832306: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-04-10 02:54:52.832319: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      0 
2020-04-10 02:54:52.832328: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1121] 0:   N 
2020-04-10 02:54:52.832457: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-04-10 02:54:52.832716: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-04-10 02:54:52.832949: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1247] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 6850 MB memory) -> physical GPU (device: 0, name: Tesla P4, pci bus id: 0000:00:04.0, compute capability: 6.1)
INFO:tensorflow:Restoring parameters from /tmp/absl_testing/429596/model.ckpt-2000
I0410 02:54:52.833737 139691431679872 saver.py:1293] Restoring parameters from /tmp/absl_testing/429596/model.ckpt-2000
INFO:tensorflow:Running local_init_op.
I0410 02:54:53.251941 139691431679872 session_manager.py:505] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
I0410 02:54:53.275639 139691431679872 session_manager.py:508] Done running local_init_op.
INFO:tensorflow:Evaluation [1/10]
I0410 02:54:56.262071 139691431679872 evaluation.py:167] Evaluation [1/10]
INFO:tensorflow:Evaluation [2/10]
I0410 02:54:58.784700 139691431679872 evaluation.py:167] Evaluation [2/10]
INFO:tensorflow:Evaluation [3/10]
I0410 02:55:01.235312 139691431679872 evaluation.py:167] Evaluation [3/10]
INFO:tensorflow:Evaluation [4/10]
I0410 02:55:02.964099 139691431679872 evaluation.py:167] Evaluation [4/10]
INFO:tensorflow:Evaluation [5/10]
I0410 02:55:04.907908 139691431679872 evaluation.py:167] Evaluation [5/10]
INFO:tensorflow:Evaluation [6/10]
I0410 02:55:06.904245 139691431679872 evaluation.py:167] Evaluation [6/10]
INFO:tensorflow:Evaluation [7/10]
I0410 02:55:08.674101 139691431679872 evaluation.py:167] Evaluation [7/10]
INFO:tensorflow:Evaluation [8/10]
I0410 02:55:10.714629 139691431679872 evaluation.py:167] Evaluation [8/10]
INFO:tensorflow:Evaluation [9/10]
I0410 02:55:13.107309 139691431679872 evaluation.py:167] Evaluation [9/10]
INFO:tensorflow:Evaluation [10/10]
I0410 02:55:15.053112 139691431679872 evaluation.py:167] Evaluation [10/10]
INFO:tensorflow:Inference Time : 22.41729s
I0410 02:55:15.110176 139691431679872 evaluation.py:273] Inference Time : 22.41729s
INFO:tensorflow:Finished evaluation at 2020-04-10-02:55:15
I0410 02:55:15.110369 139691431679872 evaluation.py:276] Finished evaluation at 2020-04-10-02:55:15
INFO:tensorflow:Saving dict for global step 2000: accuracy = 1.0, global_step = 2000, loss = 0.0314796
I0410 02:55:15.110503 139691431679872 estimator.py:2066] Saving dict for global step 2000: accuracy = 1.0, global_step = 2000, loss = 0.0314796
INFO:tensorflow:Saving 'checkpoint_path' summary for global step 2000: /tmp/absl_testing/429596/model.ckpt-2000
I0410 02:55:15.110978 139691431679872 estimator.py:2127] Saving 'checkpoint_path' summary for global step 2000: /tmp/absl_testing/429596/model.ckpt-2000
INFO:tensorflow:global_step/sec: 0.525525
I0410 02:55:16.563668 139691431679872 basic_session_run_hooks.py:702] global_step/sec: 0.525525
INFO:tensorflow:loss = 0.04115889, step = 2000 (190.287 sec)
I0410 02:55:16.565529 139691431679872 basic_session_run_hooks.py:260] loss = 0.04115889, step = 2000 (190.287 sec)
INFO:tensorflow:global_step/sec: 0.681729
I0410 02:57:43.249500 139691431679872 basic_session_run_hooks.py:702] global_step/sec: 0.681729
INFO:tensorflow:loss = 0.01185841, step = 2100 (146.685 sec)
I0410 02:57:43.250563 139691431679872 basic_session_run_hooks.py:260] loss = 0.01185841, step = 2100 (146.685 sec)
INFO:tensorflow:Calling checkpoint listeners before saving checkpoint 2200...
I0410 03:00:08.788367 139691431679872 basic_session_run_hooks.py:614] Calling checkpoint listeners before saving checkpoint 2200...
INFO:tensorflow:Saving checkpoints for 2200 into /tmp/absl_testing/429596/model.ckpt.
I0410 03:00:08.788619 139691431679872 basic_session_run_hooks.py:618] Saving checkpoints for 2200 into /tmp/absl_testing/429596/model.ckpt.
INFO:tensorflow:Calling checkpoint listeners after saving checkpoint 2200...
I0410 03:00:25.882725 139691431679872 basic_session_run_hooks.py:626] Calling checkpoint listeners after saving checkpoint 2200...
INFO:tensorflow:Skip the current checkpoint eval due to throttle secs (600 secs).
I0410 03:00:25.883167 139691431679872 training.py:528] Skip the current checkpoint eval due to throttle secs (600 secs).
INFO:tensorflow:global_step/sec: 0.609315
I0410 03:00:27.368296 139691431679872 basic_session_run_hooks.py:702] global_step/sec: 0.609315
INFO:tensorflow:loss = 0.00019464875, step = 2200 (164.119 sec)
I0410 03:00:27.369282 139691431679872 basic_session_run_hooks.py:260] loss = 0.00019464875, step = 2200 (164.119 sec)
INFO:tensorflow:global_step/sec: 0.680327
I0410 03:02:54.356489 139691431679872 basic_session_run_hooks.py:702] global_step/sec: 0.680327
INFO:tensorflow:loss = 1.3007119, step = 2300 (146.988 sec)
I0410 03:02:54.357458 139691431679872 basic_session_run_hooks.py:260] loss = 1.3007119, step = 2300 (146.988 sec)
INFO:tensorflow:Calling checkpoint listeners before saving checkpoint 2400...
I0410 03:05:19.974183 139691431679872 basic_session_run_hooks.py:614] Calling checkpoint listeners before saving checkpoint 2400...
INFO:tensorflow:Saving checkpoints for 2400 into /tmp/absl_testing/429596/model.ckpt.
I0410 03:05:19.974426 139691431679872 basic_session_run_hooks.py:618] Saving checkpoints for 2400 into /tmp/absl_testing/429596/model.ckpt.
INFO:tensorflow:Calling checkpoint listeners after saving checkpoint 2400...
I0410 03:05:36.630771 139691431679872 basic_session_run_hooks.py:626] Calling checkpoint listeners after saving checkpoint 2400...
--------------------------------------------datasets.py/eval_input_fn,s
W0410 03:05:36.950697 139691431679872 datasets.py:170] No TPUContext, using unmodified dataset seed 547.
I0410 03:05:36.950954 139691431679872 datasets.py:348] eval_input_fn(): params={'use_tpu': False, 'train_batch_size': 8, 'batch_size': 8} seed=547
--------befor self._load_dataset------------------split = validation self._eval_split= validation
--------------------------------------------datasets.py/_load_dataset,s
!!!!!!!!!!!!!!!!!!!!!!----load_local_datasets,  _local_test_ds_dir= /content/drive/My Drive/drive/gan/test
-----------------------------------------get_local_datasets,s
-----------------------------------------get_local_datasets,e
--------------------------------------------modular_gan.py/_preprocess_fn,s
I0410 03:05:37.032115 139691431679872 api.py:587] _preprocess_fn(): images=Tensor("args_0:0", shape=(128, 128, 3), dtype=float32), labels=Tensor("args_1:0", shape=(), dtype=int32), seed=547
--------------------------------------------modular_gan.py/_preprocess_fn,e
I0410 03:05:37.059886 139691431679872 api.py:587] Passing random offset: Tensor("Cast:0", shape=(), dtype=int32) with data ({'images': <tf.Tensor 'args_1:0' shape=(128, 128, 3) dtype=float32>, 'z': <tf.Tensor 'args_3:0' shape=(120,) dtype=float32>, 'sampled_labels': <tf.Tensor 'args_2:0' shape=() dtype=int32>}, <tf.Tensor 'args_4:0' shape=() dtype=int32>).
--------------------------------------------datasets.py/eval_input_fn,e
INFO:tensorflow:Calling model_fn.
I0410 03:05:37.076050 139691431679872 estimator.py:1169] Calling model_fn.
--------------------------------------------modular_gan.py/model_fn,s
I0410 03:05:37.076208 139691431679872 modular_gan.py:589] model_fn(): features={'images': <tf.Tensor 'IteratorGetNext:1' shape=(8, 128, 128, 3) dtype=float32>, 'z': <tf.Tensor 'IteratorGetNext:3' shape=(8, 120) dtype=float32>, 'sampled_labels': <tf.Tensor 'IteratorGetNext:2' shape=(8,) dtype=int32>, '_RANDOM_OFFSET': <tf.Tensor 'IteratorGetNext:0' shape=(8,) dtype=int32>}, labels=Tensor("IteratorGetNext:4", shape=(8,), dtype=int32),mode=eval, params={'use_tpu': False, 'train_batch_size': 8, 'batch_size': 8}
#Clean old summaries from previous calls to model_fn().
# Get features and labels for each sub-step.
--------------------------------------------modular_gan.py/_split_inputs_and_generate_samples,s
I0410 03:05:37.083543 139691431679872 resnet_biggan.py:236] [Generator] inputs are z=(8, 120), y=(8, 2)
I0410 03:05:37.093704 139691431679872 resnet_biggan.py:262] [Generator] z0=(8, 20), z_per_block=['(8, 20)', '(8, 20)', '(8, 20)', '(8, 20)', '(8, 20)'], y_per_block=['(8, 148)', '(8, 148)', '(8, 148)', '(8, 148)', '(8, 148)']
I0410 03:05:37.143535 139691431679872 resnet_biggan.py:150] [Block] (8, 4, 4, 1536) (z=(8, 20), y=(8, 148)) -> (8, 8, 8, 1536)
I0410 03:05:37.184844 139691431679872 resnet_biggan.py:150] [Block] (8, 8, 8, 1536) (z=(8, 20), y=(8, 148)) -> (8, 16, 16, 768)
I0410 03:05:37.226559 139691431679872 resnet_biggan.py:150] [Block] (8, 16, 16, 768) (z=(8, 20), y=(8, 148)) -> (8, 32, 32, 384)
I0410 03:05:37.265060 139691431679872 resnet_biggan.py:150] [Block] (8, 32, 32, 384) (z=(8, 20), y=(8, 148)) -> (8, 64, 64, 192)
I0410 03:05:37.265215 139691431679872 resnet_biggan.py:289] [Generator] Applying non-local block to (8, 64, 64, 192)
I0410 03:05:37.340495 139691431679872 resnet_biggan.py:150] [Block] (8, 64, 64, 192) (z=(8, 20), y=(8, 148)) -> (8, 128, 128, 96)
I0410 03:05:37.340669 139691431679872 resnet_biggan.py:294] [Generator] before final processing: (8, 128, 128, 96)
I0410 03:05:37.371390 139691431679872 resnet_biggan.py:300] [Generator] after final processing: (8, 128, 128, 3)
--------------------------------------------modular_gan.py/_split_inputs_and_generate_samples,e
---------------------------------------------------modular_gan.py/create_logits,s
I0410 03:05:37.374783 139691431679872 tpu_random.py:86] Got global random offset: Tensor("strided_slice:0", shape=(), dtype=int32)
---------------------------------------------------s3gan.py/create_loss,s
W0410 03:05:37.377292 139691431679872 s3gan.py:237] Computing fake images for every sub step separately.
I0410 03:05:37.377490 139691431679872 resnet_biggan.py:236] [Generator] inputs are z=(8, 120), y=(8, 2)
I0410 03:05:37.382901 139691431679872 resnet_biggan.py:262] [Generator] z0=(8, 20), z_per_block=['(8, 20)', '(8, 20)', '(8, 20)', '(8, 20)', '(8, 20)'], y_per_block=['(8, 148)', '(8, 148)', '(8, 148)', '(8, 148)', '(8, 148)']
I0410 03:05:37.403629 139691431679872 resnet_biggan.py:150] [Block] (8, 4, 4, 1536) (z=(8, 20), y=(8, 148)) -> (8, 8, 8, 1536)
I0410 03:05:37.419741 139691431679872 resnet_biggan.py:150] [Block] (8, 8, 8, 1536) (z=(8, 20), y=(8, 148)) -> (8, 16, 16, 768)
I0410 03:05:37.436077 139691431679872 resnet_biggan.py:150] [Block] (8, 16, 16, 768) (z=(8, 20), y=(8, 148)) -> (8, 32, 32, 384)
I0410 03:05:37.453053 139691431679872 resnet_biggan.py:150] [Block] (8, 32, 32, 384) (z=(8, 20), y=(8, 148)) -> (8, 64, 64, 192)
I0410 03:05:37.453207 139691431679872 resnet_biggan.py:289] [Generator] Applying non-local block to (8, 64, 64, 192)
I0410 03:05:37.736993 139691431679872 resnet_biggan.py:150] [Block] (8, 64, 64, 192) (z=(8, 20), y=(8, 148)) -> (8, 128, 128, 96)
I0410 03:05:37.737213 139691431679872 resnet_biggan.py:294] [Generator] before final processing: (8, 128, 128, 96)
I0410 03:05:37.751871 139691431679872 resnet_biggan.py:300] [Generator] after final processing: (8, 128, 128, 3)
I0410 03:05:37.753538 139691431679872 s3gan.py:249] bs=8, rotated_bs=4, num_rot_examples=1
---------------------------------------------------s3gan.py/merge_with_rotation_data,s
---------------------------------------------------s3gan.py/merge_with_rotation_data,e
--------------------------------------------------------------------s3gan.py/discriminator_with_additonal_heads,s
I0410 03:05:37.777960 139691431679872 resnet_biggan.py:379] [Discriminator] inputs are x=(22, 128, 128, 3), y=(22, 2)
I0410 03:05:37.808919 139691431679872 resnet_biggan.py:150] [Block] (22, 128, 128, 3) (z=None, y=(22, 2)) -> (22, 64, 64, 96)
I0410 03:05:37.809067 139691431679872 resnet_biggan.py:398] [Discriminator] Applying non-local block to (22, 64, 64, 96)
I0410 03:05:37.877435 139691431679872 resnet_biggan.py:150] [Block] (22, 64, 64, 96) (z=None, y=(22, 2)) -> (22, 32, 32, 192)
I0410 03:05:37.908281 139691431679872 resnet_biggan.py:150] [Block] (22, 32, 32, 192) (z=None, y=(22, 2)) -> (22, 16, 16, 384)
I0410 03:05:37.938370 139691431679872 resnet_biggan.py:150] [Block] (22, 16, 16, 384) (z=None, y=(22, 2)) -> (22, 8, 8, 768)
I0410 03:05:37.968304 139691431679872 resnet_biggan.py:150] [Block] (22, 8, 8, 768) (z=None, y=(22, 2)) -> (22, 4, 4, 1536)
I0410 03:05:37.987297 139691431679872 resnet_biggan.py:150] [Block] (22, 4, 4, 1536) (z=None, y=(22, 2)) -> (22, 4, 4, 1536)
I0410 03:05:37.987442 139691431679872 resnet_biggan.py:403] [Discriminator] before final processing: (22, 4, 4, 1536)
I0410 03:05:37.997325 139691431679872 resnet_biggan.py:407] [Discriminator] after final processing: (22, 4, 4, 1536)
I0410 03:05:38.005356 139691431679872 resnet_biggan.py:422] [Discriminator] embedded_y for projection: (22, 1536)
I0410 03:05:38.019826 139691431679872 s3gan.py:133] [Discriminator] rotation head (22, 1536) -> Tensor("discriminator_rotation/score_classify/add:0", shape=(22, 4), dtype=float32)
I0410 03:05:38.032440 139691431679872 s3gan.py:154] [Discriminator] (22, 2) -> aux_logits=(22, 2), y_predicted=(22, 2)
---------------------------------------------------s3gan.py/get_class_embedding,s
I0410 03:05:38.038453 139691431679872 s3gan.py:175] [Discriminator] embedded_y for projection: (22, 1536)
---------------------------------------------------s3gan.py/get_class_embedding,e
---------------------------------------------------s3gan.py/discriminator_with_additonal_heads,e
---------------------------------------------------s3gan.py/create_loss,e
---------------------------------------------------modular_gan.py/create_logits,e
################################################## mode == tf.estimator.ModeKeys.EVAL  ########################
INFO:tensorflow:Done calling model_fn.
I0410 03:05:38.121062 139691431679872 estimator.py:1171] Done calling model_fn.
INFO:tensorflow:Starting evaluation at 2020-04-10T03:05:38Z
I0410 03:05:38.136394 139691431679872 evaluation.py:255] Starting evaluation at 2020-04-10T03:05:38Z
INFO:tensorflow:Graph was finalized.
I0410 03:05:38.283428 139691431679872 monitored_session.py:246] Graph was finalized.
2020-04-10 03:05:38.284106: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-04-10 03:05:38.284406: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:00:04.0 name: Tesla P4 computeCapability: 6.1
coreClock: 1.1135GHz coreCount: 20 deviceMemorySize: 7.43GiB deviceMemoryBandwidth: 178.99GiB/s
2020-04-10 03:05:38.284454: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.1
2020-04-10 03:05:38.284476: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10
2020-04-10 03:05:38.284494: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcufft.so.10
2020-04-10 03:05:38.284513: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcurand.so.10
2020-04-10 03:05:38.284530: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusolver.so.10
2020-04-10 03:05:38.284576: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusparse.so.10
2020-04-10 03:05:38.284591: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudnn.so.7
2020-04-10 03:05:38.284668: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-04-10 03:05:38.284984: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-04-10 03:05:38.285203: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1703] Adding visible gpu devices: 0
2020-04-10 03:05:38.285245: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-04-10 03:05:38.285259: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      0 
2020-04-10 03:05:38.285271: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1121] 0:   N 
2020-04-10 03:05:38.285362: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-04-10 03:05:38.285627: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-04-10 03:05:38.285856: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1247] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 6850 MB memory) -> physical GPU (device: 0, name: Tesla P4, pci bus id: 0000:00:04.0, compute capability: 6.1)
INFO:tensorflow:Restoring parameters from /tmp/absl_testing/429596/model.ckpt-2400
I0410 03:05:38.286737 139691431679872 saver.py:1293] Restoring parameters from /tmp/absl_testing/429596/model.ckpt-2400
INFO:tensorflow:Running local_init_op.
I0410 03:05:38.701677 139691431679872 session_manager.py:505] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
I0410 03:05:38.724279 139691431679872 session_manager.py:508] Done running local_init_op.
INFO:tensorflow:Evaluation [1/10]
I0410 03:05:42.545907 139691431679872 evaluation.py:167] Evaluation [1/10]
INFO:tensorflow:Evaluation [2/10]
I0410 03:05:45.079287 139691431679872 evaluation.py:167] Evaluation [2/10]
INFO:tensorflow:Evaluation [3/10]
I0410 03:05:46.546073 139691431679872 evaluation.py:167] Evaluation [3/10]
INFO:tensorflow:Evaluation [4/10]
I0410 03:05:48.840456 139691431679872 evaluation.py:167] Evaluation [4/10]
INFO:tensorflow:Evaluation [5/10]
I0410 03:05:50.654155 139691431679872 evaluation.py:167] Evaluation [5/10]
INFO:tensorflow:Evaluation [6/10]
I0410 03:05:52.678333 139691431679872 evaluation.py:167] Evaluation [6/10]
INFO:tensorflow:Evaluation [7/10]
I0410 03:05:54.516143 139691431679872 evaluation.py:167] Evaluation [7/10]
INFO:tensorflow:Evaluation [8/10]
I0410 03:05:56.134217 139691431679872 evaluation.py:167] Evaluation [8/10]
INFO:tensorflow:Evaluation [9/10]
I0410 03:05:58.340522 139691431679872 evaluation.py:167] Evaluation [9/10]
INFO:tensorflow:Evaluation [10/10]
I0410 03:05:59.950537 139691431679872 evaluation.py:167] Evaluation [10/10]
INFO:tensorflow:Inference Time : 22.12479s
I0410 03:06:00.261340 139691431679872 evaluation.py:273] Inference Time : 22.12479s
INFO:tensorflow:Finished evaluation at 2020-04-10-03:06:00
I0410 03:06:00.261579 139691431679872 evaluation.py:276] Finished evaluation at 2020-04-10-03:06:00
INFO:tensorflow:Saving dict for global step 2400: accuracy = 1.0, global_step = 2400, loss = 0.030661639
I0410 03:06:00.261765 139691431679872 estimator.py:2066] Saving dict for global step 2400: accuracy = 1.0, global_step = 2400, loss = 0.030661639
INFO:tensorflow:Saving 'checkpoint_path' summary for global step 2400: /tmp/absl_testing/429596/model.ckpt-2400
I0410 03:06:00.262404 139691431679872 estimator.py:2127] Saving 'checkpoint_path' summary for global step 2400: /tmp/absl_testing/429596/model.ckpt-2400
INFO:tensorflow:global_step/sec: 0.5337
I0410 03:06:01.727611 139691431679872 basic_session_run_hooks.py:702] global_step/sec: 0.5337
INFO:tensorflow:loss = 0.034128793, step = 2400 (187.371 sec)
I0410 03:06:01.728444 139691431679872 basic_session_run_hooks.py:260] loss = 0.034128793, step = 2400 (187.371 sec)
INFO:tensorflow:global_step/sec: 0.681491
I0410 03:08:28.464702 139691431679872 basic_session_run_hooks.py:702] global_step/sec: 0.681491
INFO:tensorflow:loss = 0.012396216, step = 2500 (146.737 sec)
I0410 03:08:28.465727 139691431679872 basic_session_run_hooks.py:260] loss = 0.012396216, step = 2500 (146.737 sec)
INFO:tensorflow:Calling checkpoint listeners before saving checkpoint 2600...
I0410 03:10:54.042872 139691431679872 basic_session_run_hooks.py:614] Calling checkpoint listeners before saving checkpoint 2600...
INFO:tensorflow:Saving checkpoints for 2600 into /tmp/absl_testing/429596/model.ckpt.
I0410 03:10:54.043203 139691431679872 basic_session_run_hooks.py:618] Saving checkpoints for 2600 into /tmp/absl_testing/429596/model.ckpt.
INFO:tensorflow:Calling checkpoint listeners after saving checkpoint 2600...
I0410 03:11:10.076118 139691431679872 basic_session_run_hooks.py:626] Calling checkpoint listeners after saving checkpoint 2600...
INFO:tensorflow:Skip the current checkpoint eval due to throttle secs (600 secs).
I0410 03:11:10.076857 139691431679872 training.py:528] Skip the current checkpoint eval due to throttle secs (600 secs).
INFO:tensorflow:global_step/sec: 0.613114
I0410 03:11:11.566407 139691431679872 basic_session_run_hooks.py:702] global_step/sec: 0.613114
INFO:tensorflow:loss = 0.020557, step = 2600 (163.102 sec)
I0410 03:11:11.567942 139691431679872 basic_session_run_hooks.py:260] loss = 0.020557, step = 2600 (163.102 sec)
INFO:tensorflow:global_step/sec: 0.680624
I0410 03:13:38.490409 139691431679872 basic_session_run_hooks.py:702] global_step/sec: 0.680624
INFO:tensorflow:loss = 0.5786213, step = 2700 (146.924 sec)
I0410 03:13:38.491452 139691431679872 basic_session_run_hooks.py:260] loss = 0.5786213, step = 2700 (146.924 sec)
INFO:tensorflow:Calling checkpoint listeners before saving checkpoint 2800...
I0410 03:16:04.031479 139691431679872 basic_session_run_hooks.py:614] Calling checkpoint listeners before saving checkpoint 2800...
INFO:tensorflow:Saving checkpoints for 2800 into /tmp/absl_testing/429596/model.ckpt.
I0410 03:16:04.031756 139691431679872 basic_session_run_hooks.py:618] Saving checkpoints for 2800 into /tmp/absl_testing/429596/model.ckpt.
INFO:tensorflow:Calling checkpoint listeners after saving checkpoint 2800...
I0410 03:16:20.263474 139691431679872 basic_session_run_hooks.py:626] Calling checkpoint listeners after saving checkpoint 2800...
--------------------------------------------datasets.py/eval_input_fn,s
W0410 03:16:23.559436 139691431679872 datasets.py:170] No TPUContext, using unmodified dataset seed 547.
I0410 03:16:23.559616 139691431679872 datasets.py:348] eval_input_fn(): params={'use_tpu': False, 'train_batch_size': 8, 'batch_size': 8} seed=547
--------befor self._load_dataset------------------split = validation self._eval_split= validation
--------------------------------------------datasets.py/_load_dataset,s
!!!!!!!!!!!!!!!!!!!!!!----load_local_datasets,  _local_test_ds_dir= /content/drive/My Drive/drive/gan/test
-----------------------------------------get_local_datasets,s
-----------------------------------------get_local_datasets,e
--------------------------------------------modular_gan.py/_preprocess_fn,s
I0410 03:16:23.641137 139691431679872 api.py:587] _preprocess_fn(): images=Tensor("args_0:0", shape=(128, 128, 3), dtype=float32), labels=Tensor("args_1:0", shape=(), dtype=int32), seed=547
--------------------------------------------modular_gan.py/_preprocess_fn,e
I0410 03:16:23.669179 139691431679872 api.py:587] Passing random offset: Tensor("Cast:0", shape=(), dtype=int32) with data ({'images': <tf.Tensor 'args_1:0' shape=(128, 128, 3) dtype=float32>, 'z': <tf.Tensor 'args_3:0' shape=(120,) dtype=float32>, 'sampled_labels': <tf.Tensor 'args_2:0' shape=() dtype=int32>}, <tf.Tensor 'args_4:0' shape=() dtype=int32>).
--------------------------------------------datasets.py/eval_input_fn,e
INFO:tensorflow:Calling model_fn.
I0410 03:16:23.684598 139691431679872 estimator.py:1169] Calling model_fn.
--------------------------------------------modular_gan.py/model_fn,s
I0410 03:16:23.684764 139691431679872 modular_gan.py:589] model_fn(): features={'images': <tf.Tensor 'IteratorGetNext:1' shape=(8, 128, 128, 3) dtype=float32>, 'z': <tf.Tensor 'IteratorGetNext:3' shape=(8, 120) dtype=float32>, 'sampled_labels': <tf.Tensor 'IteratorGetNext:2' shape=(8,) dtype=int32>, '_RANDOM_OFFSET': <tf.Tensor 'IteratorGetNext:0' shape=(8,) dtype=int32>}, labels=Tensor("IteratorGetNext:4", shape=(8,), dtype=int32),mode=eval, params={'use_tpu': False, 'train_batch_size': 8, 'batch_size': 8}
#Clean old summaries from previous calls to model_fn().
# Get features and labels for each sub-step.
--------------------------------------------modular_gan.py/_split_inputs_and_generate_samples,s
I0410 03:16:23.691228 139691431679872 resnet_biggan.py:236] [Generator] inputs are z=(8, 120), y=(8, 2)
I0410 03:16:23.701043 139691431679872 resnet_biggan.py:262] [Generator] z0=(8, 20), z_per_block=['(8, 20)', '(8, 20)', '(8, 20)', '(8, 20)', '(8, 20)'], y_per_block=['(8, 148)', '(8, 148)', '(8, 148)', '(8, 148)', '(8, 148)']
I0410 03:16:23.747446 139691431679872 resnet_biggan.py:150] [Block] (8, 4, 4, 1536) (z=(8, 20), y=(8, 148)) -> (8, 8, 8, 1536)
I0410 03:16:23.784047 139691431679872 resnet_biggan.py:150] [Block] (8, 8, 8, 1536) (z=(8, 20), y=(8, 148)) -> (8, 16, 16, 768)
I0410 03:16:23.823559 139691431679872 resnet_biggan.py:150] [Block] (8, 16, 16, 768) (z=(8, 20), y=(8, 148)) -> (8, 32, 32, 384)
I0410 03:16:23.860917 139691431679872 resnet_biggan.py:150] [Block] (8, 32, 32, 384) (z=(8, 20), y=(8, 148)) -> (8, 64, 64, 192)
I0410 03:16:23.861067 139691431679872 resnet_biggan.py:289] [Generator] Applying non-local block to (8, 64, 64, 192)
I0410 03:16:23.934769 139691431679872 resnet_biggan.py:150] [Block] (8, 64, 64, 192) (z=(8, 20), y=(8, 148)) -> (8, 128, 128, 96)
I0410 03:16:23.934939 139691431679872 resnet_biggan.py:294] [Generator] before final processing: (8, 128, 128, 96)
I0410 03:16:23.965162 139691431679872 resnet_biggan.py:300] [Generator] after final processing: (8, 128, 128, 3)
--------------------------------------------modular_gan.py/_split_inputs_and_generate_samples,e
---------------------------------------------------modular_gan.py/create_logits,s
I0410 03:16:23.968502 139691431679872 tpu_random.py:86] Got global random offset: Tensor("strided_slice:0", shape=(), dtype=int32)
---------------------------------------------------s3gan.py/create_loss,s
W0410 03:16:23.971074 139691431679872 s3gan.py:237] Computing fake images for every sub step separately.
I0410 03:16:23.971268 139691431679872 resnet_biggan.py:236] [Generator] inputs are z=(8, 120), y=(8, 2)
I0410 03:16:23.976479 139691431679872 resnet_biggan.py:262] [Generator] z0=(8, 20), z_per_block=['(8, 20)', '(8, 20)', '(8, 20)', '(8, 20)', '(8, 20)'], y_per_block=['(8, 148)', '(8, 148)', '(8, 148)', '(8, 148)', '(8, 148)']
I0410 03:16:23.994283 139691431679872 resnet_biggan.py:150] [Block] (8, 4, 4, 1536) (z=(8, 20), y=(8, 148)) -> (8, 8, 8, 1536)
I0410 03:16:24.011402 139691431679872 resnet_biggan.py:150] [Block] (8, 8, 8, 1536) (z=(8, 20), y=(8, 148)) -> (8, 16, 16, 768)
I0410 03:16:24.027127 139691431679872 resnet_biggan.py:150] [Block] (8, 16, 16, 768) (z=(8, 20), y=(8, 148)) -> (8, 32, 32, 384)
I0410 03:16:24.042612 139691431679872 resnet_biggan.py:150] [Block] (8, 32, 32, 384) (z=(8, 20), y=(8, 148)) -> (8, 64, 64, 192)
I0410 03:16:24.042754 139691431679872 resnet_biggan.py:289] [Generator] Applying non-local block to (8, 64, 64, 192)
I0410 03:16:24.075476 139691431679872 resnet_biggan.py:150] [Block] (8, 64, 64, 192) (z=(8, 20), y=(8, 148)) -> (8, 128, 128, 96)
I0410 03:16:24.075653 139691431679872 resnet_biggan.py:294] [Generator] before final processing: (8, 128, 128, 96)
I0410 03:16:24.092004 139691431679872 resnet_biggan.py:300] [Generator] after final processing: (8, 128, 128, 3)
I0410 03:16:24.093985 139691431679872 s3gan.py:249] bs=8, rotated_bs=4, num_rot_examples=1
---------------------------------------------------s3gan.py/merge_with_rotation_data,s
---------------------------------------------------s3gan.py/merge_with_rotation_data,e
--------------------------------------------------------------------s3gan.py/discriminator_with_additonal_heads,s
I0410 03:16:24.119436 139691431679872 resnet_biggan.py:379] [Discriminator] inputs are x=(22, 128, 128, 3), y=(22, 2)
I0410 03:16:24.150173 139691431679872 resnet_biggan.py:150] [Block] (22, 128, 128, 3) (z=None, y=(22, 2)) -> (22, 64, 64, 96)
I0410 03:16:24.150326 139691431679872 resnet_biggan.py:398] [Discriminator] Applying non-local block to (22, 64, 64, 96)
I0410 03:16:24.219797 139691431679872 resnet_biggan.py:150] [Block] (22, 64, 64, 96) (z=None, y=(22, 2)) -> (22, 32, 32, 192)
I0410 03:16:24.249740 139691431679872 resnet_biggan.py:150] [Block] (22, 32, 32, 192) (z=None, y=(22, 2)) -> (22, 16, 16, 384)
I0410 03:16:24.279947 139691431679872 resnet_biggan.py:150] [Block] (22, 16, 16, 384) (z=None, y=(22, 2)) -> (22, 8, 8, 768)
I0410 03:16:24.309741 139691431679872 resnet_biggan.py:150] [Block] (22, 8, 8, 768) (z=None, y=(22, 2)) -> (22, 4, 4, 1536)
I0410 03:16:24.328675 139691431679872 resnet_biggan.py:150] [Block] (22, 4, 4, 1536) (z=None, y=(22, 2)) -> (22, 4, 4, 1536)
I0410 03:16:24.328842 139691431679872 resnet_biggan.py:403] [Discriminator] before final processing: (22, 4, 4, 1536)
I0410 03:16:24.338892 139691431679872 resnet_biggan.py:407] [Discriminator] after final processing: (22, 4, 4, 1536)
I0410 03:16:24.345622 139691431679872 resnet_biggan.py:422] [Discriminator] embedded_y for projection: (22, 1536)
I0410 03:16:24.357959 139691431679872 s3gan.py:133] [Discriminator] rotation head (22, 1536) -> Tensor("discriminator_rotation/score_classify/add:0", shape=(22, 4), dtype=float32)
I0410 03:16:24.370333 139691431679872 s3gan.py:154] [Discriminator] (22, 2) -> aux_logits=(22, 2), y_predicted=(22, 2)
---------------------------------------------------s3gan.py/get_class_embedding,s
I0410 03:16:24.376216 139691431679872 s3gan.py:175] [Discriminator] embedded_y for projection: (22, 1536)
---------------------------------------------------s3gan.py/get_class_embedding,e
---------------------------------------------------s3gan.py/discriminator_with_additonal_heads,e
---------------------------------------------------s3gan.py/create_loss,e
---------------------------------------------------modular_gan.py/create_logits,e
################################################## mode == tf.estimator.ModeKeys.EVAL  ########################
INFO:tensorflow:Done calling model_fn.
I0410 03:16:24.457210 139691431679872 estimator.py:1171] Done calling model_fn.
INFO:tensorflow:Starting evaluation at 2020-04-10T03:16:24Z
I0410 03:16:24.472149 139691431679872 evaluation.py:255] Starting evaluation at 2020-04-10T03:16:24Z
INFO:tensorflow:Graph was finalized.
I0410 03:16:24.619397 139691431679872 monitored_session.py:246] Graph was finalized.
2020-04-10 03:16:24.619931: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-04-10 03:16:24.620214: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:00:04.0 name: Tesla P4 computeCapability: 6.1
coreClock: 1.1135GHz coreCount: 20 deviceMemorySize: 7.43GiB deviceMemoryBandwidth: 178.99GiB/s
2020-04-10 03:16:24.620259: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.1
2020-04-10 03:16:24.620284: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10
2020-04-10 03:16:24.620304: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcufft.so.10
2020-04-10 03:16:24.620320: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcurand.so.10
2020-04-10 03:16:24.620334: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusolver.so.10
2020-04-10 03:16:24.620384: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusparse.so.10
2020-04-10 03:16:24.620399: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudnn.so.7
2020-04-10 03:16:24.620481: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-04-10 03:16:24.620745: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-04-10 03:16:24.620976: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1703] Adding visible gpu devices: 0
2020-04-10 03:16:24.621031: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-04-10 03:16:24.621046: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      0 
2020-04-10 03:16:24.621058: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1121] 0:   N 
2020-04-10 03:16:24.621189: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-04-10 03:16:24.621447: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-04-10 03:16:24.621660: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1247] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 6850 MB memory) -> physical GPU (device: 0, name: Tesla P4, pci bus id: 0000:00:04.0, compute capability: 6.1)
INFO:tensorflow:Restoring parameters from /tmp/absl_testing/429596/model.ckpt-2800
I0410 03:16:24.622411 139691431679872 saver.py:1293] Restoring parameters from /tmp/absl_testing/429596/model.ckpt-2800
INFO:tensorflow:Running local_init_op.
I0410 03:16:25.009909 139691431679872 session_manager.py:505] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
I0410 03:16:25.031793 139691431679872 session_manager.py:508] Done running local_init_op.
INFO:tensorflow:Evaluation [1/10]
I0410 03:16:28.052165 139691431679872 evaluation.py:167] Evaluation [1/10]
INFO:tensorflow:Evaluation [2/10]
I0410 03:16:30.352860 139691431679872 evaluation.py:167] Evaluation [2/10]
INFO:tensorflow:Evaluation [3/10]
I0410 03:16:31.551482 139691431679872 evaluation.py:167] Evaluation [3/10]
INFO:tensorflow:Evaluation [4/10]
I0410 03:16:33.037857 139691431679872 evaluation.py:167] Evaluation [4/10]
INFO:tensorflow:Evaluation [5/10]
I0410 03:16:34.557973 139691431679872 evaluation.py:167] Evaluation [5/10]
INFO:tensorflow:Evaluation [6/10]
I0410 03:16:35.987474 139691431679872 evaluation.py:167] Evaluation [6/10]
INFO:tensorflow:Evaluation [7/10]
I0410 03:16:38.385410 139691431679872 evaluation.py:167] Evaluation [7/10]
INFO:tensorflow:Evaluation [8/10]
I0410 03:16:39.367022 139691431679872 evaluation.py:167] Evaluation [8/10]
INFO:tensorflow:Evaluation [9/10]
I0410 03:16:40.616018 139691431679872 evaluation.py:167] Evaluation [9/10]
INFO:tensorflow:Evaluation [10/10]
I0410 03:16:42.790105 139691431679872 evaluation.py:167] Evaluation [10/10]
INFO:tensorflow:Inference Time : 18.44023s
I0410 03:16:42.912528 139691431679872 evaluation.py:273] Inference Time : 18.44023s
INFO:tensorflow:Finished evaluation at 2020-04-10-03:16:42
I0410 03:16:42.912728 139691431679872 evaluation.py:276] Finished evaluation at 2020-04-10-03:16:42
INFO:tensorflow:Saving dict for global step 2800: accuracy = 1.0, global_step = 2800, loss = 0.017477784
I0410 03:16:42.912883 139691431679872 estimator.py:2066] Saving dict for global step 2800: accuracy = 1.0, global_step = 2800, loss = 0.017477784
INFO:tensorflow:Saving 'checkpoint_path' summary for global step 2800: /tmp/absl_testing/429596/model.ckpt-2800
I0410 03:16:42.913354 139691431679872 estimator.py:2127] Saving 'checkpoint_path' summary for global step 2800: /tmp/absl_testing/429596/model.ckpt-2800
INFO:tensorflow:global_step/sec: 0.537975
I0410 03:16:44.372822 139691431679872 basic_session_run_hooks.py:702] global_step/sec: 0.537975
INFO:tensorflow:loss = 0.008180202, step = 2800 (185.882 sec)
I0410 03:16:44.373791 139691431679872 basic_session_run_hooks.py:260] loss = 0.008180202, step = 2800 (185.882 sec)
INFO:tensorflow:global_step/sec: 0.680913
I0410 03:19:11.234474 139691431679872 basic_session_run_hooks.py:702] global_step/sec: 0.680913
INFO:tensorflow:loss = 0.007080533, step = 2900 (146.862 sec)
I0410 03:19:11.235619 139691431679872 basic_session_run_hooks.py:260] loss = 0.007080533, step = 2900 (146.862 sec)
INFO:tensorflow:Calling checkpoint listeners before saving checkpoint 3000...
I0410 03:21:36.747951 139691431679872 basic_session_run_hooks.py:614] Calling checkpoint listeners before saving checkpoint 3000...
INFO:tensorflow:Saving checkpoints for 3000 into /tmp/absl_testing/429596/model.ckpt.
I0410 03:21:36.748271 139691431679872 basic_session_run_hooks.py:618] Saving checkpoints for 3000 into /tmp/absl_testing/429596/model.ckpt.
INFO:tensorflow:Calling checkpoint listeners after saving checkpoint 3000...
I0410 03:21:52.403563 139691431679872 basic_session_run_hooks.py:626] Calling checkpoint listeners after saving checkpoint 3000...
INFO:tensorflow:Skip the current checkpoint eval due to throttle secs (600 secs).
I0410 03:21:52.403840 139691431679872 training.py:528] Skip the current checkpoint eval due to throttle secs (600 secs).
INFO:tensorflow:global_step/sec: 0.614783
I0410 03:21:53.893510 139691431679872 basic_session_run_hooks.py:702] global_step/sec: 0.614783
INFO:tensorflow:loss = 0.2509484, step = 3000 (162.663 sec)
I0410 03:21:53.898346 139691431679872 basic_session_run_hooks.py:260] loss = 0.2509484, step = 3000 (162.663 sec)
INFO:tensorflow:global_step/sec: 0.68025
I0410 03:24:20.898330 139691431679872 basic_session_run_hooks.py:702] global_step/sec: 0.68025
INFO:tensorflow:loss = 1.2405994, step = 3100 (147.001 sec)
I0410 03:24:20.899196 139691431679872 basic_session_run_hooks.py:260] loss = 1.2405994, step = 3100 (147.001 sec)
INFO:tensorflow:Calling checkpoint listeners before saving checkpoint 3200...
I0410 03:26:46.617936 139691431679872 basic_session_run_hooks.py:614] Calling checkpoint listeners before saving checkpoint 3200...
INFO:tensorflow:Saving checkpoints for 3200 into /tmp/absl_testing/429596/model.ckpt.
I0410 03:26:46.618238 139691431679872 basic_session_run_hooks.py:618] Saving checkpoints for 3200 into /tmp/absl_testing/429596/model.ckpt.
INFO:tensorflow:Calling checkpoint listeners after saving checkpoint 3200...
I0410 03:27:04.140512 139691431679872 basic_session_run_hooks.py:626] Calling checkpoint listeners after saving checkpoint 3200...
--------------------------------------------datasets.py/eval_input_fn,s
W0410 03:27:06.387975 139691431679872 datasets.py:170] No TPUContext, using unmodified dataset seed 547.
I0410 03:27:06.388131 139691431679872 datasets.py:348] eval_input_fn(): params={'use_tpu': False, 'train_batch_size': 8, 'batch_size': 8} seed=547
--------befor self._load_dataset------------------split = validation self._eval_split= validation
--------------------------------------------datasets.py/_load_dataset,s
!!!!!!!!!!!!!!!!!!!!!!----load_local_datasets,  _local_test_ds_dir= /content/drive/My Drive/drive/gan/test
-----------------------------------------get_local_datasets,s
-----------------------------------------get_local_datasets,e
--------------------------------------------modular_gan.py/_preprocess_fn,s
I0410 03:27:06.484146 139691431679872 api.py:587] _preprocess_fn(): images=Tensor("args_0:0", shape=(128, 128, 3), dtype=float32), labels=Tensor("args_1:0", shape=(), dtype=int32), seed=547
--------------------------------------------modular_gan.py/_preprocess_fn,e
I0410 03:27:06.516933 139691431679872 api.py:587] Passing random offset: Tensor("Cast:0", shape=(), dtype=int32) with data ({'images': <tf.Tensor 'args_1:0' shape=(128, 128, 3) dtype=float32>, 'z': <tf.Tensor 'args_3:0' shape=(120,) dtype=float32>, 'sampled_labels': <tf.Tensor 'args_2:0' shape=() dtype=int32>}, <tf.Tensor 'args_4:0' shape=() dtype=int32>).
--------------------------------------------datasets.py/eval_input_fn,e
INFO:tensorflow:Calling model_fn.
I0410 03:27:06.535450 139691431679872 estimator.py:1169] Calling model_fn.
--------------------------------------------modular_gan.py/model_fn,s
I0410 03:27:06.535635 139691431679872 modular_gan.py:589] model_fn(): features={'images': <tf.Tensor 'IteratorGetNext:1' shape=(8, 128, 128, 3) dtype=float32>, 'z': <tf.Tensor 'IteratorGetNext:3' shape=(8, 120) dtype=float32>, 'sampled_labels': <tf.Tensor 'IteratorGetNext:2' shape=(8,) dtype=int32>, '_RANDOM_OFFSET': <tf.Tensor 'IteratorGetNext:0' shape=(8,) dtype=int32>}, labels=Tensor("IteratorGetNext:4", shape=(8,), dtype=int32),mode=eval, params={'use_tpu': False, 'train_batch_size': 8, 'batch_size': 8}
#Clean old summaries from previous calls to model_fn().
# Get features and labels for each sub-step.
--------------------------------------------modular_gan.py/_split_inputs_and_generate_samples,s
I0410 03:27:06.543264 139691431679872 resnet_biggan.py:236] [Generator] inputs are z=(8, 120), y=(8, 2)
I0410 03:27:06.554733 139691431679872 resnet_biggan.py:262] [Generator] z0=(8, 20), z_per_block=['(8, 20)', '(8, 20)', '(8, 20)', '(8, 20)', '(8, 20)'], y_per_block=['(8, 148)', '(8, 148)', '(8, 148)', '(8, 148)', '(8, 148)']
I0410 03:27:06.611173 139691431679872 resnet_biggan.py:150] [Block] (8, 4, 4, 1536) (z=(8, 20), y=(8, 148)) -> (8, 8, 8, 1536)
I0410 03:27:06.661168 139691431679872 resnet_biggan.py:150] [Block] (8, 8, 8, 1536) (z=(8, 20), y=(8, 148)) -> (8, 16, 16, 768)
I0410 03:27:06.706855 139691431679872 resnet_biggan.py:150] [Block] (8, 16, 16, 768) (z=(8, 20), y=(8, 148)) -> (8, 32, 32, 384)
I0410 03:27:06.747854 139691431679872 resnet_biggan.py:150] [Block] (8, 32, 32, 384) (z=(8, 20), y=(8, 148)) -> (8, 64, 64, 192)
I0410 03:27:06.748030 139691431679872 resnet_biggan.py:289] [Generator] Applying non-local block to (8, 64, 64, 192)
I0410 03:27:06.830453 139691431679872 resnet_biggan.py:150] [Block] (8, 64, 64, 192) (z=(8, 20), y=(8, 148)) -> (8, 128, 128, 96)
I0410 03:27:06.830662 139691431679872 resnet_biggan.py:294] [Generator] before final processing: (8, 128, 128, 96)
I0410 03:27:06.867438 139691431679872 resnet_biggan.py:300] [Generator] after final processing: (8, 128, 128, 3)
--------------------------------------------modular_gan.py/_split_inputs_and_generate_samples,e
---------------------------------------------------modular_gan.py/create_logits,s
I0410 03:27:06.873108 139691431679872 tpu_random.py:86] Got global random offset: Tensor("strided_slice:0", shape=(), dtype=int32)
---------------------------------------------------s3gan.py/create_loss,s
W0410 03:27:06.877414 139691431679872 s3gan.py:237] Computing fake images for every sub step separately.
I0410 03:27:06.877724 139691431679872 resnet_biggan.py:236] [Generator] inputs are z=(8, 120), y=(8, 2)
I0410 03:27:06.885403 139691431679872 resnet_biggan.py:262] [Generator] z0=(8, 20), z_per_block=['(8, 20)', '(8, 20)', '(8, 20)', '(8, 20)', '(8, 20)'], y_per_block=['(8, 148)', '(8, 148)', '(8, 148)', '(8, 148)', '(8, 148)']
I0410 03:27:06.907089 139691431679872 resnet_biggan.py:150] [Block] (8, 4, 4, 1536) (z=(8, 20), y=(8, 148)) -> (8, 8, 8, 1536)
I0410 03:27:06.924209 139691431679872 resnet_biggan.py:150] [Block] (8, 8, 8, 1536) (z=(8, 20), y=(8, 148)) -> (8, 16, 16, 768)
I0410 03:27:06.942205 139691431679872 resnet_biggan.py:150] [Block] (8, 16, 16, 768) (z=(8, 20), y=(8, 148)) -> (8, 32, 32, 384)
I0410 03:27:06.959876 139691431679872 resnet_biggan.py:150] [Block] (8, 32, 32, 384) (z=(8, 20), y=(8, 148)) -> (8, 64, 64, 192)
I0410 03:27:06.960035 139691431679872 resnet_biggan.py:289] [Generator] Applying non-local block to (8, 64, 64, 192)
I0410 03:27:06.995456 139691431679872 resnet_biggan.py:150] [Block] (8, 64, 64, 192) (z=(8, 20), y=(8, 148)) -> (8, 128, 128, 96)
I0410 03:27:06.995628 139691431679872 resnet_biggan.py:294] [Generator] before final processing: (8, 128, 128, 96)
I0410 03:27:07.010748 139691431679872 resnet_biggan.py:300] [Generator] after final processing: (8, 128, 128, 3)
I0410 03:27:07.012614 139691431679872 s3gan.py:249] bs=8, rotated_bs=4, num_rot_examples=1
---------------------------------------------------s3gan.py/merge_with_rotation_data,s
---------------------------------------------------s3gan.py/merge_with_rotation_data,e
--------------------------------------------------------------------s3gan.py/discriminator_with_additonal_heads,s
I0410 03:27:07.039769 139691431679872 resnet_biggan.py:379] [Discriminator] inputs are x=(22, 128, 128, 3), y=(22, 2)
I0410 03:27:07.076746 139691431679872 resnet_biggan.py:150] [Block] (22, 128, 128, 3) (z=None, y=(22, 2)) -> (22, 64, 64, 96)
I0410 03:27:07.076953 139691431679872 resnet_biggan.py:398] [Discriminator] Applying non-local block to (22, 64, 64, 96)
I0410 03:27:07.156407 139691431679872 resnet_biggan.py:150] [Block] (22, 64, 64, 96) (z=None, y=(22, 2)) -> (22, 32, 32, 192)
I0410 03:27:07.191182 139691431679872 resnet_biggan.py:150] [Block] (22, 32, 32, 192) (z=None, y=(22, 2)) -> (22, 16, 16, 384)
I0410 03:27:07.227029 139691431679872 resnet_biggan.py:150] [Block] (22, 16, 16, 384) (z=None, y=(22, 2)) -> (22, 8, 8, 768)
I0410 03:27:07.263221 139691431679872 resnet_biggan.py:150] [Block] (22, 8, 8, 768) (z=None, y=(22, 2)) -> (22, 4, 4, 1536)
I0410 03:27:07.284411 139691431679872 resnet_biggan.py:150] [Block] (22, 4, 4, 1536) (z=None, y=(22, 2)) -> (22, 4, 4, 1536)
I0410 03:27:07.284617 139691431679872 resnet_biggan.py:403] [Discriminator] before final processing: (22, 4, 4, 1536)
I0410 03:27:07.295651 139691431679872 resnet_biggan.py:407] [Discriminator] after final processing: (22, 4, 4, 1536)
I0410 03:27:07.302038 139691431679872 resnet_biggan.py:422] [Discriminator] embedded_y for projection: (22, 1536)
I0410 03:27:07.315233 139691431679872 s3gan.py:133] [Discriminator] rotation head (22, 1536) -> Tensor("discriminator_rotation/score_classify/add:0", shape=(22, 4), dtype=float32)
I0410 03:27:07.328843 139691431679872 s3gan.py:154] [Discriminator] (22, 2) -> aux_logits=(22, 2), y_predicted=(22, 2)
---------------------------------------------------s3gan.py/get_class_embedding,s
I0410 03:27:07.335431 139691431679872 s3gan.py:175] [Discriminator] embedded_y for projection: (22, 1536)
---------------------------------------------------s3gan.py/get_class_embedding,e
---------------------------------------------------s3gan.py/discriminator_with_additonal_heads,e
---------------------------------------------------s3gan.py/create_loss,e
---------------------------------------------------modular_gan.py/create_logits,e
################################################## mode == tf.estimator.ModeKeys.EVAL  ########################
INFO:tensorflow:Done calling model_fn.
I0410 03:27:07.431407 139691431679872 estimator.py:1171] Done calling model_fn.
INFO:tensorflow:Starting evaluation at 2020-04-10T03:27:07Z
I0410 03:27:07.449044 139691431679872 evaluation.py:255] Starting evaluation at 2020-04-10T03:27:07Z
INFO:tensorflow:Graph was finalized.
I0410 03:27:07.604108 139691431679872 monitored_session.py:246] Graph was finalized.
2020-04-10 03:27:07.604867: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-04-10 03:27:07.605211: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:00:04.0 name: Tesla P4 computeCapability: 6.1
coreClock: 1.1135GHz coreCount: 20 deviceMemorySize: 7.43GiB deviceMemoryBandwidth: 178.99GiB/s
2020-04-10 03:27:07.605261: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.1
2020-04-10 03:27:07.605285: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10
2020-04-10 03:27:07.605305: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcufft.so.10
2020-04-10 03:27:07.605325: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcurand.so.10
2020-04-10 03:27:07.605342: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusolver.so.10
2020-04-10 03:27:07.605389: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusparse.so.10
2020-04-10 03:27:07.605406: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudnn.so.7
2020-04-10 03:27:07.605495: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-04-10 03:27:07.605795: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-04-10 03:27:07.606069: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1703] Adding visible gpu devices: 0
2020-04-10 03:27:07.606113: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-04-10 03:27:07.606128: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      0 
2020-04-10 03:27:07.606158: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1121] 0:   N 
2020-04-10 03:27:07.606263: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-04-10 03:27:07.606553: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-04-10 03:27:07.606793: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1247] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 6850 MB memory) -> physical GPU (device: 0, name: Tesla P4, pci bus id: 0000:00:04.0, compute capability: 6.1)
INFO:tensorflow:Restoring parameters from /tmp/absl_testing/429596/model.ckpt-3200
I0410 03:27:07.607676 139691431679872 saver.py:1293] Restoring parameters from /tmp/absl_testing/429596/model.ckpt-3200
INFO:tensorflow:Running local_init_op.
I0410 03:27:08.036337 139691431679872 session_manager.py:505] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
I0410 03:27:08.063738 139691431679872 session_manager.py:508] Done running local_init_op.
INFO:tensorflow:Evaluation [1/10]
I0410 03:27:11.260606 139691431679872 evaluation.py:167] Evaluation [1/10]
INFO:tensorflow:Evaluation [2/10]
I0410 03:27:13.789906 139691431679872 evaluation.py:167] Evaluation [2/10]
INFO:tensorflow:Evaluation [3/10]
I0410 03:27:15.961596 139691431679872 evaluation.py:167] Evaluation [3/10]
INFO:tensorflow:Evaluation [4/10]
I0410 03:27:17.899823 139691431679872 evaluation.py:167] Evaluation [4/10]
INFO:tensorflow:Evaluation [5/10]
I0410 03:27:19.308936 139691431679872 evaluation.py:167] Evaluation [5/10]
INFO:tensorflow:Evaluation [6/10]
I0410 03:27:21.487109 139691431679872 evaluation.py:167] Evaluation [6/10]
INFO:tensorflow:Evaluation [7/10]
I0410 03:27:22.937973 139691431679872 evaluation.py:167] Evaluation [7/10]
INFO:tensorflow:Evaluation [8/10]
I0410 03:27:25.050904 139691431679872 evaluation.py:167] Evaluation [8/10]
INFO:tensorflow:Evaluation [9/10]
I0410 03:27:26.817645 139691431679872 evaluation.py:167] Evaluation [9/10]
INFO:tensorflow:Evaluation [10/10]
I0410 03:27:29.010411 139691431679872 evaluation.py:167] Evaluation [10/10]
INFO:tensorflow:Inference Time : 21.83303s
I0410 03:27:29.282251 139691431679872 evaluation.py:273] Inference Time : 21.83303s
INFO:tensorflow:Finished evaluation at 2020-04-10-03:27:29
I0410 03:27:29.282450 139691431679872 evaluation.py:276] Finished evaluation at 2020-04-10-03:27:29
INFO:tensorflow:Saving dict for global step 3200: accuracy = 1.0, global_step = 3200, loss = 0.045618307
I0410 03:27:29.282590 139691431679872 estimator.py:2066] Saving dict for global step 3200: accuracy = 1.0, global_step = 3200, loss = 0.045618307
INFO:tensorflow:Saving 'checkpoint_path' summary for global step 3200: /tmp/absl_testing/429596/model.ckpt-3200
I0410 03:27:29.283103 139691431679872 estimator.py:2127] Saving 'checkpoint_path' summary for global step 3200: /tmp/absl_testing/429596/model.ckpt-3200
INFO:tensorflow:global_step/sec: 0.526719
I0410 03:27:30.752965 139691431679872 basic_session_run_hooks.py:702] global_step/sec: 0.526719
INFO:tensorflow:loss = 0.016653575, step = 3200 (189.855 sec)
I0410 03:27:30.753968 139691431679872 basic_session_run_hooks.py:260] loss = 0.016653575, step = 3200 (189.855 sec)
INFO:tensorflow:global_step/sec: 0.681418
I0410 03:29:57.505705 139691431679872 basic_session_run_hooks.py:702] global_step/sec: 0.681418
INFO:tensorflow:loss = 0.21769719, step = 3300 (146.753 sec)
I0410 03:29:57.506772 139691431679872 basic_session_run_hooks.py:260] loss = 0.21769719, step = 3300 (146.753 sec)
INFO:tensorflow:Calling checkpoint listeners before saving checkpoint 3400...
I0410 03:32:23.160796 139691431679872 basic_session_run_hooks.py:614] Calling checkpoint listeners before saving checkpoint 3400...
INFO:tensorflow:Saving checkpoints for 3400 into /tmp/absl_testing/429596/model.ckpt.
I0410 03:32:23.161126 139691431679872 basic_session_run_hooks.py:618] Saving checkpoints for 3400 into /tmp/absl_testing/429596/model.ckpt.
INFO:tensorflow:Calling checkpoint listeners after saving checkpoint 3400...
I0410 03:32:39.145333 139691431679872 basic_session_run_hooks.py:626] Calling checkpoint listeners after saving checkpoint 3400...
INFO:tensorflow:Skip the current checkpoint eval due to throttle secs (600 secs).
I0410 03:32:39.145834 139691431679872 training.py:528] Skip the current checkpoint eval due to throttle secs (600 secs).
INFO:tensorflow:global_step/sec: 0.612955
I0410 03:32:40.649771 139691431679872 basic_session_run_hooks.py:702] global_step/sec: 0.612955
INFO:tensorflow:loss = 0.006099468, step = 3400 (163.144 sec)
I0410 03:32:40.650875 139691431679872 basic_session_run_hooks.py:260] loss = 0.006099468, step = 3400 (163.144 sec)
INFO:tensorflow:global_step/sec: 0.67962
I0410 03:35:07.790822 139691431679872 basic_session_run_hooks.py:702] global_step/sec: 0.67962
INFO:tensorflow:loss = 0.0023415391, step = 3500 (147.141 sec)
I0410 03:35:07.791905 139691431679872 basic_session_run_hooks.py:260] loss = 0.0023415391, step = 3500 (147.141 sec)
INFO:tensorflow:Calling checkpoint listeners before saving checkpoint 3600...
I0410 03:37:33.461705 139691431679872 basic_session_run_hooks.py:614] Calling checkpoint listeners before saving checkpoint 3600...
INFO:tensorflow:Saving checkpoints for 3600 into /tmp/absl_testing/429596/model.ckpt.
I0410 03:37:33.461966 139691431679872 basic_session_run_hooks.py:618] Saving checkpoints for 3600 into /tmp/absl_testing/429596/model.ckpt.
INFO:tensorflow:Calling checkpoint listeners after saving checkpoint 3600...
I0410 03:37:50.686886 139691431679872 basic_session_run_hooks.py:626] Calling checkpoint listeners after saving checkpoint 3600...
--------------------------------------------datasets.py/eval_input_fn,s
W0410 03:37:53.156594 139691431679872 datasets.py:170] No TPUContext, using unmodified dataset seed 547.
I0410 03:37:53.156787 139691431679872 datasets.py:348] eval_input_fn(): params={'use_tpu': False, 'train_batch_size': 8, 'batch_size': 8} seed=547
--------befor self._load_dataset------------------split = validation self._eval_split= validation
--------------------------------------------datasets.py/_load_dataset,s
!!!!!!!!!!!!!!!!!!!!!!----load_local_datasets,  _local_test_ds_dir= /content/drive/My Drive/drive/gan/test
-----------------------------------------get_local_datasets,s
-----------------------------------------get_local_datasets,e
--------------------------------------------modular_gan.py/_preprocess_fn,s
I0410 03:37:53.249331 139691431679872 api.py:587] _preprocess_fn(): images=Tensor("args_0:0", shape=(128, 128, 3), dtype=float32), labels=Tensor("args_1:0", shape=(), dtype=int32), seed=547
--------------------------------------------modular_gan.py/_preprocess_fn,e
I0410 03:37:53.282423 139691431679872 api.py:587] Passing random offset: Tensor("Cast:0", shape=(), dtype=int32) with data ({'images': <tf.Tensor 'args_1:0' shape=(128, 128, 3) dtype=float32>, 'z': <tf.Tensor 'args_3:0' shape=(120,) dtype=float32>, 'sampled_labels': <tf.Tensor 'args_2:0' shape=() dtype=int32>}, <tf.Tensor 'args_4:0' shape=() dtype=int32>).
--------------------------------------------datasets.py/eval_input_fn,e
INFO:tensorflow:Calling model_fn.
I0410 03:37:53.300193 139691431679872 estimator.py:1169] Calling model_fn.
--------------------------------------------modular_gan.py/model_fn,s
I0410 03:37:53.300374 139691431679872 modular_gan.py:589] model_fn(): features={'images': <tf.Tensor 'IteratorGetNext:1' shape=(8, 128, 128, 3) dtype=float32>, 'z': <tf.Tensor 'IteratorGetNext:3' shape=(8, 120) dtype=float32>, 'sampled_labels': <tf.Tensor 'IteratorGetNext:2' shape=(8,) dtype=int32>, '_RANDOM_OFFSET': <tf.Tensor 'IteratorGetNext:0' shape=(8,) dtype=int32>}, labels=Tensor("IteratorGetNext:4", shape=(8,), dtype=int32),mode=eval, params={'use_tpu': False, 'train_batch_size': 8, 'batch_size': 8}
#Clean old summaries from previous calls to model_fn().
# Get features and labels for each sub-step.
--------------------------------------------modular_gan.py/_split_inputs_and_generate_samples,s
I0410 03:37:53.307714 139691431679872 resnet_biggan.py:236] [Generator] inputs are z=(8, 120), y=(8, 2)
I0410 03:37:53.318927 139691431679872 resnet_biggan.py:262] [Generator] z0=(8, 20), z_per_block=['(8, 20)', '(8, 20)', '(8, 20)', '(8, 20)', '(8, 20)'], y_per_block=['(8, 148)', '(8, 148)', '(8, 148)', '(8, 148)', '(8, 148)']
I0410 03:37:53.369744 139691431679872 resnet_biggan.py:150] [Block] (8, 4, 4, 1536) (z=(8, 20), y=(8, 148)) -> (8, 8, 8, 1536)
I0410 03:37:53.407950 139691431679872 resnet_biggan.py:150] [Block] (8, 8, 8, 1536) (z=(8, 20), y=(8, 148)) -> (8, 16, 16, 768)
I0410 03:37:53.454210 139691431679872 resnet_biggan.py:150] [Block] (8, 16, 16, 768) (z=(8, 20), y=(8, 148)) -> (8, 32, 32, 384)
I0410 03:37:53.498310 139691431679872 resnet_biggan.py:150] [Block] (8, 32, 32, 384) (z=(8, 20), y=(8, 148)) -> (8, 64, 64, 192)
I0410 03:37:53.498453 139691431679872 resnet_biggan.py:289] [Generator] Applying non-local block to (8, 64, 64, 192)
I0410 03:37:53.581416 139691431679872 resnet_biggan.py:150] [Block] (8, 64, 64, 192) (z=(8, 20), y=(8, 148)) -> (8, 128, 128, 96)
I0410 03:37:53.581676 139691431679872 resnet_biggan.py:294] [Generator] before final processing: (8, 128, 128, 96)
I0410 03:37:53.614572 139691431679872 resnet_biggan.py:300] [Generator] after final processing: (8, 128, 128, 3)
--------------------------------------------modular_gan.py/_split_inputs_and_generate_samples,e
---------------------------------------------------modular_gan.py/create_logits,s
I0410 03:37:53.620545 139691431679872 tpu_random.py:86] Got global random offset: Tensor("strided_slice:0", shape=(), dtype=int32)
---------------------------------------------------s3gan.py/create_loss,s
W0410 03:37:53.623466 139691431679872 s3gan.py:237] Computing fake images for every sub step separately.
I0410 03:37:53.623685 139691431679872 resnet_biggan.py:236] [Generator] inputs are z=(8, 120), y=(8, 2)
I0410 03:37:53.629291 139691431679872 resnet_biggan.py:262] [Generator] z0=(8, 20), z_per_block=['(8, 20)', '(8, 20)', '(8, 20)', '(8, 20)', '(8, 20)'], y_per_block=['(8, 148)', '(8, 148)', '(8, 148)', '(8, 148)', '(8, 148)']
I0410 03:37:53.649939 139691431679872 resnet_biggan.py:150] [Block] (8, 4, 4, 1536) (z=(8, 20), y=(8, 148)) -> (8, 8, 8, 1536)
I0410 03:37:53.666854 139691431679872 resnet_biggan.py:150] [Block] (8, 8, 8, 1536) (z=(8, 20), y=(8, 148)) -> (8, 16, 16, 768)
I0410 03:37:53.689013 139691431679872 resnet_biggan.py:150] [Block] (8, 16, 16, 768) (z=(8, 20), y=(8, 148)) -> (8, 32, 32, 384)
I0410 03:37:53.707096 139691431679872 resnet_biggan.py:150] [Block] (8, 32, 32, 384) (z=(8, 20), y=(8, 148)) -> (8, 64, 64, 192)
I0410 03:37:53.707252 139691431679872 resnet_biggan.py:289] [Generator] Applying non-local block to (8, 64, 64, 192)
I0410 03:37:53.743864 139691431679872 resnet_biggan.py:150] [Block] (8, 64, 64, 192) (z=(8, 20), y=(8, 148)) -> (8, 128, 128, 96)
I0410 03:37:53.744024 139691431679872 resnet_biggan.py:294] [Generator] before final processing: (8, 128, 128, 96)
I0410 03:37:53.759367 139691431679872 resnet_biggan.py:300] [Generator] after final processing: (8, 128, 128, 3)
I0410 03:37:53.761126 139691431679872 s3gan.py:249] bs=8, rotated_bs=4, num_rot_examples=1
---------------------------------------------------s3gan.py/merge_with_rotation_data,s
---------------------------------------------------s3gan.py/merge_with_rotation_data,e
--------------------------------------------------------------------s3gan.py/discriminator_with_additonal_heads,s
I0410 03:37:53.787670 139691431679872 resnet_biggan.py:379] [Discriminator] inputs are x=(22, 128, 128, 3), y=(22, 2)
I0410 03:37:53.821858 139691431679872 resnet_biggan.py:150] [Block] (22, 128, 128, 3) (z=None, y=(22, 2)) -> (22, 64, 64, 96)
I0410 03:37:53.822045 139691431679872 resnet_biggan.py:398] [Discriminator] Applying non-local block to (22, 64, 64, 96)
I0410 03:37:53.896514 139691431679872 resnet_biggan.py:150] [Block] (22, 64, 64, 96) (z=None, y=(22, 2)) -> (22, 32, 32, 192)
I0410 03:37:53.931695 139691431679872 resnet_biggan.py:150] [Block] (22, 32, 32, 192) (z=None, y=(22, 2)) -> (22, 16, 16, 384)
I0410 03:37:53.970575 139691431679872 resnet_biggan.py:150] [Block] (22, 16, 16, 384) (z=None, y=(22, 2)) -> (22, 8, 8, 768)
I0410 03:37:54.002820 139691431679872 resnet_biggan.py:150] [Block] (22, 8, 8, 768) (z=None, y=(22, 2)) -> (22, 4, 4, 1536)
I0410 03:37:54.023468 139691431679872 resnet_biggan.py:150] [Block] (22, 4, 4, 1536) (z=None, y=(22, 2)) -> (22, 4, 4, 1536)
I0410 03:37:54.023648 139691431679872 resnet_biggan.py:403] [Discriminator] before final processing: (22, 4, 4, 1536)
I0410 03:37:54.034152 139691431679872 resnet_biggan.py:407] [Discriminator] after final processing: (22, 4, 4, 1536)
I0410 03:37:54.040123 139691431679872 resnet_biggan.py:422] [Discriminator] embedded_y for projection: (22, 1536)
I0410 03:37:54.054342 139691431679872 s3gan.py:133] [Discriminator] rotation head (22, 1536) -> Tensor("discriminator_rotation/score_classify/add:0", shape=(22, 4), dtype=float32)
I0410 03:37:54.068135 139691431679872 s3gan.py:154] [Discriminator] (22, 2) -> aux_logits=(22, 2), y_predicted=(22, 2)
---------------------------------------------------s3gan.py/get_class_embedding,s
I0410 03:37:54.074657 139691431679872 s3gan.py:175] [Discriminator] embedded_y for projection: (22, 1536)
---------------------------------------------------s3gan.py/get_class_embedding,e
---------------------------------------------------s3gan.py/discriminator_with_additonal_heads,e
---------------------------------------------------s3gan.py/create_loss,e
---------------------------------------------------modular_gan.py/create_logits,e
################################################## mode == tf.estimator.ModeKeys.EVAL  ########################
INFO:tensorflow:Done calling model_fn.
I0410 03:37:54.165102 139691431679872 estimator.py:1171] Done calling model_fn.
INFO:tensorflow:Starting evaluation at 2020-04-10T03:37:54Z
I0410 03:37:54.181830 139691431679872 evaluation.py:255] Starting evaluation at 2020-04-10T03:37:54Z
INFO:tensorflow:Graph was finalized.
I0410 03:37:54.336256 139691431679872 monitored_session.py:246] Graph was finalized.
2020-04-10 03:37:54.336992: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-04-10 03:37:54.337436: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:00:04.0 name: Tesla P4 computeCapability: 6.1
coreClock: 1.1135GHz coreCount: 20 deviceMemorySize: 7.43GiB deviceMemoryBandwidth: 178.99GiB/s
2020-04-10 03:37:54.337513: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.1
2020-04-10 03:37:54.337542: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10
2020-04-10 03:37:54.337564: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcufft.so.10
2020-04-10 03:37:54.337579: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcurand.so.10
2020-04-10 03:37:54.337595: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusolver.so.10
2020-04-10 03:37:54.337641: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusparse.so.10
2020-04-10 03:37:54.337658: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudnn.so.7
2020-04-10 03:37:54.337755: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-04-10 03:37:54.338078: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-04-10 03:37:54.338307: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1703] Adding visible gpu devices: 0
2020-04-10 03:37:54.338352: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-04-10 03:37:54.338366: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      0 
2020-04-10 03:37:54.338376: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1121] 0:   N 
2020-04-10 03:37:54.338517: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-04-10 03:37:54.338826: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-04-10 03:37:54.339066: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1247] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 6850 MB memory) -> physical GPU (device: 0, name: Tesla P4, pci bus id: 0000:00:04.0, compute capability: 6.1)
INFO:tensorflow:Restoring parameters from /tmp/absl_testing/429596/model.ckpt-3600
I0410 03:37:54.340176 139691431679872 saver.py:1293] Restoring parameters from /tmp/absl_testing/429596/model.ckpt-3600
INFO:tensorflow:Running local_init_op.
I0410 03:37:54.764180 139691431679872 session_manager.py:505] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
I0410 03:37:54.787118 139691431679872 session_manager.py:508] Done running local_init_op.
INFO:tensorflow:Evaluation [1/10]
I0410 03:37:57.523663 139691431679872 evaluation.py:167] Evaluation [1/10]
INFO:tensorflow:Evaluation [2/10]
I0410 03:37:59.386567 139691431679872 evaluation.py:167] Evaluation [2/10]
INFO:tensorflow:Evaluation [3/10]
I0410 03:38:01.167604 139691431679872 evaluation.py:167] Evaluation [3/10]
INFO:tensorflow:Evaluation [4/10]
I0410 03:38:02.570513 139691431679872 evaluation.py:167] Evaluation [4/10]
INFO:tensorflow:Evaluation [5/10]
I0410 03:38:04.844129 139691431679872 evaluation.py:167] Evaluation [5/10]
INFO:tensorflow:Evaluation [6/10]
I0410 03:38:07.029848 139691431679872 evaluation.py:167] Evaluation [6/10]
INFO:tensorflow:Evaluation [7/10]
I0410 03:38:07.962400 139691431679872 evaluation.py:167] Evaluation [7/10]
INFO:tensorflow:Evaluation [8/10]
I0410 03:38:09.248410 139691431679872 evaluation.py:167] Evaluation [8/10]
INFO:tensorflow:Evaluation [9/10]
I0410 03:38:11.418038 139691431679872 evaluation.py:167] Evaluation [9/10]
INFO:tensorflow:Evaluation [10/10]
I0410 03:38:13.035030 139691431679872 evaluation.py:167] Evaluation [10/10]
INFO:tensorflow:Inference Time : 19.26889s
I0410 03:38:13.450901 139691431679872 evaluation.py:273] Inference Time : 19.26889s
INFO:tensorflow:Finished evaluation at 2020-04-10-03:38:13
I0410 03:38:13.451119 139691431679872 evaluation.py:276] Finished evaluation at 2020-04-10-03:38:13
INFO:tensorflow:Saving dict for global step 3600: accuracy = 1.0, global_step = 3600, loss = 0.0021350097
I0410 03:38:13.451276 139691431679872 estimator.py:2066] Saving dict for global step 3600: accuracy = 1.0, global_step = 3600, loss = 0.0021350097
INFO:tensorflow:Saving 'checkpoint_path' summary for global step 3600: /tmp/absl_testing/429596/model.ckpt-3600
I0410 03:38:13.451760 139691431679872 estimator.py:2127] Saving 'checkpoint_path' summary for global step 3600: /tmp/absl_testing/429596/model.ckpt-3600
INFO:tensorflow:global_step/sec: 0.534407
I0410 03:38:14.914286 139691431679872 basic_session_run_hooks.py:702] global_step/sec: 0.534407
INFO:tensorflow:loss = 0.0014090734, step = 3600 (187.123 sec)
I0410 03:38:14.915269 139691431679872 basic_session_run_hooks.py:260] loss = 0.0014090734, step = 3600 (187.123 sec)
INFO:tensorflow:global_step/sec: 0.680466
I0410 03:40:41.872411 139691431679872 basic_session_run_hooks.py:702] global_step/sec: 0.680466
INFO:tensorflow:loss = 1.3581549, step = 3700 (146.958 sec)
I0410 03:40:41.873597 139691431679872 basic_session_run_hooks.py:260] loss = 1.3581549, step = 3700 (146.958 sec)
INFO:tensorflow:Calling checkpoint listeners before saving checkpoint 3800...
I0410 03:43:07.376091 139691431679872 basic_session_run_hooks.py:614] Calling checkpoint listeners before saving checkpoint 3800...
INFO:tensorflow:Saving checkpoints for 3800 into /tmp/absl_testing/429596/model.ckpt.
I0410 03:43:07.376324 139691431679872 basic_session_run_hooks.py:618] Saving checkpoints for 3800 into /tmp/absl_testing/429596/model.ckpt.
INFO:tensorflow:Calling checkpoint listeners after saving checkpoint 3800...
I0410 03:43:27.367931 139691431679872 basic_session_run_hooks.py:626] Calling checkpoint listeners after saving checkpoint 3800...
INFO:tensorflow:Skip the current checkpoint eval due to throttle secs (600 secs).
I0410 03:43:27.368218 139691431679872 training.py:528] Skip the current checkpoint eval due to throttle secs (600 secs).
INFO:tensorflow:global_step/sec: 0.598838
I0410 03:43:28.862425 139691431679872 basic_session_run_hooks.py:702] global_step/sec: 0.598838
INFO:tensorflow:loss = 0.570755, step = 3800 (166.990 sec)
I0410 03:43:28.863327 139691431679872 basic_session_run_hooks.py:260] loss = 0.570755, step = 3800 (166.990 sec)
INFO:tensorflow:global_step/sec: 0.680656
I0410 03:45:55.779618 139691431679872 basic_session_run_hooks.py:702] global_step/sec: 0.680656
INFO:tensorflow:loss = 0.09288548, step = 3900 (146.917 sec)
I0410 03:45:55.780640 139691431679872 basic_session_run_hooks.py:260] loss = 0.09288548, step = 3900 (146.917 sec)
INFO:tensorflow:Calling checkpoint listeners before saving checkpoint 4000...
I0410 03:48:21.479238 139691431679872 basic_session_run_hooks.py:614] Calling checkpoint listeners before saving checkpoint 4000...
INFO:tensorflow:Saving checkpoints for 4000 into /tmp/absl_testing/429596/model.ckpt.
I0410 03:48:21.479548 139691431679872 basic_session_run_hooks.py:618] Saving checkpoints for 4000 into /tmp/absl_testing/429596/model.ckpt.
INFO:tensorflow:Calling checkpoint listeners after saving checkpoint 4000...
I0410 03:48:38.101212 139691431679872 basic_session_run_hooks.py:626] Calling checkpoint listeners after saving checkpoint 4000...
--------------------------------------------datasets.py/eval_input_fn,s
W0410 03:48:38.444688 139691431679872 datasets.py:170] No TPUContext, using unmodified dataset seed 547.
I0410 03:48:38.445701 139691431679872 datasets.py:348] eval_input_fn(): params={'use_tpu': False, 'train_batch_size': 8, 'batch_size': 8} seed=547
--------befor self._load_dataset------------------split = validation self._eval_split= validation
--------------------------------------------datasets.py/_load_dataset,s
!!!!!!!!!!!!!!!!!!!!!!----load_local_datasets,  _local_test_ds_dir= /content/drive/My Drive/drive/gan/test
-----------------------------------------get_local_datasets,s
-----------------------------------------get_local_datasets,e
--------------------------------------------modular_gan.py/_preprocess_fn,s
I0410 03:48:38.546316 139691431679872 api.py:587] _preprocess_fn(): images=Tensor("args_0:0", shape=(128, 128, 3), dtype=float32), labels=Tensor("args_1:0", shape=(), dtype=int32), seed=547
--------------------------------------------modular_gan.py/_preprocess_fn,e
I0410 03:48:38.579087 139691431679872 api.py:587] Passing random offset: Tensor("Cast:0", shape=(), dtype=int32) with data ({'images': <tf.Tensor 'args_1:0' shape=(128, 128, 3) dtype=float32>, 'z': <tf.Tensor 'args_3:0' shape=(120,) dtype=float32>, 'sampled_labels': <tf.Tensor 'args_2:0' shape=() dtype=int32>}, <tf.Tensor 'args_4:0' shape=() dtype=int32>).
--------------------------------------------datasets.py/eval_input_fn,e
INFO:tensorflow:Calling model_fn.
I0410 03:48:38.597133 139691431679872 estimator.py:1169] Calling model_fn.
--------------------------------------------modular_gan.py/model_fn,s
I0410 03:48:38.597321 139691431679872 modular_gan.py:589] model_fn(): features={'images': <tf.Tensor 'IteratorGetNext:1' shape=(8, 128, 128, 3) dtype=float32>, 'z': <tf.Tensor 'IteratorGetNext:3' shape=(8, 120) dtype=float32>, 'sampled_labels': <tf.Tensor 'IteratorGetNext:2' shape=(8,) dtype=int32>, '_RANDOM_OFFSET': <tf.Tensor 'IteratorGetNext:0' shape=(8,) dtype=int32>}, labels=Tensor("IteratorGetNext:4", shape=(8,), dtype=int32),mode=eval, params={'use_tpu': False, 'train_batch_size': 8, 'batch_size': 8}
#Clean old summaries from previous calls to model_fn().
# Get features and labels for each sub-step.
--------------------------------------------modular_gan.py/_split_inputs_and_generate_samples,s
I0410 03:48:38.604755 139691431679872 resnet_biggan.py:236] [Generator] inputs are z=(8, 120), y=(8, 2)
I0410 03:48:38.616734 139691431679872 resnet_biggan.py:262] [Generator] z0=(8, 20), z_per_block=['(8, 20)', '(8, 20)', '(8, 20)', '(8, 20)', '(8, 20)'], y_per_block=['(8, 148)', '(8, 148)', '(8, 148)', '(8, 148)', '(8, 148)']
I0410 03:48:38.674309 139691431679872 resnet_biggan.py:150] [Block] (8, 4, 4, 1536) (z=(8, 20), y=(8, 148)) -> (8, 8, 8, 1536)
I0410 03:48:38.715625 139691431679872 resnet_biggan.py:150] [Block] (8, 8, 8, 1536) (z=(8, 20), y=(8, 148)) -> (8, 16, 16, 768)
I0410 03:48:38.760169 139691431679872 resnet_biggan.py:150] [Block] (8, 16, 16, 768) (z=(8, 20), y=(8, 148)) -> (8, 32, 32, 384)
I0410 03:48:38.807186 139691431679872 resnet_biggan.py:150] [Block] (8, 32, 32, 384) (z=(8, 20), y=(8, 148)) -> (8, 64, 64, 192)
I0410 03:48:38.807381 139691431679872 resnet_biggan.py:289] [Generator] Applying non-local block to (8, 64, 64, 192)
I0410 03:48:38.896370 139691431679872 resnet_biggan.py:150] [Block] (8, 64, 64, 192) (z=(8, 20), y=(8, 148)) -> (8, 128, 128, 96)
I0410 03:48:38.896553 139691431679872 resnet_biggan.py:294] [Generator] before final processing: (8, 128, 128, 96)
I0410 03:48:38.934645 139691431679872 resnet_biggan.py:300] [Generator] after final processing: (8, 128, 128, 3)
--------------------------------------------modular_gan.py/_split_inputs_and_generate_samples,e
---------------------------------------------------modular_gan.py/create_logits,s
I0410 03:48:38.939376 139691431679872 tpu_random.py:86] Got global random offset: Tensor("strided_slice:0", shape=(), dtype=int32)
---------------------------------------------------s3gan.py/create_loss,s
W0410 03:48:38.943549 139691431679872 s3gan.py:237] Computing fake images for every sub step separately.
I0410 03:48:38.943867 139691431679872 resnet_biggan.py:236] [Generator] inputs are z=(8, 120), y=(8, 2)
I0410 03:48:38.951096 139691431679872 resnet_biggan.py:262] [Generator] z0=(8, 20), z_per_block=['(8, 20)', '(8, 20)', '(8, 20)', '(8, 20)', '(8, 20)'], y_per_block=['(8, 148)', '(8, 148)', '(8, 148)', '(8, 148)', '(8, 148)']
I0410 03:48:38.972491 139691431679872 resnet_biggan.py:150] [Block] (8, 4, 4, 1536) (z=(8, 20), y=(8, 148)) -> (8, 8, 8, 1536)
I0410 03:48:38.990026 139691431679872 resnet_biggan.py:150] [Block] (8, 8, 8, 1536) (z=(8, 20), y=(8, 148)) -> (8, 16, 16, 768)
I0410 03:48:39.008659 139691431679872 resnet_biggan.py:150] [Block] (8, 16, 16, 768) (z=(8, 20), y=(8, 148)) -> (8, 32, 32, 384)
I0410 03:48:39.027750 139691431679872 resnet_biggan.py:150] [Block] (8, 32, 32, 384) (z=(8, 20), y=(8, 148)) -> (8, 64, 64, 192)
I0410 03:48:39.027949 139691431679872 resnet_biggan.py:289] [Generator] Applying non-local block to (8, 64, 64, 192)
I0410 03:48:39.067975 139691431679872 resnet_biggan.py:150] [Block] (8, 64, 64, 192) (z=(8, 20), y=(8, 148)) -> (8, 128, 128, 96)
I0410 03:48:39.068166 139691431679872 resnet_biggan.py:294] [Generator] before final processing: (8, 128, 128, 96)
I0410 03:48:39.084908 139691431679872 resnet_biggan.py:300] [Generator] after final processing: (8, 128, 128, 3)
I0410 03:48:39.086821 139691431679872 s3gan.py:249] bs=8, rotated_bs=4, num_rot_examples=1
---------------------------------------------------s3gan.py/merge_with_rotation_data,s
---------------------------------------------------s3gan.py/merge_with_rotation_data,e
--------------------------------------------------------------------s3gan.py/discriminator_with_additonal_heads,s
I0410 03:48:39.114692 139691431679872 resnet_biggan.py:379] [Discriminator] inputs are x=(22, 128, 128, 3), y=(22, 2)
I0410 03:48:39.149842 139691431679872 resnet_biggan.py:150] [Block] (22, 128, 128, 3) (z=None, y=(22, 2)) -> (22, 64, 64, 96)
I0410 03:48:39.150002 139691431679872 resnet_biggan.py:398] [Discriminator] Applying non-local block to (22, 64, 64, 96)
I0410 03:48:39.229531 139691431679872 resnet_biggan.py:150] [Block] (22, 64, 64, 96) (z=None, y=(22, 2)) -> (22, 32, 32, 192)
I0410 03:48:39.265606 139691431679872 resnet_biggan.py:150] [Block] (22, 32, 32, 192) (z=None, y=(22, 2)) -> (22, 16, 16, 384)
I0410 03:48:39.300946 139691431679872 resnet_biggan.py:150] [Block] (22, 16, 16, 384) (z=None, y=(22, 2)) -> (22, 8, 8, 768)
I0410 03:48:39.334734 139691431679872 resnet_biggan.py:150] [Block] (22, 8, 8, 768) (z=None, y=(22, 2)) -> (22, 4, 4, 1536)
I0410 03:48:39.356367 139691431679872 resnet_biggan.py:150] [Block] (22, 4, 4, 1536) (z=None, y=(22, 2)) -> (22, 4, 4, 1536)
I0410 03:48:39.356548 139691431679872 resnet_biggan.py:403] [Discriminator] before final processing: (22, 4, 4, 1536)
I0410 03:48:39.368044 139691431679872 resnet_biggan.py:407] [Discriminator] after final processing: (22, 4, 4, 1536)
I0410 03:48:39.374552 139691431679872 resnet_biggan.py:422] [Discriminator] embedded_y for projection: (22, 1536)
I0410 03:48:39.387775 139691431679872 s3gan.py:133] [Discriminator] rotation head (22, 1536) -> Tensor("discriminator_rotation/score_classify/add:0", shape=(22, 4), dtype=float32)
I0410 03:48:39.401575 139691431679872 s3gan.py:154] [Discriminator] (22, 2) -> aux_logits=(22, 2), y_predicted=(22, 2)
---------------------------------------------------s3gan.py/get_class_embedding,s
I0410 03:48:39.408319 139691431679872 s3gan.py:175] [Discriminator] embedded_y for projection: (22, 1536)
---------------------------------------------------s3gan.py/get_class_embedding,e
---------------------------------------------------s3gan.py/discriminator_with_additonal_heads,e
---------------------------------------------------s3gan.py/create_loss,e
---------------------------------------------------modular_gan.py/create_logits,e
################################################## mode == tf.estimator.ModeKeys.EVAL  ########################
INFO:tensorflow:Done calling model_fn.
I0410 03:48:39.500515 139691431679872 estimator.py:1171] Done calling model_fn.
INFO:tensorflow:Starting evaluation at 2020-04-10T03:48:39Z
I0410 03:48:39.517446 139691431679872 evaluation.py:255] Starting evaluation at 2020-04-10T03:48:39Z
INFO:tensorflow:Graph was finalized.
I0410 03:48:40.047014 139691431679872 monitored_session.py:246] Graph was finalized.
2020-04-10 03:48:40.047845: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-04-10 03:48:40.048182: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:00:04.0 name: Tesla P4 computeCapability: 6.1
coreClock: 1.1135GHz coreCount: 20 deviceMemorySize: 7.43GiB deviceMemoryBandwidth: 178.99GiB/s
2020-04-10 03:48:40.048261: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.1
2020-04-10 03:48:40.048309: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10
2020-04-10 03:48:40.048329: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcufft.so.10
2020-04-10 03:48:40.048347: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcurand.so.10
2020-04-10 03:48:40.048364: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusolver.so.10
2020-04-10 03:48:40.048418: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusparse.so.10
2020-04-10 03:48:40.048436: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudnn.so.7
2020-04-10 03:48:40.048522: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-04-10 03:48:40.048866: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-04-10 03:48:40.049104: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1703] Adding visible gpu devices: 0
2020-04-10 03:48:40.049150: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-04-10 03:48:40.049164: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      0 
2020-04-10 03:48:40.049175: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1121] 0:   N 
2020-04-10 03:48:40.049277: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-04-10 03:48:40.049556: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-04-10 03:48:40.049794: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1247] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 6850 MB memory) -> physical GPU (device: 0, name: Tesla P4, pci bus id: 0000:00:04.0, compute capability: 6.1)
INFO:tensorflow:Restoring parameters from /tmp/absl_testing/429596/model.ckpt-4000
I0410 03:48:40.050830 139691431679872 saver.py:1293] Restoring parameters from /tmp/absl_testing/429596/model.ckpt-4000
INFO:tensorflow:Running local_init_op.
I0410 03:48:40.486112 139691431679872 session_manager.py:505] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
I0410 03:48:40.509732 139691431679872 session_manager.py:508] Done running local_init_op.
INFO:tensorflow:Evaluation [1/10]
I0410 03:48:43.692695 139691431679872 evaluation.py:167] Evaluation [1/10]
INFO:tensorflow:Evaluation [2/10]
I0410 03:48:45.165368 139691431679872 evaluation.py:167] Evaluation [2/10]
INFO:tensorflow:Evaluation [3/10]
I0410 03:48:51.682366 139691431679872 evaluation.py:167] Evaluation [3/10]
INFO:tensorflow:Evaluation [4/10]
I0410 03:48:53.222036 139691431679872 evaluation.py:167] Evaluation [4/10]
INFO:tensorflow:Evaluation [5/10]
I0410 03:48:55.111511 139691431679872 evaluation.py:167] Evaluation [5/10]
INFO:tensorflow:Evaluation [6/10]
I0410 03:48:56.819171 139691431679872 evaluation.py:167] Evaluation [6/10]
INFO:tensorflow:Evaluation [7/10]
I0410 03:48:57.116563 139691431679872 evaluation.py:167] Evaluation [7/10]
INFO:tensorflow:Evaluation [8/10]
I0410 03:48:58.932786 139691431679872 evaluation.py:167] Evaluation [8/10]
INFO:tensorflow:Evaluation [9/10]
I0410 03:49:00.905599 139691431679872 evaluation.py:167] Evaluation [9/10]
INFO:tensorflow:Evaluation [10/10]
I0410 03:49:02.672338 139691431679872 evaluation.py:167] Evaluation [10/10]
INFO:tensorflow:Inference Time : 23.44085s
I0410 03:49:02.958483 139691431679872 evaluation.py:273] Inference Time : 23.44085s
INFO:tensorflow:Finished evaluation at 2020-04-10-03:49:02
I0410 03:49:02.958706 139691431679872 evaluation.py:276] Finished evaluation at 2020-04-10-03:49:02
INFO:tensorflow:Saving dict for global step 4000: accuracy = 1.0, global_step = 4000, loss = 0.022914197
I0410 03:49:02.958903 139691431679872 estimator.py:2066] Saving dict for global step 4000: accuracy = 1.0, global_step = 4000, loss = 0.022914197
INFO:tensorflow:Saving 'checkpoint_path' summary for global step 4000: /tmp/absl_testing/429596/model.ckpt-4000
I0410 03:49:02.959447 139691431679872 estimator.py:2127] Saving 'checkpoint_path' summary for global step 4000: /tmp/absl_testing/429596/model.ckpt-4000
INFO:tensorflow:global_step/sec: 0.530117
I0410 03:49:04.417219 139691431679872 basic_session_run_hooks.py:702] global_step/sec: 0.530117
INFO:tensorflow:loss = 0.03479387, step = 4000 (188.637 sec)
I0410 03:49:04.418122 139691431679872 basic_session_run_hooks.py:260] loss = 0.03479387, step = 4000 (188.637 sec)
INFO:tensorflow:global_step/sec: 0.681485
I0410 03:51:31.155535 139691431679872 basic_session_run_hooks.py:702] global_step/sec: 0.681485
INFO:tensorflow:loss = 0.002729992, step = 4100 (146.738 sec)
I0410 03:51:31.156573 139691431679872 basic_session_run_hooks.py:260] loss = 0.002729992, step = 4100 (146.738 sec)
INFO:tensorflow:Calling checkpoint listeners before saving checkpoint 4200...
I0410 03:53:56.818878 139691431679872 basic_session_run_hooks.py:614] Calling checkpoint listeners before saving checkpoint 4200...
INFO:tensorflow:Saving checkpoints for 4200 into /tmp/absl_testing/429596/model.ckpt.
I0410 03:53:56.819118 139691431679872 basic_session_run_hooks.py:618] Saving checkpoints for 4200 into /tmp/absl_testing/429596/model.ckpt.
INFO:tensorflow:Calling checkpoint listeners after saving checkpoint 4200...
I0410 03:54:13.198432 139691431679872 basic_session_run_hooks.py:626] Calling checkpoint listeners after saving checkpoint 4200...
INFO:tensorflow:Skip the current checkpoint eval due to throttle secs (600 secs).
I0410 03:54:13.198716 139691431679872 training.py:528] Skip the current checkpoint eval due to throttle secs (600 secs).
INFO:tensorflow:global_step/sec: 0.611516
I0410 03:54:14.683599 139691431679872 basic_session_run_hooks.py:702] global_step/sec: 0.611516
INFO:tensorflow:loss = 0.00014691119, step = 4200 (163.528 sec)
I0410 03:54:14.684741 139691431679872 basic_session_run_hooks.py:260] loss = 0.00014691119, step = 4200 (163.528 sec)
INFO:tensorflow:global_step/sec: 0.680552
I0410 03:56:41.623282 139691431679872 basic_session_run_hooks.py:702] global_step/sec: 0.680552
INFO:tensorflow:loss = 0.054866105, step = 4300 (146.940 sec)
I0410 03:56:41.624602 139691431679872 basic_session_run_hooks.py:260] loss = 0.054866105, step = 4300 (146.940 sec)
INFO:tensorflow:Calling checkpoint listeners before saving checkpoint 4400...
I0410 03:59:07.284060 139691431679872 basic_session_run_hooks.py:614] Calling checkpoint listeners before saving checkpoint 4400...
INFO:tensorflow:Saving checkpoints for 4400 into /tmp/absl_testing/429596/model.ckpt.
I0410 03:59:07.284353 139691431679872 basic_session_run_hooks.py:618] Saving checkpoints for 4400 into /tmp/absl_testing/429596/model.ckpt.
INFO:tensorflow:Calling checkpoint listeners after saving checkpoint 4400...
I0410 03:59:22.968604 139691431679872 basic_session_run_hooks.py:626] Calling checkpoint listeners after saving checkpoint 4400...
--------------------------------------------datasets.py/eval_input_fn,s
W0410 03:59:25.877439 139691431679872 datasets.py:170] No TPUContext, using unmodified dataset seed 547.
I0410 03:59:25.877607 139691431679872 datasets.py:348] eval_input_fn(): params={'use_tpu': False, 'train_batch_size': 8, 'batch_size': 8} seed=547
--------befor self._load_dataset------------------split = validation self._eval_split= validation
--------------------------------------------datasets.py/_load_dataset,s
!!!!!!!!!!!!!!!!!!!!!!----load_local_datasets,  _local_test_ds_dir= /content/drive/My Drive/drive/gan/test
-----------------------------------------get_local_datasets,s
-----------------------------------------get_local_datasets,e
--------------------------------------------modular_gan.py/_preprocess_fn,s
I0410 03:59:25.968793 139691431679872 api.py:587] _preprocess_fn(): images=Tensor("args_0:0", shape=(128, 128, 3), dtype=float32), labels=Tensor("args_1:0", shape=(), dtype=int32), seed=547
--------------------------------------------modular_gan.py/_preprocess_fn,e
I0410 03:59:26.001759 139691431679872 api.py:587] Passing random offset: Tensor("Cast:0", shape=(), dtype=int32) with data ({'images': <tf.Tensor 'args_1:0' shape=(128, 128, 3) dtype=float32>, 'z': <tf.Tensor 'args_3:0' shape=(120,) dtype=float32>, 'sampled_labels': <tf.Tensor 'args_2:0' shape=() dtype=int32>}, <tf.Tensor 'args_4:0' shape=() dtype=int32>).
--------------------------------------------datasets.py/eval_input_fn,e
INFO:tensorflow:Calling model_fn.
I0410 03:59:26.018828 139691431679872 estimator.py:1169] Calling model_fn.
--------------------------------------------modular_gan.py/model_fn,s
I0410 03:59:26.018996 139691431679872 modular_gan.py:589] model_fn(): features={'images': <tf.Tensor 'IteratorGetNext:1' shape=(8, 128, 128, 3) dtype=float32>, 'z': <tf.Tensor 'IteratorGetNext:3' shape=(8, 120) dtype=float32>, 'sampled_labels': <tf.Tensor 'IteratorGetNext:2' shape=(8,) dtype=int32>, '_RANDOM_OFFSET': <tf.Tensor 'IteratorGetNext:0' shape=(8,) dtype=int32>}, labels=Tensor("IteratorGetNext:4", shape=(8,), dtype=int32),mode=eval, params={'use_tpu': False, 'train_batch_size': 8, 'batch_size': 8}
#Clean old summaries from previous calls to model_fn().
# Get features and labels for each sub-step.
--------------------------------------------modular_gan.py/_split_inputs_and_generate_samples,s
I0410 03:59:26.026469 139691431679872 resnet_biggan.py:236] [Generator] inputs are z=(8, 120), y=(8, 2)
I0410 03:59:26.037545 139691431679872 resnet_biggan.py:262] [Generator] z0=(8, 20), z_per_block=['(8, 20)', '(8, 20)', '(8, 20)', '(8, 20)', '(8, 20)'], y_per_block=['(8, 148)', '(8, 148)', '(8, 148)', '(8, 148)', '(8, 148)']
I0410 03:59:26.090693 139691431679872 resnet_biggan.py:150] [Block] (8, 4, 4, 1536) (z=(8, 20), y=(8, 148)) -> (8, 8, 8, 1536)
I0410 03:59:26.131167 139691431679872 resnet_biggan.py:150] [Block] (8, 8, 8, 1536) (z=(8, 20), y=(8, 148)) -> (8, 16, 16, 768)
I0410 03:59:26.171951 139691431679872 resnet_biggan.py:150] [Block] (8, 16, 16, 768) (z=(8, 20), y=(8, 148)) -> (8, 32, 32, 384)
I0410 03:59:26.218389 139691431679872 resnet_biggan.py:150] [Block] (8, 32, 32, 384) (z=(8, 20), y=(8, 148)) -> (8, 64, 64, 192)
I0410 03:59:26.218590 139691431679872 resnet_biggan.py:289] [Generator] Applying non-local block to (8, 64, 64, 192)
I0410 03:59:26.303239 139691431679872 resnet_biggan.py:150] [Block] (8, 64, 64, 192) (z=(8, 20), y=(8, 148)) -> (8, 128, 128, 96)
I0410 03:59:26.303446 139691431679872 resnet_biggan.py:294] [Generator] before final processing: (8, 128, 128, 96)
I0410 03:59:26.337900 139691431679872 resnet_biggan.py:300] [Generator] after final processing: (8, 128, 128, 3)
--------------------------------------------modular_gan.py/_split_inputs_and_generate_samples,e
---------------------------------------------------modular_gan.py/create_logits,s
I0410 03:59:26.341759 139691431679872 tpu_random.py:86] Got global random offset: Tensor("strided_slice:0", shape=(), dtype=int32)
---------------------------------------------------s3gan.py/create_loss,s
W0410 03:59:26.344420 139691431679872 s3gan.py:237] Computing fake images for every sub step separately.
I0410 03:59:26.344641 139691431679872 resnet_biggan.py:236] [Generator] inputs are z=(8, 120), y=(8, 2)
I0410 03:59:26.351706 139691431679872 resnet_biggan.py:262] [Generator] z0=(8, 20), z_per_block=['(8, 20)', '(8, 20)', '(8, 20)', '(8, 20)', '(8, 20)'], y_per_block=['(8, 148)', '(8, 148)', '(8, 148)', '(8, 148)', '(8, 148)']
I0410 03:59:26.372016 139691431679872 resnet_biggan.py:150] [Block] (8, 4, 4, 1536) (z=(8, 20), y=(8, 148)) -> (8, 8, 8, 1536)
I0410 03:59:26.389993 139691431679872 resnet_biggan.py:150] [Block] (8, 8, 8, 1536) (z=(8, 20), y=(8, 148)) -> (8, 16, 16, 768)
I0410 03:59:26.407934 139691431679872 resnet_biggan.py:150] [Block] (8, 16, 16, 768) (z=(8, 20), y=(8, 148)) -> (8, 32, 32, 384)
I0410 03:59:26.425678 139691431679872 resnet_biggan.py:150] [Block] (8, 32, 32, 384) (z=(8, 20), y=(8, 148)) -> (8, 64, 64, 192)
I0410 03:59:26.425842 139691431679872 resnet_biggan.py:289] [Generator] Applying non-local block to (8, 64, 64, 192)
I0410 03:59:26.461406 139691431679872 resnet_biggan.py:150] [Block] (8, 64, 64, 192) (z=(8, 20), y=(8, 148)) -> (8, 128, 128, 96)
I0410 03:59:26.461584 139691431679872 resnet_biggan.py:294] [Generator] before final processing: (8, 128, 128, 96)
I0410 03:59:26.477417 139691431679872 resnet_biggan.py:300] [Generator] after final processing: (8, 128, 128, 3)
I0410 03:59:26.480836 139691431679872 s3gan.py:249] bs=8, rotated_bs=4, num_rot_examples=1
---------------------------------------------------s3gan.py/merge_with_rotation_data,s
---------------------------------------------------s3gan.py/merge_with_rotation_data,e
--------------------------------------------------------------------s3gan.py/discriminator_with_additonal_heads,s
I0410 03:59:26.514930 139691431679872 resnet_biggan.py:379] [Discriminator] inputs are x=(22, 128, 128, 3), y=(22, 2)
I0410 03:59:26.548246 139691431679872 resnet_biggan.py:150] [Block] (22, 128, 128, 3) (z=None, y=(22, 2)) -> (22, 64, 64, 96)
I0410 03:59:26.548415 139691431679872 resnet_biggan.py:398] [Discriminator] Applying non-local block to (22, 64, 64, 96)
I0410 03:59:26.631254 139691431679872 resnet_biggan.py:150] [Block] (22, 64, 64, 96) (z=None, y=(22, 2)) -> (22, 32, 32, 192)
I0410 03:59:26.668057 139691431679872 resnet_biggan.py:150] [Block] (22, 32, 32, 192) (z=None, y=(22, 2)) -> (22, 16, 16, 384)
I0410 03:59:26.706043 139691431679872 resnet_biggan.py:150] [Block] (22, 16, 16, 384) (z=None, y=(22, 2)) -> (22, 8, 8, 768)
I0410 03:59:26.740389 139691431679872 resnet_biggan.py:150] [Block] (22, 8, 8, 768) (z=None, y=(22, 2)) -> (22, 4, 4, 1536)
I0410 03:59:26.761128 139691431679872 resnet_biggan.py:150] [Block] (22, 4, 4, 1536) (z=None, y=(22, 2)) -> (22, 4, 4, 1536)
I0410 03:59:26.761326 139691431679872 resnet_biggan.py:403] [Discriminator] before final processing: (22, 4, 4, 1536)
I0410 03:59:26.773126 139691431679872 resnet_biggan.py:407] [Discriminator] after final processing: (22, 4, 4, 1536)
I0410 03:59:26.779778 139691431679872 resnet_biggan.py:422] [Discriminator] embedded_y for projection: (22, 1536)
I0410 03:59:26.793767 139691431679872 s3gan.py:133] [Discriminator] rotation head (22, 1536) -> Tensor("discriminator_rotation/score_classify/add:0", shape=(22, 4), dtype=float32)
I0410 03:59:26.807536 139691431679872 s3gan.py:154] [Discriminator] (22, 2) -> aux_logits=(22, 2), y_predicted=(22, 2)
---------------------------------------------------s3gan.py/get_class_embedding,s
I0410 03:59:26.815443 139691431679872 s3gan.py:175] [Discriminator] embedded_y for projection: (22, 1536)
---------------------------------------------------s3gan.py/get_class_embedding,e
---------------------------------------------------s3gan.py/discriminator_with_additonal_heads,e
---------------------------------------------------s3gan.py/create_loss,e
---------------------------------------------------modular_gan.py/create_logits,e
################################################## mode == tf.estimator.ModeKeys.EVAL  ########################
INFO:tensorflow:Done calling model_fn.
I0410 03:59:26.909985 139691431679872 estimator.py:1171] Done calling model_fn.
INFO:tensorflow:Starting evaluation at 2020-04-10T03:59:26Z
I0410 03:59:26.927027 139691431679872 evaluation.py:255] Starting evaluation at 2020-04-10T03:59:26Z
INFO:tensorflow:Graph was finalized.
I0410 03:59:27.077286 139691431679872 monitored_session.py:246] Graph was finalized.
2020-04-10 03:59:27.078042: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-04-10 03:59:27.078490: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:00:04.0 name: Tesla P4 computeCapability: 6.1
coreClock: 1.1135GHz coreCount: 20 deviceMemorySize: 7.43GiB deviceMemoryBandwidth: 178.99GiB/s
2020-04-10 03:59:27.078568: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.1
2020-04-10 03:59:27.078611: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10
2020-04-10 03:59:27.078632: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcufft.so.10
2020-04-10 03:59:27.078652: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcurand.so.10
2020-04-10 03:59:27.078668: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusolver.so.10
2020-04-10 03:59:27.078716: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusparse.so.10
2020-04-10 03:59:27.078733: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudnn.so.7
2020-04-10 03:59:27.078851: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-04-10 03:59:27.079156: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-04-10 03:59:27.079385: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1703] Adding visible gpu devices: 0
2020-04-10 03:59:27.079440: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-04-10 03:59:27.079454: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      0 
2020-04-10 03:59:27.079464: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1121] 0:   N 
2020-04-10 03:59:27.079615: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-04-10 03:59:27.079934: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-04-10 03:59:27.080178: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1247] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 6850 MB memory) -> physical GPU (device: 0, name: Tesla P4, pci bus id: 0000:00:04.0, compute capability: 6.1)
INFO:tensorflow:Restoring parameters from /tmp/absl_testing/429596/model.ckpt-4400
I0410 03:59:27.081255 139691431679872 saver.py:1293] Restoring parameters from /tmp/absl_testing/429596/model.ckpt-4400
INFO:tensorflow:Running local_init_op.
I0410 03:59:27.501049 139691431679872 session_manager.py:505] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
I0410 03:59:27.529402 139691431679872 session_manager.py:508] Done running local_init_op.
INFO:tensorflow:Evaluation [1/10]
I0410 03:59:30.874155 139691431679872 evaluation.py:167] Evaluation [1/10]
INFO:tensorflow:Evaluation [2/10]
I0410 03:59:32.195005 139691431679872 evaluation.py:167] Evaluation [2/10]
INFO:tensorflow:Evaluation [3/10]
I0410 03:59:33.757193 139691431679872 evaluation.py:167] Evaluation [3/10]
INFO:tensorflow:Evaluation [4/10]
I0410 03:59:34.640731 139691431679872 evaluation.py:167] Evaluation [4/10]
INFO:tensorflow:Evaluation [5/10]
I0410 03:59:36.051967 139691431679872 evaluation.py:167] Evaluation [5/10]
INFO:tensorflow:Evaluation [6/10]
I0410 03:59:45.074651 139691431679872 evaluation.py:167] Evaluation [6/10]
INFO:tensorflow:Evaluation [7/10]
I0410 03:59:45.946842 139691431679872 evaluation.py:167] Evaluation [7/10]
INFO:tensorflow:Evaluation [8/10]
I0410 03:59:47.227598 139691431679872 evaluation.py:167] Evaluation [8/10]
INFO:tensorflow:Evaluation [9/10]
I0410 03:59:48.738104 139691431679872 evaluation.py:167] Evaluation [9/10]
INFO:tensorflow:Evaluation [10/10]
I0410 03:59:50.752470 139691431679872 evaluation.py:167] Evaluation [10/10]
INFO:tensorflow:Inference Time : 23.98616s
I0410 03:59:50.913372 139691431679872 evaluation.py:273] Inference Time : 23.98616s
INFO:tensorflow:Finished evaluation at 2020-04-10-03:59:50
I0410 03:59:50.913607 139691431679872 evaluation.py:276] Finished evaluation at 2020-04-10-03:59:50
INFO:tensorflow:Saving dict for global step 4400: accuracy = 1.0, global_step = 4400, loss = 0.07753928
I0410 03:59:50.913829 139691431679872 estimator.py:2066] Saving dict for global step 4400: accuracy = 1.0, global_step = 4400, loss = 0.07753928
INFO:tensorflow:Saving 'checkpoint_path' summary for global step 4400: /tmp/absl_testing/429596/model.ckpt-4400
I0410 03:59:50.914397 139691431679872 estimator.py:2127] Saving 'checkpoint_path' summary for global step 4400: /tmp/absl_testing/429596/model.ckpt-4400
INFO:tensorflow:global_step/sec: 0.524232
I0410 03:59:52.378480 139691431679872 basic_session_run_hooks.py:702] global_step/sec: 0.524232
INFO:tensorflow:loss = 0.0028487751, step = 4400 (190.755 sec)
I0410 03:59:52.379464 139691431679872 basic_session_run_hooks.py:260] loss = 0.0028487751, step = 4400 (190.755 sec)
INFO:tensorflow:global_step/sec: 0.68078
I0410 04:02:19.268792 139691431679872 basic_session_run_hooks.py:702] global_step/sec: 0.68078
INFO:tensorflow:loss = 0.05092843, step = 4500 (146.890 sec)
I0410 04:02:19.269946 139691431679872 basic_session_run_hooks.py:260] loss = 0.05092843, step = 4500 (146.890 sec)
INFO:tensorflow:Calling checkpoint listeners before saving checkpoint 4600...
I0410 04:04:44.937583 139691431679872 basic_session_run_hooks.py:614] Calling checkpoint listeners before saving checkpoint 4600...
INFO:tensorflow:Saving checkpoints for 4600 into /tmp/absl_testing/429596/model.ckpt.
I0410 04:04:44.937885 139691431679872 basic_session_run_hooks.py:618] Saving checkpoints for 4600 into /tmp/absl_testing/429596/model.ckpt.
INFO:tensorflow:Calling checkpoint listeners after saving checkpoint 4600...
I0410 04:05:02.950911 139691431679872 basic_session_run_hooks.py:626] Calling checkpoint listeners after saving checkpoint 4600...
INFO:tensorflow:Skip the current checkpoint eval due to throttle secs (600 secs).
I0410 04:05:02.951367 139691431679872 training.py:528] Skip the current checkpoint eval due to throttle secs (600 secs).
INFO:tensorflow:global_step/sec: 0.60545
I0410 04:05:04.435188 139691431679872 basic_session_run_hooks.py:702] global_step/sec: 0.60545
INFO:tensorflow:loss = 0.003597007, step = 4600 (165.171 sec)
I0410 04:05:04.440685 139691431679872 basic_session_run_hooks.py:260] loss = 0.003597007, step = 4600 (165.171 sec)
INFO:tensorflow:global_step/sec: 0.680253
I0410 04:07:31.439268 139691431679872 basic_session_run_hooks.py:702] global_step/sec: 0.680253
INFO:tensorflow:loss = 0.0061014546, step = 4700 (147.000 sec)
I0410 04:07:31.440373 139691431679872 basic_session_run_hooks.py:260] loss = 0.0061014546, step = 4700 (147.000 sec)
INFO:tensorflow:Calling checkpoint listeners before saving checkpoint 4800...
I0410 04:09:57.098326 139691431679872 basic_session_run_hooks.py:614] Calling checkpoint listeners before saving checkpoint 4800...
INFO:tensorflow:Saving checkpoints for 4800 into /tmp/absl_testing/429596/model.ckpt.
I0410 04:09:57.098567 139691431679872 basic_session_run_hooks.py:618] Saving checkpoints for 4800 into /tmp/absl_testing/429596/model.ckpt.
INFO:tensorflow:Calling checkpoint listeners after saving checkpoint 4800...
I0410 04:10:15.076945 139691431679872 basic_session_run_hooks.py:626] Calling checkpoint listeners after saving checkpoint 4800...
--------------------------------------------datasets.py/eval_input_fn,s
W0410 04:10:15.382079 139691431679872 datasets.py:170] No TPUContext, using unmodified dataset seed 547.
I0410 04:10:15.382233 139691431679872 datasets.py:348] eval_input_fn(): params={'use_tpu': False, 'train_batch_size': 8, 'batch_size': 8} seed=547
--------befor self._load_dataset------------------split = validation self._eval_split= validation
--------------------------------------------datasets.py/_load_dataset,s
!!!!!!!!!!!!!!!!!!!!!!----load_local_datasets,  _local_test_ds_dir= /content/drive/My Drive/drive/gan/test
-----------------------------------------get_local_datasets,s
-----------------------------------------get_local_datasets,e
--------------------------------------------modular_gan.py/_preprocess_fn,s
I0410 04:10:15.474099 139691431679872 api.py:587] _preprocess_fn(): images=Tensor("args_0:0", shape=(128, 128, 3), dtype=float32), labels=Tensor("args_1:0", shape=(), dtype=int32), seed=547
--------------------------------------------modular_gan.py/_preprocess_fn,e
I0410 04:10:15.503406 139691431679872 api.py:587] Passing random offset: Tensor("Cast:0", shape=(), dtype=int32) with data ({'images': <tf.Tensor 'args_1:0' shape=(128, 128, 3) dtype=float32>, 'z': <tf.Tensor 'args_3:0' shape=(120,) dtype=float32>, 'sampled_labels': <tf.Tensor 'args_2:0' shape=() dtype=int32>}, <tf.Tensor 'args_4:0' shape=() dtype=int32>).
--------------------------------------------datasets.py/eval_input_fn,e
INFO:tensorflow:Calling model_fn.
I0410 04:10:15.520048 139691431679872 estimator.py:1169] Calling model_fn.
--------------------------------------------modular_gan.py/model_fn,s
I0410 04:10:15.520215 139691431679872 modular_gan.py:589] model_fn(): features={'images': <tf.Tensor 'IteratorGetNext:1' shape=(8, 128, 128, 3) dtype=float32>, 'z': <tf.Tensor 'IteratorGetNext:3' shape=(8, 120) dtype=float32>, 'sampled_labels': <tf.Tensor 'IteratorGetNext:2' shape=(8,) dtype=int32>, '_RANDOM_OFFSET': <tf.Tensor 'IteratorGetNext:0' shape=(8,) dtype=int32>}, labels=Tensor("IteratorGetNext:4", shape=(8,), dtype=int32),mode=eval, params={'use_tpu': False, 'train_batch_size': 8, 'batch_size': 8}
#Clean old summaries from previous calls to model_fn().
# Get features and labels for each sub-step.
--------------------------------------------modular_gan.py/_split_inputs_and_generate_samples,s
I0410 04:10:15.526898 139691431679872 resnet_biggan.py:236] [Generator] inputs are z=(8, 120), y=(8, 2)
I0410 04:10:15.537336 139691431679872 resnet_biggan.py:262] [Generator] z0=(8, 20), z_per_block=['(8, 20)', '(8, 20)', '(8, 20)', '(8, 20)', '(8, 20)'], y_per_block=['(8, 148)', '(8, 148)', '(8, 148)', '(8, 148)', '(8, 148)']
I0410 04:10:15.584697 139691431679872 resnet_biggan.py:150] [Block] (8, 4, 4, 1536) (z=(8, 20), y=(8, 148)) -> (8, 8, 8, 1536)
I0410 04:10:15.624512 139691431679872 resnet_biggan.py:150] [Block] (8, 8, 8, 1536) (z=(8, 20), y=(8, 148)) -> (8, 16, 16, 768)
I0410 04:10:15.662612 139691431679872 resnet_biggan.py:150] [Block] (8, 16, 16, 768) (z=(8, 20), y=(8, 148)) -> (8, 32, 32, 384)
I0410 04:10:15.700971 139691431679872 resnet_biggan.py:150] [Block] (8, 32, 32, 384) (z=(8, 20), y=(8, 148)) -> (8, 64, 64, 192)
I0410 04:10:15.701132 139691431679872 resnet_biggan.py:289] [Generator] Applying non-local block to (8, 64, 64, 192)
I0410 04:10:15.777912 139691431679872 resnet_biggan.py:150] [Block] (8, 64, 64, 192) (z=(8, 20), y=(8, 148)) -> (8, 128, 128, 96)
I0410 04:10:15.778111 139691431679872 resnet_biggan.py:294] [Generator] before final processing: (8, 128, 128, 96)
I0410 04:10:15.810640 139691431679872 resnet_biggan.py:300] [Generator] after final processing: (8, 128, 128, 3)
--------------------------------------------modular_gan.py/_split_inputs_and_generate_samples,e
---------------------------------------------------modular_gan.py/create_logits,s
I0410 04:10:15.814048 139691431679872 tpu_random.py:86] Got global random offset: Tensor("strided_slice:0", shape=(), dtype=int32)
---------------------------------------------------s3gan.py/create_loss,s
W0410 04:10:15.816916 139691431679872 s3gan.py:237] Computing fake images for every sub step separately.
I0410 04:10:15.817167 139691431679872 resnet_biggan.py:236] [Generator] inputs are z=(8, 120), y=(8, 2)
I0410 04:10:15.824427 139691431679872 resnet_biggan.py:262] [Generator] z0=(8, 20), z_per_block=['(8, 20)', '(8, 20)', '(8, 20)', '(8, 20)', '(8, 20)'], y_per_block=['(8, 148)', '(8, 148)', '(8, 148)', '(8, 148)', '(8, 148)']
I0410 04:10:15.843472 139691431679872 resnet_biggan.py:150] [Block] (8, 4, 4, 1536) (z=(8, 20), y=(8, 148)) -> (8, 8, 8, 1536)
I0410 04:10:15.859841 139691431679872 resnet_biggan.py:150] [Block] (8, 8, 8, 1536) (z=(8, 20), y=(8, 148)) -> (8, 16, 16, 768)
I0410 04:10:15.876036 139691431679872 resnet_biggan.py:150] [Block] (8, 16, 16, 768) (z=(8, 20), y=(8, 148)) -> (8, 32, 32, 384)
I0410 04:10:15.892023 139691431679872 resnet_biggan.py:150] [Block] (8, 32, 32, 384) (z=(8, 20), y=(8, 148)) -> (8, 64, 64, 192)
I0410 04:10:15.892180 139691431679872 resnet_biggan.py:289] [Generator] Applying non-local block to (8, 64, 64, 192)
I0410 04:10:15.926038 139691431679872 resnet_biggan.py:150] [Block] (8, 64, 64, 192) (z=(8, 20), y=(8, 148)) -> (8, 128, 128, 96)
I0410 04:10:15.926192 139691431679872 resnet_biggan.py:294] [Generator] before final processing: (8, 128, 128, 96)
I0410 04:10:15.940223 139691431679872 resnet_biggan.py:300] [Generator] after final processing: (8, 128, 128, 3)
I0410 04:10:15.941984 139691431679872 s3gan.py:249] bs=8, rotated_bs=4, num_rot_examples=1
---------------------------------------------------s3gan.py/merge_with_rotation_data,s
---------------------------------------------------s3gan.py/merge_with_rotation_data,e
--------------------------------------------------------------------s3gan.py/discriminator_with_additonal_heads,s
I0410 04:10:15.968177 139691431679872 resnet_biggan.py:379] [Discriminator] inputs are x=(22, 128, 128, 3), y=(22, 2)
I0410 04:10:15.999912 139691431679872 resnet_biggan.py:150] [Block] (22, 128, 128, 3) (z=None, y=(22, 2)) -> (22, 64, 64, 96)
I0410 04:10:16.000059 139691431679872 resnet_biggan.py:398] [Discriminator] Applying non-local block to (22, 64, 64, 96)
I0410 04:10:16.072469 139691431679872 resnet_biggan.py:150] [Block] (22, 64, 64, 96) (z=None, y=(22, 2)) -> (22, 32, 32, 192)
I0410 04:10:16.106330 139691431679872 resnet_biggan.py:150] [Block] (22, 32, 32, 192) (z=None, y=(22, 2)) -> (22, 16, 16, 384)
I0410 04:10:16.142745 139691431679872 resnet_biggan.py:150] [Block] (22, 16, 16, 384) (z=None, y=(22, 2)) -> (22, 8, 8, 768)
I0410 04:10:16.174108 139691431679872 resnet_biggan.py:150] [Block] (22, 8, 8, 768) (z=None, y=(22, 2)) -> (22, 4, 4, 1536)
I0410 04:10:16.201321 139691431679872 resnet_biggan.py:150] [Block] (22, 4, 4, 1536) (z=None, y=(22, 2)) -> (22, 4, 4, 1536)
I0410 04:10:16.201515 139691431679872 resnet_biggan.py:403] [Discriminator] before final processing: (22, 4, 4, 1536)
I0410 04:10:16.211791 139691431679872 resnet_biggan.py:407] [Discriminator] after final processing: (22, 4, 4, 1536)
I0410 04:10:16.217739 139691431679872 resnet_biggan.py:422] [Discriminator] embedded_y for projection: (22, 1536)
I0410 04:10:16.232269 139691431679872 s3gan.py:133] [Discriminator] rotation head (22, 1536) -> Tensor("discriminator_rotation/score_classify/add:0", shape=(22, 4), dtype=float32)
I0410 04:10:16.244991 139691431679872 s3gan.py:154] [Discriminator] (22, 2) -> aux_logits=(22, 2), y_predicted=(22, 2)
---------------------------------------------------s3gan.py/get_class_embedding,s
I0410 04:10:16.251262 139691431679872 s3gan.py:175] [Discriminator] embedded_y for projection: (22, 1536)
---------------------------------------------------s3gan.py/get_class_embedding,e
---------------------------------------------------s3gan.py/discriminator_with_additonal_heads,e
---------------------------------------------------s3gan.py/create_loss,e
---------------------------------------------------modular_gan.py/create_logits,e
################################################## mode == tf.estimator.ModeKeys.EVAL  ########################
INFO:tensorflow:Done calling model_fn.
I0410 04:10:16.335510 139691431679872 estimator.py:1171] Done calling model_fn.
INFO:tensorflow:Starting evaluation at 2020-04-10T04:10:16Z
I0410 04:10:16.352767 139691431679872 evaluation.py:255] Starting evaluation at 2020-04-10T04:10:16Z
INFO:tensorflow:Graph was finalized.
I0410 04:10:16.503593 139691431679872 monitored_session.py:246] Graph was finalized.
2020-04-10 04:10:16.504244: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-04-10 04:10:16.504559: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:00:04.0 name: Tesla P4 computeCapability: 6.1
coreClock: 1.1135GHz coreCount: 20 deviceMemorySize: 7.43GiB deviceMemoryBandwidth: 178.99GiB/s
2020-04-10 04:10:16.504611: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.1
2020-04-10 04:10:16.504634: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10
2020-04-10 04:10:16.504651: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcufft.so.10
2020-04-10 04:10:16.504667: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcurand.so.10
2020-04-10 04:10:16.504681: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusolver.so.10
2020-04-10 04:10:16.504724: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusparse.so.10
2020-04-10 04:10:16.504739: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudnn.so.7
2020-04-10 04:10:16.504828: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-04-10 04:10:16.505099: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-04-10 04:10:16.505302: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1703] Adding visible gpu devices: 0
2020-04-10 04:10:16.505343: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-04-10 04:10:16.505357: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      0 
2020-04-10 04:10:16.505366: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1121] 0:   N 
2020-04-10 04:10:16.505468: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-04-10 04:10:16.505781: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-04-10 04:10:16.506011: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1247] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 6850 MB memory) -> physical GPU (device: 0, name: Tesla P4, pci bus id: 0000:00:04.0, compute capability: 6.1)
INFO:tensorflow:Restoring parameters from /tmp/absl_testing/429596/model.ckpt-4800
I0410 04:10:16.506851 139691431679872 saver.py:1293] Restoring parameters from /tmp/absl_testing/429596/model.ckpt-4800
INFO:tensorflow:Running local_init_op.
I0410 04:10:16.931283 139691431679872 session_manager.py:505] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
I0410 04:10:16.955181 139691431679872 session_manager.py:508] Done running local_init_op.
INFO:tensorflow:Evaluation [1/10]
I0410 04:10:20.636017 139691431679872 evaluation.py:167] Evaluation [1/10]
INFO:tensorflow:Evaluation [2/10]
I0410 04:10:21.877486 139691431679872 evaluation.py:167] Evaluation [2/10]
INFO:tensorflow:Evaluation [3/10]
I0410 04:10:23.200919 139691431679872 evaluation.py:167] Evaluation [3/10]
INFO:tensorflow:Evaluation [4/10]
I0410 04:10:24.153567 139691431679872 evaluation.py:167] Evaluation [4/10]
INFO:tensorflow:Evaluation [5/10]
I0410 04:10:25.650871 139691431679872 evaluation.py:167] Evaluation [5/10]
INFO:tensorflow:Evaluation [6/10]
I0410 04:10:26.811785 139691431679872 evaluation.py:167] Evaluation [6/10]
INFO:tensorflow:Evaluation [7/10]
I0410 04:10:27.718347 139691431679872 evaluation.py:167] Evaluation [7/10]
INFO:tensorflow:Evaluation [8/10]
I0410 04:10:29.599699 139691431679872 evaluation.py:167] Evaluation [8/10]
INFO:tensorflow:Evaluation [9/10]
I0410 04:10:30.933701 139691431679872 evaluation.py:167] Evaluation [9/10]
INFO:tensorflow:Evaluation [10/10]
I0410 04:10:32.113300 139691431679872 evaluation.py:167] Evaluation [10/10]
INFO:tensorflow:Inference Time : 15.98728s
I0410 04:10:32.340245 139691431679872 evaluation.py:273] Inference Time : 15.98728s
INFO:tensorflow:Finished evaluation at 2020-04-10-04:10:32
I0410 04:10:32.340444 139691431679872 evaluation.py:276] Finished evaluation at 2020-04-10-04:10:32
INFO:tensorflow:Saving dict for global step 4800: accuracy = 1.0, global_step = 4800, loss = 0.03146915
I0410 04:10:32.340585 139691431679872 estimator.py:2066] Saving dict for global step 4800: accuracy = 1.0, global_step = 4800, loss = 0.03146915
INFO:tensorflow:Saving 'checkpoint_path' summary for global step 4800: /tmp/absl_testing/429596/model.ckpt-4800
I0410 04:10:32.346541 139691431679872 estimator.py:2127] Saving 'checkpoint_path' summary for global step 4800: /tmp/absl_testing/429596/model.ckpt-4800
INFO:tensorflow:global_step/sec: 0.548371
I0410 04:10:33.797662 139691431679872 basic_session_run_hooks.py:702] global_step/sec: 0.548371
INFO:tensorflow:loss = 0.006123212, step = 4800 (182.358 sec)
I0410 04:10:33.798659 139691431679872 basic_session_run_hooks.py:260] loss = 0.006123212, step = 4800 (182.358 sec)
INFO:tensorflow:global_step/sec: 0.681173
I0410 04:13:00.603352 139691431679872 basic_session_run_hooks.py:702] global_step/sec: 0.681173
INFO:tensorflow:loss = 0.0030984594, step = 4900 (146.806 sec)
I0410 04:13:00.604972 139691431679872 basic_session_run_hooks.py:260] loss = 0.0030984594, step = 4900 (146.806 sec)
INFO:tensorflow:Calling checkpoint listeners before saving checkpoint 5000...
I0410 04:15:25.956598 139691431679872 basic_session_run_hooks.py:614] Calling checkpoint listeners before saving checkpoint 5000...
INFO:tensorflow:Saving checkpoints for 5000 into /tmp/absl_testing/429596/model.ckpt.
I0410 04:15:25.956856 139691431679872 basic_session_run_hooks.py:618] Saving checkpoints for 5000 into /tmp/absl_testing/429596/model.ckpt.
INFO:tensorflow:Calling checkpoint listeners after saving checkpoint 5000...
I0410 04:15:43.822666 139691431679872 basic_session_run_hooks.py:626] Calling checkpoint listeners after saving checkpoint 5000...
INFO:tensorflow:Skip the current checkpoint eval due to throttle secs (600 secs).
I0410 04:15:43.822945 139691431679872 training.py:528] Skip the current checkpoint eval due to throttle secs (600 secs).
INFO:tensorflow:global_step/sec: 0.607114
I0410 04:15:45.316946 139691431679872 basic_session_run_hooks.py:702] global_step/sec: 0.607114
INFO:tensorflow:loss = 0.005021896, step = 5000 (164.713 sec)
I0410 04:15:45.317958 139691431679872 basic_session_run_hooks.py:260] loss = 0.005021896, step = 5000 (164.713 sec)
INFO:tensorflow:global_step/sec: 0.679778
I0410 04:18:12.423789 139691431679872 basic_session_run_hooks.py:702] global_step/sec: 0.679778
INFO:tensorflow:loss = 0.0016304894, step = 5100 (147.107 sec)
I0410 04:18:12.424938 139691431679872 basic_session_run_hooks.py:260] loss = 0.0016304894, step = 5100 (147.107 sec)
INFO:tensorflow:Calling checkpoint listeners before saving checkpoint 5200...
I0410 04:20:38.017138 139691431679872 basic_session_run_hooks.py:614] Calling checkpoint listeners before saving checkpoint 5200...
INFO:tensorflow:Saving checkpoints for 5200 into /tmp/absl_testing/429596/model.ckpt.
I0410 04:20:38.017459 139691431679872 basic_session_run_hooks.py:618] Saving checkpoints for 5200 into /tmp/absl_testing/429596/model.ckpt.
INFO:tensorflow:Calling checkpoint listeners after saving checkpoint 5200...
I0410 04:20:55.766278 139691431679872 basic_session_run_hooks.py:626] Calling checkpoint listeners after saving checkpoint 5200...
--------------------------------------------datasets.py/eval_input_fn,s
W0410 04:20:56.038785 139691431679872 datasets.py:170] No TPUContext, using unmodified dataset seed 547.
I0410 04:20:56.039015 139691431679872 datasets.py:348] eval_input_fn(): params={'use_tpu': False, 'train_batch_size': 8, 'batch_size': 8} seed=547
--------befor self._load_dataset------------------split = validation self._eval_split= validation
--------------------------------------------datasets.py/_load_dataset,s
!!!!!!!!!!!!!!!!!!!!!!----load_local_datasets,  _local_test_ds_dir= /content/drive/My Drive/drive/gan/test
-----------------------------------------get_local_datasets,s
-----------------------------------------get_local_datasets,e
--------------------------------------------modular_gan.py/_preprocess_fn,s
I0410 04:20:56.120796 139691431679872 api.py:587] _preprocess_fn(): images=Tensor("args_0:0", shape=(128, 128, 3), dtype=float32), labels=Tensor("args_1:0", shape=(), dtype=int32), seed=547
--------------------------------------------modular_gan.py/_preprocess_fn,e
I0410 04:20:56.148316 139691431679872 api.py:587] Passing random offset: Tensor("Cast:0", shape=(), dtype=int32) with data ({'images': <tf.Tensor 'args_1:0' shape=(128, 128, 3) dtype=float32>, 'z': <tf.Tensor 'args_3:0' shape=(120,) dtype=float32>, 'sampled_labels': <tf.Tensor 'args_2:0' shape=() dtype=int32>}, <tf.Tensor 'args_4:0' shape=() dtype=int32>).
--------------------------------------------datasets.py/eval_input_fn,e
INFO:tensorflow:Calling model_fn.
I0410 04:20:56.163966 139691431679872 estimator.py:1169] Calling model_fn.
--------------------------------------------modular_gan.py/model_fn,s
I0410 04:20:56.164112 139691431679872 modular_gan.py:589] model_fn(): features={'images': <tf.Tensor 'IteratorGetNext:1' shape=(8, 128, 128, 3) dtype=float32>, 'z': <tf.Tensor 'IteratorGetNext:3' shape=(8, 120) dtype=float32>, 'sampled_labels': <tf.Tensor 'IteratorGetNext:2' shape=(8,) dtype=int32>, '_RANDOM_OFFSET': <tf.Tensor 'IteratorGetNext:0' shape=(8,) dtype=int32>}, labels=Tensor("IteratorGetNext:4", shape=(8,), dtype=int32),mode=eval, params={'use_tpu': False, 'train_batch_size': 8, 'batch_size': 8}
#Clean old summaries from previous calls to model_fn().
# Get features and labels for each sub-step.
--------------------------------------------modular_gan.py/_split_inputs_and_generate_samples,s
I0410 04:20:56.170881 139691431679872 resnet_biggan.py:236] [Generator] inputs are z=(8, 120), y=(8, 2)
I0410 04:20:56.180834 139691431679872 resnet_biggan.py:262] [Generator] z0=(8, 20), z_per_block=['(8, 20)', '(8, 20)', '(8, 20)', '(8, 20)', '(8, 20)'], y_per_block=['(8, 148)', '(8, 148)', '(8, 148)', '(8, 148)', '(8, 148)']
I0410 04:20:56.227439 139691431679872 resnet_biggan.py:150] [Block] (8, 4, 4, 1536) (z=(8, 20), y=(8, 148)) -> (8, 8, 8, 1536)
I0410 04:20:56.273366 139691431679872 resnet_biggan.py:150] [Block] (8, 8, 8, 1536) (z=(8, 20), y=(8, 148)) -> (8, 16, 16, 768)
I0410 04:20:56.316350 139691431679872 resnet_biggan.py:150] [Block] (8, 16, 16, 768) (z=(8, 20), y=(8, 148)) -> (8, 32, 32, 384)
I0410 04:20:56.353584 139691431679872 resnet_biggan.py:150] [Block] (8, 32, 32, 384) (z=(8, 20), y=(8, 148)) -> (8, 64, 64, 192)
I0410 04:20:56.353746 139691431679872 resnet_biggan.py:289] [Generator] Applying non-local block to (8, 64, 64, 192)
I0410 04:20:56.431099 139691431679872 resnet_biggan.py:150] [Block] (8, 64, 64, 192) (z=(8, 20), y=(8, 148)) -> (8, 128, 128, 96)
I0410 04:20:56.431262 139691431679872 resnet_biggan.py:294] [Generator] before final processing: (8, 128, 128, 96)
I0410 04:20:56.461204 139691431679872 resnet_biggan.py:300] [Generator] after final processing: (8, 128, 128, 3)
--------------------------------------------modular_gan.py/_split_inputs_and_generate_samples,e
---------------------------------------------------modular_gan.py/create_logits,s
I0410 04:20:56.464544 139691431679872 tpu_random.py:86] Got global random offset: Tensor("strided_slice:0", shape=(), dtype=int32)
---------------------------------------------------s3gan.py/create_loss,s
W0410 04:20:56.467226 139691431679872 s3gan.py:237] Computing fake images for every sub step separately.
I0410 04:20:56.467418 139691431679872 resnet_biggan.py:236] [Generator] inputs are z=(8, 120), y=(8, 2)
I0410 04:20:56.472624 139691431679872 resnet_biggan.py:262] [Generator] z0=(8, 20), z_per_block=['(8, 20)', '(8, 20)', '(8, 20)', '(8, 20)', '(8, 20)'], y_per_block=['(8, 148)', '(8, 148)', '(8, 148)', '(8, 148)', '(8, 148)']
I0410 04:20:56.490210 139691431679872 resnet_biggan.py:150] [Block] (8, 4, 4, 1536) (z=(8, 20), y=(8, 148)) -> (8, 8, 8, 1536)
I0410 04:20:56.505507 139691431679872 resnet_biggan.py:150] [Block] (8, 8, 8, 1536) (z=(8, 20), y=(8, 148)) -> (8, 16, 16, 768)
I0410 04:20:56.523302 139691431679872 resnet_biggan.py:150] [Block] (8, 16, 16, 768) (z=(8, 20), y=(8, 148)) -> (8, 32, 32, 384)
I0410 04:20:56.538691 139691431679872 resnet_biggan.py:150] [Block] (8, 32, 32, 384) (z=(8, 20), y=(8, 148)) -> (8, 64, 64, 192)
I0410 04:20:56.538856 139691431679872 resnet_biggan.py:289] [Generator] Applying non-local block to (8, 64, 64, 192)
I0410 04:20:56.571217 139691431679872 resnet_biggan.py:150] [Block] (8, 64, 64, 192) (z=(8, 20), y=(8, 148)) -> (8, 128, 128, 96)
I0410 04:20:56.571387 139691431679872 resnet_biggan.py:294] [Generator] before final processing: (8, 128, 128, 96)
I0410 04:20:56.585375 139691431679872 resnet_biggan.py:300] [Generator] after final processing: (8, 128, 128, 3)
I0410 04:20:56.587073 139691431679872 s3gan.py:249] bs=8, rotated_bs=4, num_rot_examples=1
---------------------------------------------------s3gan.py/merge_with_rotation_data,s
---------------------------------------------------s3gan.py/merge_with_rotation_data,e
--------------------------------------------------------------------s3gan.py/discriminator_with_additonal_heads,s
I0410 04:20:56.610980 139691431679872 resnet_biggan.py:379] [Discriminator] inputs are x=(22, 128, 128, 3), y=(22, 2)
I0410 04:20:56.641050 139691431679872 resnet_biggan.py:150] [Block] (22, 128, 128, 3) (z=None, y=(22, 2)) -> (22, 64, 64, 96)
I0410 04:20:56.641227 139691431679872 resnet_biggan.py:398] [Discriminator] Applying non-local block to (22, 64, 64, 96)
I0410 04:20:56.708777 139691431679872 resnet_biggan.py:150] [Block] (22, 64, 64, 96) (z=None, y=(22, 2)) -> (22, 32, 32, 192)
I0410 04:20:56.742105 139691431679872 resnet_biggan.py:150] [Block] (22, 32, 32, 192) (z=None, y=(22, 2)) -> (22, 16, 16, 384)
I0410 04:20:56.773416 139691431679872 resnet_biggan.py:150] [Block] (22, 16, 16, 384) (z=None, y=(22, 2)) -> (22, 8, 8, 768)
I0410 04:20:56.803933 139691431679872 resnet_biggan.py:150] [Block] (22, 8, 8, 768) (z=None, y=(22, 2)) -> (22, 4, 4, 1536)
I0410 04:20:56.823015 139691431679872 resnet_biggan.py:150] [Block] (22, 4, 4, 1536) (z=None, y=(22, 2)) -> (22, 4, 4, 1536)
I0410 04:20:56.823156 139691431679872 resnet_biggan.py:403] [Discriminator] before final processing: (22, 4, 4, 1536)
I0410 04:20:56.833261 139691431679872 resnet_biggan.py:407] [Discriminator] after final processing: (22, 4, 4, 1536)
I0410 04:20:56.839248 139691431679872 resnet_biggan.py:422] [Discriminator] embedded_y for projection: (22, 1536)
I0410 04:20:56.851290 139691431679872 s3gan.py:133] [Discriminator] rotation head (22, 1536) -> Tensor("discriminator_rotation/score_classify/add:0", shape=(22, 4), dtype=float32)
I0410 04:20:56.863649 139691431679872 s3gan.py:154] [Discriminator] (22, 2) -> aux_logits=(22, 2), y_predicted=(22, 2)
---------------------------------------------------s3gan.py/get_class_embedding,s
I0410 04:20:56.869768 139691431679872 s3gan.py:175] [Discriminator] embedded_y for projection: (22, 1536)
---------------------------------------------------s3gan.py/get_class_embedding,e
---------------------------------------------------s3gan.py/discriminator_with_additonal_heads,e
---------------------------------------------------s3gan.py/create_loss,e
---------------------------------------------------modular_gan.py/create_logits,e
################################################## mode == tf.estimator.ModeKeys.EVAL  ########################
INFO:tensorflow:Done calling model_fn.
I0410 04:20:56.954947 139691431679872 estimator.py:1171] Done calling model_fn.
INFO:tensorflow:Starting evaluation at 2020-04-10T04:20:56Z
I0410 04:20:56.970125 139691431679872 evaluation.py:255] Starting evaluation at 2020-04-10T04:20:56Z
INFO:tensorflow:Graph was finalized.
I0410 04:20:57.102499 139691431679872 monitored_session.py:246] Graph was finalized.
2020-04-10 04:20:57.103157: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-04-10 04:20:57.103475: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:00:04.0 name: Tesla P4 computeCapability: 6.1
coreClock: 1.1135GHz coreCount: 20 deviceMemorySize: 7.43GiB deviceMemoryBandwidth: 178.99GiB/s
2020-04-10 04:20:57.103522: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.1
2020-04-10 04:20:57.103545: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10
2020-04-10 04:20:57.103562: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcufft.so.10
2020-04-10 04:20:57.103579: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcurand.so.10
2020-04-10 04:20:57.103594: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusolver.so.10
2020-04-10 04:20:57.103639: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusparse.so.10
2020-04-10 04:20:57.103654: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudnn.so.7
2020-04-10 04:20:57.103724: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-04-10 04:20:57.104039: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-04-10 04:20:57.104245: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1703] Adding visible gpu devices: 0
2020-04-10 04:20:57.104285: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-04-10 04:20:57.104299: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      0 
2020-04-10 04:20:57.104310: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1121] 0:   N 
2020-04-10 04:20:57.104430: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-04-10 04:20:57.104879: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-04-10 04:20:57.105122: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1247] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 6850 MB memory) -> physical GPU (device: 0, name: Tesla P4, pci bus id: 0000:00:04.0, compute capability: 6.1)
INFO:tensorflow:Restoring parameters from /tmp/absl_testing/429596/model.ckpt-5200
I0410 04:20:57.106044 139691431679872 saver.py:1293] Restoring parameters from /tmp/absl_testing/429596/model.ckpt-5200
INFO:tensorflow:Running local_init_op.
I0410 04:20:57.535097 139691431679872 session_manager.py:505] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
I0410 04:20:57.557871 139691431679872 session_manager.py:508] Done running local_init_op.
INFO:tensorflow:Evaluation [1/10]
I0410 04:21:00.432553 139691431679872 evaluation.py:167] Evaluation [1/10]
INFO:tensorflow:Evaluation [2/10]
I0410 04:21:02.596124 139691431679872 evaluation.py:167] Evaluation [2/10]
INFO:tensorflow:Evaluation [3/10]
I0410 04:21:04.002481 139691431679872 evaluation.py:167] Evaluation [3/10]
INFO:tensorflow:Evaluation [4/10]
I0410 04:21:05.905901 139691431679872 evaluation.py:167] Evaluation [4/10]
INFO:tensorflow:Evaluation [5/10]
I0410 04:21:06.201252 139691431679872 evaluation.py:167] Evaluation [5/10]
INFO:tensorflow:Evaluation [6/10]
I0410 04:21:07.331081 139691431679872 evaluation.py:167] Evaluation [6/10]
INFO:tensorflow:Evaluation [7/10]
I0410 04:21:09.614652 139691431679872 evaluation.py:167] Evaluation [7/10]
INFO:tensorflow:Evaluation [8/10]
I0410 04:21:10.283774 139691431679872 evaluation.py:167] Evaluation [8/10]
INFO:tensorflow:Evaluation [9/10]
I0410 04:21:11.950732 139691431679872 evaluation.py:167] Evaluation [9/10]
INFO:tensorflow:Evaluation [10/10]
I0410 04:21:13.073217 139691431679872 evaluation.py:167] Evaluation [10/10]
INFO:tensorflow:Inference Time : 16.44398s
I0410 04:21:13.414256 139691431679872 evaluation.py:273] Inference Time : 16.44398s
INFO:tensorflow:Finished evaluation at 2020-04-10-04:21:13
I0410 04:21:13.414462 139691431679872 evaluation.py:276] Finished evaluation at 2020-04-10-04:21:13
INFO:tensorflow:Saving dict for global step 5200: accuracy = 1.0, global_step = 5200, loss = 0.036280546
I0410 04:21:13.414599 139691431679872 estimator.py:2066] Saving dict for global step 5200: accuracy = 1.0, global_step = 5200, loss = 0.036280546
INFO:tensorflow:Saving 'checkpoint_path' summary for global step 5200: /tmp/absl_testing/429596/model.ckpt-5200
I0410 04:21:13.415088 139691431679872 estimator.py:2127] Saving 'checkpoint_path' summary for global step 5200: /tmp/absl_testing/429596/model.ckpt-5200
INFO:tensorflow:global_step/sec: 0.548086
I0410 04:21:14.877000 139691431679872 basic_session_run_hooks.py:702] global_step/sec: 0.548086
INFO:tensorflow:loss = 0.00037988718, step = 5200 (182.453 sec)
I0410 04:21:14.877901 139691431679872 basic_session_run_hooks.py:260] loss = 0.00037988718, step = 5200 (182.453 sec)
INFO:tensorflow:global_step/sec: 0.680838
I0410 04:23:41.754720 139691431679872 basic_session_run_hooks.py:702] global_step/sec: 0.680838
INFO:tensorflow:loss = 0.00018966211, step = 5300 (146.878 sec)
I0410 04:23:41.755691 139691431679872 basic_session_run_hooks.py:260] loss = 0.00018966211, step = 5300 (146.878 sec)
INFO:tensorflow:Calling checkpoint listeners before saving checkpoint 5400...
I0410 04:26:07.479483 139691431679872 basic_session_run_hooks.py:614] Calling checkpoint listeners before saving checkpoint 5400...
INFO:tensorflow:Saving checkpoints for 5400 into /tmp/absl_testing/429596/model.ckpt.
I0410 04:26:07.479712 139691431679872 basic_session_run_hooks.py:618] Saving checkpoints for 5400 into /tmp/absl_testing/429596/model.ckpt.
INFO:tensorflow:Calling checkpoint listeners after saving checkpoint 5400...
I0410 04:26:25.758742 139691431679872 basic_session_run_hooks.py:626] Calling checkpoint listeners after saving checkpoint 5400...
INFO:tensorflow:Skip the current checkpoint eval due to throttle secs (600 secs).
I0410 04:26:25.759076 139691431679872 training.py:528] Skip the current checkpoint eval due to throttle secs (600 secs).
INFO:tensorflow:global_step/sec: 0.604247
I0410 04:26:27.249966 139691431679872 basic_session_run_hooks.py:702] global_step/sec: 0.604247
INFO:tensorflow:loss = 0.012617039, step = 5400 (165.495 sec)
I0410 04:26:27.250851 139691431679872 basic_session_run_hooks.py:260] loss = 0.012617039, step = 5400 (165.495 sec)
INFO:tensorflow:global_step/sec: 0.680412
I0410 04:28:54.219747 139691431679872 basic_session_run_hooks.py:702] global_step/sec: 0.680412
INFO:tensorflow:loss = 0.034707278, step = 5500 (146.970 sec)
I0410 04:28:54.220991 139691431679872 basic_session_run_hooks.py:260] loss = 0.034707278, step = 5500 (146.970 sec)
INFO:tensorflow:Calling checkpoint listeners before saving checkpoint 5600...
I0410 04:31:19.882672 139691431679872 basic_session_run_hooks.py:614] Calling checkpoint listeners before saving checkpoint 5600...
INFO:tensorflow:Saving checkpoints for 5600 into /tmp/absl_testing/429596/model.ckpt.
I0410 04:31:19.882922 139691431679872 basic_session_run_hooks.py:618] Saving checkpoints for 5600 into /tmp/absl_testing/429596/model.ckpt.
INFO:tensorflow:Calling checkpoint listeners after saving checkpoint 5600...
I0410 04:31:37.537327 139691431679872 basic_session_run_hooks.py:626] Calling checkpoint listeners after saving checkpoint 5600...
--------------------------------------------datasets.py/eval_input_fn,s
W0410 04:31:37.896574 139691431679872 datasets.py:170] No TPUContext, using unmodified dataset seed 547.
I0410 04:31:37.896725 139691431679872 datasets.py:348] eval_input_fn(): params={'use_tpu': False, 'train_batch_size': 8, 'batch_size': 8} seed=547
--------befor self._load_dataset------------------split = validation self._eval_split= validation
--------------------------------------------datasets.py/_load_dataset,s
!!!!!!!!!!!!!!!!!!!!!!----load_local_datasets,  _local_test_ds_dir= /content/drive/My Drive/drive/gan/test
-----------------------------------------get_local_datasets,s
-----------------------------------------get_local_datasets,e
--------------------------------------------modular_gan.py/_preprocess_fn,s
I0410 04:31:37.976611 139691431679872 api.py:587] _preprocess_fn(): images=Tensor("args_0:0", shape=(128, 128, 3), dtype=float32), labels=Tensor("args_1:0", shape=(), dtype=int32), seed=547
--------------------------------------------modular_gan.py/_preprocess_fn,e
I0410 04:31:38.004702 139691431679872 api.py:587] Passing random offset: Tensor("Cast:0", shape=(), dtype=int32) with data ({'images': <tf.Tensor 'args_1:0' shape=(128, 128, 3) dtype=float32>, 'z': <tf.Tensor 'args_3:0' shape=(120,) dtype=float32>, 'sampled_labels': <tf.Tensor 'args_2:0' shape=() dtype=int32>}, <tf.Tensor 'args_4:0' shape=() dtype=int32>).
--------------------------------------------datasets.py/eval_input_fn,e
INFO:tensorflow:Calling model_fn.
I0410 04:31:38.020056 139691431679872 estimator.py:1169] Calling model_fn.
--------------------------------------------modular_gan.py/model_fn,s
I0410 04:31:38.020206 139691431679872 modular_gan.py:589] model_fn(): features={'images': <tf.Tensor 'IteratorGetNext:1' shape=(8, 128, 128, 3) dtype=float32>, 'z': <tf.Tensor 'IteratorGetNext:3' shape=(8, 120) dtype=float32>, 'sampled_labels': <tf.Tensor 'IteratorGetNext:2' shape=(8,) dtype=int32>, '_RANDOM_OFFSET': <tf.Tensor 'IteratorGetNext:0' shape=(8,) dtype=int32>}, labels=Tensor("IteratorGetNext:4", shape=(8,), dtype=int32),mode=eval, params={'use_tpu': False, 'train_batch_size': 8, 'batch_size': 8}
#Clean old summaries from previous calls to model_fn().
# Get features and labels for each sub-step.
--------------------------------------------modular_gan.py/_split_inputs_and_generate_samples,s
I0410 04:31:38.026730 139691431679872 resnet_biggan.py:236] [Generator] inputs are z=(8, 120), y=(8, 2)
I0410 04:31:38.036576 139691431679872 resnet_biggan.py:262] [Generator] z0=(8, 20), z_per_block=['(8, 20)', '(8, 20)', '(8, 20)', '(8, 20)', '(8, 20)'], y_per_block=['(8, 148)', '(8, 148)', '(8, 148)', '(8, 148)', '(8, 148)']
I0410 04:31:38.083696 139691431679872 resnet_biggan.py:150] [Block] (8, 4, 4, 1536) (z=(8, 20), y=(8, 148)) -> (8, 8, 8, 1536)
I0410 04:31:38.124621 139691431679872 resnet_biggan.py:150] [Block] (8, 8, 8, 1536) (z=(8, 20), y=(8, 148)) -> (8, 16, 16, 768)
I0410 04:31:38.162643 139691431679872 resnet_biggan.py:150] [Block] (8, 16, 16, 768) (z=(8, 20), y=(8, 148)) -> (8, 32, 32, 384)
I0410 04:31:38.203919 139691431679872 resnet_biggan.py:150] [Block] (8, 32, 32, 384) (z=(8, 20), y=(8, 148)) -> (8, 64, 64, 192)
I0410 04:31:38.204090 139691431679872 resnet_biggan.py:289] [Generator] Applying non-local block to (8, 64, 64, 192)
I0410 04:31:38.280306 139691431679872 resnet_biggan.py:150] [Block] (8, 64, 64, 192) (z=(8, 20), y=(8, 148)) -> (8, 128, 128, 96)
I0410 04:31:38.280472 139691431679872 resnet_biggan.py:294] [Generator] before final processing: (8, 128, 128, 96)
I0410 04:31:38.310948 139691431679872 resnet_biggan.py:300] [Generator] after final processing: (8, 128, 128, 3)
--------------------------------------------modular_gan.py/_split_inputs_and_generate_samples,e
---------------------------------------------------modular_gan.py/create_logits,s
I0410 04:31:38.314260 139691431679872 tpu_random.py:86] Got global random offset: Tensor("strided_slice:0", shape=(), dtype=int32)
---------------------------------------------------s3gan.py/create_loss,s
W0410 04:31:38.316933 139691431679872 s3gan.py:237] Computing fake images for every sub step separately.
I0410 04:31:38.317126 139691431679872 resnet_biggan.py:236] [Generator] inputs are z=(8, 120), y=(8, 2)
I0410 04:31:38.322986 139691431679872 resnet_biggan.py:262] [Generator] z0=(8, 20), z_per_block=['(8, 20)', '(8, 20)', '(8, 20)', '(8, 20)', '(8, 20)'], y_per_block=['(8, 148)', '(8, 148)', '(8, 148)', '(8, 148)', '(8, 148)']
I0410 04:31:38.341373 139691431679872 resnet_biggan.py:150] [Block] (8, 4, 4, 1536) (z=(8, 20), y=(8, 148)) -> (8, 8, 8, 1536)
I0410 04:31:38.356824 139691431679872 resnet_biggan.py:150] [Block] (8, 8, 8, 1536) (z=(8, 20), y=(8, 148)) -> (8, 16, 16, 768)
I0410 04:31:38.373390 139691431679872 resnet_biggan.py:150] [Block] (8, 16, 16, 768) (z=(8, 20), y=(8, 148)) -> (8, 32, 32, 384)
I0410 04:31:38.388978 139691431679872 resnet_biggan.py:150] [Block] (8, 32, 32, 384) (z=(8, 20), y=(8, 148)) -> (8, 64, 64, 192)
I0410 04:31:38.389136 139691431679872 resnet_biggan.py:289] [Generator] Applying non-local block to (8, 64, 64, 192)
I0410 04:31:38.428219 139691431679872 resnet_biggan.py:150] [Block] (8, 64, 64, 192) (z=(8, 20), y=(8, 148)) -> (8, 128, 128, 96)
I0410 04:31:38.428388 139691431679872 resnet_biggan.py:294] [Generator] before final processing: (8, 128, 128, 96)
I0410 04:31:38.442370 139691431679872 resnet_biggan.py:300] [Generator] after final processing: (8, 128, 128, 3)
I0410 04:31:38.444023 139691431679872 s3gan.py:249] bs=8, rotated_bs=4, num_rot_examples=1
---------------------------------------------------s3gan.py/merge_with_rotation_data,s
---------------------------------------------------s3gan.py/merge_with_rotation_data,e
--------------------------------------------------------------------s3gan.py/discriminator_with_additonal_heads,s
I0410 04:31:38.468791 139691431679872 resnet_biggan.py:379] [Discriminator] inputs are x=(22, 128, 128, 3), y=(22, 2)
I0410 04:31:38.502172 139691431679872 resnet_biggan.py:150] [Block] (22, 128, 128, 3) (z=None, y=(22, 2)) -> (22, 64, 64, 96)
I0410 04:31:38.502317 139691431679872 resnet_biggan.py:398] [Discriminator] Applying non-local block to (22, 64, 64, 96)
I0410 04:31:38.571410 139691431679872 resnet_biggan.py:150] [Block] (22, 64, 64, 96) (z=None, y=(22, 2)) -> (22, 32, 32, 192)
I0410 04:31:38.601990 139691431679872 resnet_biggan.py:150] [Block] (22, 32, 32, 192) (z=None, y=(22, 2)) -> (22, 16, 16, 384)
I0410 04:31:38.631879 139691431679872 resnet_biggan.py:150] [Block] (22, 16, 16, 384) (z=None, y=(22, 2)) -> (22, 8, 8, 768)
I0410 04:31:38.663008 139691431679872 resnet_biggan.py:150] [Block] (22, 8, 8, 768) (z=None, y=(22, 2)) -> (22, 4, 4, 1536)
I0410 04:31:38.683956 139691431679872 resnet_biggan.py:150] [Block] (22, 4, 4, 1536) (z=None, y=(22, 2)) -> (22, 4, 4, 1536)
I0410 04:31:38.684103 139691431679872 resnet_biggan.py:403] [Discriminator] before final processing: (22, 4, 4, 1536)
I0410 04:31:38.694062 139691431679872 resnet_biggan.py:407] [Discriminator] after final processing: (22, 4, 4, 1536)
I0410 04:31:38.699972 139691431679872 resnet_biggan.py:422] [Discriminator] embedded_y for projection: (22, 1536)
I0410 04:31:38.711930 139691431679872 s3gan.py:133] [Discriminator] rotation head (22, 1536) -> Tensor("discriminator_rotation/score_classify/add:0", shape=(22, 4), dtype=float32)
I0410 04:31:38.724346 139691431679872 s3gan.py:154] [Discriminator] (22, 2) -> aux_logits=(22, 2), y_predicted=(22, 2)
---------------------------------------------------s3gan.py/get_class_embedding,s
I0410 04:31:38.730318 139691431679872 s3gan.py:175] [Discriminator] embedded_y for projection: (22, 1536)
---------------------------------------------------s3gan.py/get_class_embedding,e
---------------------------------------------------s3gan.py/discriminator_with_additonal_heads,e
---------------------------------------------------s3gan.py/create_loss,e
---------------------------------------------------modular_gan.py/create_logits,e
################################################## mode == tf.estimator.ModeKeys.EVAL  ########################
INFO:tensorflow:Done calling model_fn.
I0410 04:31:38.814530 139691431679872 estimator.py:1171] Done calling model_fn.
INFO:tensorflow:Starting evaluation at 2020-04-10T04:31:38Z
I0410 04:31:38.829991 139691431679872 evaluation.py:255] Starting evaluation at 2020-04-10T04:31:38Z
INFO:tensorflow:Graph was finalized.
I0410 04:31:38.970118 139691431679872 monitored_session.py:246] Graph was finalized.
2020-04-10 04:31:38.970777: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-04-10 04:31:38.971102: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:00:04.0 name: Tesla P4 computeCapability: 6.1
coreClock: 1.1135GHz coreCount: 20 deviceMemorySize: 7.43GiB deviceMemoryBandwidth: 178.99GiB/s
2020-04-10 04:31:38.971157: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.1
2020-04-10 04:31:38.971180: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10
2020-04-10 04:31:38.971198: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcufft.so.10
2020-04-10 04:31:38.971214: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcurand.so.10
2020-04-10 04:31:38.971228: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusolver.so.10
2020-04-10 04:31:38.971273: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusparse.so.10
2020-04-10 04:31:38.971289: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudnn.so.7
2020-04-10 04:31:38.971367: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-04-10 04:31:38.971635: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-04-10 04:31:38.971860: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1703] Adding visible gpu devices: 0
2020-04-10 04:31:38.971908: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-04-10 04:31:38.971923: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      0 
2020-04-10 04:31:38.971934: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1121] 0:   N 
2020-04-10 04:31:38.972025: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-04-10 04:31:38.972281: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-04-10 04:31:38.972505: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1247] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 6850 MB memory) -> physical GPU (device: 0, name: Tesla P4, pci bus id: 0000:00:04.0, compute capability: 6.1)
INFO:tensorflow:Restoring parameters from /tmp/absl_testing/429596/model.ckpt-5600
I0410 04:31:38.973384 139691431679872 saver.py:1293] Restoring parameters from /tmp/absl_testing/429596/model.ckpt-5600
INFO:tensorflow:Running local_init_op.
I0410 04:31:39.384751 139691431679872 session_manager.py:505] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
I0410 04:31:39.406155 139691431679872 session_manager.py:508] Done running local_init_op.
INFO:tensorflow:Evaluation [1/10]
I0410 04:31:41.858201 139691431679872 evaluation.py:167] Evaluation [1/10]
INFO:tensorflow:Evaluation [2/10]
I0410 04:31:42.157588 139691431679872 evaluation.py:167] Evaluation [2/10]
INFO:tensorflow:Evaluation [3/10]
I0410 04:31:43.331238 139691431679872 evaluation.py:167] Evaluation [3/10]
INFO:tensorflow:Evaluation [4/10]
I0410 04:31:45.006738 139691431679872 evaluation.py:167] Evaluation [4/10]
INFO:tensorflow:Evaluation [5/10]
I0410 04:31:46.040727 139691431679872 evaluation.py:167] Evaluation [5/10]
INFO:tensorflow:Evaluation [6/10]
I0410 04:31:46.946368 139691431679872 evaluation.py:167] Evaluation [6/10]
INFO:tensorflow:Evaluation [7/10]
I0410 04:31:47.326348 139691431679872 evaluation.py:167] Evaluation [7/10]
INFO:tensorflow:Evaluation [8/10]
I0410 04:31:49.797203 139691431679872 evaluation.py:167] Evaluation [8/10]
INFO:tensorflow:Evaluation [9/10]
I0410 04:31:51.501941 139691431679872 evaluation.py:167] Evaluation [9/10]
INFO:tensorflow:Evaluation [10/10]
I0410 04:31:52.432608 139691431679872 evaluation.py:167] Evaluation [10/10]
INFO:tensorflow:Inference Time : 13.83816s
I0410 04:31:52.668295 139691431679872 evaluation.py:273] Inference Time : 13.83816s
INFO:tensorflow:Finished evaluation at 2020-04-10-04:31:52
I0410 04:31:52.668496 139691431679872 evaluation.py:276] Finished evaluation at 2020-04-10-04:31:52
INFO:tensorflow:Saving dict for global step 5600: accuracy = 0.975, global_step = 5600, loss = 0.20711048
I0410 04:31:52.668637 139691431679872 estimator.py:2066] Saving dict for global step 5600: accuracy = 0.975, global_step = 5600, loss = 0.20711048
INFO:tensorflow:Saving 'checkpoint_path' summary for global step 5600: /tmp/absl_testing/429596/model.ckpt-5600
I0410 04:31:52.669138 139691431679872 estimator.py:2127] Saving 'checkpoint_path' summary for global step 5600: /tmp/absl_testing/429596/model.ckpt-5600
INFO:tensorflow:global_step/sec: 0.555805
I0410 04:31:54.139039 139691431679872 basic_session_run_hooks.py:702] global_step/sec: 0.555805
INFO:tensorflow:loss = 0.15327589, step = 5600 (179.919 sec)
I0410 04:31:54.139891 139691431679872 basic_session_run_hooks.py:260] loss = 0.15327589, step = 5600 (179.919 sec)
INFO:tensorflow:global_step/sec: 0.67993
I0410 04:34:21.212994 139691431679872 basic_session_run_hooks.py:702] global_step/sec: 0.67993
INFO:tensorflow:loss = 0.046960678, step = 5700 (147.074 sec)
I0410 04:34:21.214077 139691431679872 basic_session_run_hooks.py:260] loss = 0.046960678, step = 5700 (147.074 sec)
INFO:tensorflow:Calling checkpoint listeners before saving checkpoint 5800...
I0410 04:36:46.884347 139691431679872 basic_session_run_hooks.py:614] Calling checkpoint listeners before saving checkpoint 5800...
INFO:tensorflow:Saving checkpoints for 5800 into /tmp/absl_testing/429596/model.ckpt.
I0410 04:36:46.884619 139691431679872 basic_session_run_hooks.py:618] Saving checkpoints for 5800 into /tmp/absl_testing/429596/model.ckpt.
INFO:tensorflow:Calling checkpoint listeners after saving checkpoint 5800...
I0410 04:37:02.917144 139691431679872 basic_session_run_hooks.py:626] Calling checkpoint listeners after saving checkpoint 5800...
INFO:tensorflow:Skip the current checkpoint eval due to throttle secs (600 secs).
I0410 04:37:02.917406 139691431679872 training.py:528] Skip the current checkpoint eval due to throttle secs (600 secs).
INFO:tensorflow:global_step/sec: 0.612776
I0410 04:37:04.404736 139691431679872 basic_session_run_hooks.py:702] global_step/sec: 0.612776
INFO:tensorflow:loss = 0.08063403, step = 5800 (163.192 sec)
I0410 04:37:04.405951 139691431679872 basic_session_run_hooks.py:260] loss = 0.08063403, step = 5800 (163.192 sec)
INFO:tensorflow:global_step/sec: 0.679406
I0410 04:39:31.592120 139691431679872 basic_session_run_hooks.py:702] global_step/sec: 0.679406
INFO:tensorflow:loss = 0.004486844, step = 5900 (147.187 sec)
I0410 04:39:31.592999 139691431679872 basic_session_run_hooks.py:260] loss = 0.004486844, step = 5900 (147.187 sec)
INFO:tensorflow:Calling checkpoint listeners before saving checkpoint 6000...
I0410 04:41:57.295634 139691431679872 basic_session_run_hooks.py:614] Calling checkpoint listeners before saving checkpoint 6000...
INFO:tensorflow:Saving checkpoints for 6000 into /tmp/absl_testing/429596/model.ckpt.
I0410 04:41:57.295897 139691431679872 basic_session_run_hooks.py:618] Saving checkpoints for 6000 into /tmp/absl_testing/429596/model.ckpt.
INFO:tensorflow:Calling checkpoint listeners after saving checkpoint 6000...
I0410 04:42:15.025596 139691431679872 basic_session_run_hooks.py:626] Calling checkpoint listeners after saving checkpoint 6000...
--------------------------------------------datasets.py/eval_input_fn,s
W0410 04:42:15.050032 139691431679872 datasets.py:170] No TPUContext, using unmodified dataset seed 547.
I0410 04:42:15.050173 139691431679872 datasets.py:348] eval_input_fn(): params={'use_tpu': False, 'train_batch_size': 8, 'batch_size': 8} seed=547
--------befor self._load_dataset------------------split = validation self._eval_split= validation
--------------------------------------------datasets.py/_load_dataset,s
!!!!!!!!!!!!!!!!!!!!!!----load_local_datasets,  _local_test_ds_dir= /content/drive/My Drive/drive/gan/test
-----------------------------------------get_local_datasets,s
-----------------------------------------get_local_datasets,e
--------------------------------------------modular_gan.py/_preprocess_fn,s
I0410 04:42:15.130489 139691431679872 api.py:587] _preprocess_fn(): images=Tensor("args_0:0", shape=(128, 128, 3), dtype=float32), labels=Tensor("args_1:0", shape=(), dtype=int32), seed=547
--------------------------------------------modular_gan.py/_preprocess_fn,e
I0410 04:42:15.158858 139691431679872 api.py:587] Passing random offset: Tensor("Cast:0", shape=(), dtype=int32) with data ({'images': <tf.Tensor 'args_1:0' shape=(128, 128, 3) dtype=float32>, 'z': <tf.Tensor 'args_3:0' shape=(120,) dtype=float32>, 'sampled_labels': <tf.Tensor 'args_2:0' shape=() dtype=int32>}, <tf.Tensor 'args_4:0' shape=() dtype=int32>).
--------------------------------------------datasets.py/eval_input_fn,e
INFO:tensorflow:Calling model_fn.
I0410 04:42:15.174657 139691431679872 estimator.py:1169] Calling model_fn.
--------------------------------------------modular_gan.py/model_fn,s
I0410 04:42:15.174830 139691431679872 modular_gan.py:589] model_fn(): features={'images': <tf.Tensor 'IteratorGetNext:1' shape=(8, 128, 128, 3) dtype=float32>, 'z': <tf.Tensor 'IteratorGetNext:3' shape=(8, 120) dtype=float32>, 'sampled_labels': <tf.Tensor 'IteratorGetNext:2' shape=(8,) dtype=int32>, '_RANDOM_OFFSET': <tf.Tensor 'IteratorGetNext:0' shape=(8,) dtype=int32>}, labels=Tensor("IteratorGetNext:4", shape=(8,), dtype=int32),mode=eval, params={'use_tpu': False, 'train_batch_size': 8, 'batch_size': 8}
#Clean old summaries from previous calls to model_fn().
# Get features and labels for each sub-step.
--------------------------------------------modular_gan.py/_split_inputs_and_generate_samples,s
I0410 04:42:15.181448 139691431679872 resnet_biggan.py:236] [Generator] inputs are z=(8, 120), y=(8, 2)
I0410 04:42:15.191369 139691431679872 resnet_biggan.py:262] [Generator] z0=(8, 20), z_per_block=['(8, 20)', '(8, 20)', '(8, 20)', '(8, 20)', '(8, 20)'], y_per_block=['(8, 148)', '(8, 148)', '(8, 148)', '(8, 148)', '(8, 148)']
I0410 04:42:15.242266 139691431679872 resnet_biggan.py:150] [Block] (8, 4, 4, 1536) (z=(8, 20), y=(8, 148)) -> (8, 8, 8, 1536)
I0410 04:42:15.280432 139691431679872 resnet_biggan.py:150] [Block] (8, 8, 8, 1536) (z=(8, 20), y=(8, 148)) -> (8, 16, 16, 768)
I0410 04:42:15.318182 139691431679872 resnet_biggan.py:150] [Block] (8, 16, 16, 768) (z=(8, 20), y=(8, 148)) -> (8, 32, 32, 384)
I0410 04:42:15.356153 139691431679872 resnet_biggan.py:150] [Block] (8, 32, 32, 384) (z=(8, 20), y=(8, 148)) -> (8, 64, 64, 192)
I0410 04:42:15.356303 139691431679872 resnet_biggan.py:289] [Generator] Applying non-local block to (8, 64, 64, 192)
I0410 04:42:15.438501 139691431679872 resnet_biggan.py:150] [Block] (8, 64, 64, 192) (z=(8, 20), y=(8, 148)) -> (8, 128, 128, 96)
I0410 04:42:15.438660 139691431679872 resnet_biggan.py:294] [Generator] before final processing: (8, 128, 128, 96)
I0410 04:42:15.470088 139691431679872 resnet_biggan.py:300] [Generator] after final processing: (8, 128, 128, 3)
--------------------------------------------modular_gan.py/_split_inputs_and_generate_samples,e
---------------------------------------------------modular_gan.py/create_logits,s
I0410 04:42:15.473652 139691431679872 tpu_random.py:86] Got global random offset: Tensor("strided_slice:0", shape=(), dtype=int32)
---------------------------------------------------s3gan.py/create_loss,s
W0410 04:42:15.476488 139691431679872 s3gan.py:237] Computing fake images for every sub step separately.
I0410 04:42:15.476688 139691431679872 resnet_biggan.py:236] [Generator] inputs are z=(8, 120), y=(8, 2)
I0410 04:42:15.483047 139691431679872 resnet_biggan.py:262] [Generator] z0=(8, 20), z_per_block=['(8, 20)', '(8, 20)', '(8, 20)', '(8, 20)', '(8, 20)'], y_per_block=['(8, 148)', '(8, 148)', '(8, 148)', '(8, 148)', '(8, 148)']
I0410 04:42:15.508184 139691431679872 resnet_biggan.py:150] [Block] (8, 4, 4, 1536) (z=(8, 20), y=(8, 148)) -> (8, 8, 8, 1536)
I0410 04:42:15.525628 139691431679872 resnet_biggan.py:150] [Block] (8, 8, 8, 1536) (z=(8, 20), y=(8, 148)) -> (8, 16, 16, 768)
I0410 04:42:15.541983 139691431679872 resnet_biggan.py:150] [Block] (8, 16, 16, 768) (z=(8, 20), y=(8, 148)) -> (8, 32, 32, 384)
I0410 04:42:15.557785 139691431679872 resnet_biggan.py:150] [Block] (8, 32, 32, 384) (z=(8, 20), y=(8, 148)) -> (8, 64, 64, 192)
I0410 04:42:15.557947 139691431679872 resnet_biggan.py:289] [Generator] Applying non-local block to (8, 64, 64, 192)
I0410 04:42:15.591030 139691431679872 resnet_biggan.py:150] [Block] (8, 64, 64, 192) (z=(8, 20), y=(8, 148)) -> (8, 128, 128, 96)
I0410 04:42:15.591183 139691431679872 resnet_biggan.py:294] [Generator] before final processing: (8, 128, 128, 96)
I0410 04:42:15.605334 139691431679872 resnet_biggan.py:300] [Generator] after final processing: (8, 128, 128, 3)
I0410 04:42:15.607013 139691431679872 s3gan.py:249] bs=8, rotated_bs=4, num_rot_examples=1
---------------------------------------------------s3gan.py/merge_with_rotation_data,s
---------------------------------------------------s3gan.py/merge_with_rotation_data,e
--------------------------------------------------------------------s3gan.py/discriminator_with_additonal_heads,s
I0410 04:42:15.843701 139691431679872 resnet_biggan.py:379] [Discriminator] inputs are x=(22, 128, 128, 3), y=(22, 2)
I0410 04:42:15.874647 139691431679872 resnet_biggan.py:150] [Block] (22, 128, 128, 3) (z=None, y=(22, 2)) -> (22, 64, 64, 96)
I0410 04:42:15.874831 139691431679872 resnet_biggan.py:398] [Discriminator] Applying non-local block to (22, 64, 64, 96)
I0410 04:42:15.943347 139691431679872 resnet_biggan.py:150] [Block] (22, 64, 64, 96) (z=None, y=(22, 2)) -> (22, 32, 32, 192)
I0410 04:42:15.975797 139691431679872 resnet_biggan.py:150] [Block] (22, 32, 32, 192) (z=None, y=(22, 2)) -> (22, 16, 16, 384)
I0410 04:42:16.006432 139691431679872 resnet_biggan.py:150] [Block] (22, 16, 16, 384) (z=None, y=(22, 2)) -> (22, 8, 8, 768)
I0410 04:42:16.036695 139691431679872 resnet_biggan.py:150] [Block] (22, 8, 8, 768) (z=None, y=(22, 2)) -> (22, 4, 4, 1536)
I0410 04:42:16.056211 139691431679872 resnet_biggan.py:150] [Block] (22, 4, 4, 1536) (z=None, y=(22, 2)) -> (22, 4, 4, 1536)
I0410 04:42:16.056360 139691431679872 resnet_biggan.py:403] [Discriminator] before final processing: (22, 4, 4, 1536)
I0410 04:42:16.066224 139691431679872 resnet_biggan.py:407] [Discriminator] after final processing: (22, 4, 4, 1536)
I0410 04:42:16.072001 139691431679872 resnet_biggan.py:422] [Discriminator] embedded_y for projection: (22, 1536)
I0410 04:42:16.084075 139691431679872 s3gan.py:133] [Discriminator] rotation head (22, 1536) -> Tensor("discriminator_rotation/score_classify/add:0", shape=(22, 4), dtype=float32)
I0410 04:42:16.098186 139691431679872 s3gan.py:154] [Discriminator] (22, 2) -> aux_logits=(22, 2), y_predicted=(22, 2)
---------------------------------------------------s3gan.py/get_class_embedding,s
I0410 04:42:16.105138 139691431679872 s3gan.py:175] [Discriminator] embedded_y for projection: (22, 1536)
---------------------------------------------------s3gan.py/get_class_embedding,e
---------------------------------------------------s3gan.py/discriminator_with_additonal_heads,e
---------------------------------------------------s3gan.py/create_loss,e
---------------------------------------------------modular_gan.py/create_logits,e
################################################## mode == tf.estimator.ModeKeys.EVAL  ########################
INFO:tensorflow:Done calling model_fn.
I0410 04:42:16.196317 139691431679872 estimator.py:1171] Done calling model_fn.
INFO:tensorflow:Starting evaluation at 2020-04-10T04:42:16Z
I0410 04:42:16.211859 139691431679872 evaluation.py:255] Starting evaluation at 2020-04-10T04:42:16Z
INFO:tensorflow:Graph was finalized.
I0410 04:42:16.351018 139691431679872 monitored_session.py:246] Graph was finalized.
2020-04-10 04:42:16.351605: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-04-10 04:42:16.351977: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:00:04.0 name: Tesla P4 computeCapability: 6.1
coreClock: 1.1135GHz coreCount: 20 deviceMemorySize: 7.43GiB deviceMemoryBandwidth: 178.99GiB/s
2020-04-10 04:42:16.352038: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.1
2020-04-10 04:42:16.352062: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10
2020-04-10 04:42:16.352080: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcufft.so.10
2020-04-10 04:42:16.352095: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcurand.so.10
2020-04-10 04:42:16.352109: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusolver.so.10
2020-04-10 04:42:16.352163: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusparse.so.10
2020-04-10 04:42:16.352179: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudnn.so.7
2020-04-10 04:42:16.352261: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-04-10 04:42:16.352530: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-04-10 04:42:16.352734: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1703] Adding visible gpu devices: 0
2020-04-10 04:42:16.352775: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-04-10 04:42:16.352794: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      0 
2020-04-10 04:42:16.352819: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1121] 0:   N 
2020-04-10 04:42:16.352958: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-04-10 04:42:16.353220: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-04-10 04:42:16.353435: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1247] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 6850 MB memory) -> physical GPU (device: 0, name: Tesla P4, pci bus id: 0000:00:04.0, compute capability: 6.1)
INFO:tensorflow:Restoring parameters from /tmp/absl_testing/429596/model.ckpt-6000
I0410 04:42:16.354263 139691431679872 saver.py:1293] Restoring parameters from /tmp/absl_testing/429596/model.ckpt-6000
INFO:tensorflow:Running local_init_op.
I0410 04:42:16.769481 139691431679872 session_manager.py:505] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
I0410 04:42:16.790574 139691431679872 session_manager.py:508] Done running local_init_op.
INFO:tensorflow:Evaluation [1/10]
I0410 04:42:19.653287 139691431679872 evaluation.py:167] Evaluation [1/10]
INFO:tensorflow:Evaluation [2/10]
I0410 04:42:20.984291 139691431679872 evaluation.py:167] Evaluation [2/10]
INFO:tensorflow:Evaluation [3/10]
I0410 04:42:22.859080 139691431679872 evaluation.py:167] Evaluation [3/10]
INFO:tensorflow:Evaluation [4/10]
I0410 04:42:24.027863 139691431679872 evaluation.py:167] Evaluation [4/10]
INFO:tensorflow:Evaluation [5/10]
I0410 04:42:25.174227 139691431679872 evaluation.py:167] Evaluation [5/10]
INFO:tensorflow:Evaluation [6/10]
I0410 04:42:25.538912 139691431679872 evaluation.py:167] Evaluation [6/10]
INFO:tensorflow:Evaluation [7/10]
I0410 04:42:27.189887 139691431679872 evaluation.py:167] Evaluation [7/10]
INFO:tensorflow:Evaluation [8/10]
I0410 04:42:28.565393 139691431679872 evaluation.py:167] Evaluation [8/10]
INFO:tensorflow:Evaluation [9/10]
I0410 04:42:30.070344 139691431679872 evaluation.py:167] Evaluation [9/10]
INFO:tensorflow:Evaluation [10/10]
I0410 04:42:31.413246 139691431679872 evaluation.py:167] Evaluation [10/10]
INFO:tensorflow:Inference Time : 15.48360s
I0410 04:42:31.695612 139691431679872 evaluation.py:273] Inference Time : 15.48360s
INFO:tensorflow:Finished evaluation at 2020-04-10-04:42:31
I0410 04:42:31.695820 139691431679872 evaluation.py:276] Finished evaluation at 2020-04-10-04:42:31
INFO:tensorflow:Saving dict for global step 6000: accuracy = 1.0, global_step = 6000, loss = 0.005486385
I0410 04:42:31.695979 139691431679872 estimator.py:2066] Saving dict for global step 6000: accuracy = 1.0, global_step = 6000, loss = 0.005486385
INFO:tensorflow:Saving 'checkpoint_path' summary for global step 6000: /tmp/absl_testing/429596/model.ckpt-6000
I0410 04:42:31.696437 139691431679872 estimator.py:2127] Saving 'checkpoint_path' summary for global step 6000: /tmp/absl_testing/429596/model.ckpt-6000
INFO:tensorflow:global_step/sec: 0.550797
I0410 04:42:33.147136 139691431679872 basic_session_run_hooks.py:702] global_step/sec: 0.550797
INFO:tensorflow:loss = 0.0011812621, step = 6000 (181.555 sec)
I0410 04:42:33.148083 139691431679872 basic_session_run_hooks.py:260] loss = 0.0011812621, step = 6000 (181.555 sec)
INFO:tensorflow:global_step/sec: 0.679837
I0410 04:45:00.241203 139691431679872 basic_session_run_hooks.py:702] global_step/sec: 0.679837
INFO:tensorflow:loss = 0.00073922105, step = 6100 (147.094 sec)
I0410 04:45:00.242516 139691431679872 basic_session_run_hooks.py:260] loss = 0.00073922105, step = 6100 (147.094 sec)
INFO:tensorflow:Calling checkpoint listeners before saving checkpoint 6200...
I0410 04:47:26.019574 139691431679872 basic_session_run_hooks.py:614] Calling checkpoint listeners before saving checkpoint 6200...
INFO:tensorflow:Saving checkpoints for 6200 into /tmp/absl_testing/429596/model.ckpt.
I0410 04:47:26.019838 139691431679872 basic_session_run_hooks.py:618] Saving checkpoints for 6200 into /tmp/absl_testing/429596/model.ckpt.
INFO:tensorflow:Calling checkpoint listeners after saving checkpoint 6200...
I0410 04:47:44.097779 139691431679872 basic_session_run_hooks.py:626] Calling checkpoint listeners after saving checkpoint 6200...
INFO:tensorflow:Skip the current checkpoint eval due to throttle secs (600 secs).
I0410 04:47:44.098238 139691431679872 training.py:528] Skip the current checkpoint eval due to throttle secs (600 secs).
INFO:tensorflow:global_step/sec: 0.604782
I0410 04:47:45.590039 139691431679872 basic_session_run_hooks.py:702] global_step/sec: 0.604782
INFO:tensorflow:loss = 0.000116259296, step = 6200 (165.348 sec)
I0410 04:47:45.591007 139691431679872 basic_session_run_hooks.py:260] loss = 0.000116259296, step = 6200 (165.348 sec)
INFO:tensorflow:global_step/sec: 0.678788
I0410 04:50:12.911412 139691431679872 basic_session_run_hooks.py:702] global_step/sec: 0.678788
INFO:tensorflow:loss = 0.027799772, step = 6300 (147.322 sec)
I0410 04:50:12.912517 139691431679872 basic_session_run_hooks.py:260] loss = 0.027799772, step = 6300 (147.322 sec)
INFO:tensorflow:Calling checkpoint listeners before saving checkpoint 6400...
I0410 04:52:38.812368 139691431679872 basic_session_run_hooks.py:614] Calling checkpoint listeners before saving checkpoint 6400...
INFO:tensorflow:Saving checkpoints for 6400 into /tmp/absl_testing/429596/model.ckpt.
I0410 04:52:38.812618 139691431679872 basic_session_run_hooks.py:618] Saving checkpoints for 6400 into /tmp/absl_testing/429596/model.ckpt.
INFO:tensorflow:Calling checkpoint listeners after saving checkpoint 6400...
I0410 04:52:55.547597 139691431679872 basic_session_run_hooks.py:626] Calling checkpoint listeners after saving checkpoint 6400...
--------------------------------------------datasets.py/eval_input_fn,s
W0410 04:52:58.550393 139691431679872 datasets.py:170] No TPUContext, using unmodified dataset seed 547.
I0410 04:52:58.550571 139691431679872 datasets.py:348] eval_input_fn(): params={'use_tpu': False, 'train_batch_size': 8, 'batch_size': 8} seed=547
--------befor self._load_dataset------------------split = validation self._eval_split= validation
--------------------------------------------datasets.py/_load_dataset,s
!!!!!!!!!!!!!!!!!!!!!!----load_local_datasets,  _local_test_ds_dir= /content/drive/My Drive/drive/gan/test
-----------------------------------------get_local_datasets,s
-----------------------------------------get_local_datasets,e
--------------------------------------------modular_gan.py/_preprocess_fn,s
I0410 04:52:58.638443 139691431679872 api.py:587] _preprocess_fn(): images=Tensor("args_0:0", shape=(128, 128, 3), dtype=float32), labels=Tensor("args_1:0", shape=(), dtype=int32), seed=547
--------------------------------------------modular_gan.py/_preprocess_fn,e
I0410 04:52:58.669156 139691431679872 api.py:587] Passing random offset: Tensor("Cast:0", shape=(), dtype=int32) with data ({'images': <tf.Tensor 'args_1:0' shape=(128, 128, 3) dtype=float32>, 'z': <tf.Tensor 'args_3:0' shape=(120,) dtype=float32>, 'sampled_labels': <tf.Tensor 'args_2:0' shape=() dtype=int32>}, <tf.Tensor 'args_4:0' shape=() dtype=int32>).
--------------------------------------------datasets.py/eval_input_fn,e
INFO:tensorflow:Calling model_fn.
I0410 04:52:58.689587 139691431679872 estimator.py:1169] Calling model_fn.
--------------------------------------------modular_gan.py/model_fn,s
I0410 04:52:58.689758 139691431679872 modular_gan.py:589] model_fn(): features={'images': <tf.Tensor 'IteratorGetNext:1' shape=(8, 128, 128, 3) dtype=float32>, 'z': <tf.Tensor 'IteratorGetNext:3' shape=(8, 120) dtype=float32>, 'sampled_labels': <tf.Tensor 'IteratorGetNext:2' shape=(8,) dtype=int32>, '_RANDOM_OFFSET': <tf.Tensor 'IteratorGetNext:0' shape=(8,) dtype=int32>}, labels=Tensor("IteratorGetNext:4", shape=(8,), dtype=int32),mode=eval, params={'use_tpu': False, 'train_batch_size': 8, 'batch_size': 8}
#Clean old summaries from previous calls to model_fn().
# Get features and labels for each sub-step.
--------------------------------------------modular_gan.py/_split_inputs_and_generate_samples,s
I0410 04:52:58.696654 139691431679872 resnet_biggan.py:236] [Generator] inputs are z=(8, 120), y=(8, 2)
I0410 04:52:58.710736 139691431679872 resnet_biggan.py:262] [Generator] z0=(8, 20), z_per_block=['(8, 20)', '(8, 20)', '(8, 20)', '(8, 20)', '(8, 20)'], y_per_block=['(8, 148)', '(8, 148)', '(8, 148)', '(8, 148)', '(8, 148)']
I0410 04:52:58.759779 139691431679872 resnet_biggan.py:150] [Block] (8, 4, 4, 1536) (z=(8, 20), y=(8, 148)) -> (8, 8, 8, 1536)
I0410 04:52:58.800710 139691431679872 resnet_biggan.py:150] [Block] (8, 8, 8, 1536) (z=(8, 20), y=(8, 148)) -> (8, 16, 16, 768)
I0410 04:52:58.838104 139691431679872 resnet_biggan.py:150] [Block] (8, 16, 16, 768) (z=(8, 20), y=(8, 148)) -> (8, 32, 32, 384)
I0410 04:52:58.875246 139691431679872 resnet_biggan.py:150] [Block] (8, 32, 32, 384) (z=(8, 20), y=(8, 148)) -> (8, 64, 64, 192)
I0410 04:52:58.875386 139691431679872 resnet_biggan.py:289] [Generator] Applying non-local block to (8, 64, 64, 192)
I0410 04:52:58.950140 139691431679872 resnet_biggan.py:150] [Block] (8, 64, 64, 192) (z=(8, 20), y=(8, 148)) -> (8, 128, 128, 96)
I0410 04:52:58.950294 139691431679872 resnet_biggan.py:294] [Generator] before final processing: (8, 128, 128, 96)
I0410 04:52:58.983283 139691431679872 resnet_biggan.py:300] [Generator] after final processing: (8, 128, 128, 3)
--------------------------------------------modular_gan.py/_split_inputs_and_generate_samples,e
---------------------------------------------------modular_gan.py/create_logits,s
I0410 04:52:58.986638 139691431679872 tpu_random.py:86] Got global random offset: Tensor("strided_slice:0", shape=(), dtype=int32)
---------------------------------------------------s3gan.py/create_loss,s
W0410 04:52:58.989137 139691431679872 s3gan.py:237] Computing fake images for every sub step separately.
I0410 04:52:58.989345 139691431679872 resnet_biggan.py:236] [Generator] inputs are z=(8, 120), y=(8, 2)
I0410 04:52:58.994653 139691431679872 resnet_biggan.py:262] [Generator] z0=(8, 20), z_per_block=['(8, 20)', '(8, 20)', '(8, 20)', '(8, 20)', '(8, 20)'], y_per_block=['(8, 148)', '(8, 148)', '(8, 148)', '(8, 148)', '(8, 148)']
I0410 04:52:59.012733 139691431679872 resnet_biggan.py:150] [Block] (8, 4, 4, 1536) (z=(8, 20), y=(8, 148)) -> (8, 8, 8, 1536)
I0410 04:52:59.028925 139691431679872 resnet_biggan.py:150] [Block] (8, 8, 8, 1536) (z=(8, 20), y=(8, 148)) -> (8, 16, 16, 768)
I0410 04:52:59.044602 139691431679872 resnet_biggan.py:150] [Block] (8, 16, 16, 768) (z=(8, 20), y=(8, 148)) -> (8, 32, 32, 384)
I0410 04:52:59.060339 139691431679872 resnet_biggan.py:150] [Block] (8, 32, 32, 384) (z=(8, 20), y=(8, 148)) -> (8, 64, 64, 192)
I0410 04:52:59.060481 139691431679872 resnet_biggan.py:289] [Generator] Applying non-local block to (8, 64, 64, 192)
I0410 04:52:59.094074 139691431679872 resnet_biggan.py:150] [Block] (8, 64, 64, 192) (z=(8, 20), y=(8, 148)) -> (8, 128, 128, 96)
I0410 04:52:59.094235 139691431679872 resnet_biggan.py:294] [Generator] before final processing: (8, 128, 128, 96)
I0410 04:52:59.108028 139691431679872 resnet_biggan.py:300] [Generator] after final processing: (8, 128, 128, 3)
I0410 04:52:59.109689 139691431679872 s3gan.py:249] bs=8, rotated_bs=4, num_rot_examples=1
---------------------------------------------------s3gan.py/merge_with_rotation_data,s
---------------------------------------------------s3gan.py/merge_with_rotation_data,e
--------------------------------------------------------------------s3gan.py/discriminator_with_additonal_heads,s
I0410 04:52:59.134109 139691431679872 resnet_biggan.py:379] [Discriminator] inputs are x=(22, 128, 128, 3), y=(22, 2)
I0410 04:52:59.164739 139691431679872 resnet_biggan.py:150] [Block] (22, 128, 128, 3) (z=None, y=(22, 2)) -> (22, 64, 64, 96)
I0410 04:52:59.164918 139691431679872 resnet_biggan.py:398] [Discriminator] Applying non-local block to (22, 64, 64, 96)
I0410 04:52:59.235164 139691431679872 resnet_biggan.py:150] [Block] (22, 64, 64, 96) (z=None, y=(22, 2)) -> (22, 32, 32, 192)
I0410 04:52:59.265487 139691431679872 resnet_biggan.py:150] [Block] (22, 32, 32, 192) (z=None, y=(22, 2)) -> (22, 16, 16, 384)
I0410 04:52:59.298248 139691431679872 resnet_biggan.py:150] [Block] (22, 16, 16, 384) (z=None, y=(22, 2)) -> (22, 8, 8, 768)
I0410 04:52:59.329437 139691431679872 resnet_biggan.py:150] [Block] (22, 8, 8, 768) (z=None, y=(22, 2)) -> (22, 4, 4, 1536)
I0410 04:52:59.349258 139691431679872 resnet_biggan.py:150] [Block] (22, 4, 4, 1536) (z=None, y=(22, 2)) -> (22, 4, 4, 1536)
I0410 04:52:59.349428 139691431679872 resnet_biggan.py:403] [Discriminator] before final processing: (22, 4, 4, 1536)
I0410 04:52:59.361446 139691431679872 resnet_biggan.py:407] [Discriminator] after final processing: (22, 4, 4, 1536)
I0410 04:52:59.368018 139691431679872 resnet_biggan.py:422] [Discriminator] embedded_y for projection: (22, 1536)
I0410 04:52:59.381425 139691431679872 s3gan.py:133] [Discriminator] rotation head (22, 1536) -> Tensor("discriminator_rotation/score_classify/add:0", shape=(22, 4), dtype=float32)
I0410 04:52:59.397195 139691431679872 s3gan.py:154] [Discriminator] (22, 2) -> aux_logits=(22, 2), y_predicted=(22, 2)
---------------------------------------------------s3gan.py/get_class_embedding,s
I0410 04:52:59.404418 139691431679872 s3gan.py:175] [Discriminator] embedded_y for projection: (22, 1536)
---------------------------------------------------s3gan.py/get_class_embedding,e
---------------------------------------------------s3gan.py/discriminator_with_additonal_heads,e
---------------------------------------------------s3gan.py/create_loss,e
---------------------------------------------------modular_gan.py/create_logits,e
################################################## mode == tf.estimator.ModeKeys.EVAL  ########################
INFO:tensorflow:Done calling model_fn.
I0410 04:52:59.488730 139691431679872 estimator.py:1171] Done calling model_fn.
INFO:tensorflow:Starting evaluation at 2020-04-10T04:52:59Z
I0410 04:52:59.503537 139691431679872 evaluation.py:255] Starting evaluation at 2020-04-10T04:52:59Z
INFO:tensorflow:Graph was finalized.
I0410 04:52:59.637447 139691431679872 monitored_session.py:246] Graph was finalized.
2020-04-10 04:52:59.638067: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-04-10 04:52:59.638386: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:00:04.0 name: Tesla P4 computeCapability: 6.1
coreClock: 1.1135GHz coreCount: 20 deviceMemorySize: 7.43GiB deviceMemoryBandwidth: 178.99GiB/s
2020-04-10 04:52:59.638440: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.1
2020-04-10 04:52:59.638467: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10
2020-04-10 04:52:59.638485: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcufft.so.10
2020-04-10 04:52:59.638502: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcurand.so.10
2020-04-10 04:52:59.638517: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusolver.so.10
2020-04-10 04:52:59.638569: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusparse.so.10
2020-04-10 04:52:59.638586: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudnn.so.7
2020-04-10 04:52:59.638666: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-04-10 04:52:59.638989: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-04-10 04:52:59.639205: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1703] Adding visible gpu devices: 0
2020-04-10 04:52:59.639247: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-04-10 04:52:59.639262: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      0 
2020-04-10 04:52:59.639275: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1121] 0:   N 
2020-04-10 04:52:59.639365: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-04-10 04:52:59.639671: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-04-10 04:52:59.639917: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1247] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 6850 MB memory) -> physical GPU (device: 0, name: Tesla P4, pci bus id: 0000:00:04.0, compute capability: 6.1)
INFO:tensorflow:Restoring parameters from /tmp/absl_testing/429596/model.ckpt-6400
I0410 04:52:59.640743 139691431679872 saver.py:1293] Restoring parameters from /tmp/absl_testing/429596/model.ckpt-6400
INFO:tensorflow:Running local_init_op.
I0410 04:53:00.049510 139691431679872 session_manager.py:505] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
I0410 04:53:00.071162 139691431679872 session_manager.py:508] Done running local_init_op.
INFO:tensorflow:Evaluation [1/10]
I0410 04:53:02.585635 139691431679872 evaluation.py:167] Evaluation [1/10]
INFO:tensorflow:Evaluation [2/10]
I0410 04:53:03.442729 139691431679872 evaluation.py:167] Evaluation [2/10]
INFO:tensorflow:Evaluation [3/10]
I0410 04:53:04.664940 139691431679872 evaluation.py:167] Evaluation [3/10]
INFO:tensorflow:Evaluation [4/10]
I0410 04:53:06.196309 139691431679872 evaluation.py:167] Evaluation [4/10]
INFO:tensorflow:Evaluation [5/10]
I0410 04:53:07.158431 139691431679872 evaluation.py:167] Evaluation [5/10]
INFO:tensorflow:Evaluation [6/10]
I0410 04:53:08.549373 139691431679872 evaluation.py:167] Evaluation [6/10]
INFO:tensorflow:Evaluation [7/10]
I0410 04:53:09.145003 139691431679872 evaluation.py:167] Evaluation [7/10]
INFO:tensorflow:Evaluation [8/10]
I0410 04:53:09.727683 139691431679872 evaluation.py:167] Evaluation [8/10]
INFO:tensorflow:Evaluation [9/10]
I0410 04:53:10.031327 139691431679872 evaluation.py:167] Evaluation [9/10]
INFO:tensorflow:Evaluation [10/10]
I0410 04:53:11.342278 139691431679872 evaluation.py:167] Evaluation [10/10]
INFO:tensorflow:Inference Time : 11.94790s
I0410 04:53:11.451589 139691431679872 evaluation.py:273] Inference Time : 11.94790s
INFO:tensorflow:Finished evaluation at 2020-04-10-04:53:11
I0410 04:53:11.451838 139691431679872 evaluation.py:276] Finished evaluation at 2020-04-10-04:53:11
INFO:tensorflow:Saving dict for global step 6400: accuracy = 1.0, global_step = 6400, loss = 0.00576467
I0410 04:53:11.452006 139691431679872 estimator.py:2066] Saving dict for global step 6400: accuracy = 1.0, global_step = 6400, loss = 0.00576467
INFO:tensorflow:Saving 'checkpoint_path' summary for global step 6400: /tmp/absl_testing/429596/model.ckpt-6400
I0410 04:53:11.452535 139691431679872 estimator.py:2127] Saving 'checkpoint_path' summary for global step 6400: /tmp/absl_testing/429596/model.ckpt-6400
INFO:tensorflow:global_step/sec: 0.555519
I0410 04:53:12.923188 139691431679872 basic_session_run_hooks.py:702] global_step/sec: 0.555519
INFO:tensorflow:loss = 0.009274276, step = 6400 (180.011 sec)
I0410 04:53:12.924001 139691431679872 basic_session_run_hooks.py:260] loss = 0.009274276, step = 6400 (180.011 sec)
INFO:tensorflow:global_step/sec: 0.679231
I0410 04:55:40.148612 139691431679872 basic_session_run_hooks.py:702] global_step/sec: 0.679231
INFO:tensorflow:loss = 0.0027406914, step = 6500 (147.226 sec)
I0410 04:55:40.149742 139691431679872 basic_session_run_hooks.py:260] loss = 0.0027406914, step = 6500 (147.226 sec)
INFO:tensorflow:Calling checkpoint listeners before saving checkpoint 6600...
I0410 04:58:05.957119 139691431679872 basic_session_run_hooks.py:614] Calling checkpoint listeners before saving checkpoint 6600...
INFO:tensorflow:Saving checkpoints for 6600 into /tmp/absl_testing/429596/model.ckpt.
I0410 04:58:05.957383 139691431679872 basic_session_run_hooks.py:618] Saving checkpoints for 6600 into /tmp/absl_testing/429596/model.ckpt.
INFO:tensorflow:Calling checkpoint listeners after saving checkpoint 6600...
I0410 04:58:21.474278 139691431679872 basic_session_run_hooks.py:626] Calling checkpoint listeners after saving checkpoint 6600...
INFO:tensorflow:Skip the current checkpoint eval due to throttle secs (600 secs).
I0410 04:58:21.474559 139691431679872 training.py:528] Skip the current checkpoint eval due to throttle secs (600 secs).
INFO:tensorflow:global_step/sec: 0.614186
I0410 04:58:22.965793 139691431679872 basic_session_run_hooks.py:702] global_step/sec: 0.614186
INFO:tensorflow:loss = 0.015532142, step = 6600 (162.817 sec)
I0410 04:58:22.966887 139691431679872 basic_session_run_hooks.py:260] loss = 0.015532142, step = 6600 (162.817 sec)
INFO:tensorflow:global_step/sec: 0.678804
I0410 05:00:50.283789 139691431679872 basic_session_run_hooks.py:702] global_step/sec: 0.678804
INFO:tensorflow:loss = 0.017053293, step = 6700 (147.318 sec)
I0410 05:00:50.284798 139691431679872 basic_session_run_hooks.py:260] loss = 0.017053293, step = 6700 (147.318 sec)
INFO:tensorflow:Calling checkpoint listeners before saving checkpoint 6800...
I0410 05:03:16.210505 139691431679872 basic_session_run_hooks.py:614] Calling checkpoint listeners before saving checkpoint 6800...
INFO:tensorflow:Saving checkpoints for 6800 into /tmp/absl_testing/429596/model.ckpt.
I0410 05:03:16.210831 139691431679872 basic_session_run_hooks.py:618] Saving checkpoints for 6800 into /tmp/absl_testing/429596/model.ckpt.
INFO:tensorflow:Calling checkpoint listeners after saving checkpoint 6800...
I0410 05:03:31.813967 139691431679872 basic_session_run_hooks.py:626] Calling checkpoint listeners after saving checkpoint 6800...
--------------------------------------------datasets.py/eval_input_fn,s
W0410 05:03:32.136013 139691431679872 datasets.py:170] No TPUContext, using unmodified dataset seed 547.
I0410 05:03:32.136172 139691431679872 datasets.py:348] eval_input_fn(): params={'use_tpu': False, 'train_batch_size': 8, 'batch_size': 8} seed=547
--------befor self._load_dataset------------------split = validation self._eval_split= validation
--------------------------------------------datasets.py/_load_dataset,s
!!!!!!!!!!!!!!!!!!!!!!----load_local_datasets,  _local_test_ds_dir= /content/drive/My Drive/drive/gan/test
-----------------------------------------get_local_datasets,s
-----------------------------------------get_local_datasets,e
--------------------------------------------modular_gan.py/_preprocess_fn,s
I0410 05:03:36.012707 139691431679872 api.py:587] _preprocess_fn(): images=Tensor("args_0:0", shape=(128, 128, 3), dtype=float32), labels=Tensor("args_1:0", shape=(), dtype=int32), seed=547
--------------------------------------------modular_gan.py/_preprocess_fn,e
I0410 05:03:36.041285 139691431679872 api.py:587] Passing random offset: Tensor("Cast:0", shape=(), dtype=int32) with data ({'images': <tf.Tensor 'args_1:0' shape=(128, 128, 3) dtype=float32>, 'z': <tf.Tensor 'args_3:0' shape=(120,) dtype=float32>, 'sampled_labels': <tf.Tensor 'args_2:0' shape=() dtype=int32>}, <tf.Tensor 'args_4:0' shape=() dtype=int32>).
--------------------------------------------datasets.py/eval_input_fn,e
INFO:tensorflow:Calling model_fn.
I0410 05:03:36.057111 139691431679872 estimator.py:1169] Calling model_fn.
--------------------------------------------modular_gan.py/model_fn,s
I0410 05:03:36.057266 139691431679872 modular_gan.py:589] model_fn(): features={'images': <tf.Tensor 'IteratorGetNext:1' shape=(8, 128, 128, 3) dtype=float32>, 'z': <tf.Tensor 'IteratorGetNext:3' shape=(8, 120) dtype=float32>, 'sampled_labels': <tf.Tensor 'IteratorGetNext:2' shape=(8,) dtype=int32>, '_RANDOM_OFFSET': <tf.Tensor 'IteratorGetNext:0' shape=(8,) dtype=int32>}, labels=Tensor("IteratorGetNext:4", shape=(8,), dtype=int32),mode=eval, params={'use_tpu': False, 'train_batch_size': 8, 'batch_size': 8}
#Clean old summaries from previous calls to model_fn().
# Get features and labels for each sub-step.
--------------------------------------------modular_gan.py/_split_inputs_and_generate_samples,s
I0410 05:03:36.063957 139691431679872 resnet_biggan.py:236] [Generator] inputs are z=(8, 120), y=(8, 2)
I0410 05:03:36.074352 139691431679872 resnet_biggan.py:262] [Generator] z0=(8, 20), z_per_block=['(8, 20)', '(8, 20)', '(8, 20)', '(8, 20)', '(8, 20)'], y_per_block=['(8, 148)', '(8, 148)', '(8, 148)', '(8, 148)', '(8, 148)']
I0410 05:03:36.121669 139691431679872 resnet_biggan.py:150] [Block] (8, 4, 4, 1536) (z=(8, 20), y=(8, 148)) -> (8, 8, 8, 1536)
I0410 05:03:36.162495 139691431679872 resnet_biggan.py:150] [Block] (8, 8, 8, 1536) (z=(8, 20), y=(8, 148)) -> (8, 16, 16, 768)
I0410 05:03:36.200890 139691431679872 resnet_biggan.py:150] [Block] (8, 16, 16, 768) (z=(8, 20), y=(8, 148)) -> (8, 32, 32, 384)
I0410 05:03:36.239734 139691431679872 resnet_biggan.py:150] [Block] (8, 32, 32, 384) (z=(8, 20), y=(8, 148)) -> (8, 64, 64, 192)
I0410 05:03:36.239915 139691431679872 resnet_biggan.py:289] [Generator] Applying non-local block to (8, 64, 64, 192)
I0410 05:03:36.321369 139691431679872 resnet_biggan.py:150] [Block] (8, 64, 64, 192) (z=(8, 20), y=(8, 148)) -> (8, 128, 128, 96)
I0410 05:03:36.321538 139691431679872 resnet_biggan.py:294] [Generator] before final processing: (8, 128, 128, 96)
I0410 05:03:36.351663 139691431679872 resnet_biggan.py:300] [Generator] after final processing: (8, 128, 128, 3)
--------------------------------------------modular_gan.py/_split_inputs_and_generate_samples,e
---------------------------------------------------modular_gan.py/create_logits,s
I0410 05:03:36.355100 139691431679872 tpu_random.py:86] Got global random offset: Tensor("strided_slice:0", shape=(), dtype=int32)
---------------------------------------------------s3gan.py/create_loss,s
W0410 05:03:36.357605 139691431679872 s3gan.py:237] Computing fake images for every sub step separately.
I0410 05:03:36.357889 139691431679872 resnet_biggan.py:236] [Generator] inputs are z=(8, 120), y=(8, 2)
I0410 05:03:36.363332 139691431679872 resnet_biggan.py:262] [Generator] z0=(8, 20), z_per_block=['(8, 20)', '(8, 20)', '(8, 20)', '(8, 20)', '(8, 20)'], y_per_block=['(8, 148)', '(8, 148)', '(8, 148)', '(8, 148)', '(8, 148)']
I0410 05:03:36.382554 139691431679872 resnet_biggan.py:150] [Block] (8, 4, 4, 1536) (z=(8, 20), y=(8, 148)) -> (8, 8, 8, 1536)
I0410 05:03:36.398468 139691431679872 resnet_biggan.py:150] [Block] (8, 8, 8, 1536) (z=(8, 20), y=(8, 148)) -> (8, 16, 16, 768)
I0410 05:03:36.414459 139691431679872 resnet_biggan.py:150] [Block] (8, 16, 16, 768) (z=(8, 20), y=(8, 148)) -> (8, 32, 32, 384)
I0410 05:03:36.430090 139691431679872 resnet_biggan.py:150] [Block] (8, 32, 32, 384) (z=(8, 20), y=(8, 148)) -> (8, 64, 64, 192)
I0410 05:03:36.430238 139691431679872 resnet_biggan.py:289] [Generator] Applying non-local block to (8, 64, 64, 192)
I0410 05:03:36.462049 139691431679872 resnet_biggan.py:150] [Block] (8, 64, 64, 192) (z=(8, 20), y=(8, 148)) -> (8, 128, 128, 96)
I0410 05:03:36.462209 139691431679872 resnet_biggan.py:294] [Generator] before final processing: (8, 128, 128, 96)
I0410 05:03:36.476583 139691431679872 resnet_biggan.py:300] [Generator] after final processing: (8, 128, 128, 3)
I0410 05:03:36.478362 139691431679872 s3gan.py:249] bs=8, rotated_bs=4, num_rot_examples=1
---------------------------------------------------s3gan.py/merge_with_rotation_data,s
---------------------------------------------------s3gan.py/merge_with_rotation_data,e
--------------------------------------------------------------------s3gan.py/discriminator_with_additonal_heads,s
I0410 05:03:36.502625 139691431679872 resnet_biggan.py:379] [Discriminator] inputs are x=(22, 128, 128, 3), y=(22, 2)
I0410 05:03:36.533200 139691431679872 resnet_biggan.py:150] [Block] (22, 128, 128, 3) (z=None, y=(22, 2)) -> (22, 64, 64, 96)
I0410 05:03:36.533345 139691431679872 resnet_biggan.py:398] [Discriminator] Applying non-local block to (22, 64, 64, 96)
I0410 05:03:36.602955 139691431679872 resnet_biggan.py:150] [Block] (22, 64, 64, 96) (z=None, y=(22, 2)) -> (22, 32, 32, 192)
I0410 05:03:36.634723 139691431679872 resnet_biggan.py:150] [Block] (22, 32, 32, 192) (z=None, y=(22, 2)) -> (22, 16, 16, 384)
I0410 05:03:36.665126 139691431679872 resnet_biggan.py:150] [Block] (22, 16, 16, 384) (z=None, y=(22, 2)) -> (22, 8, 8, 768)
I0410 05:03:36.697336 139691431679872 resnet_biggan.py:150] [Block] (22, 8, 8, 768) (z=None, y=(22, 2)) -> (22, 4, 4, 1536)
I0410 05:03:36.716775 139691431679872 resnet_biggan.py:150] [Block] (22, 4, 4, 1536) (z=None, y=(22, 2)) -> (22, 4, 4, 1536)
I0410 05:03:36.716935 139691431679872 resnet_biggan.py:403] [Discriminator] before final processing: (22, 4, 4, 1536)
I0410 05:03:36.727489 139691431679872 resnet_biggan.py:407] [Discriminator] after final processing: (22, 4, 4, 1536)
I0410 05:03:36.733420 139691431679872 resnet_biggan.py:422] [Discriminator] embedded_y for projection: (22, 1536)
I0410 05:03:36.745505 139691431679872 s3gan.py:133] [Discriminator] rotation head (22, 1536) -> Tensor("discriminator_rotation/score_classify/add:0", shape=(22, 4), dtype=float32)
I0410 05:03:36.758092 139691431679872 s3gan.py:154] [Discriminator] (22, 2) -> aux_logits=(22, 2), y_predicted=(22, 2)
---------------------------------------------------s3gan.py/get_class_embedding,s
I0410 05:03:36.764089 139691431679872 s3gan.py:175] [Discriminator] embedded_y for projection: (22, 1536)
---------------------------------------------------s3gan.py/get_class_embedding,e
---------------------------------------------------s3gan.py/discriminator_with_additonal_heads,e
---------------------------------------------------s3gan.py/create_loss,e
---------------------------------------------------modular_gan.py/create_logits,e
################################################## mode == tf.estimator.ModeKeys.EVAL  ########################
INFO:tensorflow:Done calling model_fn.
I0410 05:03:36.854651 139691431679872 estimator.py:1171] Done calling model_fn.
INFO:tensorflow:Starting evaluation at 2020-04-10T05:03:36Z
I0410 05:03:36.869994 139691431679872 evaluation.py:255] Starting evaluation at 2020-04-10T05:03:36Z
INFO:tensorflow:Graph was finalized.
I0410 05:03:37.011975 139691431679872 monitored_session.py:246] Graph was finalized.
2020-04-10 05:03:37.012613: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-04-10 05:03:37.012980: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:00:04.0 name: Tesla P4 computeCapability: 6.1
coreClock: 1.1135GHz coreCount: 20 deviceMemorySize: 7.43GiB deviceMemoryBandwidth: 178.99GiB/s
2020-04-10 05:03:37.013032: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.1
2020-04-10 05:03:37.013057: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10
2020-04-10 05:03:37.013079: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcufft.so.10
2020-04-10 05:03:37.013095: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcurand.so.10
2020-04-10 05:03:37.013109: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusolver.so.10
2020-04-10 05:03:37.013157: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusparse.so.10
2020-04-10 05:03:37.013174: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudnn.so.7
2020-04-10 05:03:37.013257: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-04-10 05:03:37.013519: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-04-10 05:03:37.013722: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1703] Adding visible gpu devices: 0
2020-04-10 05:03:37.013766: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-04-10 05:03:37.013781: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      0 
2020-04-10 05:03:37.013790: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1121] 0:   N 
2020-04-10 05:03:37.013932: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-04-10 05:03:37.014200: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-04-10 05:03:37.014418: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1247] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 6850 MB memory) -> physical GPU (device: 0, name: Tesla P4, pci bus id: 0000:00:04.0, compute capability: 6.1)
INFO:tensorflow:Restoring parameters from /tmp/absl_testing/429596/model.ckpt-6800
I0410 05:03:37.015345 139691431679872 saver.py:1293] Restoring parameters from /tmp/absl_testing/429596/model.ckpt-6800
INFO:tensorflow:Running local_init_op.
I0410 05:03:37.429041 139691431679872 session_manager.py:505] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
I0410 05:03:37.450688 139691431679872 session_manager.py:508] Done running local_init_op.
INFO:tensorflow:Evaluation [1/10]
I0410 05:03:41.128080 139691431679872 evaluation.py:167] Evaluation [1/10]
INFO:tensorflow:Evaluation [2/10]
I0410 05:03:42.335158 139691431679872 evaluation.py:167] Evaluation [2/10]
INFO:tensorflow:Evaluation [3/10]
I0410 05:03:44.010561 139691431679872 evaluation.py:167] Evaluation [3/10]
INFO:tensorflow:Evaluation [4/10]
I0410 05:03:45.273170 139691431679872 evaluation.py:167] Evaluation [4/10]
INFO:tensorflow:Evaluation [5/10]
I0410 05:03:46.514013 139691431679872 evaluation.py:167] Evaluation [5/10]
INFO:tensorflow:Evaluation [6/10]
I0410 05:03:47.854274 139691431679872 evaluation.py:167] Evaluation [6/10]
INFO:tensorflow:Evaluation [7/10]
I0410 05:03:50.042765 139691431679872 evaluation.py:167] Evaluation [7/10]
INFO:tensorflow:Evaluation [8/10]
I0410 05:03:50.360875 139691431679872 evaluation.py:167] Evaluation [8/10]
INFO:tensorflow:Evaluation [9/10]
I0410 05:03:51.522393 139691431679872 evaluation.py:167] Evaluation [9/10]
INFO:tensorflow:Evaluation [10/10]
I0410 05:03:52.425076 139691431679872 evaluation.py:167] Evaluation [10/10]
INFO:tensorflow:Inference Time : 15.87934s
I0410 05:03:52.749507 139691431679872 evaluation.py:273] Inference Time : 15.87934s
INFO:tensorflow:Finished evaluation at 2020-04-10-05:03:52
I0410 05:03:52.749718 139691431679872 evaluation.py:276] Finished evaluation at 2020-04-10-05:03:52
INFO:tensorflow:Saving dict for global step 6800: accuracy = 0.9875, global_step = 6800, loss = 0.08156408
I0410 05:03:52.749881 139691431679872 estimator.py:2066] Saving dict for global step 6800: accuracy = 0.9875, global_step = 6800, loss = 0.08156408
INFO:tensorflow:Saving 'checkpoint_path' summary for global step 6800: /tmp/absl_testing/429596/model.ckpt-6800
I0410 05:03:52.750335 139691431679872 estimator.py:2127] Saving 'checkpoint_path' summary for global step 6800: /tmp/absl_testing/429596/model.ckpt-6800
INFO:tensorflow:global_step/sec: 0.543692
I0410 05:03:54.211495 139691431679872 basic_session_run_hooks.py:702] global_step/sec: 0.543692
INFO:tensorflow:loss = 0.026715666, step = 6800 (183.928 sec)
I0410 05:03:54.212453 139691431679872 basic_session_run_hooks.py:260] loss = 0.026715666, step = 6800 (183.928 sec)
INFO:tensorflow:global_step/sec: 0.679444
I0410 05:06:21.390734 139691431679872 basic_session_run_hooks.py:702] global_step/sec: 0.679444
INFO:tensorflow:loss = 0.0015887932, step = 6900 (147.179 sec)
I0410 05:06:21.391744 139691431679872 basic_session_run_hooks.py:260] loss = 0.0015887932, step = 6900 (147.179 sec)
INFO:tensorflow:Calling checkpoint listeners before saving checkpoint 7000...
I0410 05:08:47.155180 139691431679872 basic_session_run_hooks.py:614] Calling checkpoint listeners before saving checkpoint 7000...
INFO:tensorflow:Saving checkpoints for 7000 into /tmp/absl_testing/429596/model.ckpt.
I0410 05:08:47.155429 139691431679872 basic_session_run_hooks.py:618] Saving checkpoints for 7000 into /tmp/absl_testing/429596/model.ckpt.
INFO:tensorflow:Calling checkpoint listeners after saving checkpoint 7000...
I0410 05:09:03.822971 139691431679872 basic_session_run_hooks.py:626] Calling checkpoint listeners after saving checkpoint 7000...
INFO:tensorflow:Skip the current checkpoint eval due to throttle secs (600 secs).
I0410 05:09:03.823382 139691431679872 training.py:528] Skip the current checkpoint eval due to throttle secs (600 secs).
INFO:tensorflow:global_step/sec: 0.610032
I0410 05:09:05.316594 139691431679872 basic_session_run_hooks.py:702] global_step/sec: 0.610032
INFO:tensorflow:loss = 1.1280123e-05, step = 7000 (163.926 sec)
I0410 05:09:05.317553 139691431679872 basic_session_run_hooks.py:260] loss = 1.1280123e-05, step = 7000 (163.926 sec)
INFO:tensorflow:global_step/sec: 0.679578
I0410 05:11:32.466665 139691431679872 basic_session_run_hooks.py:702] global_step/sec: 0.679578
INFO:tensorflow:loss = 0.0012727211, step = 7100 (147.150 sec)
I0410 05:11:32.467669 139691431679872 basic_session_run_hooks.py:260] loss = 0.0012727211, step = 7100 (147.150 sec)
INFO:tensorflow:Calling checkpoint listeners before saving checkpoint 7200...
I0410 05:13:58.280995 139691431679872 basic_session_run_hooks.py:614] Calling checkpoint listeners before saving checkpoint 7200...
INFO:tensorflow:Saving checkpoints for 7200 into /tmp/absl_testing/429596/model.ckpt.
I0410 05:13:58.281260 139691431679872 basic_session_run_hooks.py:618] Saving checkpoints for 7200 into /tmp/absl_testing/429596/model.ckpt.
INFO:tensorflow:Calling checkpoint listeners after saving checkpoint 7200...
I0410 05:14:14.438254 139691431679872 basic_session_run_hooks.py:626] Calling checkpoint listeners after saving checkpoint 7200...
--------------------------------------------datasets.py/eval_input_fn,s
W0410 05:14:17.390694 139691431679872 datasets.py:170] No TPUContext, using unmodified dataset seed 547.
I0410 05:14:17.390870 139691431679872 datasets.py:348] eval_input_fn(): params={'use_tpu': False, 'train_batch_size': 8, 'batch_size': 8} seed=547
--------befor self._load_dataset------------------split = validation self._eval_split= validation
--------------------------------------------datasets.py/_load_dataset,s
!!!!!!!!!!!!!!!!!!!!!!----load_local_datasets,  _local_test_ds_dir= /content/drive/My Drive/drive/gan/test
-----------------------------------------get_local_datasets,s
-----------------------------------------get_local_datasets,e
--------------------------------------------modular_gan.py/_preprocess_fn,s
I0410 05:14:18.166493 139691431679872 api.py:587] _preprocess_fn(): images=Tensor("args_0:0", shape=(128, 128, 3), dtype=float32), labels=Tensor("args_1:0", shape=(), dtype=int32), seed=547
--------------------------------------------modular_gan.py/_preprocess_fn,e
I0410 05:14:18.195646 139691431679872 api.py:587] Passing random offset: Tensor("Cast:0", shape=(), dtype=int32) with data ({'images': <tf.Tensor 'args_1:0' shape=(128, 128, 3) dtype=float32>, 'z': <tf.Tensor 'args_3:0' shape=(120,) dtype=float32>, 'sampled_labels': <tf.Tensor 'args_2:0' shape=() dtype=int32>}, <tf.Tensor 'args_4:0' shape=() dtype=int32>).
--------------------------------------------datasets.py/eval_input_fn,e
INFO:tensorflow:Calling model_fn.
I0410 05:14:18.211487 139691431679872 estimator.py:1169] Calling model_fn.
--------------------------------------------modular_gan.py/model_fn,s
I0410 05:14:18.211671 139691431679872 modular_gan.py:589] model_fn(): features={'images': <tf.Tensor 'IteratorGetNext:1' shape=(8, 128, 128, 3) dtype=float32>, 'z': <tf.Tensor 'IteratorGetNext:3' shape=(8, 120) dtype=float32>, 'sampled_labels': <tf.Tensor 'IteratorGetNext:2' shape=(8,) dtype=int32>, '_RANDOM_OFFSET': <tf.Tensor 'IteratorGetNext:0' shape=(8,) dtype=int32>}, labels=Tensor("IteratorGetNext:4", shape=(8,), dtype=int32),mode=eval, params={'use_tpu': False, 'train_batch_size': 8, 'batch_size': 8}
#Clean old summaries from previous calls to model_fn().
# Get features and labels for each sub-step.
--------------------------------------------modular_gan.py/_split_inputs_and_generate_samples,s
I0410 05:14:18.218887 139691431679872 resnet_biggan.py:236] [Generator] inputs are z=(8, 120), y=(8, 2)
I0410 05:14:18.229082 139691431679872 resnet_biggan.py:262] [Generator] z0=(8, 20), z_per_block=['(8, 20)', '(8, 20)', '(8, 20)', '(8, 20)', '(8, 20)'], y_per_block=['(8, 148)', '(8, 148)', '(8, 148)', '(8, 148)', '(8, 148)']
I0410 05:14:18.277107 139691431679872 resnet_biggan.py:150] [Block] (8, 4, 4, 1536) (z=(8, 20), y=(8, 148)) -> (8, 8, 8, 1536)
I0410 05:14:18.313995 139691431679872 resnet_biggan.py:150] [Block] (8, 8, 8, 1536) (z=(8, 20), y=(8, 148)) -> (8, 16, 16, 768)
I0410 05:14:18.350957 139691431679872 resnet_biggan.py:150] [Block] (8, 16, 16, 768) (z=(8, 20), y=(8, 148)) -> (8, 32, 32, 384)
I0410 05:14:18.388177 139691431679872 resnet_biggan.py:150] [Block] (8, 32, 32, 384) (z=(8, 20), y=(8, 148)) -> (8, 64, 64, 192)
I0410 05:14:18.388326 139691431679872 resnet_biggan.py:289] [Generator] Applying non-local block to (8, 64, 64, 192)
I0410 05:14:18.469274 139691431679872 resnet_biggan.py:150] [Block] (8, 64, 64, 192) (z=(8, 20), y=(8, 148)) -> (8, 128, 128, 96)
I0410 05:14:18.469464 139691431679872 resnet_biggan.py:294] [Generator] before final processing: (8, 128, 128, 96)
I0410 05:14:18.500627 139691431679872 resnet_biggan.py:300] [Generator] after final processing: (8, 128, 128, 3)
--------------------------------------------modular_gan.py/_split_inputs_and_generate_samples,e
---------------------------------------------------modular_gan.py/create_logits,s
I0410 05:14:18.503956 139691431679872 tpu_random.py:86] Got global random offset: Tensor("strided_slice:0", shape=(), dtype=int32)
---------------------------------------------------s3gan.py/create_loss,s
W0410 05:14:18.506430 139691431679872 s3gan.py:237] Computing fake images for every sub step separately.
I0410 05:14:18.506631 139691431679872 resnet_biggan.py:236] [Generator] inputs are z=(8, 120), y=(8, 2)
I0410 05:14:18.511957 139691431679872 resnet_biggan.py:262] [Generator] z0=(8, 20), z_per_block=['(8, 20)', '(8, 20)', '(8, 20)', '(8, 20)', '(8, 20)'], y_per_block=['(8, 148)', '(8, 148)', '(8, 148)', '(8, 148)', '(8, 148)']
I0410 05:14:18.530262 139691431679872 resnet_biggan.py:150] [Block] (8, 4, 4, 1536) (z=(8, 20), y=(8, 148)) -> (8, 8, 8, 1536)
I0410 05:14:18.546241 139691431679872 resnet_biggan.py:150] [Block] (8, 8, 8, 1536) (z=(8, 20), y=(8, 148)) -> (8, 16, 16, 768)
I0410 05:14:18.562551 139691431679872 resnet_biggan.py:150] [Block] (8, 16, 16, 768) (z=(8, 20), y=(8, 148)) -> (8, 32, 32, 384)
I0410 05:14:18.578731 139691431679872 resnet_biggan.py:150] [Block] (8, 32, 32, 384) (z=(8, 20), y=(8, 148)) -> (8, 64, 64, 192)
I0410 05:14:18.578887 139691431679872 resnet_biggan.py:289] [Generator] Applying non-local block to (8, 64, 64, 192)
I0410 05:14:18.610978 139691431679872 resnet_biggan.py:150] [Block] (8, 64, 64, 192) (z=(8, 20), y=(8, 148)) -> (8, 128, 128, 96)
I0410 05:14:18.611137 139691431679872 resnet_biggan.py:294] [Generator] before final processing: (8, 128, 128, 96)
I0410 05:14:18.627382 139691431679872 resnet_biggan.py:300] [Generator] after final processing: (8, 128, 128, 3)
I0410 05:14:18.629142 139691431679872 s3gan.py:249] bs=8, rotated_bs=4, num_rot_examples=1
---------------------------------------------------s3gan.py/merge_with_rotation_data,s
---------------------------------------------------s3gan.py/merge_with_rotation_data,e
--------------------------------------------------------------------s3gan.py/discriminator_with_additonal_heads,s
I0410 05:14:18.654652 139691431679872 resnet_biggan.py:379] [Discriminator] inputs are x=(22, 128, 128, 3), y=(22, 2)
I0410 05:14:18.687220 139691431679872 resnet_biggan.py:150] [Block] (22, 128, 128, 3) (z=None, y=(22, 2)) -> (22, 64, 64, 96)
I0410 05:14:18.687389 139691431679872 resnet_biggan.py:398] [Discriminator] Applying non-local block to (22, 64, 64, 96)
I0410 05:14:18.761644 139691431679872 resnet_biggan.py:150] [Block] (22, 64, 64, 96) (z=None, y=(22, 2)) -> (22, 32, 32, 192)
I0410 05:14:18.793205 139691431679872 resnet_biggan.py:150] [Block] (22, 32, 32, 192) (z=None, y=(22, 2)) -> (22, 16, 16, 384)
I0410 05:14:18.823982 139691431679872 resnet_biggan.py:150] [Block] (22, 16, 16, 384) (z=None, y=(22, 2)) -> (22, 8, 8, 768)
I0410 05:14:18.856115 139691431679872 resnet_biggan.py:150] [Block] (22, 8, 8, 768) (z=None, y=(22, 2)) -> (22, 4, 4, 1536)
I0410 05:14:18.875427 139691431679872 resnet_biggan.py:150] [Block] (22, 4, 4, 1536) (z=None, y=(22, 2)) -> (22, 4, 4, 1536)
I0410 05:14:18.875574 139691431679872 resnet_biggan.py:403] [Discriminator] before final processing: (22, 4, 4, 1536)
I0410 05:14:18.885649 139691431679872 resnet_biggan.py:407] [Discriminator] after final processing: (22, 4, 4, 1536)
I0410 05:14:18.891657 139691431679872 resnet_biggan.py:422] [Discriminator] embedded_y for projection: (22, 1536)
I0410 05:14:18.903622 139691431679872 s3gan.py:133] [Discriminator] rotation head (22, 1536) -> Tensor("discriminator_rotation/score_classify/add:0", shape=(22, 4), dtype=float32)
I0410 05:14:18.915979 139691431679872 s3gan.py:154] [Discriminator] (22, 2) -> aux_logits=(22, 2), y_predicted=(22, 2)
---------------------------------------------------s3gan.py/get_class_embedding,s
I0410 05:14:18.922018 139691431679872 s3gan.py:175] [Discriminator] embedded_y for projection: (22, 1536)
---------------------------------------------------s3gan.py/get_class_embedding,e
---------------------------------------------------s3gan.py/discriminator_with_additonal_heads,e
---------------------------------------------------s3gan.py/create_loss,e
---------------------------------------------------modular_gan.py/create_logits,e
################################################## mode == tf.estimator.ModeKeys.EVAL  ########################
INFO:tensorflow:Done calling model_fn.
I0410 05:14:19.004155 139691431679872 estimator.py:1171] Done calling model_fn.
INFO:tensorflow:Starting evaluation at 2020-04-10T05:14:19Z
I0410 05:14:19.019661 139691431679872 evaluation.py:255] Starting evaluation at 2020-04-10T05:14:19Z
INFO:tensorflow:Graph was finalized.
I0410 05:14:19.169442 139691431679872 monitored_session.py:246] Graph was finalized.
2020-04-10 05:14:19.170353: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-04-10 05:14:19.170685: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:00:04.0 name: Tesla P4 computeCapability: 6.1
coreClock: 1.1135GHz coreCount: 20 deviceMemorySize: 7.43GiB deviceMemoryBandwidth: 178.99GiB/s
2020-04-10 05:14:19.170740: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.1
2020-04-10 05:14:19.170768: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10
2020-04-10 05:14:19.170785: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcufft.so.10
2020-04-10 05:14:19.170821: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcurand.so.10
2020-04-10 05:14:19.170837: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusolver.so.10
2020-04-10 05:14:19.170886: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusparse.so.10
2020-04-10 05:14:19.170902: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudnn.so.7
2020-04-10 05:14:19.171005: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-04-10 05:14:19.171287: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-04-10 05:14:19.171499: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1703] Adding visible gpu devices: 0
2020-04-10 05:14:19.171551: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-04-10 05:14:19.171565: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      0 
2020-04-10 05:14:19.171575: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1121] 0:   N 
2020-04-10 05:14:19.171679: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-04-10 05:14:19.171961: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-04-10 05:14:19.172197: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1247] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 6850 MB memory) -> physical GPU (device: 0, name: Tesla P4, pci bus id: 0000:00:04.0, compute capability: 6.1)
INFO:tensorflow:Restoring parameters from /tmp/absl_testing/429596/model.ckpt-7200
I0410 05:14:19.173065 139691431679872 saver.py:1293] Restoring parameters from /tmp/absl_testing/429596/model.ckpt-7200
INFO:tensorflow:Running local_init_op.
I0410 05:14:19.583979 139691431679872 session_manager.py:505] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
I0410 05:14:19.606986 139691431679872 session_manager.py:508] Done running local_init_op.
INFO:tensorflow:Evaluation [1/10]
I0410 05:14:23.058712 139691431679872 evaluation.py:167] Evaluation [1/10]
INFO:tensorflow:Evaluation [2/10]
I0410 05:14:24.144054 139691431679872 evaluation.py:167] Evaluation [2/10]
INFO:tensorflow:Evaluation [3/10]
I0410 05:14:25.056326 139691431679872 evaluation.py:167] Evaluation [3/10]
INFO:tensorflow:Evaluation [4/10]
I0410 05:14:26.216199 139691431679872 evaluation.py:167] Evaluation [4/10]
INFO:tensorflow:Evaluation [5/10]
I0410 05:14:26.755339 139691431679872 evaluation.py:167] Evaluation [5/10]
INFO:tensorflow:Evaluation [6/10]
I0410 05:14:27.430964 139691431679872 evaluation.py:167] Evaluation [6/10]
INFO:tensorflow:Evaluation [7/10]
I0410 05:14:28.643941 139691431679872 evaluation.py:167] Evaluation [7/10]
INFO:tensorflow:Evaluation [8/10]
I0410 05:14:29.465724 139691431679872 evaluation.py:167] Evaluation [8/10]
INFO:tensorflow:Evaluation [9/10]
I0410 05:14:30.716683 139691431679872 evaluation.py:167] Evaluation [9/10]
INFO:tensorflow:Evaluation [10/10]
I0410 05:14:32.520099 139691431679872 evaluation.py:167] Evaluation [10/10]
INFO:tensorflow:Inference Time : 13.56879s
I0410 05:14:32.588620 139691431679872 evaluation.py:273] Inference Time : 13.56879s
INFO:tensorflow:Finished evaluation at 2020-04-10-05:14:32
I0410 05:14:32.588849 139691431679872 evaluation.py:276] Finished evaluation at 2020-04-10-05:14:32
INFO:tensorflow:Saving dict for global step 7200: accuracy = 1.0, global_step = 7200, loss = 0.08405964
I0410 05:14:32.589015 139691431679872 estimator.py:2066] Saving dict for global step 7200: accuracy = 1.0, global_step = 7200, loss = 0.08405964
INFO:tensorflow:Saving 'checkpoint_path' summary for global step 7200: /tmp/absl_testing/429596/model.ckpt-7200
I0410 05:14:32.589476 139691431679872 estimator.py:2127] Saving 'checkpoint_path' summary for global step 7200: /tmp/absl_testing/429596/model.ckpt-7200
INFO:tensorflow:global_step/sec: 0.550672
I0410 05:14:34.062998 139691431679872 basic_session_run_hooks.py:702] global_step/sec: 0.550672
INFO:tensorflow:loss = 0.09620043, step = 7200 (181.596 sec)
I0410 05:14:34.064109 139691431679872 basic_session_run_hooks.py:260] loss = 0.09620043, step = 7200 (181.596 sec)
INFO:tensorflow:global_step/sec: 0.679846
I0410 05:17:01.155149 139691431679872 basic_session_run_hooks.py:702] global_step/sec: 0.679846
INFO:tensorflow:loss = 0.0006764007, step = 7300 (147.092 sec)
I0410 05:17:01.156113 139691431679872 basic_session_run_hooks.py:260] loss = 0.0006764007, step = 7300 (147.092 sec)
INFO:tensorflow:Calling checkpoint listeners before saving checkpoint 7400...
I0410 05:19:26.920133 139691431679872 basic_session_run_hooks.py:614] Calling checkpoint listeners before saving checkpoint 7400...
INFO:tensorflow:Saving checkpoints for 7400 into /tmp/absl_testing/429596/model.ckpt.
I0410 05:19:26.920429 139691431679872 basic_session_run_hooks.py:618] Saving checkpoints for 7400 into /tmp/absl_testing/429596/model.ckpt.
INFO:tensorflow:Calling checkpoint listeners after saving checkpoint 7400...
I0410 05:19:46.099682 139691431679872 basic_session_run_hooks.py:626] Calling checkpoint listeners after saving checkpoint 7400...
INFO:tensorflow:Skip the current checkpoint eval due to throttle secs (600 secs).
I0410 05:19:46.099991 139691431679872 training.py:528] Skip the current checkpoint eval due to throttle secs (600 secs).
INFO:tensorflow:global_step/sec: 0.600882
I0410 05:19:47.577226 139691431679872 basic_session_run_hooks.py:702] global_step/sec: 0.600882
INFO:tensorflow:loss = 0.0010226156, step = 7400 (166.422 sec)
I0410 05:19:47.578194 139691431679872 basic_session_run_hooks.py:260] loss = 0.0010226156, step = 7400 (166.422 sec)
INFO:tensorflow:global_step/sec: 0.679457
I0410 05:22:14.753632 139691431679872 basic_session_run_hooks.py:702] global_step/sec: 0.679457
INFO:tensorflow:loss = 9.709734e-05, step = 7500 (147.176 sec)
I0410 05:22:14.754607 139691431679872 basic_session_run_hooks.py:260] loss = 9.709734e-05, step = 7500 (147.176 sec)
INFO:tensorflow:Calling checkpoint listeners before saving checkpoint 7600...
I0410 05:24:40.446209 139691431679872 basic_session_run_hooks.py:614] Calling checkpoint listeners before saving checkpoint 7600...
INFO:tensorflow:Saving checkpoints for 7600 into /tmp/absl_testing/429596/model.ckpt.
I0410 05:24:40.446464 139691431679872 basic_session_run_hooks.py:618] Saving checkpoints for 7600 into /tmp/absl_testing/429596/model.ckpt.
INFO:tensorflow:Calling checkpoint listeners after saving checkpoint 7600...
I0410 05:24:56.437478 139691431679872 basic_session_run_hooks.py:626] Calling checkpoint listeners after saving checkpoint 7600...
--------------------------------------------datasets.py/eval_input_fn,s
W0410 05:24:59.132316 139691431679872 datasets.py:170] No TPUContext, using unmodified dataset seed 547.
I0410 05:24:59.132506 139691431679872 datasets.py:348] eval_input_fn(): params={'use_tpu': False, 'train_batch_size': 8, 'batch_size': 8} seed=547
--------befor self._load_dataset------------------split = validation self._eval_split= validation
--------------------------------------------datasets.py/_load_dataset,s
!!!!!!!!!!!!!!!!!!!!!!----load_local_datasets,  _local_test_ds_dir= /content/drive/My Drive/drive/gan/test
-----------------------------------------get_local_datasets,s
-----------------------------------------get_local_datasets,e
--------------------------------------------modular_gan.py/_preprocess_fn,s
I0410 05:25:00.294334 139691431679872 api.py:587] _preprocess_fn(): images=Tensor("args_0:0", shape=(128, 128, 3), dtype=float32), labels=Tensor("args_1:0", shape=(), dtype=int32), seed=547
--------------------------------------------modular_gan.py/_preprocess_fn,e
I0410 05:25:00.322136 139691431679872 api.py:587] Passing random offset: Tensor("Cast:0", shape=(), dtype=int32) with data ({'images': <tf.Tensor 'args_1:0' shape=(128, 128, 3) dtype=float32>, 'z': <tf.Tensor 'args_3:0' shape=(120,) dtype=float32>, 'sampled_labels': <tf.Tensor 'args_2:0' shape=() dtype=int32>}, <tf.Tensor 'args_4:0' shape=() dtype=int32>).
--------------------------------------------datasets.py/eval_input_fn,e
INFO:tensorflow:Calling model_fn.
I0410 05:25:00.337761 139691431679872 estimator.py:1169] Calling model_fn.
--------------------------------------------modular_gan.py/model_fn,s
I0410 05:25:00.337935 139691431679872 modular_gan.py:589] model_fn(): features={'images': <tf.Tensor 'IteratorGetNext:1' shape=(8, 128, 128, 3) dtype=float32>, 'z': <tf.Tensor 'IteratorGetNext:3' shape=(8, 120) dtype=float32>, 'sampled_labels': <tf.Tensor 'IteratorGetNext:2' shape=(8,) dtype=int32>, '_RANDOM_OFFSET': <tf.Tensor 'IteratorGetNext:0' shape=(8,) dtype=int32>}, labels=Tensor("IteratorGetNext:4", shape=(8,), dtype=int32),mode=eval, params={'use_tpu': False, 'train_batch_size': 8, 'batch_size': 8}
#Clean old summaries from previous calls to model_fn().
# Get features and labels for each sub-step.
--------------------------------------------modular_gan.py/_split_inputs_and_generate_samples,s
I0410 05:25:00.344478 139691431679872 resnet_biggan.py:236] [Generator] inputs are z=(8, 120), y=(8, 2)
I0410 05:25:00.354506 139691431679872 resnet_biggan.py:262] [Generator] z0=(8, 20), z_per_block=['(8, 20)', '(8, 20)', '(8, 20)', '(8, 20)', '(8, 20)'], y_per_block=['(8, 148)', '(8, 148)', '(8, 148)', '(8, 148)', '(8, 148)']
I0410 05:25:00.405899 139691431679872 resnet_biggan.py:150] [Block] (8, 4, 4, 1536) (z=(8, 20), y=(8, 148)) -> (8, 8, 8, 1536)
I0410 05:25:00.443202 139691431679872 resnet_biggan.py:150] [Block] (8, 8, 8, 1536) (z=(8, 20), y=(8, 148)) -> (8, 16, 16, 768)
I0410 05:25:00.483472 139691431679872 resnet_biggan.py:150] [Block] (8, 16, 16, 768) (z=(8, 20), y=(8, 148)) -> (8, 32, 32, 384)
I0410 05:25:00.520931 139691431679872 resnet_biggan.py:150] [Block] (8, 32, 32, 384) (z=(8, 20), y=(8, 148)) -> (8, 64, 64, 192)
I0410 05:25:00.521074 139691431679872 resnet_biggan.py:289] [Generator] Applying non-local block to (8, 64, 64, 192)
I0410 05:25:00.602013 139691431679872 resnet_biggan.py:150] [Block] (8, 64, 64, 192) (z=(8, 20), y=(8, 148)) -> (8, 128, 128, 96)
I0410 05:25:00.602213 139691431679872 resnet_biggan.py:294] [Generator] before final processing: (8, 128, 128, 96)
I0410 05:25:00.636614 139691431679872 resnet_biggan.py:300] [Generator] after final processing: (8, 128, 128, 3)
--------------------------------------------modular_gan.py/_split_inputs_and_generate_samples,e
---------------------------------------------------modular_gan.py/create_logits,s
I0410 05:25:00.640121 139691431679872 tpu_random.py:86] Got global random offset: Tensor("strided_slice:0", shape=(), dtype=int32)
---------------------------------------------------s3gan.py/create_loss,s
W0410 05:25:00.642882 139691431679872 s3gan.py:237] Computing fake images for every sub step separately.
I0410 05:25:00.643081 139691431679872 resnet_biggan.py:236] [Generator] inputs are z=(8, 120), y=(8, 2)
I0410 05:25:00.648561 139691431679872 resnet_biggan.py:262] [Generator] z0=(8, 20), z_per_block=['(8, 20)', '(8, 20)', '(8, 20)', '(8, 20)', '(8, 20)'], y_per_block=['(8, 148)', '(8, 148)', '(8, 148)', '(8, 148)', '(8, 148)']
I0410 05:25:00.667239 139691431679872 resnet_biggan.py:150] [Block] (8, 4, 4, 1536) (z=(8, 20), y=(8, 148)) -> (8, 8, 8, 1536)
I0410 05:25:00.685741 139691431679872 resnet_biggan.py:150] [Block] (8, 8, 8, 1536) (z=(8, 20), y=(8, 148)) -> (8, 16, 16, 768)
I0410 05:25:00.701694 139691431679872 resnet_biggan.py:150] [Block] (8, 16, 16, 768) (z=(8, 20), y=(8, 148)) -> (8, 32, 32, 384)
I0410 05:25:00.717566 139691431679872 resnet_biggan.py:150] [Block] (8, 32, 32, 384) (z=(8, 20), y=(8, 148)) -> (8, 64, 64, 192)
I0410 05:25:00.717711 139691431679872 resnet_biggan.py:289] [Generator] Applying non-local block to (8, 64, 64, 192)
I0410 05:25:00.753620 139691431679872 resnet_biggan.py:150] [Block] (8, 64, 64, 192) (z=(8, 20), y=(8, 148)) -> (8, 128, 128, 96)
I0410 05:25:00.753778 139691431679872 resnet_biggan.py:294] [Generator] before final processing: (8, 128, 128, 96)
I0410 05:25:00.768049 139691431679872 resnet_biggan.py:300] [Generator] after final processing: (8, 128, 128, 3)
I0410 05:25:00.770112 139691431679872 s3gan.py:249] bs=8, rotated_bs=4, num_rot_examples=1
---------------------------------------------------s3gan.py/merge_with_rotation_data,s
---------------------------------------------------s3gan.py/merge_with_rotation_data,e
--------------------------------------------------------------------s3gan.py/discriminator_with_additonal_heads,s
I0410 05:25:00.794951 139691431679872 resnet_biggan.py:379] [Discriminator] inputs are x=(22, 128, 128, 3), y=(22, 2)
I0410 05:25:00.827023 139691431679872 resnet_biggan.py:150] [Block] (22, 128, 128, 3) (z=None, y=(22, 2)) -> (22, 64, 64, 96)
I0410 05:25:00.827167 139691431679872 resnet_biggan.py:398] [Discriminator] Applying non-local block to (22, 64, 64, 96)
I0410 05:25:00.898756 139691431679872 resnet_biggan.py:150] [Block] (22, 64, 64, 96) (z=None, y=(22, 2)) -> (22, 32, 32, 192)
I0410 05:25:00.929104 139691431679872 resnet_biggan.py:150] [Block] (22, 32, 32, 192) (z=None, y=(22, 2)) -> (22, 16, 16, 384)
I0410 05:25:00.959451 139691431679872 resnet_biggan.py:150] [Block] (22, 16, 16, 384) (z=None, y=(22, 2)) -> (22, 8, 8, 768)
I0410 05:25:00.990593 139691431679872 resnet_biggan.py:150] [Block] (22, 8, 8, 768) (z=None, y=(22, 2)) -> (22, 4, 4, 1536)
I0410 05:25:01.009601 139691431679872 resnet_biggan.py:150] [Block] (22, 4, 4, 1536) (z=None, y=(22, 2)) -> (22, 4, 4, 1536)
I0410 05:25:01.009744 139691431679872 resnet_biggan.py:403] [Discriminator] before final processing: (22, 4, 4, 1536)
I0410 05:25:01.020273 139691431679872 resnet_biggan.py:407] [Discriminator] after final processing: (22, 4, 4, 1536)
I0410 05:25:01.027048 139691431679872 resnet_biggan.py:422] [Discriminator] embedded_y for projection: (22, 1536)
I0410 05:25:01.039109 139691431679872 s3gan.py:133] [Discriminator] rotation head (22, 1536) -> Tensor("discriminator_rotation/score_classify/add:0", shape=(22, 4), dtype=float32)
I0410 05:25:01.051792 139691431679872 s3gan.py:154] [Discriminator] (22, 2) -> aux_logits=(22, 2), y_predicted=(22, 2)
---------------------------------------------------s3gan.py/get_class_embedding,s
I0410 05:25:01.057772 139691431679872 s3gan.py:175] [Discriminator] embedded_y for projection: (22, 1536)
---------------------------------------------------s3gan.py/get_class_embedding,e
---------------------------------------------------s3gan.py/discriminator_with_additonal_heads,e
---------------------------------------------------s3gan.py/create_loss,e
---------------------------------------------------modular_gan.py/create_logits,e
################################################## mode == tf.estimator.ModeKeys.EVAL  ########################
INFO:tensorflow:Done calling model_fn.
I0410 05:25:01.143010 139691431679872 estimator.py:1171] Done calling model_fn.
INFO:tensorflow:Starting evaluation at 2020-04-10T05:25:01Z
I0410 05:25:01.158330 139691431679872 evaluation.py:255] Starting evaluation at 2020-04-10T05:25:01Z
INFO:tensorflow:Graph was finalized.
I0410 05:25:01.738709 139691431679872 monitored_session.py:246] Graph was finalized.
2020-04-10 05:25:01.739448: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-04-10 05:25:01.739786: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:00:04.0 name: Tesla P4 computeCapability: 6.1
coreClock: 1.1135GHz coreCount: 20 deviceMemorySize: 7.43GiB deviceMemoryBandwidth: 178.99GiB/s
2020-04-10 05:25:01.739865: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.1
2020-04-10 05:25:01.739893: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10
2020-04-10 05:25:01.739913: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcufft.so.10
2020-04-10 05:25:01.739931: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcurand.so.10
2020-04-10 05:25:01.739947: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusolver.so.10
2020-04-10 05:25:01.740001: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusparse.so.10
2020-04-10 05:25:01.740019: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudnn.so.7
2020-04-10 05:25:01.740101: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-04-10 05:25:01.740381: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-04-10 05:25:01.740595: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1703] Adding visible gpu devices: 0
2020-04-10 05:25:01.740643: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-04-10 05:25:01.740658: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      0 
2020-04-10 05:25:01.740668: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1121] 0:   N 
2020-04-10 05:25:01.740827: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-04-10 05:25:01.741132: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-04-10 05:25:01.741366: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1247] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 6850 MB memory) -> physical GPU (device: 0, name: Tesla P4, pci bus id: 0000:00:04.0, compute capability: 6.1)
INFO:tensorflow:Restoring parameters from /tmp/absl_testing/429596/model.ckpt-7600
I0410 05:25:01.742424 139691431679872 saver.py:1293] Restoring parameters from /tmp/absl_testing/429596/model.ckpt-7600
INFO:tensorflow:Running local_init_op.
I0410 05:25:02.147464 139691431679872 session_manager.py:505] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
I0410 05:25:02.169259 139691431679872 session_manager.py:508] Done running local_init_op.
INFO:tensorflow:Evaluation [1/10]
I0410 05:25:05.323210 139691431679872 evaluation.py:167] Evaluation [1/10]
INFO:tensorflow:Evaluation [2/10]
I0410 05:25:06.627750 139691431679872 evaluation.py:167] Evaluation [2/10]
INFO:tensorflow:Evaluation [3/10]
I0410 05:25:07.555962 139691431679872 evaluation.py:167] Evaluation [3/10]
INFO:tensorflow:Evaluation [4/10]
I0410 05:25:08.163352 139691431679872 evaluation.py:167] Evaluation [4/10]
INFO:tensorflow:Evaluation [5/10]
I0410 05:25:08.461122 139691431679872 evaluation.py:167] Evaluation [5/10]
INFO:tensorflow:Evaluation [6/10]
I0410 05:25:09.319523 139691431679872 evaluation.py:167] Evaluation [6/10]
INFO:tensorflow:Evaluation [7/10]
I0410 05:25:09.931262 139691431679872 evaluation.py:167] Evaluation [7/10]
INFO:tensorflow:Evaluation [8/10]
I0410 05:25:10.820027 139691431679872 evaluation.py:167] Evaluation [8/10]
INFO:tensorflow:Evaluation [9/10]
I0410 05:25:12.495566 139691431679872 evaluation.py:167] Evaluation [9/10]
INFO:tensorflow:Evaluation [10/10]
I0410 05:25:13.374783 139691431679872 evaluation.py:167] Evaluation [10/10]
INFO:tensorflow:Inference Time : 12.52243s
I0410 05:25:13.680910 139691431679872 evaluation.py:273] Inference Time : 12.52243s
INFO:tensorflow:Finished evaluation at 2020-04-10-05:25:13
I0410 05:25:13.681121 139691431679872 evaluation.py:276] Finished evaluation at 2020-04-10-05:25:13
INFO:tensorflow:Saving dict for global step 7600: accuracy = 1.0, global_step = 7600, loss = 0.008839092
I0410 05:25:13.681274 139691431679872 estimator.py:2066] Saving dict for global step 7600: accuracy = 1.0, global_step = 7600, loss = 0.008839092
INFO:tensorflow:Saving 'checkpoint_path' summary for global step 7600: /tmp/absl_testing/429596/model.ckpt-7600
I0410 05:25:13.681754 139691431679872 estimator.py:2127] Saving 'checkpoint_path' summary for global step 7600: /tmp/absl_testing/429596/model.ckpt-7600
INFO:tensorflow:global_step/sec: 0.554339
I0410 05:25:15.148603 139691431679872 basic_session_run_hooks.py:702] global_step/sec: 0.554339
INFO:tensorflow:loss = 0.0005966729, step = 7600 (180.395 sec)
I0410 05:25:15.149663 139691431679872 basic_session_run_hooks.py:260] loss = 0.0005966729, step = 7600 (180.395 sec)
INFO:tensorflow:global_step/sec: 0.679643
I0410 05:27:42.284656 139691431679872 basic_session_run_hooks.py:702] global_step/sec: 0.679643
INFO:tensorflow:loss = 0.004074022, step = 7700 (147.136 sec)
I0410 05:27:42.285527 139691431679872 basic_session_run_hooks.py:260] loss = 0.004074022, step = 7700 (147.136 sec)
INFO:tensorflow:Calling checkpoint listeners before saving checkpoint 7800...
I0410 05:30:08.069542 139691431679872 basic_session_run_hooks.py:614] Calling checkpoint listeners before saving checkpoint 7800...
INFO:tensorflow:Saving checkpoints for 7800 into /tmp/absl_testing/429596/model.ckpt.
I0410 05:30:08.069853 139691431679872 basic_session_run_hooks.py:618] Saving checkpoints for 7800 into /tmp/absl_testing/429596/model.ckpt.
INFO:tensorflow:Calling checkpoint listeners after saving checkpoint 7800...
I0410 05:30:24.554305 139691431679872 basic_session_run_hooks.py:626] Calling checkpoint listeners after saving checkpoint 7800...
INFO:tensorflow:Skip the current checkpoint eval due to throttle secs (600 secs).
I0410 05:30:24.554747 139691431679872 training.py:528] Skip the current checkpoint eval due to throttle secs (600 secs).
INFO:tensorflow:global_step/sec: 0.610664
I0410 05:30:26.040681 139691431679872 basic_session_run_hooks.py:702] global_step/sec: 0.610664
INFO:tensorflow:loss = 0.001956251, step = 7800 (163.756 sec)
I0410 05:30:26.041821 139691431679872 basic_session_run_hooks.py:260] loss = 0.001956251, step = 7800 (163.756 sec)
INFO:tensorflow:global_step/sec: 0.680241
I0410 05:32:53.047511 139691431679872 basic_session_run_hooks.py:702] global_step/sec: 0.680241
INFO:tensorflow:loss = 1.0877637e-05, step = 7900 (147.007 sec)
I0410 05:32:53.048598 139691431679872 basic_session_run_hooks.py:260] loss = 1.0877637e-05, step = 7900 (147.007 sec)
INFO:tensorflow:Calling checkpoint listeners before saving checkpoint 8000...
I0410 05:35:18.783517 139691431679872 basic_session_run_hooks.py:614] Calling checkpoint listeners before saving checkpoint 8000...
INFO:tensorflow:Saving checkpoints for 8000 into /tmp/absl_testing/429596/model.ckpt.
I0410 05:35:18.783781 139691431679872 basic_session_run_hooks.py:618] Saving checkpoints for 8000 into /tmp/absl_testing/429596/model.ckpt.
INFO:tensorflow:Calling checkpoint listeners after saving checkpoint 8000...
I0410 05:35:36.482642 139691431679872 basic_session_run_hooks.py:626] Calling checkpoint listeners after saving checkpoint 8000...
--------------------------------------------datasets.py/eval_input_fn,s
W0410 05:35:36.636848 139691431679872 datasets.py:170] No TPUContext, using unmodified dataset seed 547.
I0410 05:35:36.636997 139691431679872 datasets.py:348] eval_input_fn(): params={'use_tpu': False, 'train_batch_size': 8, 'batch_size': 8} seed=547
--------befor self._load_dataset------------------split = validation self._eval_split= validation
--------------------------------------------datasets.py/_load_dataset,s
!!!!!!!!!!!!!!!!!!!!!!----load_local_datasets,  _local_test_ds_dir= /content/drive/My Drive/drive/gan/test
-----------------------------------------get_local_datasets,s
-----------------------------------------get_local_datasets,e
--------------------------------------------modular_gan.py/_preprocess_fn,s
I0410 05:35:36.722465 139691431679872 api.py:587] _preprocess_fn(): images=Tensor("args_0:0", shape=(128, 128, 3), dtype=float32), labels=Tensor("args_1:0", shape=(), dtype=int32), seed=547
--------------------------------------------modular_gan.py/_preprocess_fn,e
I0410 05:35:36.751596 139691431679872 api.py:587] Passing random offset: Tensor("Cast:0", shape=(), dtype=int32) with data ({'images': <tf.Tensor 'args_1:0' shape=(128, 128, 3) dtype=float32>, 'z': <tf.Tensor 'args_3:0' shape=(120,) dtype=float32>, 'sampled_labels': <tf.Tensor 'args_2:0' shape=() dtype=int32>}, <tf.Tensor 'args_4:0' shape=() dtype=int32>).
--------------------------------------------datasets.py/eval_input_fn,e
INFO:tensorflow:Calling model_fn.
I0410 05:35:36.767786 139691431679872 estimator.py:1169] Calling model_fn.
--------------------------------------------modular_gan.py/model_fn,s
I0410 05:35:36.767952 139691431679872 modular_gan.py:589] model_fn(): features={'images': <tf.Tensor 'IteratorGetNext:1' shape=(8, 128, 128, 3) dtype=float32>, 'z': <tf.Tensor 'IteratorGetNext:3' shape=(8, 120) dtype=float32>, 'sampled_labels': <tf.Tensor 'IteratorGetNext:2' shape=(8,) dtype=int32>, '_RANDOM_OFFSET': <tf.Tensor 'IteratorGetNext:0' shape=(8,) dtype=int32>}, labels=Tensor("IteratorGetNext:4", shape=(8,), dtype=int32),mode=eval, params={'use_tpu': False, 'train_batch_size': 8, 'batch_size': 8}
#Clean old summaries from previous calls to model_fn().
# Get features and labels for each sub-step.
--------------------------------------------modular_gan.py/_split_inputs_and_generate_samples,s
I0410 05:35:36.775083 139691431679872 resnet_biggan.py:236] [Generator] inputs are z=(8, 120), y=(8, 2)
I0410 05:35:36.786522 139691431679872 resnet_biggan.py:262] [Generator] z0=(8, 20), z_per_block=['(8, 20)', '(8, 20)', '(8, 20)', '(8, 20)', '(8, 20)'], y_per_block=['(8, 148)', '(8, 148)', '(8, 148)', '(8, 148)', '(8, 148)']
I0410 05:35:36.832868 139691431679872 resnet_biggan.py:150] [Block] (8, 4, 4, 1536) (z=(8, 20), y=(8, 148)) -> (8, 8, 8, 1536)
I0410 05:35:36.869133 139691431679872 resnet_biggan.py:150] [Block] (8, 8, 8, 1536) (z=(8, 20), y=(8, 148)) -> (8, 16, 16, 768)
I0410 05:35:36.913450 139691431679872 resnet_biggan.py:150] [Block] (8, 16, 16, 768) (z=(8, 20), y=(8, 148)) -> (8, 32, 32, 384)
I0410 05:35:36.950345 139691431679872 resnet_biggan.py:150] [Block] (8, 32, 32, 384) (z=(8, 20), y=(8, 148)) -> (8, 64, 64, 192)
I0410 05:35:36.950493 139691431679872 resnet_biggan.py:289] [Generator] Applying non-local block to (8, 64, 64, 192)
I0410 05:35:37.024693 139691431679872 resnet_biggan.py:150] [Block] (8, 64, 64, 192) (z=(8, 20), y=(8, 148)) -> (8, 128, 128, 96)
I0410 05:35:37.024862 139691431679872 resnet_biggan.py:294] [Generator] before final processing: (8, 128, 128, 96)
I0410 05:35:37.056352 139691431679872 resnet_biggan.py:300] [Generator] after final processing: (8, 128, 128, 3)
--------------------------------------------modular_gan.py/_split_inputs_and_generate_samples,e
---------------------------------------------------modular_gan.py/create_logits,s
I0410 05:35:37.059672 139691431679872 tpu_random.py:86] Got global random offset: Tensor("strided_slice:0", shape=(), dtype=int32)
---------------------------------------------------s3gan.py/create_loss,s
W0410 05:35:37.062178 139691431679872 s3gan.py:237] Computing fake images for every sub step separately.
I0410 05:35:37.062383 139691431679872 resnet_biggan.py:236] [Generator] inputs are z=(8, 120), y=(8, 2)
I0410 05:35:37.068125 139691431679872 resnet_biggan.py:262] [Generator] z0=(8, 20), z_per_block=['(8, 20)', '(8, 20)', '(8, 20)', '(8, 20)', '(8, 20)'], y_per_block=['(8, 148)', '(8, 148)', '(8, 148)', '(8, 148)', '(8, 148)']
I0410 05:35:37.086866 139691431679872 resnet_biggan.py:150] [Block] (8, 4, 4, 1536) (z=(8, 20), y=(8, 148)) -> (8, 8, 8, 1536)
I0410 05:35:37.105005 139691431679872 resnet_biggan.py:150] [Block] (8, 8, 8, 1536) (z=(8, 20), y=(8, 148)) -> (8, 16, 16, 768)
I0410 05:35:37.124135 139691431679872 resnet_biggan.py:150] [Block] (8, 16, 16, 768) (z=(8, 20), y=(8, 148)) -> (8, 32, 32, 384)
I0410 05:35:37.144133 139691431679872 resnet_biggan.py:150] [Block] (8, 32, 32, 384) (z=(8, 20), y=(8, 148)) -> (8, 64, 64, 192)
I0410 05:35:37.144373 139691431679872 resnet_biggan.py:289] [Generator] Applying non-local block to (8, 64, 64, 192)
I0410 05:35:37.186326 139691431679872 resnet_biggan.py:150] [Block] (8, 64, 64, 192) (z=(8, 20), y=(8, 148)) -> (8, 128, 128, 96)
I0410 05:35:37.186508 139691431679872 resnet_biggan.py:294] [Generator] before final processing: (8, 128, 128, 96)
I0410 05:35:37.201103 139691431679872 resnet_biggan.py:300] [Generator] after final processing: (8, 128, 128, 3)
I0410 05:35:37.202855 139691431679872 s3gan.py:249] bs=8, rotated_bs=4, num_rot_examples=1
---------------------------------------------------s3gan.py/merge_with_rotation_data,s
---------------------------------------------------s3gan.py/merge_with_rotation_data,e
--------------------------------------------------------------------s3gan.py/discriminator_with_additonal_heads,s
I0410 05:35:37.227403 139691431679872 resnet_biggan.py:379] [Discriminator] inputs are x=(22, 128, 128, 3), y=(22, 2)
I0410 05:35:37.258750 139691431679872 resnet_biggan.py:150] [Block] (22, 128, 128, 3) (z=None, y=(22, 2)) -> (22, 64, 64, 96)
I0410 05:35:37.258914 139691431679872 resnet_biggan.py:398] [Discriminator] Applying non-local block to (22, 64, 64, 96)
I0410 05:35:37.331185 139691431679872 resnet_biggan.py:150] [Block] (22, 64, 64, 96) (z=None, y=(22, 2)) -> (22, 32, 32, 192)
I0410 05:35:37.362070 139691431679872 resnet_biggan.py:150] [Block] (22, 32, 32, 192) (z=None, y=(22, 2)) -> (22, 16, 16, 384)
I0410 05:35:37.393351 139691431679872 resnet_biggan.py:150] [Block] (22, 16, 16, 384) (z=None, y=(22, 2)) -> (22, 8, 8, 768)
I0410 05:35:37.424829 139691431679872 resnet_biggan.py:150] [Block] (22, 8, 8, 768) (z=None, y=(22, 2)) -> (22, 4, 4, 1536)
I0410 05:35:37.444167 139691431679872 resnet_biggan.py:150] [Block] (22, 4, 4, 1536) (z=None, y=(22, 2)) -> (22, 4, 4, 1536)
I0410 05:35:37.444312 139691431679872 resnet_biggan.py:403] [Discriminator] before final processing: (22, 4, 4, 1536)
I0410 05:35:37.454369 139691431679872 resnet_biggan.py:407] [Discriminator] after final processing: (22, 4, 4, 1536)
I0410 05:35:37.460209 139691431679872 resnet_biggan.py:422] [Discriminator] embedded_y for projection: (22, 1536)
I0410 05:35:37.472487 139691431679872 s3gan.py:133] [Discriminator] rotation head (22, 1536) -> Tensor("discriminator_rotation/score_classify/add:0", shape=(22, 4), dtype=float32)
I0410 05:35:37.485155 139691431679872 s3gan.py:154] [Discriminator] (22, 2) -> aux_logits=(22, 2), y_predicted=(22, 2)
---------------------------------------------------s3gan.py/get_class_embedding,s
I0410 05:35:37.491632 139691431679872 s3gan.py:175] [Discriminator] embedded_y for projection: (22, 1536)
---------------------------------------------------s3gan.py/get_class_embedding,e
---------------------------------------------------s3gan.py/discriminator_with_additonal_heads,e
---------------------------------------------------s3gan.py/create_loss,e
---------------------------------------------------modular_gan.py/create_logits,e
################################################## mode == tf.estimator.ModeKeys.EVAL  ########################
INFO:tensorflow:Done calling model_fn.
I0410 05:35:37.572207 139691431679872 estimator.py:1171] Done calling model_fn.
INFO:tensorflow:Starting evaluation at 2020-04-10T05:35:37Z
I0410 05:35:37.587630 139691431679872 evaluation.py:255] Starting evaluation at 2020-04-10T05:35:37Z
INFO:tensorflow:Graph was finalized.
I0410 05:35:37.729244 139691431679872 monitored_session.py:246] Graph was finalized.
2020-04-10 05:35:37.729903: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-04-10 05:35:37.730201: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:00:04.0 name: Tesla P4 computeCapability: 6.1
coreClock: 1.1135GHz coreCount: 20 deviceMemorySize: 7.43GiB deviceMemoryBandwidth: 178.99GiB/s
2020-04-10 05:35:37.730253: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.1
2020-04-10 05:35:37.730276: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10
2020-04-10 05:35:37.730293: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcufft.so.10
2020-04-10 05:35:37.730308: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcurand.so.10
2020-04-10 05:35:37.730322: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusolver.so.10
2020-04-10 05:35:37.730365: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusparse.so.10
2020-04-10 05:35:37.730381: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudnn.so.7
2020-04-10 05:35:37.730451: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-04-10 05:35:37.730721: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-04-10 05:35:37.730995: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1703] Adding visible gpu devices: 0
2020-04-10 05:35:37.731038: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-04-10 05:35:37.731051: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      0 
2020-04-10 05:35:37.731061: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1121] 0:   N 
2020-04-10 05:35:37.731147: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-04-10 05:35:37.731406: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-04-10 05:35:37.731621: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1247] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 6850 MB memory) -> physical GPU (device: 0, name: Tesla P4, pci bus id: 0000:00:04.0, compute capability: 6.1)
INFO:tensorflow:Restoring parameters from /tmp/absl_testing/429596/model.ckpt-8000
I0410 05:35:37.732515 139691431679872 saver.py:1293] Restoring parameters from /tmp/absl_testing/429596/model.ckpt-8000
INFO:tensorflow:Running local_init_op.
I0410 05:35:38.144348 139691431679872 session_manager.py:505] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
I0410 05:35:38.165093 139691431679872 session_manager.py:508] Done running local_init_op.
INFO:tensorflow:Evaluation [1/10]
I0410 05:35:40.825335 139691431679872 evaluation.py:167] Evaluation [1/10]
INFO:tensorflow:Evaluation [2/10]
I0410 05:35:41.903657 139691431679872 evaluation.py:167] Evaluation [2/10]
INFO:tensorflow:Evaluation [3/10]
I0410 05:35:42.937341 139691431679872 evaluation.py:167] Evaluation [3/10]
INFO:tensorflow:Evaluation [4/10]
I0410 05:35:43.880535 139691431679872 evaluation.py:167] Evaluation [4/10]
INFO:tensorflow:Evaluation [5/10]
I0410 05:35:45.383131 139691431679872 evaluation.py:167] Evaluation [5/10]
INFO:tensorflow:Evaluation [6/10]
I0410 05:35:50.927531 139691431679872 evaluation.py:167] Evaluation [6/10]
INFO:tensorflow:Evaluation [7/10]
I0410 05:35:53.295256 139691431679872 evaluation.py:167] Evaluation [7/10]
INFO:tensorflow:Evaluation [8/10]
I0410 05:35:53.855034 139691431679872 evaluation.py:167] Evaluation [8/10]
INFO:tensorflow:Evaluation [9/10]
I0410 05:35:54.945851 139691431679872 evaluation.py:167] Evaluation [9/10]
INFO:tensorflow:Evaluation [10/10]
I0410 05:35:55.812520 139691431679872 evaluation.py:167] Evaluation [10/10]
INFO:tensorflow:Inference Time : 18.30371s
I0410 05:35:55.891498 139691431679872 evaluation.py:273] Inference Time : 18.30371s
INFO:tensorflow:Finished evaluation at 2020-04-10-05:35:55
I0410 05:35:55.891720 139691431679872 evaluation.py:276] Finished evaluation at 2020-04-10-05:35:55
INFO:tensorflow:Saving dict for global step 8000: accuracy = 1.0, global_step = 8000, loss = 0.005611104
I0410 05:35:55.891898 139691431679872 estimator.py:2066] Saving dict for global step 8000: accuracy = 1.0, global_step = 8000, loss = 0.005611104
INFO:tensorflow:Saving 'checkpoint_path' summary for global step 8000: /tmp/absl_testing/429596/model.ckpt-8000
I0410 05:35:55.892479 139691431679872 estimator.py:2127] Saving 'checkpoint_path' summary for global step 8000: /tmp/absl_testing/429596/model.ckpt-8000
INFO:tensorflow:global_step/sec: 0.542564
I0410 05:35:57.357485 139691431679872 basic_session_run_hooks.py:702] global_step/sec: 0.542564
INFO:tensorflow:loss = 0.07163789, step = 8000 (184.310 sec)
I0410 05:35:57.358350 139691431679872 basic_session_run_hooks.py:260] loss = 0.07163789, step = 8000 (184.310 sec)
INFO:tensorflow:global_step/sec: 0.68029
I0410 05:38:24.353615 139691431679872 basic_session_run_hooks.py:702] global_step/sec: 0.68029
INFO:tensorflow:loss = 5.9902195e-06, step = 8100 (146.996 sec)
I0410 05:38:24.354659 139691431679872 basic_session_run_hooks.py:260] loss = 5.9902195e-06, step = 8100 (146.996 sec)
INFO:tensorflow:Calling checkpoint listeners before saving checkpoint 8200...
I0410 05:40:49.977175 139691431679872 basic_session_run_hooks.py:614] Calling checkpoint listeners before saving checkpoint 8200...
INFO:tensorflow:Saving checkpoints for 8200 into /tmp/absl_testing/429596/model.ckpt.
I0410 05:40:49.977442 139691431679872 basic_session_run_hooks.py:618] Saving checkpoints for 8200 into /tmp/absl_testing/429596/model.ckpt.
INFO:tensorflow:Calling checkpoint listeners after saving checkpoint 8200...
I0410 05:41:06.619204 139691431679872 basic_session_run_hooks.py:626] Calling checkpoint listeners after saving checkpoint 8200...
INFO:tensorflow:Skip the current checkpoint eval due to throttle secs (600 secs).
I0410 05:41:06.619493 139691431679872 training.py:528] Skip the current checkpoint eval due to throttle secs (600 secs).
INFO:tensorflow:global_step/sec: 0.610655
I0410 05:41:08.112133 139691431679872 basic_session_run_hooks.py:702] global_step/sec: 0.610655
INFO:tensorflow:loss = 0.11672343, step = 8200 (163.758 sec)
I0410 05:41:08.113064 139691431679872 basic_session_run_hooks.py:260] loss = 0.11672343, step = 8200 (163.758 sec)
INFO:tensorflow:global_step/sec: 0.679709
I0410 05:43:35.233978 139691431679872 basic_session_run_hooks.py:702] global_step/sec: 0.679709
INFO:tensorflow:loss = 0.071658604, step = 8300 (147.122 sec)
I0410 05:43:35.235028 139691431679872 basic_session_run_hooks.py:260] loss = 0.071658604, step = 8300 (147.122 sec)
INFO:tensorflow:Calling checkpoint listeners before saving checkpoint 8400...
I0410 05:46:00.924923 139691431679872 basic_session_run_hooks.py:614] Calling checkpoint listeners before saving checkpoint 8400...
INFO:tensorflow:Saving checkpoints for 8400 into /tmp/absl_testing/429596/model.ckpt.
I0410 05:46:00.925225 139691431679872 basic_session_run_hooks.py:618] Saving checkpoints for 8400 into /tmp/absl_testing/429596/model.ckpt.
INFO:tensorflow:Calling checkpoint listeners after saving checkpoint 8400...
I0410 05:46:17.848695 139691431679872 basic_session_run_hooks.py:626] Calling checkpoint listeners after saving checkpoint 8400...
--------------------------------------------datasets.py/eval_input_fn,s
W0410 05:46:17.855419 139691431679872 datasets.py:170] No TPUContext, using unmodified dataset seed 547.
I0410 05:46:17.855563 139691431679872 datasets.py:348] eval_input_fn(): params={'use_tpu': False, 'train_batch_size': 8, 'batch_size': 8} seed=547
--------befor self._load_dataset------------------split = validation self._eval_split= validation
--------------------------------------------datasets.py/_load_dataset,s
!!!!!!!!!!!!!!!!!!!!!!----load_local_datasets,  _local_test_ds_dir= /content/drive/My Drive/drive/gan/test
-----------------------------------------get_local_datasets,s
-----------------------------------------get_local_datasets,e
--------------------------------------------modular_gan.py/_preprocess_fn,s
I0410 05:46:17.938474 139691431679872 api.py:587] _preprocess_fn(): images=Tensor("args_0:0", shape=(128, 128, 3), dtype=float32), labels=Tensor("args_1:0", shape=(), dtype=int32), seed=547
--------------------------------------------modular_gan.py/_preprocess_fn,e
I0410 05:46:17.967229 139691431679872 api.py:587] Passing random offset: Tensor("Cast:0", shape=(), dtype=int32) with data ({'images': <tf.Tensor 'args_1:0' shape=(128, 128, 3) dtype=float32>, 'z': <tf.Tensor 'args_3:0' shape=(120,) dtype=float32>, 'sampled_labels': <tf.Tensor 'args_2:0' shape=() dtype=int32>}, <tf.Tensor 'args_4:0' shape=() dtype=int32>).
--------------------------------------------datasets.py/eval_input_fn,e
INFO:tensorflow:Calling model_fn.
I0410 05:46:17.983435 139691431679872 estimator.py:1169] Calling model_fn.
--------------------------------------------modular_gan.py/model_fn,s
I0410 05:46:17.983596 139691431679872 modular_gan.py:589] model_fn(): features={'images': <tf.Tensor 'IteratorGetNext:1' shape=(8, 128, 128, 3) dtype=float32>, 'z': <tf.Tensor 'IteratorGetNext:3' shape=(8, 120) dtype=float32>, 'sampled_labels': <tf.Tensor 'IteratorGetNext:2' shape=(8,) dtype=int32>, '_RANDOM_OFFSET': <tf.Tensor 'IteratorGetNext:0' shape=(8,) dtype=int32>}, labels=Tensor("IteratorGetNext:4", shape=(8,), dtype=int32),mode=eval, params={'use_tpu': False, 'train_batch_size': 8, 'batch_size': 8}
#Clean old summaries from previous calls to model_fn().
# Get features and labels for each sub-step.
--------------------------------------------modular_gan.py/_split_inputs_and_generate_samples,s
I0410 05:46:17.990398 139691431679872 resnet_biggan.py:236] [Generator] inputs are z=(8, 120), y=(8, 2)
I0410 05:46:18.000396 139691431679872 resnet_biggan.py:262] [Generator] z0=(8, 20), z_per_block=['(8, 20)', '(8, 20)', '(8, 20)', '(8, 20)', '(8, 20)'], y_per_block=['(8, 148)', '(8, 148)', '(8, 148)', '(8, 148)', '(8, 148)']
I0410 05:46:18.048289 139691431679872 resnet_biggan.py:150] [Block] (8, 4, 4, 1536) (z=(8, 20), y=(8, 148)) -> (8, 8, 8, 1536)
I0410 05:46:18.094514 139691431679872 resnet_biggan.py:150] [Block] (8, 8, 8, 1536) (z=(8, 20), y=(8, 148)) -> (8, 16, 16, 768)
I0410 05:46:18.133374 139691431679872 resnet_biggan.py:150] [Block] (8, 16, 16, 768) (z=(8, 20), y=(8, 148)) -> (8, 32, 32, 384)
I0410 05:46:18.173630 139691431679872 resnet_biggan.py:150] [Block] (8, 32, 32, 384) (z=(8, 20), y=(8, 148)) -> (8, 64, 64, 192)
I0410 05:46:18.173817 139691431679872 resnet_biggan.py:289] [Generator] Applying non-local block to (8, 64, 64, 192)
I0410 05:46:18.250707 139691431679872 resnet_biggan.py:150] [Block] (8, 64, 64, 192) (z=(8, 20), y=(8, 148)) -> (8, 128, 128, 96)
I0410 05:46:18.250914 139691431679872 resnet_biggan.py:294] [Generator] before final processing: (8, 128, 128, 96)
I0410 05:46:18.282309 139691431679872 resnet_biggan.py:300] [Generator] after final processing: (8, 128, 128, 3)
--------------------------------------------modular_gan.py/_split_inputs_and_generate_samples,e
---------------------------------------------------modular_gan.py/create_logits,s
I0410 05:46:18.285735 139691431679872 tpu_random.py:86] Got global random offset: Tensor("strided_slice:0", shape=(), dtype=int32)
---------------------------------------------------s3gan.py/create_loss,s
W0410 05:46:18.288235 139691431679872 s3gan.py:237] Computing fake images for every sub step separately.
I0410 05:46:18.288449 139691431679872 resnet_biggan.py:236] [Generator] inputs are z=(8, 120), y=(8, 2)
I0410 05:46:18.294054 139691431679872 resnet_biggan.py:262] [Generator] z0=(8, 20), z_per_block=['(8, 20)', '(8, 20)', '(8, 20)', '(8, 20)', '(8, 20)'], y_per_block=['(8, 148)', '(8, 148)', '(8, 148)', '(8, 148)', '(8, 148)']
I0410 05:46:18.312689 139691431679872 resnet_biggan.py:150] [Block] (8, 4, 4, 1536) (z=(8, 20), y=(8, 148)) -> (8, 8, 8, 1536)
I0410 05:46:18.328191 139691431679872 resnet_biggan.py:150] [Block] (8, 8, 8, 1536) (z=(8, 20), y=(8, 148)) -> (8, 16, 16, 768)
I0410 05:46:18.346379 139691431679872 resnet_biggan.py:150] [Block] (8, 16, 16, 768) (z=(8, 20), y=(8, 148)) -> (8, 32, 32, 384)
I0410 05:46:18.362792 139691431679872 resnet_biggan.py:150] [Block] (8, 32, 32, 384) (z=(8, 20), y=(8, 148)) -> (8, 64, 64, 192)
I0410 05:46:18.362956 139691431679872 resnet_biggan.py:289] [Generator] Applying non-local block to (8, 64, 64, 192)
I0410 05:46:18.399264 139691431679872 resnet_biggan.py:150] [Block] (8, 64, 64, 192) (z=(8, 20), y=(8, 148)) -> (8, 128, 128, 96)
I0410 05:46:18.399435 139691431679872 resnet_biggan.py:294] [Generator] before final processing: (8, 128, 128, 96)
I0410 05:46:18.413699 139691431679872 resnet_biggan.py:300] [Generator] after final processing: (8, 128, 128, 3)
I0410 05:46:18.415360 139691431679872 s3gan.py:249] bs=8, rotated_bs=4, num_rot_examples=1
---------------------------------------------------s3gan.py/merge_with_rotation_data,s
---------------------------------------------------s3gan.py/merge_with_rotation_data,e
--------------------------------------------------------------------s3gan.py/discriminator_with_additonal_heads,s
I0410 05:46:18.440138 139691431679872 resnet_biggan.py:379] [Discriminator] inputs are x=(22, 128, 128, 3), y=(22, 2)
I0410 05:46:18.472833 139691431679872 resnet_biggan.py:150] [Block] (22, 128, 128, 3) (z=None, y=(22, 2)) -> (22, 64, 64, 96)
I0410 05:46:18.472990 139691431679872 resnet_biggan.py:398] [Discriminator] Applying non-local block to (22, 64, 64, 96)
I0410 05:46:18.549668 139691431679872 resnet_biggan.py:150] [Block] (22, 64, 64, 96) (z=None, y=(22, 2)) -> (22, 32, 32, 192)
I0410 05:46:18.581017 139691431679872 resnet_biggan.py:150] [Block] (22, 32, 32, 192) (z=None, y=(22, 2)) -> (22, 16, 16, 384)
I0410 05:46:18.611547 139691431679872 resnet_biggan.py:150] [Block] (22, 16, 16, 384) (z=None, y=(22, 2)) -> (22, 8, 8, 768)
I0410 05:46:18.642699 139691431679872 resnet_biggan.py:150] [Block] (22, 8, 8, 768) (z=None, y=(22, 2)) -> (22, 4, 4, 1536)
I0410 05:46:18.662908 139691431679872 resnet_biggan.py:150] [Block] (22, 4, 4, 1536) (z=None, y=(22, 2)) -> (22, 4, 4, 1536)
I0410 05:46:18.663064 139691431679872 resnet_biggan.py:403] [Discriminator] before final processing: (22, 4, 4, 1536)
I0410 05:46:18.673631 139691431679872 resnet_biggan.py:407] [Discriminator] after final processing: (22, 4, 4, 1536)
I0410 05:46:18.679440 139691431679872 resnet_biggan.py:422] [Discriminator] embedded_y for projection: (22, 1536)
I0410 05:46:18.692108 139691431679872 s3gan.py:133] [Discriminator] rotation head (22, 1536) -> Tensor("discriminator_rotation/score_classify/add:0", shape=(22, 4), dtype=float32)
I0410 05:46:18.704770 139691431679872 s3gan.py:154] [Discriminator] (22, 2) -> aux_logits=(22, 2), y_predicted=(22, 2)
---------------------------------------------------s3gan.py/get_class_embedding,s
I0410 05:46:18.710946 139691431679872 s3gan.py:175] [Discriminator] embedded_y for projection: (22, 1536)
---------------------------------------------------s3gan.py/get_class_embedding,e
---------------------------------------------------s3gan.py/discriminator_with_additonal_heads,e
---------------------------------------------------s3gan.py/create_loss,e
---------------------------------------------------modular_gan.py/create_logits,e
################################################## mode == tf.estimator.ModeKeys.EVAL  ########################
INFO:tensorflow:Done calling model_fn.
I0410 05:46:18.793448 139691431679872 estimator.py:1171] Done calling model_fn.
INFO:tensorflow:Starting evaluation at 2020-04-10T05:46:18Z
I0410 05:46:18.808654 139691431679872 evaluation.py:255] Starting evaluation at 2020-04-10T05:46:18Z
INFO:tensorflow:Graph was finalized.
I0410 05:46:18.946235 139691431679872 monitored_session.py:246] Graph was finalized.
2020-04-10 05:46:18.946879: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-04-10 05:46:18.947178: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:00:04.0 name: Tesla P4 computeCapability: 6.1
coreClock: 1.1135GHz coreCount: 20 deviceMemorySize: 7.43GiB deviceMemoryBandwidth: 178.99GiB/s
2020-04-10 05:46:18.947227: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.1
2020-04-10 05:46:18.947255: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10
2020-04-10 05:46:18.947272: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcufft.so.10
2020-04-10 05:46:18.947288: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcurand.so.10
2020-04-10 05:46:18.947302: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusolver.so.10
2020-04-10 05:46:18.947354: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusparse.so.10
2020-04-10 05:46:18.947376: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudnn.so.7
2020-04-10 05:46:18.947470: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-04-10 05:46:18.947880: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-04-10 05:46:18.948182: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1703] Adding visible gpu devices: 0
2020-04-10 05:46:18.948236: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-04-10 05:46:18.948253: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      0 
2020-04-10 05:46:18.948266: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1121] 0:   N 
2020-04-10 05:46:18.948447: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-04-10 05:46:18.948861: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-04-10 05:46:18.949192: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1247] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 6850 MB memory) -> physical GPU (device: 0, name: Tesla P4, pci bus id: 0000:00:04.0, compute capability: 6.1)
INFO:tensorflow:Restoring parameters from /tmp/absl_testing/429596/model.ckpt-8400
I0410 05:46:18.951283 139691431679872 saver.py:1293] Restoring parameters from /tmp/absl_testing/429596/model.ckpt-8400
INFO:tensorflow:Running local_init_op.
I0410 05:46:19.363421 139691431679872 session_manager.py:505] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
I0410 05:46:19.385754 139691431679872 session_manager.py:508] Done running local_init_op.
INFO:tensorflow:Evaluation [1/10]
I0410 05:46:21.382525 139691431679872 evaluation.py:167] Evaluation [1/10]
INFO:tensorflow:Evaluation [2/10]
I0410 05:46:22.356567 139691431679872 evaluation.py:167] Evaluation [2/10]
INFO:tensorflow:Evaluation [3/10]
I0410 05:46:23.263901 139691431679872 evaluation.py:167] Evaluation [3/10]
INFO:tensorflow:Evaluation [4/10]
I0410 05:46:23.939499 139691431679872 evaluation.py:167] Evaluation [4/10]
INFO:tensorflow:Evaluation [5/10]
I0410 05:46:25.118517 139691431679872 evaluation.py:167] Evaluation [5/10]
INFO:tensorflow:Evaluation [6/10]
I0410 05:46:26.051562 139691431679872 evaluation.py:167] Evaluation [6/10]
INFO:tensorflow:Evaluation [7/10]
I0410 05:46:26.917496 139691431679872 evaluation.py:167] Evaluation [7/10]
INFO:tensorflow:Evaluation [8/10]
I0410 05:46:28.803397 139691431679872 evaluation.py:167] Evaluation [8/10]
INFO:tensorflow:Evaluation [9/10]
I0410 05:46:30.274771 139691431679872 evaluation.py:167] Evaluation [9/10]
INFO:tensorflow:Evaluation [10/10]
I0410 05:46:31.362311 139691431679872 evaluation.py:167] Evaluation [10/10]
INFO:tensorflow:Inference Time : 12.86723s
I0410 05:46:31.676023 139691431679872 evaluation.py:273] Inference Time : 12.86723s
INFO:tensorflow:Finished evaluation at 2020-04-10-05:46:31
I0410 05:46:31.676215 139691431679872 evaluation.py:276] Finished evaluation at 2020-04-10-05:46:31
INFO:tensorflow:Saving dict for global step 8400: accuracy = 1.0, global_step = 8400, loss = 0.0069154203
I0410 05:46:31.676357 139691431679872 estimator.py:2066] Saving dict for global step 8400: accuracy = 1.0, global_step = 8400, loss = 0.0069154203
INFO:tensorflow:Saving 'checkpoint_path' summary for global step 8400: /tmp/absl_testing/429596/model.ckpt-8400
I0410 05:46:31.676833 139691431679872 estimator.py:2127] Saving 'checkpoint_path' summary for global step 8400: /tmp/absl_testing/429596/model.ckpt-8400
INFO:tensorflow:global_step/sec: 0.562135
I0410 05:46:33.127173 139691431679872 basic_session_run_hooks.py:702] global_step/sec: 0.562135
INFO:tensorflow:loss = 6.42752e-05, step = 8400 (177.893 sec)
I0410 05:46:33.128095 139691431679872 basic_session_run_hooks.py:260] loss = 6.42752e-05, step = 8400 (177.893 sec)
INFO:tensorflow:global_step/sec: 0.680136
I0410 05:49:00.156541 139691431679872 basic_session_run_hooks.py:702] global_step/sec: 0.680136
INFO:tensorflow:loss = 0.00083373947, step = 8500 (147.029 sec)
I0410 05:49:00.157528 139691431679872 basic_session_run_hooks.py:260] loss = 0.00083373947, step = 8500 (147.029 sec)
INFO:tensorflow:Calling checkpoint listeners before saving checkpoint 8600...
I0410 05:51:25.957899 139691431679872 basic_session_run_hooks.py:614] Calling checkpoint listeners before saving checkpoint 8600...
INFO:tensorflow:Saving checkpoints for 8600 into /tmp/absl_testing/429596/model.ckpt.
I0410 05:51:25.958203 139691431679872 basic_session_run_hooks.py:618] Saving checkpoints for 8600 into /tmp/absl_testing/429596/model.ckpt.
INFO:tensorflow:Calling checkpoint listeners after saving checkpoint 8600...
I0410 05:51:45.480157 139691431679872 basic_session_run_hooks.py:626] Calling checkpoint listeners after saving checkpoint 8600...
INFO:tensorflow:Skip the current checkpoint eval due to throttle secs (600 secs).
I0410 05:51:45.480586 139691431679872 training.py:528] Skip the current checkpoint eval due to throttle secs (600 secs).
INFO:tensorflow:global_step/sec: 0.59945
I0410 05:51:46.976135 139691431679872 basic_session_run_hooks.py:702] global_step/sec: 0.59945
INFO:tensorflow:loss = 0.0031379058, step = 8600 (166.820 sec)
I0410 05:51:46.977082 139691431679872 basic_session_run_hooks.py:260] loss = 0.0031379058, step = 8600 (166.820 sec)
INFO:tensorflow:global_step/sec: 0.679957
I0410 05:54:14.044302 139691431679872 basic_session_run_hooks.py:702] global_step/sec: 0.679957
INFO:tensorflow:loss = 0.016931742, step = 8700 (147.068 sec)
I0410 05:54:14.045190 139691431679872 basic_session_run_hooks.py:260] loss = 0.016931742, step = 8700 (147.068 sec)
INFO:tensorflow:Calling checkpoint listeners before saving checkpoint 8800...
I0410 05:56:39.906283 139691431679872 basic_session_run_hooks.py:614] Calling checkpoint listeners before saving checkpoint 8800...
INFO:tensorflow:Saving checkpoints for 8800 into /tmp/absl_testing/429596/model.ckpt.
I0410 05:56:39.906540 139691431679872 basic_session_run_hooks.py:618] Saving checkpoints for 8800 into /tmp/absl_testing/429596/model.ckpt.
INFO:tensorflow:Calling checkpoint listeners after saving checkpoint 8800...
I0410 05:56:57.820610 139691431679872 basic_session_run_hooks.py:626] Calling checkpoint listeners after saving checkpoint 8800...
--------------------------------------------datasets.py/eval_input_fn,s
W0410 05:56:58.259309 139691431679872 datasets.py:170] No TPUContext, using unmodified dataset seed 547.
I0410 05:56:58.259476 139691431679872 datasets.py:348] eval_input_fn(): params={'use_tpu': False, 'train_batch_size': 8, 'batch_size': 8} seed=547
--------befor self._load_dataset------------------split = validation self._eval_split= validation
--------------------------------------------datasets.py/_load_dataset,s
!!!!!!!!!!!!!!!!!!!!!!----load_local_datasets,  _local_test_ds_dir= /content/drive/My Drive/drive/gan/test
-----------------------------------------get_local_datasets,s
-----------------------------------------get_local_datasets,e
--------------------------------------------modular_gan.py/_preprocess_fn,s
I0410 05:56:58.341857 139691431679872 api.py:587] _preprocess_fn(): images=Tensor("args_0:0", shape=(128, 128, 3), dtype=float32), labels=Tensor("args_1:0", shape=(), dtype=int32), seed=547
--------------------------------------------modular_gan.py/_preprocess_fn,e
I0410 05:56:58.370470 139691431679872 api.py:587] Passing random offset: Tensor("Cast:0", shape=(), dtype=int32) with data ({'images': <tf.Tensor 'args_1:0' shape=(128, 128, 3) dtype=float32>, 'z': <tf.Tensor 'args_3:0' shape=(120,) dtype=float32>, 'sampled_labels': <tf.Tensor 'args_2:0' shape=() dtype=int32>}, <tf.Tensor 'args_4:0' shape=() dtype=int32>).
--------------------------------------------datasets.py/eval_input_fn,e
INFO:tensorflow:Calling model_fn.
I0410 05:56:58.386357 139691431679872 estimator.py:1169] Calling model_fn.
--------------------------------------------modular_gan.py/model_fn,s
I0410 05:56:58.386527 139691431679872 modular_gan.py:589] model_fn(): features={'images': <tf.Tensor 'IteratorGetNext:1' shape=(8, 128, 128, 3) dtype=float32>, 'z': <tf.Tensor 'IteratorGetNext:3' shape=(8, 120) dtype=float32>, 'sampled_labels': <tf.Tensor 'IteratorGetNext:2' shape=(8,) dtype=int32>, '_RANDOM_OFFSET': <tf.Tensor 'IteratorGetNext:0' shape=(8,) dtype=int32>}, labels=Tensor("IteratorGetNext:4", shape=(8,), dtype=int32),mode=eval, params={'use_tpu': False, 'train_batch_size': 8, 'batch_size': 8}
#Clean old summaries from previous calls to model_fn().
# Get features and labels for each sub-step.
--------------------------------------------modular_gan.py/_split_inputs_and_generate_samples,s
I0410 05:56:58.393614 139691431679872 resnet_biggan.py:236] [Generator] inputs are z=(8, 120), y=(8, 2)
I0410 05:56:58.404165 139691431679872 resnet_biggan.py:262] [Generator] z0=(8, 20), z_per_block=['(8, 20)', '(8, 20)', '(8, 20)', '(8, 20)', '(8, 20)'], y_per_block=['(8, 148)', '(8, 148)', '(8, 148)', '(8, 148)', '(8, 148)']
I0410 05:56:58.451555 139691431679872 resnet_biggan.py:150] [Block] (8, 4, 4, 1536) (z=(8, 20), y=(8, 148)) -> (8, 8, 8, 1536)
I0410 05:56:58.491178 139691431679872 resnet_biggan.py:150] [Block] (8, 8, 8, 1536) (z=(8, 20), y=(8, 148)) -> (8, 16, 16, 768)
I0410 05:56:58.529257 139691431679872 resnet_biggan.py:150] [Block] (8, 16, 16, 768) (z=(8, 20), y=(8, 148)) -> (8, 32, 32, 384)
I0410 05:56:58.566928 139691431679872 resnet_biggan.py:150] [Block] (8, 32, 32, 384) (z=(8, 20), y=(8, 148)) -> (8, 64, 64, 192)
I0410 05:56:58.567081 139691431679872 resnet_biggan.py:289] [Generator] Applying non-local block to (8, 64, 64, 192)
I0410 05:56:58.643271 139691431679872 resnet_biggan.py:150] [Block] (8, 64, 64, 192) (z=(8, 20), y=(8, 148)) -> (8, 128, 128, 96)
I0410 05:56:58.643445 139691431679872 resnet_biggan.py:294] [Generator] before final processing: (8, 128, 128, 96)
I0410 05:56:58.676831 139691431679872 resnet_biggan.py:300] [Generator] after final processing: (8, 128, 128, 3)
--------------------------------------------modular_gan.py/_split_inputs_and_generate_samples,e
---------------------------------------------------modular_gan.py/create_logits,s
I0410 05:56:58.680242 139691431679872 tpu_random.py:86] Got global random offset: Tensor("strided_slice:0", shape=(), dtype=int32)
---------------------------------------------------s3gan.py/create_loss,s
W0410 05:56:58.682798 139691431679872 s3gan.py:237] Computing fake images for every sub step separately.
I0410 05:56:58.683018 139691431679872 resnet_biggan.py:236] [Generator] inputs are z=(8, 120), y=(8, 2)
I0410 05:56:58.688373 139691431679872 resnet_biggan.py:262] [Generator] z0=(8, 20), z_per_block=['(8, 20)', '(8, 20)', '(8, 20)', '(8, 20)', '(8, 20)'], y_per_block=['(8, 148)', '(8, 148)', '(8, 148)', '(8, 148)', '(8, 148)']
I0410 05:56:58.711836 139691431679872 resnet_biggan.py:150] [Block] (8, 4, 4, 1536) (z=(8, 20), y=(8, 148)) -> (8, 8, 8, 1536)
I0410 05:56:58.727612 139691431679872 resnet_biggan.py:150] [Block] (8, 8, 8, 1536) (z=(8, 20), y=(8, 148)) -> (8, 16, 16, 768)
I0410 05:56:58.743773 139691431679872 resnet_biggan.py:150] [Block] (8, 16, 16, 768) (z=(8, 20), y=(8, 148)) -> (8, 32, 32, 384)
I0410 05:56:58.759699 139691431679872 resnet_biggan.py:150] [Block] (8, 32, 32, 384) (z=(8, 20), y=(8, 148)) -> (8, 64, 64, 192)
I0410 05:56:58.759879 139691431679872 resnet_biggan.py:289] [Generator] Applying non-local block to (8, 64, 64, 192)
I0410 05:56:58.792399 139691431679872 resnet_biggan.py:150] [Block] (8, 64, 64, 192) (z=(8, 20), y=(8, 148)) -> (8, 128, 128, 96)
I0410 05:56:58.792563 139691431679872 resnet_biggan.py:294] [Generator] before final processing: (8, 128, 128, 96)
I0410 05:56:58.806855 139691431679872 resnet_biggan.py:300] [Generator] after final processing: (8, 128, 128, 3)
I0410 05:56:58.808533 139691431679872 s3gan.py:249] bs=8, rotated_bs=4, num_rot_examples=1
---------------------------------------------------s3gan.py/merge_with_rotation_data,s
---------------------------------------------------s3gan.py/merge_with_rotation_data,e
--------------------------------------------------------------------s3gan.py/discriminator_with_additonal_heads,s
I0410 05:56:58.832861 139691431679872 resnet_biggan.py:379] [Discriminator] inputs are x=(22, 128, 128, 3), y=(22, 2)
I0410 05:56:58.862849 139691431679872 resnet_biggan.py:150] [Block] (22, 128, 128, 3) (z=None, y=(22, 2)) -> (22, 64, 64, 96)
I0410 05:56:58.862991 139691431679872 resnet_biggan.py:398] [Discriminator] Applying non-local block to (22, 64, 64, 96)
I0410 05:56:58.935745 139691431679872 resnet_biggan.py:150] [Block] (22, 64, 64, 96) (z=None, y=(22, 2)) -> (22, 32, 32, 192)
I0410 05:56:58.967855 139691431679872 resnet_biggan.py:150] [Block] (22, 32, 32, 192) (z=None, y=(22, 2)) -> (22, 16, 16, 384)
I0410 05:56:59.006937 139691431679872 resnet_biggan.py:150] [Block] (22, 16, 16, 384) (z=None, y=(22, 2)) -> (22, 8, 8, 768)
I0410 05:56:59.037507 139691431679872 resnet_biggan.py:150] [Block] (22, 8, 8, 768) (z=None, y=(22, 2)) -> (22, 4, 4, 1536)
I0410 05:56:59.056635 139691431679872 resnet_biggan.py:150] [Block] (22, 4, 4, 1536) (z=None, y=(22, 2)) -> (22, 4, 4, 1536)
I0410 05:56:59.056810 139691431679872 resnet_biggan.py:403] [Discriminator] before final processing: (22, 4, 4, 1536)
I0410 05:56:59.066872 139691431679872 resnet_biggan.py:407] [Discriminator] after final processing: (22, 4, 4, 1536)
I0410 05:56:59.072854 139691431679872 resnet_biggan.py:422] [Discriminator] embedded_y for projection: (22, 1536)
I0410 05:56:59.085004 139691431679872 s3gan.py:133] [Discriminator] rotation head (22, 1536) -> Tensor("discriminator_rotation/score_classify/add:0", shape=(22, 4), dtype=float32)
I0410 05:56:59.097593 139691431679872 s3gan.py:154] [Discriminator] (22, 2) -> aux_logits=(22, 2), y_predicted=(22, 2)
---------------------------------------------------s3gan.py/get_class_embedding,s
I0410 05:56:59.103457 139691431679872 s3gan.py:175] [Discriminator] embedded_y for projection: (22, 1536)
---------------------------------------------------s3gan.py/get_class_embedding,e
---------------------------------------------------s3gan.py/discriminator_with_additonal_heads,e
---------------------------------------------------s3gan.py/create_loss,e
---------------------------------------------------modular_gan.py/create_logits,e
################################################## mode == tf.estimator.ModeKeys.EVAL  ########################
INFO:tensorflow:Done calling model_fn.
I0410 05:56:59.205044 139691431679872 estimator.py:1171] Done calling model_fn.
INFO:tensorflow:Starting evaluation at 2020-04-10T05:56:59Z
I0410 05:56:59.223941 139691431679872 evaluation.py:255] Starting evaluation at 2020-04-10T05:56:59Z
INFO:tensorflow:Graph was finalized.
I0410 05:56:59.372918 139691431679872 monitored_session.py:246] Graph was finalized.
2020-04-10 05:56:59.373578: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-04-10 05:56:59.373928: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:00:04.0 name: Tesla P4 computeCapability: 6.1
coreClock: 1.1135GHz coreCount: 20 deviceMemorySize: 7.43GiB deviceMemoryBandwidth: 178.99GiB/s
2020-04-10 05:56:59.373987: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.1
2020-04-10 05:56:59.374013: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10
2020-04-10 05:56:59.374031: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcufft.so.10
2020-04-10 05:56:59.374047: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcurand.so.10
2020-04-10 05:56:59.374061: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusolver.so.10
2020-04-10 05:56:59.374123: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusparse.so.10
2020-04-10 05:56:59.374141: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudnn.so.7
2020-04-10 05:56:59.374226: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-04-10 05:56:59.374494: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-04-10 05:56:59.374700: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1703] Adding visible gpu devices: 0
2020-04-10 05:56:59.374747: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-04-10 05:56:59.374760: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      0 
2020-04-10 05:56:59.374770: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1121] 0:   N 
2020-04-10 05:56:59.374879: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-04-10 05:56:59.375149: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-04-10 05:56:59.375369: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1247] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 6850 MB memory) -> physical GPU (device: 0, name: Tesla P4, pci bus id: 0000:00:04.0, compute capability: 6.1)
INFO:tensorflow:Restoring parameters from /tmp/absl_testing/429596/model.ckpt-8800
I0410 05:56:59.376373 139691431679872 saver.py:1293] Restoring parameters from /tmp/absl_testing/429596/model.ckpt-8800
INFO:tensorflow:Running local_init_op.
I0410 05:56:59.771535 139691431679872 session_manager.py:505] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
I0410 05:56:59.793914 139691431679872 session_manager.py:508] Done running local_init_op.
INFO:tensorflow:Evaluation [1/10]
I0410 05:57:02.336585 139691431679872 evaluation.py:167] Evaluation [1/10]
INFO:tensorflow:Evaluation [2/10]
I0410 05:57:03.172202 139691431679872 evaluation.py:167] Evaluation [2/10]
INFO:tensorflow:Evaluation [3/10]
I0410 05:57:03.999426 139691431679872 evaluation.py:167] Evaluation [3/10]
INFO:tensorflow:Evaluation [4/10]
I0410 05:57:04.596422 139691431679872 evaluation.py:167] Evaluation [4/10]
INFO:tensorflow:Evaluation [5/10]
I0410 05:57:04.967478 139691431679872 evaluation.py:167] Evaluation [5/10]
INFO:tensorflow:Evaluation [6/10]
I0410 05:57:05.254185 139691431679872 evaluation.py:167] Evaluation [6/10]
INFO:tensorflow:Evaluation [7/10]
I0410 05:57:06.461996 139691431679872 evaluation.py:167] Evaluation [7/10]
INFO:tensorflow:Evaluation [8/10]
I0410 05:57:07.774973 139691431679872 evaluation.py:167] Evaluation [8/10]
INFO:tensorflow:Evaluation [9/10]
I0410 05:57:08.063724 139691431679872 evaluation.py:167] Evaluation [9/10]
INFO:tensorflow:Evaluation [10/10]
I0410 05:57:08.971603 139691431679872 evaluation.py:167] Evaluation [10/10]
INFO:tensorflow:Inference Time : 9.80628s
I0410 05:57:09.030395 139691431679872 evaluation.py:273] Inference Time : 9.80628s
INFO:tensorflow:Finished evaluation at 2020-04-10-05:57:09
I0410 05:57:09.030585 139691431679872 evaluation.py:276] Finished evaluation at 2020-04-10-05:57:09
INFO:tensorflow:Saving dict for global step 8800: accuracy = 1.0, global_step = 8800, loss = 0.09207733
I0410 05:57:09.030718 139691431679872 estimator.py:2066] Saving dict for global step 8800: accuracy = 1.0, global_step = 8800, loss = 0.09207733
INFO:tensorflow:Saving 'checkpoint_path' summary for global step 8800: /tmp/absl_testing/429596/model.ckpt-8800
I0410 05:57:09.031204 139691431679872 estimator.py:2127] Saving 'checkpoint_path' summary for global step 8800: /tmp/absl_testing/429596/model.ckpt-8800
INFO:tensorflow:global_step/sec: 0.566705
I0410 05:57:10.502978 139691431679872 basic_session_run_hooks.py:702] global_step/sec: 0.566705
INFO:tensorflow:loss = 0.054588664, step = 8800 (176.459 sec)
I0410 05:57:10.503793 139691431679872 basic_session_run_hooks.py:260] loss = 0.054588664, step = 8800 (176.459 sec)
INFO:tensorflow:global_step/sec: 0.679797
I0410 05:59:37.605773 139691431679872 basic_session_run_hooks.py:702] global_step/sec: 0.679797
INFO:tensorflow:loss = 0.12395962, step = 8900 (147.103 sec)
I0410 05:59:37.606648 139691431679872 basic_session_run_hooks.py:260] loss = 0.12395962, step = 8900 (147.103 sec)
INFO:tensorflow:Calling checkpoint listeners before saving checkpoint 9000...
I0410 06:02:03.468022 139691431679872 basic_session_run_hooks.py:614] Calling checkpoint listeners before saving checkpoint 9000...
INFO:tensorflow:Saving checkpoints for 9000 into /tmp/absl_testing/429596/model.ckpt.
I0410 06:02:03.468262 139691431679872 basic_session_run_hooks.py:618] Saving checkpoints for 9000 into /tmp/absl_testing/429596/model.ckpt.
INFO:tensorflow:Calling checkpoint listeners after saving checkpoint 9000...
I0410 06:02:19.307982 139691431679872 basic_session_run_hooks.py:626] Calling checkpoint listeners after saving checkpoint 9000...
INFO:tensorflow:Skip the current checkpoint eval due to throttle secs (600 secs).
I0410 06:02:19.308233 139691431679872 training.py:528] Skip the current checkpoint eval due to throttle secs (600 secs).
INFO:tensorflow:global_step/sec: 0.612764
I0410 06:02:20.800847 139691431679872 basic_session_run_hooks.py:702] global_step/sec: 0.612764
INFO:tensorflow:loss = 0.028218057, step = 9000 (163.195 sec)
I0410 06:02:20.801887 139691431679872 basic_session_run_hooks.py:260] loss = 0.028218057, step = 9000 (163.195 sec)
INFO:tensorflow:global_step/sec: 0.679206
I0410 06:04:48.031564 139691431679872 basic_session_run_hooks.py:702] global_step/sec: 0.679206
INFO:tensorflow:loss = 0.0022691328, step = 9100 (147.231 sec)
I0410 06:04:48.032491 139691431679872 basic_session_run_hooks.py:260] loss = 0.0022691328, step = 9100 (147.231 sec)
INFO:tensorflow:Calling checkpoint listeners before saving checkpoint 9200...
I0410 06:07:13.849575 139691431679872 basic_session_run_hooks.py:614] Calling checkpoint listeners before saving checkpoint 9200...
INFO:tensorflow:Saving checkpoints for 9200 into /tmp/absl_testing/429596/model.ckpt.
I0410 06:07:13.849870 139691431679872 basic_session_run_hooks.py:618] Saving checkpoints for 9200 into /tmp/absl_testing/429596/model.ckpt.
INFO:tensorflow:Calling checkpoint listeners after saving checkpoint 9200...
I0410 06:07:31.099359 139691431679872 basic_session_run_hooks.py:626] Calling checkpoint listeners after saving checkpoint 9200...
--------------------------------------------datasets.py/eval_input_fn,s
W0410 06:07:31.427078 139691431679872 datasets.py:170] No TPUContext, using unmodified dataset seed 547.
I0410 06:07:31.427231 139691431679872 datasets.py:348] eval_input_fn(): params={'use_tpu': False, 'train_batch_size': 8, 'batch_size': 8} seed=547
--------befor self._load_dataset------------------split = validation self._eval_split= validation
--------------------------------------------datasets.py/_load_dataset,s
!!!!!!!!!!!!!!!!!!!!!!----load_local_datasets,  _local_test_ds_dir= /content/drive/My Drive/drive/gan/test
-----------------------------------------get_local_datasets,s
-----------------------------------------get_local_datasets,e
--------------------------------------------modular_gan.py/_preprocess_fn,s
I0410 06:07:31.508017 139691431679872 api.py:587] _preprocess_fn(): images=Tensor("args_0:0", shape=(128, 128, 3), dtype=float32), labels=Tensor("args_1:0", shape=(), dtype=int32), seed=547
--------------------------------------------modular_gan.py/_preprocess_fn,e
I0410 06:07:31.536811 139691431679872 api.py:587] Passing random offset: Tensor("Cast:0", shape=(), dtype=int32) with data ({'images': <tf.Tensor 'args_1:0' shape=(128, 128, 3) dtype=float32>, 'z': <tf.Tensor 'args_3:0' shape=(120,) dtype=float32>, 'sampled_labels': <tf.Tensor 'args_2:0' shape=() dtype=int32>}, <tf.Tensor 'args_4:0' shape=() dtype=int32>).
--------------------------------------------datasets.py/eval_input_fn,e
INFO:tensorflow:Calling model_fn.
I0410 06:07:31.552680 139691431679872 estimator.py:1169] Calling model_fn.
--------------------------------------------modular_gan.py/model_fn,s
I0410 06:07:31.552850 139691431679872 modular_gan.py:589] model_fn(): features={'images': <tf.Tensor 'IteratorGetNext:1' shape=(8, 128, 128, 3) dtype=float32>, 'z': <tf.Tensor 'IteratorGetNext:3' shape=(8, 120) dtype=float32>, 'sampled_labels': <tf.Tensor 'IteratorGetNext:2' shape=(8,) dtype=int32>, '_RANDOM_OFFSET': <tf.Tensor 'IteratorGetNext:0' shape=(8,) dtype=int32>}, labels=Tensor("IteratorGetNext:4", shape=(8,), dtype=int32),mode=eval, params={'use_tpu': False, 'train_batch_size': 8, 'batch_size': 8}
#Clean old summaries from previous calls to model_fn().
# Get features and labels for each sub-step.
--------------------------------------------modular_gan.py/_split_inputs_and_generate_samples,s
I0410 06:07:31.559283 139691431679872 resnet_biggan.py:236] [Generator] inputs are z=(8, 120), y=(8, 2)
I0410 06:07:31.569272 139691431679872 resnet_biggan.py:262] [Generator] z0=(8, 20), z_per_block=['(8, 20)', '(8, 20)', '(8, 20)', '(8, 20)', '(8, 20)'], y_per_block=['(8, 148)', '(8, 148)', '(8, 148)', '(8, 148)', '(8, 148)']
I0410 06:07:31.622376 139691431679872 resnet_biggan.py:150] [Block] (8, 4, 4, 1536) (z=(8, 20), y=(8, 148)) -> (8, 8, 8, 1536)
I0410 06:07:31.662207 139691431679872 resnet_biggan.py:150] [Block] (8, 8, 8, 1536) (z=(8, 20), y=(8, 148)) -> (8, 16, 16, 768)
I0410 06:07:31.700290 139691431679872 resnet_biggan.py:150] [Block] (8, 16, 16, 768) (z=(8, 20), y=(8, 148)) -> (8, 32, 32, 384)
I0410 06:07:31.738055 139691431679872 resnet_biggan.py:150] [Block] (8, 32, 32, 384) (z=(8, 20), y=(8, 148)) -> (8, 64, 64, 192)
I0410 06:07:31.738195 139691431679872 resnet_biggan.py:289] [Generator] Applying non-local block to (8, 64, 64, 192)
I0410 06:07:31.813174 139691431679872 resnet_biggan.py:150] [Block] (8, 64, 64, 192) (z=(8, 20), y=(8, 148)) -> (8, 128, 128, 96)
I0410 06:07:31.813329 139691431679872 resnet_biggan.py:294] [Generator] before final processing: (8, 128, 128, 96)
I0410 06:07:31.848268 139691431679872 resnet_biggan.py:300] [Generator] after final processing: (8, 128, 128, 3)
--------------------------------------------modular_gan.py/_split_inputs_and_generate_samples,e
---------------------------------------------------modular_gan.py/create_logits,s
I0410 06:07:31.853153 139691431679872 tpu_random.py:86] Got global random offset: Tensor("strided_slice:0", shape=(), dtype=int32)
---------------------------------------------------s3gan.py/create_loss,s
W0410 06:07:31.856245 139691431679872 s3gan.py:237] Computing fake images for every sub step separately.
I0410 06:07:31.856447 139691431679872 resnet_biggan.py:236] [Generator] inputs are z=(8, 120), y=(8, 2)
I0410 06:07:31.861944 139691431679872 resnet_biggan.py:262] [Generator] z0=(8, 20), z_per_block=['(8, 20)', '(8, 20)', '(8, 20)', '(8, 20)', '(8, 20)'], y_per_block=['(8, 148)', '(8, 148)', '(8, 148)', '(8, 148)', '(8, 148)']
I0410 06:07:31.880453 139691431679872 resnet_biggan.py:150] [Block] (8, 4, 4, 1536) (z=(8, 20), y=(8, 148)) -> (8, 8, 8, 1536)
I0410 06:07:31.895938 139691431679872 resnet_biggan.py:150] [Block] (8, 8, 8, 1536) (z=(8, 20), y=(8, 148)) -> (8, 16, 16, 768)
I0410 06:07:31.912336 139691431679872 resnet_biggan.py:150] [Block] (8, 16, 16, 768) (z=(8, 20), y=(8, 148)) -> (8, 32, 32, 384)
I0410 06:07:31.927797 139691431679872 resnet_biggan.py:150] [Block] (8, 32, 32, 384) (z=(8, 20), y=(8, 148)) -> (8, 64, 64, 192)
I0410 06:07:31.927950 139691431679872 resnet_biggan.py:289] [Generator] Applying non-local block to (8, 64, 64, 192)
I0410 06:07:31.960430 139691431679872 resnet_biggan.py:150] [Block] (8, 64, 64, 192) (z=(8, 20), y=(8, 148)) -> (8, 128, 128, 96)
I0410 06:07:31.960577 139691431679872 resnet_biggan.py:294] [Generator] before final processing: (8, 128, 128, 96)
I0410 06:07:31.974452 139691431679872 resnet_biggan.py:300] [Generator] after final processing: (8, 128, 128, 3)
I0410 06:07:31.976092 139691431679872 s3gan.py:249] bs=8, rotated_bs=4, num_rot_examples=1
---------------------------------------------------s3gan.py/merge_with_rotation_data,s
---------------------------------------------------s3gan.py/merge_with_rotation_data,e
--------------------------------------------------------------------s3gan.py/discriminator_with_additonal_heads,s
I0410 06:07:32.002576 139691431679872 resnet_biggan.py:379] [Discriminator] inputs are x=(22, 128, 128, 3), y=(22, 2)
I0410 06:07:32.038001 139691431679872 resnet_biggan.py:150] [Block] (22, 128, 128, 3) (z=None, y=(22, 2)) -> (22, 64, 64, 96)
I0410 06:07:32.038465 139691431679872 resnet_biggan.py:398] [Discriminator] Applying non-local block to (22, 64, 64, 96)
I0410 06:07:32.113183 139691431679872 resnet_biggan.py:150] [Block] (22, 64, 64, 96) (z=None, y=(22, 2)) -> (22, 32, 32, 192)
I0410 06:07:32.144427 139691431679872 resnet_biggan.py:150] [Block] (22, 32, 32, 192) (z=None, y=(22, 2)) -> (22, 16, 16, 384)
I0410 06:07:32.177993 139691431679872 resnet_biggan.py:150] [Block] (22, 16, 16, 384) (z=None, y=(22, 2)) -> (22, 8, 8, 768)
I0410 06:07:32.209525 139691431679872 resnet_biggan.py:150] [Block] (22, 8, 8, 768) (z=None, y=(22, 2)) -> (22, 4, 4, 1536)
I0410 06:07:32.228754 139691431679872 resnet_biggan.py:150] [Block] (22, 4, 4, 1536) (z=None, y=(22, 2)) -> (22, 4, 4, 1536)
I0410 06:07:32.228922 139691431679872 resnet_biggan.py:403] [Discriminator] before final processing: (22, 4, 4, 1536)
I0410 06:07:32.239530 139691431679872 resnet_biggan.py:407] [Discriminator] after final processing: (22, 4, 4, 1536)
I0410 06:07:32.247946 139691431679872 resnet_biggan.py:422] [Discriminator] embedded_y for projection: (22, 1536)
I0410 06:07:32.261005 139691431679872 s3gan.py:133] [Discriminator] rotation head (22, 1536) -> Tensor("discriminator_rotation/score_classify/add:0", shape=(22, 4), dtype=float32)
I0410 06:07:32.274131 139691431679872 s3gan.py:154] [Discriminator] (22, 2) -> aux_logits=(22, 2), y_predicted=(22, 2)
---------------------------------------------------s3gan.py/get_class_embedding,s
I0410 06:07:32.280675 139691431679872 s3gan.py:175] [Discriminator] embedded_y for projection: (22, 1536)
---------------------------------------------------s3gan.py/get_class_embedding,e
---------------------------------------------------s3gan.py/discriminator_with_additonal_heads,e
---------------------------------------------------s3gan.py/create_loss,e
---------------------------------------------------modular_gan.py/create_logits,e
################################################## mode == tf.estimator.ModeKeys.EVAL  ########################
INFO:tensorflow:Done calling model_fn.
I0410 06:07:32.363157 139691431679872 estimator.py:1171] Done calling model_fn.
INFO:tensorflow:Starting evaluation at 2020-04-10T06:07:32Z
I0410 06:07:32.378884 139691431679872 evaluation.py:255] Starting evaluation at 2020-04-10T06:07:32Z
INFO:tensorflow:Graph was finalized.
I0410 06:07:32.521454 139691431679872 monitored_session.py:246] Graph was finalized.
2020-04-10 06:07:32.522034: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-04-10 06:07:32.522334: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:00:04.0 name: Tesla P4 computeCapability: 6.1
coreClock: 1.1135GHz coreCount: 20 deviceMemorySize: 7.43GiB deviceMemoryBandwidth: 178.99GiB/s
2020-04-10 06:07:32.522388: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.1
2020-04-10 06:07:32.522412: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10
2020-04-10 06:07:32.522429: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcufft.so.10
2020-04-10 06:07:32.522445: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcurand.so.10
2020-04-10 06:07:32.522459: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusolver.so.10
2020-04-10 06:07:32.522503: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusparse.so.10
2020-04-10 06:07:32.522518: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudnn.so.7
2020-04-10 06:07:32.522594: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-04-10 06:07:32.522904: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-04-10 06:07:32.523121: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1703] Adding visible gpu devices: 0
2020-04-10 06:07:32.523167: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-04-10 06:07:32.523180: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      0 
2020-04-10 06:07:32.523190: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1121] 0:   N 
2020-04-10 06:07:32.523314: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-04-10 06:07:32.523594: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-04-10 06:07:32.523839: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1247] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 6850 MB memory) -> physical GPU (device: 0, name: Tesla P4, pci bus id: 0000:00:04.0, compute capability: 6.1)
INFO:tensorflow:Restoring parameters from /tmp/absl_testing/429596/model.ckpt-9200
I0410 06:07:32.524593 139691431679872 saver.py:1293] Restoring parameters from /tmp/absl_testing/429596/model.ckpt-9200
INFO:tensorflow:Running local_init_op.
I0410 06:07:32.936836 139691431679872 session_manager.py:505] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
I0410 06:07:32.957942 139691431679872 session_manager.py:508] Done running local_init_op.
INFO:tensorflow:Evaluation [1/10]
I0410 06:07:35.037939 139691431679872 evaluation.py:167] Evaluation [1/10]
INFO:tensorflow:Evaluation [2/10]
I0410 06:07:36.244408 139691431679872 evaluation.py:167] Evaluation [2/10]
INFO:tensorflow:Evaluation [3/10]
I0410 06:07:37.327198 139691431679872 evaluation.py:167] Evaluation [3/10]
INFO:tensorflow:Evaluation [4/10]
I0410 06:07:38.105441 139691431679872 evaluation.py:167] Evaluation [4/10]
INFO:tensorflow:Evaluation [5/10]
I0410 06:07:38.454977 139691431679872 evaluation.py:167] Evaluation [5/10]
INFO:tensorflow:Evaluation [6/10]
I0410 06:07:39.654641 139691431679872 evaluation.py:167] Evaluation [6/10]
INFO:tensorflow:Evaluation [7/10]
I0410 06:07:40.348500 139691431679872 evaluation.py:167] Evaluation [7/10]
INFO:tensorflow:Evaluation [8/10]
I0410 06:07:41.080187 139691431679872 evaluation.py:167] Evaluation [8/10]
INFO:tensorflow:Evaluation [9/10]
I0410 06:07:41.632375 139691431679872 evaluation.py:167] Evaluation [9/10]
INFO:tensorflow:Evaluation [10/10]
I0410 06:07:43.069298 139691431679872 evaluation.py:167] Evaluation [10/10]
INFO:tensorflow:Inference Time : 11.08237s
I0410 06:07:43.461398 139691431679872 evaluation.py:273] Inference Time : 11.08237s
INFO:tensorflow:Finished evaluation at 2020-04-10-06:07:43
I0410 06:07:43.461612 139691431679872 evaluation.py:276] Finished evaluation at 2020-04-10-06:07:43
INFO:tensorflow:Saving dict for global step 9200: accuracy = 1.0, global_step = 9200, loss = 0.034909017
I0410 06:07:43.461755 139691431679872 estimator.py:2066] Saving dict for global step 9200: accuracy = 1.0, global_step = 9200, loss = 0.034909017
INFO:tensorflow:Saving 'checkpoint_path' summary for global step 9200: /tmp/absl_testing/429596/model.ckpt-9200
I0410 06:07:43.462262 139691431679872 estimator.py:2127] Saving 'checkpoint_path' summary for global step 9200: /tmp/absl_testing/429596/model.ckpt-9200
INFO:tensorflow:global_step/sec: 0.565306
I0410 06:07:44.926740 139691431679872 basic_session_run_hooks.py:702] global_step/sec: 0.565306
INFO:tensorflow:loss = 0.16300401, step = 9200 (176.895 sec)
I0410 06:07:44.927746 139691431679872 basic_session_run_hooks.py:260] loss = 0.16300401, step = 9200 (176.895 sec)
INFO:tensorflow:global_step/sec: 0.679882
I0410 06:10:12.011082 139691431679872 basic_session_run_hooks.py:702] global_step/sec: 0.679882
INFO:tensorflow:loss = 0.00013444727, step = 9300 (147.084 sec)
I0410 06:10:12.012189 139691431679872 basic_session_run_hooks.py:260] loss = 0.00013444727, step = 9300 (147.084 sec)
INFO:tensorflow:Calling checkpoint listeners before saving checkpoint 9400...
I0410 06:12:37.858703 139691431679872 basic_session_run_hooks.py:614] Calling checkpoint listeners before saving checkpoint 9400...
INFO:tensorflow:Saving checkpoints for 9400 into /tmp/absl_testing/429596/model.ckpt.
I0410 06:12:37.859025 139691431679872 basic_session_run_hooks.py:618] Saving checkpoints for 9400 into /tmp/absl_testing/429596/model.ckpt.
INFO:tensorflow:Calling checkpoint listeners after saving checkpoint 9400...
I0410 06:12:53.493948 139691431679872 basic_session_run_hooks.py:626] Calling checkpoint listeners after saving checkpoint 9400...
INFO:tensorflow:Skip the current checkpoint eval due to throttle secs (600 secs).
I0410 06:12:53.494199 139691431679872 training.py:528] Skip the current checkpoint eval due to throttle secs (600 secs).
INFO:tensorflow:global_step/sec: 0.613552
I0410 06:12:54.996529 139691431679872 basic_session_run_hooks.py:702] global_step/sec: 0.613552
INFO:tensorflow:loss = 0.008747114, step = 9400 (162.985 sec)
I0410 06:12:54.997516 139691431679872 basic_session_run_hooks.py:260] loss = 0.008747114, step = 9400 (162.985 sec)
INFO:tensorflow:global_step/sec: 0.678998
I0410 06:15:22.272479 139691431679872 basic_session_run_hooks.py:702] global_step/sec: 0.678998
INFO:tensorflow:loss = 0.004748156, step = 9500 (147.276 sec)
I0410 06:15:22.273598 139691431679872 basic_session_run_hooks.py:260] loss = 0.004748156, step = 9500 (147.276 sec)
INFO:tensorflow:Calling checkpoint listeners before saving checkpoint 9600...
I0410 06:17:48.113971 139691431679872 basic_session_run_hooks.py:614] Calling checkpoint listeners before saving checkpoint 9600...
INFO:tensorflow:Saving checkpoints for 9600 into /tmp/absl_testing/429596/model.ckpt.
I0410 06:17:48.114197 139691431679872 basic_session_run_hooks.py:618] Saving checkpoints for 9600 into /tmp/absl_testing/429596/model.ckpt.
INFO:tensorflow:Calling checkpoint listeners after saving checkpoint 9600...
I0410 06:18:06.391047 139691431679872 basic_session_run_hooks.py:626] Calling checkpoint listeners after saving checkpoint 9600...
--------------------------------------------datasets.py/eval_input_fn,s
W0410 06:18:06.397311 139691431679872 datasets.py:170] No TPUContext, using unmodified dataset seed 547.
I0410 06:18:06.397451 139691431679872 datasets.py:348] eval_input_fn(): params={'use_tpu': False, 'train_batch_size': 8, 'batch_size': 8} seed=547
--------befor self._load_dataset------------------split = validation self._eval_split= validation
--------------------------------------------datasets.py/_load_dataset,s
!!!!!!!!!!!!!!!!!!!!!!----load_local_datasets,  _local_test_ds_dir= /content/drive/My Drive/drive/gan/test
-----------------------------------------get_local_datasets,s
-----------------------------------------get_local_datasets,e
--------------------------------------------modular_gan.py/_preprocess_fn,s
I0410 06:18:06.478179 139691431679872 api.py:587] _preprocess_fn(): images=Tensor("args_0:0", shape=(128, 128, 3), dtype=float32), labels=Tensor("args_1:0", shape=(), dtype=int32), seed=547
--------------------------------------------modular_gan.py/_preprocess_fn,e
I0410 06:18:06.505771 139691431679872 api.py:587] Passing random offset: Tensor("Cast:0", shape=(), dtype=int32) with data ({'images': <tf.Tensor 'args_1:0' shape=(128, 128, 3) dtype=float32>, 'z': <tf.Tensor 'args_3:0' shape=(120,) dtype=float32>, 'sampled_labels': <tf.Tensor 'args_2:0' shape=() dtype=int32>}, <tf.Tensor 'args_4:0' shape=() dtype=int32>).
--------------------------------------------datasets.py/eval_input_fn,e
INFO:tensorflow:Calling model_fn.
I0410 06:18:06.521079 139691431679872 estimator.py:1169] Calling model_fn.
--------------------------------------------modular_gan.py/model_fn,s
I0410 06:18:06.521224 139691431679872 modular_gan.py:589] model_fn(): features={'images': <tf.Tensor 'IteratorGetNext:1' shape=(8, 128, 128, 3) dtype=float32>, 'z': <tf.Tensor 'IteratorGetNext:3' shape=(8, 120) dtype=float32>, 'sampled_labels': <tf.Tensor 'IteratorGetNext:2' shape=(8,) dtype=int32>, '_RANDOM_OFFSET': <tf.Tensor 'IteratorGetNext:0' shape=(8,) dtype=int32>}, labels=Tensor("IteratorGetNext:4", shape=(8,), dtype=int32),mode=eval, params={'use_tpu': False, 'train_batch_size': 8, 'batch_size': 8}
#Clean old summaries from previous calls to model_fn().
# Get features and labels for each sub-step.
--------------------------------------------modular_gan.py/_split_inputs_and_generate_samples,s
I0410 06:18:06.527845 139691431679872 resnet_biggan.py:236] [Generator] inputs are z=(8, 120), y=(8, 2)
I0410 06:18:06.537765 139691431679872 resnet_biggan.py:262] [Generator] z0=(8, 20), z_per_block=['(8, 20)', '(8, 20)', '(8, 20)', '(8, 20)', '(8, 20)'], y_per_block=['(8, 148)', '(8, 148)', '(8, 148)', '(8, 148)', '(8, 148)']
I0410 06:18:06.588424 139691431679872 resnet_biggan.py:150] [Block] (8, 4, 4, 1536) (z=(8, 20), y=(8, 148)) -> (8, 8, 8, 1536)
I0410 06:18:06.642226 139691431679872 resnet_biggan.py:150] [Block] (8, 8, 8, 1536) (z=(8, 20), y=(8, 148)) -> (8, 16, 16, 768)
I0410 06:18:06.685394 139691431679872 resnet_biggan.py:150] [Block] (8, 16, 16, 768) (z=(8, 20), y=(8, 148)) -> (8, 32, 32, 384)
I0410 06:18:06.954288 139691431679872 resnet_biggan.py:150] [Block] (8, 32, 32, 384) (z=(8, 20), y=(8, 148)) -> (8, 64, 64, 192)
I0410 06:18:06.954501 139691431679872 resnet_biggan.py:289] [Generator] Applying non-local block to (8, 64, 64, 192)
I0410 06:18:07.032297 139691431679872 resnet_biggan.py:150] [Block] (8, 64, 64, 192) (z=(8, 20), y=(8, 148)) -> (8, 128, 128, 96)
I0410 06:18:07.032500 139691431679872 resnet_biggan.py:294] [Generator] before final processing: (8, 128, 128, 96)
I0410 06:18:07.062988 139691431679872 resnet_biggan.py:300] [Generator] after final processing: (8, 128, 128, 3)
--------------------------------------------modular_gan.py/_split_inputs_and_generate_samples,e
---------------------------------------------------modular_gan.py/create_logits,s
I0410 06:18:07.066460 139691431679872 tpu_random.py:86] Got global random offset: Tensor("strided_slice:0", shape=(), dtype=int32)
---------------------------------------------------s3gan.py/create_loss,s
W0410 06:18:07.068993 139691431679872 s3gan.py:237] Computing fake images for every sub step separately.
I0410 06:18:07.069186 139691431679872 resnet_biggan.py:236] [Generator] inputs are z=(8, 120), y=(8, 2)
I0410 06:18:07.074725 139691431679872 resnet_biggan.py:262] [Generator] z0=(8, 20), z_per_block=['(8, 20)', '(8, 20)', '(8, 20)', '(8, 20)', '(8, 20)'], y_per_block=['(8, 148)', '(8, 148)', '(8, 148)', '(8, 148)', '(8, 148)']
I0410 06:18:07.093605 139691431679872 resnet_biggan.py:150] [Block] (8, 4, 4, 1536) (z=(8, 20), y=(8, 148)) -> (8, 8, 8, 1536)
I0410 06:18:07.110414 139691431679872 resnet_biggan.py:150] [Block] (8, 8, 8, 1536) (z=(8, 20), y=(8, 148)) -> (8, 16, 16, 768)
I0410 06:18:07.126202 139691431679872 resnet_biggan.py:150] [Block] (8, 16, 16, 768) (z=(8, 20), y=(8, 148)) -> (8, 32, 32, 384)
I0410 06:18:07.141979 139691431679872 resnet_biggan.py:150] [Block] (8, 32, 32, 384) (z=(8, 20), y=(8, 148)) -> (8, 64, 64, 192)
I0410 06:18:07.142120 139691431679872 resnet_biggan.py:289] [Generator] Applying non-local block to (8, 64, 64, 192)
I0410 06:18:07.176908 139691431679872 resnet_biggan.py:150] [Block] (8, 64, 64, 192) (z=(8, 20), y=(8, 148)) -> (8, 128, 128, 96)
I0410 06:18:07.177093 139691431679872 resnet_biggan.py:294] [Generator] before final processing: (8, 128, 128, 96)
I0410 06:18:07.199091 139691431679872 resnet_biggan.py:300] [Generator] after final processing: (8, 128, 128, 3)
I0410 06:18:07.200766 139691431679872 s3gan.py:249] bs=8, rotated_bs=4, num_rot_examples=1
---------------------------------------------------s3gan.py/merge_with_rotation_data,s
---------------------------------------------------s3gan.py/merge_with_rotation_data,e
--------------------------------------------------------------------s3gan.py/discriminator_with_additonal_heads,s
I0410 06:18:07.225045 139691431679872 resnet_biggan.py:379] [Discriminator] inputs are x=(22, 128, 128, 3), y=(22, 2)
I0410 06:18:07.256784 139691431679872 resnet_biggan.py:150] [Block] (22, 128, 128, 3) (z=None, y=(22, 2)) -> (22, 64, 64, 96)
I0410 06:18:07.256955 139691431679872 resnet_biggan.py:398] [Discriminator] Applying non-local block to (22, 64, 64, 96)
I0410 06:18:07.324450 139691431679872 resnet_biggan.py:150] [Block] (22, 64, 64, 96) (z=None, y=(22, 2)) -> (22, 32, 32, 192)
I0410 06:18:07.354123 139691431679872 resnet_biggan.py:150] [Block] (22, 32, 32, 192) (z=None, y=(22, 2)) -> (22, 16, 16, 384)
I0410 06:18:07.388007 139691431679872 resnet_biggan.py:150] [Block] (22, 16, 16, 384) (z=None, y=(22, 2)) -> (22, 8, 8, 768)
I0410 06:18:07.420030 139691431679872 resnet_biggan.py:150] [Block] (22, 8, 8, 768) (z=None, y=(22, 2)) -> (22, 4, 4, 1536)
I0410 06:18:07.441282 139691431679872 resnet_biggan.py:150] [Block] (22, 4, 4, 1536) (z=None, y=(22, 2)) -> (22, 4, 4, 1536)
I0410 06:18:07.441439 139691431679872 resnet_biggan.py:403] [Discriminator] before final processing: (22, 4, 4, 1536)
I0410 06:18:07.452479 139691431679872 resnet_biggan.py:407] [Discriminator] after final processing: (22, 4, 4, 1536)
I0410 06:18:07.459010 139691431679872 resnet_biggan.py:422] [Discriminator] embedded_y for projection: (22, 1536)
I0410 06:18:07.472842 139691431679872 s3gan.py:133] [Discriminator] rotation head (22, 1536) -> Tensor("discriminator_rotation/score_classify/add:0", shape=(22, 4), dtype=float32)
I0410 06:18:07.485655 139691431679872 s3gan.py:154] [Discriminator] (22, 2) -> aux_logits=(22, 2), y_predicted=(22, 2)
---------------------------------------------------s3gan.py/get_class_embedding,s
I0410 06:18:07.491428 139691431679872 s3gan.py:175] [Discriminator] embedded_y for projection: (22, 1536)
---------------------------------------------------s3gan.py/get_class_embedding,e
---------------------------------------------------s3gan.py/discriminator_with_additonal_heads,e
---------------------------------------------------s3gan.py/create_loss,e
---------------------------------------------------modular_gan.py/create_logits,e
################################################## mode == tf.estimator.ModeKeys.EVAL  ########################
INFO:tensorflow:Done calling model_fn.
I0410 06:18:07.571074 139691431679872 estimator.py:1171] Done calling model_fn.
INFO:tensorflow:Starting evaluation at 2020-04-10T06:18:07Z
I0410 06:18:07.588591 139691431679872 evaluation.py:255] Starting evaluation at 2020-04-10T06:18:07Z
INFO:tensorflow:Graph was finalized.
I0410 06:18:07.725854 139691431679872 monitored_session.py:246] Graph was finalized.
2020-04-10 06:18:07.726481: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-04-10 06:18:07.726781: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:00:04.0 name: Tesla P4 computeCapability: 6.1
coreClock: 1.1135GHz coreCount: 20 deviceMemorySize: 7.43GiB deviceMemoryBandwidth: 178.99GiB/s
2020-04-10 06:18:07.726850: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.1
2020-04-10 06:18:07.726878: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10
2020-04-10 06:18:07.726897: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcufft.so.10
2020-04-10 06:18:07.726913: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcurand.so.10
2020-04-10 06:18:07.726928: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusolver.so.10
2020-04-10 06:18:07.726980: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusparse.so.10
2020-04-10 06:18:07.726997: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudnn.so.7
2020-04-10 06:18:07.727079: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-04-10 06:18:07.727348: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-04-10 06:18:07.727559: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1703] Adding visible gpu devices: 0
2020-04-10 06:18:07.727601: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-04-10 06:18:07.727615: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      0 
2020-04-10 06:18:07.727624: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1121] 0:   N 
2020-04-10 06:18:07.727717: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-04-10 06:18:07.727995: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-04-10 06:18:07.728221: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1247] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 6850 MB memory) -> physical GPU (device: 0, name: Tesla P4, pci bus id: 0000:00:04.0, compute capability: 6.1)
INFO:tensorflow:Restoring parameters from /tmp/absl_testing/429596/model.ckpt-9600
I0410 06:18:07.729017 139691431679872 saver.py:1293] Restoring parameters from /tmp/absl_testing/429596/model.ckpt-9600
INFO:tensorflow:Running local_init_op.
I0410 06:18:08.136925 139691431679872 session_manager.py:505] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
I0410 06:18:08.157848 139691431679872 session_manager.py:508] Done running local_init_op.
INFO:tensorflow:Evaluation [1/10]
I0410 06:18:10.659890 139691431679872 evaluation.py:167] Evaluation [1/10]
INFO:tensorflow:Evaluation [2/10]
I0410 06:18:11.281957 139691431679872 evaluation.py:167] Evaluation [2/10]
INFO:tensorflow:Evaluation [3/10]
I0410 06:18:12.674028 139691431679872 evaluation.py:167] Evaluation [3/10]
INFO:tensorflow:Evaluation [4/10]
I0410 06:18:14.363012 139691431679872 evaluation.py:167] Evaluation [4/10]
INFO:tensorflow:Evaluation [5/10]
I0410 06:18:14.897768 139691431679872 evaluation.py:167] Evaluation [5/10]
INFO:tensorflow:Evaluation [6/10]
I0410 06:18:15.825994 139691431679872 evaluation.py:167] Evaluation [6/10]
INFO:tensorflow:Evaluation [7/10]
I0410 06:18:16.951133 139691431679872 evaluation.py:167] Evaluation [7/10]
INFO:tensorflow:Evaluation [8/10]
I0410 06:18:17.238955 139691431679872 evaluation.py:167] Evaluation [8/10]
INFO:tensorflow:Evaluation [9/10]
I0410 06:18:18.540400 139691431679872 evaluation.py:167] Evaluation [9/10]
INFO:tensorflow:Evaluation [10/10]
I0410 06:18:19.098094 139691431679872 evaluation.py:167] Evaluation [10/10]
INFO:tensorflow:Inference Time : 11.86836s
I0410 06:18:19.457107 139691431679872 evaluation.py:273] Inference Time : 11.86836s
INFO:tensorflow:Finished evaluation at 2020-04-10-06:18:19
I0410 06:18:19.457373 139691431679872 evaluation.py:276] Finished evaluation at 2020-04-10-06:18:19
INFO:tensorflow:Saving dict for global step 9600: accuracy = 1.0, global_step = 9600, loss = 3.0267267e-05
I0410 06:18:19.457560 139691431679872 estimator.py:2066] Saving dict for global step 9600: accuracy = 1.0, global_step = 9600, loss = 3.0267267e-05
INFO:tensorflow:Saving 'checkpoint_path' summary for global step 9600: /tmp/absl_testing/429596/model.ckpt-9600
I0410 06:18:19.458115 139691431679872 estimator.py:2127] Saving 'checkpoint_path' summary for global step 9600: /tmp/absl_testing/429596/model.ckpt-9600
INFO:tensorflow:global_step/sec: 0.559756
I0410 06:18:20.921671 139691431679872 basic_session_run_hooks.py:702] global_step/sec: 0.559756
INFO:tensorflow:loss = 6.109462e-07, step = 9600 (178.649 sec)
I0410 06:18:20.922514 139691431679872 basic_session_run_hooks.py:260] loss = 6.109462e-07, step = 9600 (178.649 sec)
INFO:tensorflow:global_step/sec: 0.679681
I0410 06:20:48.049454 139691431679872 basic_session_run_hooks.py:702] global_step/sec: 0.679681
INFO:tensorflow:loss = 0.00074511656, step = 9700 (147.128 sec)
I0410 06:20:48.050776 139691431679872 basic_session_run_hooks.py:260] loss = 0.00074511656, step = 9700 (147.128 sec)
INFO:tensorflow:Calling checkpoint listeners before saving checkpoint 9800...
I0410 06:23:13.858922 139691431679872 basic_session_run_hooks.py:614] Calling checkpoint listeners before saving checkpoint 9800...
INFO:tensorflow:Saving checkpoints for 9800 into /tmp/absl_testing/429596/model.ckpt.
I0410 06:23:13.859200 139691431679872 basic_session_run_hooks.py:618] Saving checkpoints for 9800 into /tmp/absl_testing/429596/model.ckpt.
INFO:tensorflow:Calling checkpoint listeners after saving checkpoint 9800...
I0410 06:23:30.285010 139691431679872 basic_session_run_hooks.py:626] Calling checkpoint listeners after saving checkpoint 9800...
INFO:tensorflow:Skip the current checkpoint eval due to throttle secs (600 secs).
I0410 06:23:30.285293 139691431679872 training.py:528] Skip the current checkpoint eval due to throttle secs (600 secs).
INFO:tensorflow:global_step/sec: 0.60396
I0410 06:23:33.623448 139691431679872 basic_session_run_hooks.py:702] global_step/sec: 0.60396
INFO:tensorflow:loss = 0.0014409368, step = 9800 (165.575 sec)
I0410 06:23:33.625658 139691431679872 basic_session_run_hooks.py:260] loss = 0.0014409368, step = 9800 (165.575 sec)
INFO:tensorflow:global_step/sec: 0.679259
I0410 06:26:00.842566 139691431679872 basic_session_run_hooks.py:702] global_step/sec: 0.679259
INFO:tensorflow:loss = 6.101506e-05, step = 9900 (147.218 sec)
I0410 06:26:00.843608 139691431679872 basic_session_run_hooks.py:260] loss = 6.101506e-05, step = 9900 (147.218 sec)
INFO:tensorflow:Calling checkpoint listeners before saving checkpoint 10000...
I0410 06:28:26.721319 139691431679872 basic_session_run_hooks.py:614] Calling checkpoint listeners before saving checkpoint 10000...
INFO:tensorflow:Saving checkpoints for 10000 into /tmp/absl_testing/429596/model.ckpt.
I0410 06:28:26.721603 139691431679872 basic_session_run_hooks.py:618] Saving checkpoints for 10000 into /tmp/absl_testing/429596/model.ckpt.
INFO:tensorflow:Calling checkpoint listeners after saving checkpoint 10000...
I0410 06:28:42.907350 139691431679872 basic_session_run_hooks.py:626] Calling checkpoint listeners after saving checkpoint 10000...
--------------------------------------------datasets.py/eval_input_fn,s
W0410 06:28:42.913227 139691431679872 datasets.py:170] No TPUContext, using unmodified dataset seed 547.
I0410 06:28:42.913362 139691431679872 datasets.py:348] eval_input_fn(): params={'use_tpu': False, 'train_batch_size': 8, 'batch_size': 8} seed=547
--------befor self._load_dataset------------------split = validation self._eval_split= validation
--------------------------------------------datasets.py/_load_dataset,s
!!!!!!!!!!!!!!!!!!!!!!----load_local_datasets,  _local_test_ds_dir= /content/drive/My Drive/drive/gan/test
-----------------------------------------get_local_datasets,s
-----------------------------------------get_local_datasets,e
--------------------------------------------modular_gan.py/_preprocess_fn,s
I0410 06:28:42.993738 139691431679872 api.py:587] _preprocess_fn(): images=Tensor("args_0:0", shape=(128, 128, 3), dtype=float32), labels=Tensor("args_1:0", shape=(), dtype=int32), seed=547
--------------------------------------------modular_gan.py/_preprocess_fn,e
I0410 06:28:43.022069 139691431679872 api.py:587] Passing random offset: Tensor("Cast:0", shape=(), dtype=int32) with data ({'images': <tf.Tensor 'args_1:0' shape=(128, 128, 3) dtype=float32>, 'z': <tf.Tensor 'args_3:0' shape=(120,) dtype=float32>, 'sampled_labels': <tf.Tensor 'args_2:0' shape=() dtype=int32>}, <tf.Tensor 'args_4:0' shape=() dtype=int32>).
--------------------------------------------datasets.py/eval_input_fn,e
INFO:tensorflow:Calling model_fn.
I0410 06:28:43.037508 139691431679872 estimator.py:1169] Calling model_fn.
--------------------------------------------modular_gan.py/model_fn,s
I0410 06:28:43.037679 139691431679872 modular_gan.py:589] model_fn(): features={'images': <tf.Tensor 'IteratorGetNext:1' shape=(8, 128, 128, 3) dtype=float32>, 'z': <tf.Tensor 'IteratorGetNext:3' shape=(8, 120) dtype=float32>, 'sampled_labels': <tf.Tensor 'IteratorGetNext:2' shape=(8,) dtype=int32>, '_RANDOM_OFFSET': <tf.Tensor 'IteratorGetNext:0' shape=(8,) dtype=int32>}, labels=Tensor("IteratorGetNext:4", shape=(8,), dtype=int32),mode=eval, params={'use_tpu': False, 'train_batch_size': 8, 'batch_size': 8}
#Clean old summaries from previous calls to model_fn().
# Get features and labels for each sub-step.
--------------------------------------------modular_gan.py/_split_inputs_and_generate_samples,s
I0410 06:28:43.045103 139691431679872 resnet_biggan.py:236] [Generator] inputs are z=(8, 120), y=(8, 2)
I0410 06:28:43.056682 139691431679872 resnet_biggan.py:262] [Generator] z0=(8, 20), z_per_block=['(8, 20)', '(8, 20)', '(8, 20)', '(8, 20)', '(8, 20)'], y_per_block=['(8, 148)', '(8, 148)', '(8, 148)', '(8, 148)', '(8, 148)']
I0410 06:28:43.105545 139691431679872 resnet_biggan.py:150] [Block] (8, 4, 4, 1536) (z=(8, 20), y=(8, 148)) -> (8, 8, 8, 1536)
I0410 06:28:43.142498 139691431679872 resnet_biggan.py:150] [Block] (8, 8, 8, 1536) (z=(8, 20), y=(8, 148)) -> (8, 16, 16, 768)
I0410 06:28:43.184755 139691431679872 resnet_biggan.py:150] [Block] (8, 16, 16, 768) (z=(8, 20), y=(8, 148)) -> (8, 32, 32, 384)
I0410 06:28:43.228844 139691431679872 resnet_biggan.py:150] [Block] (8, 32, 32, 384) (z=(8, 20), y=(8, 148)) -> (8, 64, 64, 192)
I0410 06:28:43.229008 139691431679872 resnet_biggan.py:289] [Generator] Applying non-local block to (8, 64, 64, 192)
I0410 06:28:43.329042 139691431679872 resnet_biggan.py:150] [Block] (8, 64, 64, 192) (z=(8, 20), y=(8, 148)) -> (8, 128, 128, 96)
I0410 06:28:43.329311 139691431679872 resnet_biggan.py:294] [Generator] before final processing: (8, 128, 128, 96)
I0410 06:28:43.399323 139691431679872 resnet_biggan.py:300] [Generator] after final processing: (8, 128, 128, 3)
--------------------------------------------modular_gan.py/_split_inputs_and_generate_samples,e
---------------------------------------------------modular_gan.py/create_logits,s
I0410 06:28:43.402840 139691431679872 tpu_random.py:86] Got global random offset: Tensor("strided_slice:0", shape=(), dtype=int32)
---------------------------------------------------s3gan.py/create_loss,s
W0410 06:28:43.405367 139691431679872 s3gan.py:237] Computing fake images for every sub step separately.
I0410 06:28:43.405577 139691431679872 resnet_biggan.py:236] [Generator] inputs are z=(8, 120), y=(8, 2)
I0410 06:28:43.411017 139691431679872 resnet_biggan.py:262] [Generator] z0=(8, 20), z_per_block=['(8, 20)', '(8, 20)', '(8, 20)', '(8, 20)', '(8, 20)'], y_per_block=['(8, 148)', '(8, 148)', '(8, 148)', '(8, 148)', '(8, 148)']
I0410 06:28:43.429758 139691431679872 resnet_biggan.py:150] [Block] (8, 4, 4, 1536) (z=(8, 20), y=(8, 148)) -> (8, 8, 8, 1536)
I0410 06:28:43.445288 139691431679872 resnet_biggan.py:150] [Block] (8, 8, 8, 1536) (z=(8, 20), y=(8, 148)) -> (8, 16, 16, 768)
I0410 06:28:43.461175 139691431679872 resnet_biggan.py:150] [Block] (8, 16, 16, 768) (z=(8, 20), y=(8, 148)) -> (8, 32, 32, 384)
I0410 06:28:43.478998 139691431679872 resnet_biggan.py:150] [Block] (8, 32, 32, 384) (z=(8, 20), y=(8, 148)) -> (8, 64, 64, 192)
I0410 06:28:43.479138 139691431679872 resnet_biggan.py:289] [Generator] Applying non-local block to (8, 64, 64, 192)
I0410 06:28:43.512501 139691431679872 resnet_biggan.py:150] [Block] (8, 64, 64, 192) (z=(8, 20), y=(8, 148)) -> (8, 128, 128, 96)
I0410 06:28:43.512668 139691431679872 resnet_biggan.py:294] [Generator] before final processing: (8, 128, 128, 96)
I0410 06:28:43.528672 139691431679872 resnet_biggan.py:300] [Generator] after final processing: (8, 128, 128, 3)
I0410 06:28:43.530348 139691431679872 s3gan.py:249] bs=8, rotated_bs=4, num_rot_examples=1
---------------------------------------------------s3gan.py/merge_with_rotation_data,s
---------------------------------------------------s3gan.py/merge_with_rotation_data,e
--------------------------------------------------------------------s3gan.py/discriminator_with_additonal_heads,s
I0410 06:28:43.554709 139691431679872 resnet_biggan.py:379] [Discriminator] inputs are x=(22, 128, 128, 3), y=(22, 2)
I0410 06:28:43.584938 139691431679872 resnet_biggan.py:150] [Block] (22, 128, 128, 3) (z=None, y=(22, 2)) -> (22, 64, 64, 96)
I0410 06:28:43.585076 139691431679872 resnet_biggan.py:398] [Discriminator] Applying non-local block to (22, 64, 64, 96)
I0410 06:28:43.655900 139691431679872 resnet_biggan.py:150] [Block] (22, 64, 64, 96) (z=None, y=(22, 2)) -> (22, 32, 32, 192)
I0410 06:28:43.686495 139691431679872 resnet_biggan.py:150] [Block] (22, 32, 32, 192) (z=None, y=(22, 2)) -> (22, 16, 16, 384)
I0410 06:28:43.717489 139691431679872 resnet_biggan.py:150] [Block] (22, 16, 16, 384) (z=None, y=(22, 2)) -> (22, 8, 8, 768)
I0410 06:28:43.747648 139691431679872 resnet_biggan.py:150] [Block] (22, 8, 8, 768) (z=None, y=(22, 2)) -> (22, 4, 4, 1536)
I0410 06:28:43.768222 139691431679872 resnet_biggan.py:150] [Block] (22, 4, 4, 1536) (z=None, y=(22, 2)) -> (22, 4, 4, 1536)
I0410 06:28:43.768415 139691431679872 resnet_biggan.py:403] [Discriminator] before final processing: (22, 4, 4, 1536)
I0410 06:28:43.778586 139691431679872 resnet_biggan.py:407] [Discriminator] after final processing: (22, 4, 4, 1536)
I0410 06:28:43.784315 139691431679872 resnet_biggan.py:422] [Discriminator] embedded_y for projection: (22, 1536)
I0410 06:28:43.797048 139691431679872 s3gan.py:133] [Discriminator] rotation head (22, 1536) -> Tensor("discriminator_rotation/score_classify/add:0", shape=(22, 4), dtype=float32)
I0410 06:28:43.809414 139691431679872 s3gan.py:154] [Discriminator] (22, 2) -> aux_logits=(22, 2), y_predicted=(22, 2)
---------------------------------------------------s3gan.py/get_class_embedding,s
I0410 06:28:43.815565 139691431679872 s3gan.py:175] [Discriminator] embedded_y for projection: (22, 1536)
---------------------------------------------------s3gan.py/get_class_embedding,e
---------------------------------------------------s3gan.py/discriminator_with_additonal_heads,e
---------------------------------------------------s3gan.py/create_loss,e
---------------------------------------------------modular_gan.py/create_logits,e
################################################## mode == tf.estimator.ModeKeys.EVAL  ########################
INFO:tensorflow:Done calling model_fn.
I0410 06:28:43.899522 139691431679872 estimator.py:1171] Done calling model_fn.
INFO:tensorflow:Starting evaluation at 2020-04-10T06:28:43Z
I0410 06:28:43.918767 139691431679872 evaluation.py:255] Starting evaluation at 2020-04-10T06:28:43Z
INFO:tensorflow:Graph was finalized.
I0410 06:28:44.057234 139691431679872 monitored_session.py:246] Graph was finalized.
2020-04-10 06:28:44.057917: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-04-10 06:28:44.058260: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:00:04.0 name: Tesla P4 computeCapability: 6.1
coreClock: 1.1135GHz coreCount: 20 deviceMemorySize: 7.43GiB deviceMemoryBandwidth: 178.99GiB/s
2020-04-10 06:28:44.058314: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.1
2020-04-10 06:28:44.058341: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10
2020-04-10 06:28:44.058360: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcufft.so.10
2020-04-10 06:28:44.058377: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcurand.so.10
2020-04-10 06:28:44.058392: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusolver.so.10
2020-04-10 06:28:44.058436: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusparse.so.10
2020-04-10 06:28:44.058452: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudnn.so.7
2020-04-10 06:28:44.058527: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-04-10 06:28:44.058789: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-04-10 06:28:44.059012: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1703] Adding visible gpu devices: 0
2020-04-10 06:28:44.059058: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-04-10 06:28:44.059071: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      0 
2020-04-10 06:28:44.059082: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1121] 0:   N 
2020-04-10 06:28:44.059210: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-04-10 06:28:44.059468: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-04-10 06:28:44.059683: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1247] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 6850 MB memory) -> physical GPU (device: 0, name: Tesla P4, pci bus id: 0000:00:04.0, compute capability: 6.1)
INFO:tensorflow:Restoring parameters from /tmp/absl_testing/429596/model.ckpt-10000
I0410 06:28:44.060680 139691431679872 saver.py:1293] Restoring parameters from /tmp/absl_testing/429596/model.ckpt-10000
INFO:tensorflow:Running local_init_op.
I0410 06:28:44.496661 139691431679872 session_manager.py:505] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
I0410 06:28:44.517850 139691431679872 session_manager.py:508] Done running local_init_op.
INFO:tensorflow:Evaluation [1/10]
I0410 06:28:47.584108 139691431679872 evaluation.py:167] Evaluation [1/10]
INFO:tensorflow:Evaluation [2/10]
I0410 06:28:48.199099 139691431679872 evaluation.py:167] Evaluation [2/10]
INFO:tensorflow:Evaluation [3/10]
I0410 06:28:48.819235 139691431679872 evaluation.py:167] Evaluation [3/10]
INFO:tensorflow:Evaluation [4/10]
I0410 06:28:49.131700 139691431679872 evaluation.py:167] Evaluation [4/10]
INFO:tensorflow:Evaluation [5/10]
I0410 06:28:49.718614 139691431679872 evaluation.py:167] Evaluation [5/10]
INFO:tensorflow:Evaluation [6/10]
I0410 06:28:50.610359 139691431679872 evaluation.py:167] Evaluation [6/10]
INFO:tensorflow:Evaluation [7/10]
I0410 06:28:51.166653 139691431679872 evaluation.py:167] Evaluation [7/10]
INFO:tensorflow:Evaluation [8/10]
I0410 06:28:52.317582 139691431679872 evaluation.py:167] Evaluation [8/10]
INFO:tensorflow:Evaluation [9/10]
I0410 06:28:53.647857 139691431679872 evaluation.py:167] Evaluation [9/10]
INFO:tensorflow:Evaluation [10/10]
I0410 06:28:54.330620 139691431679872 evaluation.py:167] Evaluation [10/10]
INFO:tensorflow:Inference Time : 10.77428s
I0410 06:28:54.693241 139691431679872 evaluation.py:273] Inference Time : 10.77428s
INFO:tensorflow:Finished evaluation at 2020-04-10-06:28:54
I0410 06:28:54.693449 139691431679872 evaluation.py:276] Finished evaluation at 2020-04-10-06:28:54
INFO:tensorflow:Saving dict for global step 10000: accuracy = 1.0, global_step = 10000, loss = 0.0023810617
I0410 06:28:54.693586 139691431679872 estimator.py:2066] Saving dict for global step 10000: accuracy = 1.0, global_step = 10000, loss = 0.0023810617
INFO:tensorflow:Saving 'checkpoint_path' summary for global step 10000: /tmp/absl_testing/429596/model.ckpt-10000
I0410 06:28:54.694071 139691431679872 estimator.py:2127] Saving 'checkpoint_path' summary for global step 10000: /tmp/absl_testing/429596/model.ckpt-10000
INFO:tensorflow:Loss for final step: 7.039901e-05.
I0410 06:28:54.787135 139691431679872 estimator.py:350] Loss for final step: 7.039901e-05.
-----------------------testSingleTrainingStepArchitectures,e
[       OK ] S3GANTest.testSingleTrainingStepArchitectures
[ RUN      ] S3GANTest.test_session
[  SKIPPED ] S3GANTest.test_session
----------------------------------------------------------------------
Ran 2 tests in 18697.394s

OK (skipped=1)