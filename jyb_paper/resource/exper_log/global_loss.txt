['/content/drive/My Drive/drive/gan/gan_git-02/gan_git/compare_gan/gans', '/env/python', '/usr/lib/python36.zip', '/usr/lib/python3.6', '/usr/lib/python3.6/lib-dynload', '/usr/local/lib/python3.6/dist-packages', '/usr/lib/python3/dist-packages', '/content/drive/My Drive/drive/gan/gan_git-02/gan_git/compare_gan/', '/content/drive/My Drive/drive/gan/gan_git-02/gan_git/']
2020-04-08 02:57:06.298380: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.1
WARNING:tensorflow:From /usr/local/lib/python3.6/dist-packages/tensorflow_gan/python/estimator/tpu_gan_estimator.py:42: The name tf.estimator.tpu.TPUEstimator is deprecated. Please use tf.compat.v1.estimator.tpu.TPUEstimator instead.

['/content/drive/My Drive/drive/gan/gan_git-02/gan_git/compare_gan/gans', '/env/python', '/usr/lib/python36.zip', '/usr/lib/python3.6', '/usr/lib/python3.6/lib-dynload', '/usr/local/lib/python3.6/dist-packages', '/usr/lib/python3/dist-packages', '/content/drive/My Drive/drive/gan/gan_git-02/gan_git/compare_gan/', '/content/drive/My Drive/drive/gan/gan_git-02/gan_git/', '/usr/local/lib/python3.6/dist-packages/IPython/extensions', '/content/drive/My Drive/drive/gan/gan_git-02/gan_git/compare_gan/tpu/', '/content/drive/My Drive/drive/gan/gan_git-02/gan_git/compare_gan/metrics/', '/content/drive/My Drive/drive/gan/gan_git-02/gan_git/compare_gan/architectures/', '/content/drive/My Drive/drive/gan/gan_git-02/gan_git/compare_gan/', '/content/drive/My Drive/drive/gan/gan_git-02/gan_git/']
['/content/drive/My Drive/drive/gan/gan_git-02/gan_git/compare_gan/gans', '/env/python', '/usr/lib/python36.zip', '/usr/lib/python3.6', '/usr/lib/python3.6/lib-dynload', '/usr/local/lib/python3.6/dist-packages', '/usr/lib/python3/dist-packages', '/content/drive/My Drive/drive/gan/gan_git-02/gan_git/compare_gan/', '/content/drive/My Drive/drive/gan/gan_git-02/gan_git/', '/usr/local/lib/python3.6/dist-packages/IPython/extensions', '/content/drive/My Drive/drive/gan/gan_git-02/gan_git/compare_gan/tpu/', '/content/drive/My Drive/drive/gan/gan_git-02/gan_git/compare_gan/metrics/', '/content/drive/My Drive/drive/gan/gan_git-02/gan_git/compare_gan/architectures/', '/content/drive/My Drive/drive/gan/gan_git-02/gan_git/compare_gan/', '/content/drive/My Drive/drive/gan/gan_git-02/gan_git/', '/content/drive/My Drive/drive/gan/gan_git-02/gan_git/compare_gan/architectures/', '/content/drive/My Drive/drive/gan/gan_git-02/gan_git/compare_gan/', '/content/drive/My Drive/drive/gan/gan_git-02/gan_git/']
Running tests under Python 3.6.9: /usr/bin/python3
[ RUN      ] S3GANTest.testSingleTrainingStepArchitectures
WARNING:tensorflow:From /content/drive/My Drive/drive/gan/gan_git-02/gan_git/compare_gan/test_utils.py:59: flatten (from tensorflow.python.layers.core) is deprecated and will be removed in a future version.
Instructions for updating:
Use keras.layers.Flatten instead.
W0408 02:57:19.539847 139967323350912 deprecation.py:323] From /content/drive/My Drive/drive/gan/gan_git-02/gan_git/compare_gan/test_utils.py:59: flatten (from tensorflow.python.layers.core) is deprecated and will be removed in a future version.
Instructions for updating:
Use keras.layers.Flatten instead.
WARNING:tensorflow:From /usr/local/lib/python3.6/dist-packages/tensorflow/python/layers/core.py:332: Layer.apply (from tensorflow.python.keras.engine.base_layer_v1) is deprecated and will be removed in a future version.
Instructions for updating:
Please use `layer.__call__` method instead.
W0408 02:57:19.544239 139967323350912 deprecation.py:323] From /usr/local/lib/python3.6/dist-packages/tensorflow/python/layers/core.py:332: Layer.apply (from tensorflow.python.keras.engine.base_layer_v1) is deprecated and will be removed in a future version.
Instructions for updating:
Please use `layer.__call__` method instead.
-----------------------testSingleTrainingStepArchitectures,s
I0408 02:57:19.550653 139967323350912 datasets.py:104] ImageDatasetV2(name=RotorWinding_128, tfds_name=RotorWinding2020, resolution=128, colors=3, num_classes=2, eval_test_samples=1742, seed=547)
-----------------------tf.estimator.TrainSpec
-----------------------tf.estimator.EvalSpec
-----------------------gan.as_estimator
--------------------------------------------modular_gan.py/as_estimator,s
--------------------------------------------modular_gan.py/as_estimator,e
INFO:tensorflow:Using config: {'_model_dir': '/tmp/absl_testing/550760', '_tf_random_seed': None, '_save_summary_steps': 100, '_save_checkpoints_steps': None, '_save_checkpoints_secs': 600, '_session_config': gpu_options {
  per_process_gpu_memory_fraction: 0.9
}
allow_soft_placement: true
, '_keep_checkpoint_max': 5, '_keep_checkpoint_every_n_hours': 10000, '_log_step_count_steps': 100, '_train_distribute': None, '_device_fn': None, '_protocol': None, '_eval_distribute': None, '_experimental_distribute': None, '_experimental_max_worker_delay_secs': None, '_session_creation_timeout_secs': 7200, '_service': None, '_cluster_spec': ClusterSpec({}), '_task_type': 'worker', '_task_id': 0, '_global_id_in_cluster': 0, '_master': '', '_evaluation_master': '', '_is_chief': True, '_num_ps_replicas': 0, '_num_worker_replicas': 1}
I0408 02:57:19.552655 139967323350912 estimator.py:191] Using config: {'_model_dir': '/tmp/absl_testing/550760', '_tf_random_seed': None, '_save_summary_steps': 100, '_save_checkpoints_steps': None, '_save_checkpoints_secs': 600, '_session_config': gpu_options {
  per_process_gpu_memory_fraction: 0.9
}
allow_soft_placement: true
, '_keep_checkpoint_max': 5, '_keep_checkpoint_every_n_hours': 10000, '_log_step_count_steps': 100, '_train_distribute': None, '_device_fn': None, '_protocol': None, '_eval_distribute': None, '_experimental_distribute': None, '_experimental_max_worker_delay_secs': None, '_session_creation_timeout_secs': 7200, '_service': None, '_cluster_spec': ClusterSpec({}), '_task_type': 'worker', '_task_id': 0, '_global_id_in_cluster': 0, '_master': '', '_evaluation_master': '', '_is_chief': True, '_num_ps_replicas': 0, '_num_worker_replicas': 1}
-----------------------tf.estimator.train_and_evaluate
INFO:tensorflow:Not using Distribute Coordinator.
I0408 02:57:19.553006 139967323350912 estimator_training.py:186] Not using Distribute Coordinator.
INFO:tensorflow:Running training and evaluation locally (non-distributed).
I0408 02:57:19.553215 139967323350912 training.py:612] Running training and evaluation locally (non-distributed).
INFO:tensorflow:Start train and evaluate loop. The evaluate will happen after every checkpoint. Checkpoint frequency is determined based on RunConfig arguments: save_checkpoints_steps None or save_checkpoints_secs 600.
I0408 02:57:19.553445 139967323350912 training.py:700] Start train and evaluate loop. The evaluate will happen after every checkpoint. Checkpoint frequency is determined based on RunConfig arguments: save_checkpoints_steps None or save_checkpoints_secs 600.
WARNING:tensorflow:From /usr/local/lib/python3.6/dist-packages/tensorflow/python/ops/resource_variable_ops.py:1666: calling BaseResourceVariable.__init__ (from tensorflow.python.ops.resource_variable_ops) with constraint is deprecated and will be removed in a future version.
Instructions for updating:
If using Keras pass *_constraint arguments to layers.
W0408 02:57:19.556984 139967323350912 deprecation.py:506] From /usr/local/lib/python3.6/dist-packages/tensorflow/python/ops/resource_variable_ops.py:1666: calling BaseResourceVariable.__init__ (from tensorflow.python.ops.resource_variable_ops) with constraint is deprecated and will be removed in a future version.
Instructions for updating:
If using Keras pass *_constraint arguments to layers.
WARNING:tensorflow:From /usr/local/lib/python3.6/dist-packages/tensorflow/python/training/training_util.py:236: Variable.initialized_value (from tensorflow.python.ops.variables) is deprecated and will be removed in a future version.
Instructions for updating:
Use Variable.read_value. Variables in 2.X are initialized automatically both in eager and graph (inside tf.defun) contexts.
W0408 02:57:19.557352 139967323350912 deprecation.py:323] From /usr/local/lib/python3.6/dist-packages/tensorflow/python/training/training_util.py:236: Variable.initialized_value (from tensorflow.python.ops.variables) is deprecated and will be removed in a future version.
Instructions for updating:
Use Variable.read_value. Variables in 2.X are initialized automatically both in eager and graph (inside tf.defun) contexts.
2020-04-08 02:57:19.563195: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2020-04-08 02:57:19.589875: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-04-08 02:57:19.590495: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:00:04.0 name: Tesla P4 computeCapability: 6.1
coreClock: 1.1135GHz coreCount: 20 deviceMemorySize: 7.43GiB deviceMemoryBandwidth: 178.99GiB/s
2020-04-08 02:57:19.590544: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.1
2020-04-08 02:57:19.590607: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10
2020-04-08 02:57:19.590642: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcufft.so.10
2020-04-08 02:57:19.590677: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcurand.so.10
2020-04-08 02:57:19.590714: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusolver.so.10
2020-04-08 02:57:19.591660: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusparse.so.10
2020-04-08 02:57:19.591746: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudnn.so.7
2020-04-08 02:57:19.591842: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-04-08 02:57:19.592447: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-04-08 02:57:19.593027: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1703] Adding visible gpu devices: 0
--------------------------------------------modular_gan.py/input_fn,s/e
--------------------------------------------datasets.py/input_fn,s/e
--------------------------------------------datasets.py/train_input_fn,s
W0408 02:57:19.601009 139967323350912 datasets.py:170] No TPUContext, using unmodified dataset seed 547.
I0408 02:57:19.601138 139967323350912 datasets.py:304] train_input_fn(): params={'use_tpu': False, 'train_batch_size': 8, 'batch_size': 8} seed=547
--------------------------------------------datasets.py/_load_dataset,s
!!!!!!!!!!!!!!!!!!!!!!----load_local_datasets,  _local_train_ds_dir= /content/drive/My Drive/drive/gan/train
-----------------------------------------get_local_datasets,s
-----------------------------------------get_local_datasets,e
WARNING:tensorflow:From /usr/local/lib/python3.6/dist-packages/tensorflow/python/ops/image_ops_impl.py:2827: sample_distorted_bounding_box (from tensorflow.python.ops.image_ops_impl) is deprecated and will be removed in a future version.
Instructions for updating:
`seed2` arg is deprecated.Use sample_distorted_bounding_box_v2 instead.
W0408 02:57:22.114741 139967323350912 deprecation.py:323] From /usr/local/lib/python3.6/dist-packages/tensorflow/python/ops/image_ops_impl.py:2827: sample_distorted_bounding_box (from tensorflow.python.ops.image_ops_impl) is deprecated and will be removed in a future version.
Instructions for updating:
`seed2` arg is deprecated.Use sample_distorted_bounding_box_v2 instead.
--------------------------------------------modular_gan.py/_preprocess_fn,s
I0408 02:57:23.542346 139967323350912 api.py:587] _preprocess_fn(): images=Tensor("args_0:0", shape=(128, 128, 3), dtype=float32), labels=Tensor("args_1:0", shape=(), dtype=int32), seed=547
--------------------------------------------modular_gan.py/_preprocess_fn,e
WARNING:tensorflow:From /content/drive/My Drive/drive/gan/gan_git-02/gan_git/compare_gan/tpu/tpu_random.py:65: enumerate_dataset (from tensorflow.python.data.experimental.ops.enumerate_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.data.Dataset.enumerate()
W0408 02:57:26.042223 139967323350912 deprecation.py:323] From /content/drive/My Drive/drive/gan/gan_git-02/gan_git/compare_gan/tpu/tpu_random.py:65: enumerate_dataset (from tensorflow.python.data.experimental.ops.enumerate_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.data.Dataset.enumerate()
I0408 02:57:26.165064 139967323350912 api.py:587] Passing random offset: Tensor("Cast:0", shape=(), dtype=int32) with data ({'images': <tf.Tensor 'args_1:0' shape=(128, 128, 3) dtype=float32>, 'z': <tf.Tensor 'args_3:0' shape=(120,) dtype=float32>, 'sampled_labels': <tf.Tensor 'args_2:0' shape=() dtype=int32>}, <tf.Tensor 'args_4:0' shape=() dtype=int32>).
--------------------------------------------datasets.py/train_input_fn,e
INFO:tensorflow:Calling model_fn.
I0408 02:57:26.189983 139967323350912 estimator.py:1169] Calling model_fn.
--------------------------------------------modular_gan.py/model_fn,s
I0408 02:57:26.190246 139967323350912 modular_gan.py:568] model_fn(): features={'images': <tf.Tensor 'IteratorGetNext:1' shape=(8, 128, 128, 3) dtype=float32>, 'z': <tf.Tensor 'IteratorGetNext:3' shape=(8, 120) dtype=float32>, 'sampled_labels': <tf.Tensor 'IteratorGetNext:2' shape=(8,) dtype=int32>, '_RANDOM_OFFSET': <tf.Tensor 'IteratorGetNext:0' shape=(8,) dtype=int32>}, labels=Tensor("IteratorGetNext:4", shape=(8,), dtype=int32),mode=train, params={'use_tpu': False, 'train_batch_size': 8, 'batch_size': 8}
#Clean old summaries from previous calls to model_fn().
# Get features and labels for each sub-step.
--------------------------------------------modular_gan.py/_split_inputs_and_generate_samples,s
I0408 02:57:26.197949 139967323350912 resnet_biggan.py:236] [Generator] inputs are z=(8, 120), y=(8, 2)
I0408 02:57:26.210014 139967323350912 resnet_biggan.py:262] [Generator] z0=(8, 20), z_per_block=['(8, 20)', '(8, 20)', '(8, 20)', '(8, 20)', '(8, 20)'], y_per_block=['(8, 148)', '(8, 148)', '(8, 148)', '(8, 148)', '(8, 148)']
I0408 02:57:26.263090 139967323350912 resnet_biggan.py:150] [Block] (8, 4, 4, 1536) (z=(8, 20), y=(8, 148)) -> (8, 8, 8, 1536)
I0408 02:57:26.304610 139967323350912 resnet_biggan.py:150] [Block] (8, 8, 8, 1536) (z=(8, 20), y=(8, 148)) -> (8, 16, 16, 768)
I0408 02:57:26.347884 139967323350912 resnet_biggan.py:150] [Block] (8, 16, 16, 768) (z=(8, 20), y=(8, 148)) -> (8, 32, 32, 384)
I0408 02:57:26.386097 139967323350912 resnet_biggan.py:150] [Block] (8, 32, 32, 384) (z=(8, 20), y=(8, 148)) -> (8, 64, 64, 192)
I0408 02:57:26.386293 139967323350912 resnet_biggan.py:289] [Generator] Applying non-local block to (8, 64, 64, 192)
WARNING:tensorflow:From /content/drive/My Drive/drive/gan/gan_git-02/gan_git/compare_gan/architectures/arch_ops.py:741: max_pooling2d (from tensorflow.python.layers.pooling) is deprecated and will be removed in a future version.
Instructions for updating:
Use keras.layers.MaxPooling2D instead.
W0408 02:57:26.398476 139967323350912 deprecation.py:323] From /content/drive/My Drive/drive/gan/gan_git-02/gan_git/compare_gan/architectures/arch_ops.py:741: max_pooling2d (from tensorflow.python.layers.pooling) is deprecated and will be removed in a future version.
Instructions for updating:
Use keras.layers.MaxPooling2D instead.
I0408 02:57:26.460417 139967323350912 resnet_biggan.py:150] [Block] (8, 64, 64, 192) (z=(8, 20), y=(8, 148)) -> (8, 128, 128, 96)
I0408 02:57:26.460572 139967323350912 resnet_biggan.py:294] [Generator] before final processing: (8, 128, 128, 96)
I0408 02:57:26.494931 139967323350912 resnet_biggan.py:300] [Generator] after final processing: (8, 128, 128, 3)
--------------------------------------------modular_gan.py/_split_inputs_and_generate_samples,e
##################################################  mode == tf.estimator.ModeKeys.TRAIN ########################
#simpeler train_disc_fn
#simpeler train_gen_fn
#confirm train_gen_fn
# Train D.(train d_steps)
I0408 02:57:26.501358 139967323350912 tpu_random.py:86] Got global random offset: Tensor("disc_step_1/strided_slice:0", shape=(), dtype=int32)
---------------------------------------------------s3gan.py/create_loss,s
W0408 02:57:26.504069 139967323350912 s3gan.py:237] Computing fake images for every sub step separately.
I0408 02:57:26.504312 139967323350912 resnet_biggan.py:236] [Generator] inputs are z=(8, 120), y=(8, 2)
I0408 02:57:26.509870 139967323350912 resnet_biggan.py:262] [Generator] z0=(8, 20), z_per_block=['(8, 20)', '(8, 20)', '(8, 20)', '(8, 20)', '(8, 20)'], y_per_block=['(8, 148)', '(8, 148)', '(8, 148)', '(8, 148)', '(8, 148)']
I0408 02:57:26.529256 139967323350912 resnet_biggan.py:150] [Block] (8, 4, 4, 1536) (z=(8, 20), y=(8, 148)) -> (8, 8, 8, 1536)
I0408 02:57:26.546050 139967323350912 resnet_biggan.py:150] [Block] (8, 8, 8, 1536) (z=(8, 20), y=(8, 148)) -> (8, 16, 16, 768)
I0408 02:57:26.563688 139967323350912 resnet_biggan.py:150] [Block] (8, 16, 16, 768) (z=(8, 20), y=(8, 148)) -> (8, 32, 32, 384)
I0408 02:57:26.579933 139967323350912 resnet_biggan.py:150] [Block] (8, 32, 32, 384) (z=(8, 20), y=(8, 148)) -> (8, 64, 64, 192)
I0408 02:57:26.580114 139967323350912 resnet_biggan.py:289] [Generator] Applying non-local block to (8, 64, 64, 192)
I0408 02:57:26.614148 139967323350912 resnet_biggan.py:150] [Block] (8, 64, 64, 192) (z=(8, 20), y=(8, 148)) -> (8, 128, 128, 96)
I0408 02:57:26.614309 139967323350912 resnet_biggan.py:294] [Generator] before final processing: (8, 128, 128, 96)
I0408 02:57:26.629068 139967323350912 resnet_biggan.py:300] [Generator] after final processing: (8, 128, 128, 3)
I0408 02:57:26.631328 139967323350912 s3gan.py:249] bs=8, rotated_bs=4, num_rot_examples=1
---------------------------------------------------s3gan.py/merge_with_rotation_data,s
---------------------------------------------------s3gan.py/merge_with_rotation_data,e
--------------------------------------------------------------------s3gan.py/discriminator_with_additonal_heads,s
I0408 02:57:26.658457 139967323350912 resnet_biggan.py:379] [Discriminator] inputs are x=(22, 128, 128, 3), y=(22, 2)
I0408 02:57:26.688493 139967323350912 resnet_biggan.py:150] [Block] (22, 128, 128, 3) (z=None, y=(22, 2)) -> (22, 64, 64, 96)
I0408 02:57:26.688644 139967323350912 resnet_biggan.py:398] [Discriminator] Applying non-local block to (22, 64, 64, 96)
I0408 02:57:26.761815 139967323350912 resnet_biggan.py:150] [Block] (22, 64, 64, 96) (z=None, y=(22, 2)) -> (22, 32, 32, 192)
I0408 02:57:26.791398 139967323350912 resnet_biggan.py:150] [Block] (22, 32, 32, 192) (z=None, y=(22, 2)) -> (22, 16, 16, 384)
I0408 02:57:26.820955 139967323350912 resnet_biggan.py:150] [Block] (22, 16, 16, 384) (z=None, y=(22, 2)) -> (22, 8, 8, 768)
I0408 02:57:26.857821 139967323350912 resnet_biggan.py:150] [Block] (22, 8, 8, 768) (z=None, y=(22, 2)) -> (22, 4, 4, 1536)
I0408 02:57:26.878339 139967323350912 resnet_biggan.py:150] [Block] (22, 4, 4, 1536) (z=None, y=(22, 2)) -> (22, 4, 4, 1536)
I0408 02:57:26.878488 139967323350912 resnet_biggan.py:403] [Discriminator] before final processing: (22, 4, 4, 1536)
I0408 02:57:26.893864 139967323350912 resnet_biggan.py:407] [Discriminator] after final processing: (22, 4, 4, 1536)
I0408 02:57:26.904282 139967323350912 resnet_biggan.py:422] [Discriminator] embedded_y for projection: (22, 1536)
I0408 02:57:26.922869 139967323350912 s3gan.py:133] [Discriminator] rotation head (22, 1536) -> Tensor("disc_step_1/discriminator_rotation/score_classify/add:0", shape=(22, 4), dtype=float32)
I0408 02:57:26.943096 139967323350912 s3gan.py:154] [Discriminator] (22, 2) -> aux_logits=(22, 2), y_predicted=(22, 2)
---------------------------------------------------s3gan.py/get_class_embedding,s
I0408 02:57:26.949884 139967323350912 s3gan.py:175] [Discriminator] embedded_y for projection: (22, 1536)
---------------------------------------------------s3gan.py/get_class_embedding,e
---------------------------------------------------s3gan.py/discriminator_with_additonal_heads,e
---------------------------------------------------s3gan.py/create_loss,e
# Train G.(train one step)
I0408 02:57:27.781454 139967323350912 tpu_random.py:86] Got global random offset: Tensor("gen_step/strided_slice:0", shape=(), dtype=int32)
---------------------------------------------------s3gan.py/create_loss,s
W0408 02:57:27.784215 139967323350912 s3gan.py:237] Computing fake images for every sub step separately.
I0408 02:57:27.784442 139967323350912 resnet_biggan.py:236] [Generator] inputs are z=(8, 120), y=(8, 2)
I0408 02:57:27.789868 139967323350912 resnet_biggan.py:262] [Generator] z0=(8, 20), z_per_block=['(8, 20)', '(8, 20)', '(8, 20)', '(8, 20)', '(8, 20)'], y_per_block=['(8, 148)', '(8, 148)', '(8, 148)', '(8, 148)', '(8, 148)']
I0408 02:57:27.808581 139967323350912 resnet_biggan.py:150] [Block] (8, 4, 4, 1536) (z=(8, 20), y=(8, 148)) -> (8, 8, 8, 1536)
I0408 02:57:27.824988 139967323350912 resnet_biggan.py:150] [Block] (8, 8, 8, 1536) (z=(8, 20), y=(8, 148)) -> (8, 16, 16, 768)
I0408 02:57:27.841574 139967323350912 resnet_biggan.py:150] [Block] (8, 16, 16, 768) (z=(8, 20), y=(8, 148)) -> (8, 32, 32, 384)
I0408 02:57:27.858670 139967323350912 resnet_biggan.py:150] [Block] (8, 32, 32, 384) (z=(8, 20), y=(8, 148)) -> (8, 64, 64, 192)
I0408 02:57:27.858834 139967323350912 resnet_biggan.py:289] [Generator] Applying non-local block to (8, 64, 64, 192)
I0408 02:57:27.895596 139967323350912 resnet_biggan.py:150] [Block] (8, 64, 64, 192) (z=(8, 20), y=(8, 148)) -> (8, 128, 128, 96)
I0408 02:57:27.895806 139967323350912 resnet_biggan.py:294] [Generator] before final processing: (8, 128, 128, 96)
I0408 02:57:27.912262 139967323350912 resnet_biggan.py:300] [Generator] after final processing: (8, 128, 128, 3)
I0408 02:57:27.914071 139967323350912 s3gan.py:249] bs=8, rotated_bs=4, num_rot_examples=1
---------------------------------------------------s3gan.py/merge_with_rotation_data,s
---------------------------------------------------s3gan.py/merge_with_rotation_data,e
--------------------------------------------------------------------s3gan.py/discriminator_with_additonal_heads,s
I0408 02:57:27.940892 139967323350912 resnet_biggan.py:379] [Discriminator] inputs are x=(22, 128, 128, 3), y=(22, 2)
I0408 02:57:27.953836 139967323350912 resnet_biggan.py:150] [Block] (22, 128, 128, 3) (z=None, y=(22, 2)) -> (22, 64, 64, 96)
I0408 02:57:27.954011 139967323350912 resnet_biggan.py:398] [Discriminator] Applying non-local block to (22, 64, 64, 96)
I0408 02:57:27.985048 139967323350912 resnet_biggan.py:150] [Block] (22, 64, 64, 96) (z=None, y=(22, 2)) -> (22, 32, 32, 192)
I0408 02:57:27.994746 139967323350912 resnet_biggan.py:150] [Block] (22, 32, 32, 192) (z=None, y=(22, 2)) -> (22, 16, 16, 384)
I0408 02:57:28.004554 139967323350912 resnet_biggan.py:150] [Block] (22, 16, 16, 384) (z=None, y=(22, 2)) -> (22, 8, 8, 768)
I0408 02:57:28.014221 139967323350912 resnet_biggan.py:150] [Block] (22, 8, 8, 768) (z=None, y=(22, 2)) -> (22, 4, 4, 1536)
I0408 02:57:28.019417 139967323350912 resnet_biggan.py:150] [Block] (22, 4, 4, 1536) (z=None, y=(22, 2)) -> (22, 4, 4, 1536)
I0408 02:57:28.019598 139967323350912 resnet_biggan.py:403] [Discriminator] before final processing: (22, 4, 4, 1536)
I0408 02:57:28.022800 139967323350912 resnet_biggan.py:407] [Discriminator] after final processing: (22, 4, 4, 1536)
I0408 02:57:28.024038 139967323350912 resnet_biggan.py:422] [Discriminator] embedded_y for projection: (22, 1536)
I0408 02:57:28.029751 139967323350912 s3gan.py:133] [Discriminator] rotation head (22, 1536) -> Tensor("gen_step/discriminator_rotation/score_classify/add:0", shape=(22, 4), dtype=float32)
I0408 02:57:28.035855 139967323350912 s3gan.py:154] [Discriminator] (22, 2) -> aux_logits=(22, 2), y_predicted=(22, 2)
---------------------------------------------------s3gan.py/get_class_embedding,s
I0408 02:57:28.037168 139967323350912 s3gan.py:175] [Discriminator] embedded_y for projection: (22, 1536)
---------------------------------------------------s3gan.py/get_class_embedding,e
---------------------------------------------------s3gan.py/discriminator_with_additonal_heads,e
---------------------------------------------------s3gan.py/create_loss,e
#add loss to summary
I0408 02:57:29.342252 139967323350912 utils.py:174] 
Generator variables:
+--------------------------------------------------+--------------------+------------+---------+
| Name                                             | Shape              | Size       | Type    |
+--------------------------------------------------+--------------------+------------+---------+
| generator/embed_y/kernel:0                       |           (2, 128) |        256 | float32 |
| generator/fc_noise/kernel:0                      |        (20, 24576) |    491,520 | float32 |
| generator/fc_noise/bias:0                        |           (24576,) |     24,576 | float32 |
| generator/B1/up_conv1/kernel:0                   | (3, 3, 1536, 1536) | 21,233,664 | float32 |
| generator/B1/up_conv1/bias:0                     |            (1536,) |      1,536 | float32 |
| generator/B1/same_conv2/kernel:0                 | (3, 3, 1536, 1536) | 21,233,664 | float32 |
| generator/B1/same_conv2/bias:0                   |            (1536,) |      1,536 | float32 |
| generator/B1/up_conv_shortcut/kernel:0           | (1, 1, 1536, 1536) |  2,359,296 | float32 |
| generator/B1/up_conv_shortcut/bias:0             |            (1536,) |      1,536 | float32 |
| generator/B2/up_conv1/kernel:0                   |  (3, 3, 1536, 768) | 10,616,832 | float32 |
| generator/B2/up_conv1/bias:0                     |             (768,) |        768 | float32 |
| generator/B2/same_conv2/kernel:0                 |   (3, 3, 768, 768) |  5,308,416 | float32 |
| generator/B2/same_conv2/bias:0                   |             (768,) |        768 | float32 |
| generator/B2/up_conv_shortcut/kernel:0           |  (1, 1, 1536, 768) |  1,179,648 | float32 |
| generator/B2/up_conv_shortcut/bias:0             |             (768,) |        768 | float32 |
| generator/B3/up_conv1/kernel:0                   |   (3, 3, 768, 384) |  2,654,208 | float32 |
| generator/B3/up_conv1/bias:0                     |             (384,) |        384 | float32 |
| generator/B3/same_conv2/kernel:0                 |   (3, 3, 384, 384) |  1,327,104 | float32 |
| generator/B3/same_conv2/bias:0                   |             (384,) |        384 | float32 |
| generator/B3/up_conv_shortcut/kernel:0           |   (1, 1, 768, 384) |    294,912 | float32 |
| generator/B3/up_conv_shortcut/bias:0             |             (384,) |        384 | float32 |
| generator/B4/up_conv1/kernel:0                   |   (3, 3, 384, 192) |    663,552 | float32 |
| generator/B4/up_conv1/bias:0                     |             (192,) |        192 | float32 |
| generator/B4/same_conv2/kernel:0                 |   (3, 3, 192, 192) |    331,776 | float32 |
| generator/B4/same_conv2/bias:0                   |             (192,) |        192 | float32 |
| generator/B4/up_conv_shortcut/kernel:0           |   (1, 1, 384, 192) |     73,728 | float32 |
| generator/B4/up_conv_shortcut/bias:0             |             (192,) |        192 | float32 |
| generator/non_local_block/conv2d_theta/kernel:0  |    (1, 1, 192, 24) |      4,608 | float32 |
| generator/non_local_block/conv2d_phi/kernel:0    |    (1, 1, 192, 24) |      4,608 | float32 |
| generator/non_local_block/conv2d_g/kernel:0      |    (1, 1, 192, 96) |     18,432 | float32 |
| generator/non_local_block/sigma:0                |                 () |          1 | float32 |
| generator/non_local_block/conv2d_attn_g/kernel:0 |    (1, 1, 96, 192) |     18,432 | float32 |
| generator/B5/up_conv1/kernel:0                   |    (3, 3, 192, 96) |    165,888 | float32 |
| generator/B5/up_conv1/bias:0                     |              (96,) |         96 | float32 |
| generator/B5/same_conv2/kernel:0                 |     (3, 3, 96, 96) |     82,944 | float32 |
| generator/B5/same_conv2/bias:0                   |              (96,) |         96 | float32 |
| generator/B5/up_conv_shortcut/kernel:0           |    (1, 1, 192, 96) |     18,432 | float32 |
| generator/B5/up_conv_shortcut/bias:0             |              (96,) |         96 | float32 |
| generator/final_norm/gamma:0                     |              (96,) |         96 | float32 |
| generator/final_norm/beta:0                      |              (96,) |         96 | float32 |
| generator/final_conv/kernel:0                    |      (3, 3, 96, 3) |      2,592 | float32 |
| generator/final_conv/bias:0                      |               (3,) |          3 | float32 |
+--------------------------------------------------+--------------------+------------+---------+
Total: 68,118,212
I0408 02:57:29.343132 139967323350912 utils.py:174] 
Discriminator variables:
+------------------------------------------------------+--------------------+------------+---------+
| Name                                                 | Shape              | Size       | Type    |
+------------------------------------------------------+--------------------+------------+---------+
| discriminator/B1/same_conv1/kernel:0                 |      (3, 3, 3, 96) |      2,592 | float32 |
| discriminator/B1/same_conv1/bias:0                   |              (96,) |         96 | float32 |
| discriminator/B1/down_conv2/kernel:0                 |     (3, 3, 96, 96) |     82,944 | float32 |
| discriminator/B1/down_conv2/bias:0                   |              (96,) |         96 | float32 |
| discriminator/B1/down_conv_shortcut/kernel:0         |      (1, 1, 3, 96) |        288 | float32 |
| discriminator/B1/down_conv_shortcut/bias:0           |              (96,) |         96 | float32 |
| discriminator/non_local_block/conv2d_theta/kernel:0  |     (1, 1, 96, 12) |      1,152 | float32 |
| discriminator/non_local_block/conv2d_phi/kernel:0    |     (1, 1, 96, 12) |      1,152 | float32 |
| discriminator/non_local_block/conv2d_g/kernel:0      |     (1, 1, 96, 48) |      4,608 | float32 |
| discriminator/non_local_block/sigma:0                |                 () |          1 | float32 |
| discriminator/non_local_block/conv2d_attn_g/kernel:0 |     (1, 1, 48, 96) |      4,608 | float32 |
| discriminator/B2/same_conv1/kernel:0                 |    (3, 3, 96, 192) |    165,888 | float32 |
| discriminator/B2/same_conv1/bias:0                   |             (192,) |        192 | float32 |
| discriminator/B2/down_conv2/kernel:0                 |   (3, 3, 192, 192) |    331,776 | float32 |
| discriminator/B2/down_conv2/bias:0                   |             (192,) |        192 | float32 |
| discriminator/B2/down_conv_shortcut/kernel:0         |    (1, 1, 96, 192) |     18,432 | float32 |
| discriminator/B2/down_conv_shortcut/bias:0           |             (192,) |        192 | float32 |
| discriminator/B3/same_conv1/kernel:0                 |   (3, 3, 192, 384) |    663,552 | float32 |
| discriminator/B3/same_conv1/bias:0                   |             (384,) |        384 | float32 |
| discriminator/B3/down_conv2/kernel:0                 |   (3, 3, 384, 384) |  1,327,104 | float32 |
| discriminator/B3/down_conv2/bias:0                   |             (384,) |        384 | float32 |
| discriminator/B3/down_conv_shortcut/kernel:0         |   (1, 1, 192, 384) |     73,728 | float32 |
| discriminator/B3/down_conv_shortcut/bias:0           |             (384,) |        384 | float32 |
| discriminator/B4/same_conv1/kernel:0                 |   (3, 3, 384, 768) |  2,654,208 | float32 |
| discriminator/B4/same_conv1/bias:0                   |             (768,) |        768 | float32 |
| discriminator/B4/down_conv2/kernel:0                 |   (3, 3, 768, 768) |  5,308,416 | float32 |
| discriminator/B4/down_conv2/bias:0                   |             (768,) |        768 | float32 |
| discriminator/B4/down_conv_shortcut/kernel:0         |   (1, 1, 384, 768) |    294,912 | float32 |
| discriminator/B4/down_conv_shortcut/bias:0           |             (768,) |        768 | float32 |
| discriminator/B5/same_conv1/kernel:0                 |  (3, 3, 768, 1536) | 10,616,832 | float32 |
| discriminator/B5/same_conv1/bias:0                   |            (1536,) |      1,536 | float32 |
| discriminator/B5/down_conv2/kernel:0                 | (3, 3, 1536, 1536) | 21,233,664 | float32 |
| discriminator/B5/down_conv2/bias:0                   |            (1536,) |      1,536 | float32 |
| discriminator/B5/down_conv_shortcut/kernel:0         |  (1, 1, 768, 1536) |  1,179,648 | float32 |
| discriminator/B5/down_conv_shortcut/bias:0           |            (1536,) |      1,536 | float32 |
| discriminator/B6/same_conv1/kernel:0                 | (3, 3, 1536, 1536) | 21,233,664 | float32 |
| discriminator/B6/same_conv1/bias:0                   |            (1536,) |      1,536 | float32 |
| discriminator/B6/same_conv2/kernel:0                 | (3, 3, 1536, 1536) | 21,233,664 | float32 |
| discriminator/B6/same_conv2/bias:0                   |            (1536,) |      1,536 | float32 |
| discriminator/final_fc/kernel:0                      |          (1536, 1) |      1,536 | float32 |
| discriminator/final_fc/bias:0                        |               (1,) |          1 | float32 |
| discriminator/embedding_fc/kernel:0                  |          (2, 1536) |      3,072 | float32 |
| discriminator_rotation/score_classify/kernel:0       |          (1536, 4) |      6,144 | float32 |
| discriminator_rotation/score_classify/bias:0         |               (4,) |          4 | float32 |
| discriminator_predictor/predictor_linear/kernel:0    |          (1536, 2) |      3,072 | float32 |
| discriminator_predictor/predictor_linear/bias:0      |               (2,) |          2 | float32 |
| discriminator_projection/kernel:0                    |          (2, 1536) |      3,072 | float32 |
+------------------------------------------------------+--------------------+------------+---------+
Total: 86,461,736
--------------------------------------------modular_gan.py/model_fn,e
INFO:tensorflow:Done calling model_fn.
I0408 02:57:29.343598 139967323350912 estimator.py:1171] Done calling model_fn.
INFO:tensorflow:Create CheckpointSaverHook.
I0408 02:57:29.344593 139967323350912 basic_session_run_hooks.py:546] Create CheckpointSaverHook.
INFO:tensorflow:Graph was finalized.
I0408 02:57:30.184037 139967323350912 monitored_session.py:246] Graph was finalized.
2020-04-08 02:57:30.184509: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX512F
2020-04-08 02:57:30.190289: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2000155000 Hz
2020-04-08 02:57:30.190533: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1dd32c0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-04-08 02:57:30.190572: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-04-08 02:57:30.292271: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-04-08 02:57:30.292819: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x9436000 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2020-04-08 02:57:30.292855: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Tesla P4, Compute Capability 6.1
2020-04-08 02:57:30.293084: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-04-08 02:57:30.293486: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:00:04.0 name: Tesla P4 computeCapability: 6.1
coreClock: 1.1135GHz coreCount: 20 deviceMemorySize: 7.43GiB deviceMemoryBandwidth: 178.99GiB/s
2020-04-08 02:57:30.293536: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.1
2020-04-08 02:57:30.293561: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10
2020-04-08 02:57:30.293585: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcufft.so.10
2020-04-08 02:57:30.293604: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcurand.so.10
2020-04-08 02:57:30.293622: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusolver.so.10
2020-04-08 02:57:30.293670: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusparse.so.10
2020-04-08 02:57:30.293690: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudnn.so.7
2020-04-08 02:57:30.293787: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-04-08 02:57:30.294252: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-04-08 02:57:30.294598: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1703] Adding visible gpu devices: 0
2020-04-08 02:57:30.294663: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.1
2020-04-08 02:57:30.787019: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-04-08 02:57:30.787075: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      0 
2020-04-08 02:57:30.787088: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1121] 0:   N 
2020-04-08 02:57:30.787298: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-04-08 02:57:30.787733: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-04-08 02:57:30.788068: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:39] Overriding allow_growth setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2020-04-08 02:57:30.788140: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1247] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 6850 MB memory) -> physical GPU (device: 0, name: Tesla P4, pci bus id: 0000:00:04.0, compute capability: 6.1)
INFO:tensorflow:Running local_init_op.
I0408 02:57:34.561135 139967323350912 session_manager.py:505] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
I0408 02:57:34.630753 139967323350912 session_manager.py:508] Done running local_init_op.
INFO:tensorflow:Calling checkpoint listeners before saving checkpoint 0...
I0408 02:57:37.105551 139967323350912 basic_session_run_hooks.py:614] Calling checkpoint listeners before saving checkpoint 0...
INFO:tensorflow:Saving checkpoints for 0 into /tmp/absl_testing/550760/model.ckpt.
I0408 02:57:37.109370 139967323350912 basic_session_run_hooks.py:618] Saving checkpoints for 0 into /tmp/absl_testing/550760/model.ckpt.
INFO:tensorflow:Calling checkpoint listeners after saving checkpoint 0...
I0408 02:57:57.833079 139967323350912 basic_session_run_hooks.py:626] Calling checkpoint listeners after saving checkpoint 0...
2020-04-08 02:58:03.598487: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10
2020-04-08 02:58:09.449062: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudnn.so.7
2020-04-08 02:58:14.618952: W tensorflow/core/common_runtime/bfc_allocator.cc:245] Allocator (GPU_0_bfc) ran out of memory trying to allocate 2.82GiB with freed_by_count=0. The caller indicates that this is not a failure, but may mean that there could be performance gains if more memory were available.
INFO:tensorflow:loss = 22.071337, step = 0
I0408 02:58:17.392172 139967323350912 basic_session_run_hooks.py:262] loss = 22.071337, step = 0
INFO:tensorflow:global_step/sec: 0.246341
I0408 03:05:03.333179 139967323350912 basic_session_run_hooks.py:702] global_step/sec: 0.246341
INFO:tensorflow:loss = 0.4062093, step = 100 (405.942 sec)
I0408 03:05:03.334279 139967323350912 basic_session_run_hooks.py:260] loss = 0.4062093, step = 100 (405.942 sec)
INFO:tensorflow:Calling checkpoint listeners before saving checkpoint 146...
I0408 03:07:58.302724 139967323350912 basic_session_run_hooks.py:614] Calling checkpoint listeners before saving checkpoint 146...
INFO:tensorflow:Saving checkpoints for 146 into /tmp/absl_testing/550760/model.ckpt.
I0408 03:07:58.303020 139967323350912 basic_session_run_hooks.py:618] Saving checkpoints for 146 into /tmp/absl_testing/550760/model.ckpt.
INFO:tensorflow:Calling checkpoint listeners after saving checkpoint 146...
I0408 03:08:14.251689 139967323350912 basic_session_run_hooks.py:626] Calling checkpoint listeners after saving checkpoint 146...
--------------------------------------------datasets.py/eval_input_fn,s
W0408 03:08:14.264914 139967323350912 datasets.py:170] No TPUContext, using unmodified dataset seed 547.
I0408 03:08:14.265083 139967323350912 datasets.py:348] eval_input_fn(): params={'use_tpu': False, 'train_batch_size': 8, 'batch_size': 8} seed=547
--------befor self._load_dataset------------------split = validation self._eval_split= validation
--------------------------------------------datasets.py/_load_dataset,s
!!!!!!!!!!!!!!!!!!!!!!----load_local_datasets,  _local_test_ds_dir= /content/drive/My Drive/drive/gan/test
-----------------------------------------get_local_datasets,s
-----------------------------------------get_local_datasets,e
--------------------------------------------modular_gan.py/_preprocess_fn,s
I0408 03:08:27.449904 139967323350912 api.py:587] _preprocess_fn(): images=Tensor("args_0:0", shape=(128, 128, 3), dtype=float32), labels=Tensor("args_1:0", shape=(), dtype=int32), seed=547
--------------------------------------------modular_gan.py/_preprocess_fn,e
I0408 03:08:27.483108 139967323350912 api.py:587] Passing random offset: Tensor("Cast:0", shape=(), dtype=int32) with data ({'images': <tf.Tensor 'args_1:0' shape=(128, 128, 3) dtype=float32>, 'z': <tf.Tensor 'args_3:0' shape=(120,) dtype=float32>, 'sampled_labels': <tf.Tensor 'args_2:0' shape=() dtype=int32>}, <tf.Tensor 'args_4:0' shape=() dtype=int32>).
--------------------------------------------datasets.py/eval_input_fn,e
INFO:tensorflow:Calling model_fn.
I0408 03:08:27.502008 139967323350912 estimator.py:1169] Calling model_fn.
--------------------------------------------modular_gan.py/model_fn,s
I0408 03:08:27.502231 139967323350912 modular_gan.py:568] model_fn(): features={'images': <tf.Tensor 'IteratorGetNext:1' shape=(8, 128, 128, 3) dtype=float32>, 'z': <tf.Tensor 'IteratorGetNext:3' shape=(8, 120) dtype=float32>, 'sampled_labels': <tf.Tensor 'IteratorGetNext:2' shape=(8,) dtype=int32>, '_RANDOM_OFFSET': <tf.Tensor 'IteratorGetNext:0' shape=(8,) dtype=int32>}, labels=Tensor("IteratorGetNext:4", shape=(8,), dtype=int32),mode=eval, params={'use_tpu': False, 'train_batch_size': 8, 'batch_size': 8}
#Clean old summaries from previous calls to model_fn().
# Get features and labels for each sub-step.
--------------------------------------------modular_gan.py/_split_inputs_and_generate_samples,s
I0408 03:08:27.510818 139967323350912 resnet_biggan.py:236] [Generator] inputs are z=(8, 120), y=(8, 2)
I0408 03:08:27.522961 139967323350912 resnet_biggan.py:262] [Generator] z0=(8, 20), z_per_block=['(8, 20)', '(8, 20)', '(8, 20)', '(8, 20)', '(8, 20)'], y_per_block=['(8, 148)', '(8, 148)', '(8, 148)', '(8, 148)', '(8, 148)']
I0408 03:08:27.582639 139967323350912 resnet_biggan.py:150] [Block] (8, 4, 4, 1536) (z=(8, 20), y=(8, 148)) -> (8, 8, 8, 1536)
I0408 03:08:27.626588 139967323350912 resnet_biggan.py:150] [Block] (8, 8, 8, 1536) (z=(8, 20), y=(8, 148)) -> (8, 16, 16, 768)
I0408 03:08:27.670614 139967323350912 resnet_biggan.py:150] [Block] (8, 16, 16, 768) (z=(8, 20), y=(8, 148)) -> (8, 32, 32, 384)
I0408 03:08:27.716534 139967323350912 resnet_biggan.py:150] [Block] (8, 32, 32, 384) (z=(8, 20), y=(8, 148)) -> (8, 64, 64, 192)
I0408 03:08:27.716708 139967323350912 resnet_biggan.py:289] [Generator] Applying non-local block to (8, 64, 64, 192)
I0408 03:08:27.807588 139967323350912 resnet_biggan.py:150] [Block] (8, 64, 64, 192) (z=(8, 20), y=(8, 148)) -> (8, 128, 128, 96)
I0408 03:08:27.807768 139967323350912 resnet_biggan.py:294] [Generator] before final processing: (8, 128, 128, 96)
I0408 03:08:27.844604 139967323350912 resnet_biggan.py:300] [Generator] after final processing: (8, 128, 128, 3)
--------------------------------------------modular_gan.py/_split_inputs_and_generate_samples,e
---------------------------------------------------modular_gan.py/create_logits,s
I0408 03:08:27.848678 139967323350912 tpu_random.py:86] Got global random offset: Tensor("strided_slice:0", shape=(), dtype=int32)
---------------------------------------------------s3gan.py/create_loss,s
W0408 03:08:27.851866 139967323350912 s3gan.py:237] Computing fake images for every sub step separately.
I0408 03:08:27.852092 139967323350912 resnet_biggan.py:236] [Generator] inputs are z=(8, 120), y=(8, 2)
I0408 03:08:27.861157 139967323350912 resnet_biggan.py:262] [Generator] z0=(8, 20), z_per_block=['(8, 20)', '(8, 20)', '(8, 20)', '(8, 20)', '(8, 20)'], y_per_block=['(8, 148)', '(8, 148)', '(8, 148)', '(8, 148)', '(8, 148)']
I0408 03:08:27.890311 139967323350912 resnet_biggan.py:150] [Block] (8, 4, 4, 1536) (z=(8, 20), y=(8, 148)) -> (8, 8, 8, 1536)
I0408 03:08:27.911286 139967323350912 resnet_biggan.py:150] [Block] (8, 8, 8, 1536) (z=(8, 20), y=(8, 148)) -> (8, 16, 16, 768)
I0408 03:08:27.932630 139967323350912 resnet_biggan.py:150] [Block] (8, 16, 16, 768) (z=(8, 20), y=(8, 148)) -> (8, 32, 32, 384)
I0408 03:08:27.951608 139967323350912 resnet_biggan.py:150] [Block] (8, 32, 32, 384) (z=(8, 20), y=(8, 148)) -> (8, 64, 64, 192)
I0408 03:08:27.951774 139967323350912 resnet_biggan.py:289] [Generator] Applying non-local block to (8, 64, 64, 192)
I0408 03:08:27.991091 139967323350912 resnet_biggan.py:150] [Block] (8, 64, 64, 192) (z=(8, 20), y=(8, 148)) -> (8, 128, 128, 96)
I0408 03:08:27.991286 139967323350912 resnet_biggan.py:294] [Generator] before final processing: (8, 128, 128, 96)
I0408 03:08:28.008384 139967323350912 resnet_biggan.py:300] [Generator] after final processing: (8, 128, 128, 3)
I0408 03:08:28.010427 139967323350912 s3gan.py:249] bs=8, rotated_bs=4, num_rot_examples=1
---------------------------------------------------s3gan.py/merge_with_rotation_data,s
---------------------------------------------------s3gan.py/merge_with_rotation_data,e
--------------------------------------------------------------------s3gan.py/discriminator_with_additonal_heads,s
I0408 03:08:28.041542 139967323350912 resnet_biggan.py:379] [Discriminator] inputs are x=(22, 128, 128, 3), y=(22, 2)
I0408 03:08:28.082485 139967323350912 resnet_biggan.py:150] [Block] (22, 128, 128, 3) (z=None, y=(22, 2)) -> (22, 64, 64, 96)
I0408 03:08:28.082661 139967323350912 resnet_biggan.py:398] [Discriminator] Applying non-local block to (22, 64, 64, 96)
I0408 03:08:28.166038 139967323350912 resnet_biggan.py:150] [Block] (22, 64, 64, 96) (z=None, y=(22, 2)) -> (22, 32, 32, 192)
I0408 03:08:28.202289 139967323350912 resnet_biggan.py:150] [Block] (22, 32, 32, 192) (z=None, y=(22, 2)) -> (22, 16, 16, 384)
I0408 03:08:28.238744 139967323350912 resnet_biggan.py:150] [Block] (22, 16, 16, 384) (z=None, y=(22, 2)) -> (22, 8, 8, 768)
I0408 03:08:28.278981 139967323350912 resnet_biggan.py:150] [Block] (22, 8, 8, 768) (z=None, y=(22, 2)) -> (22, 4, 4, 1536)
I0408 03:08:28.302023 139967323350912 resnet_biggan.py:150] [Block] (22, 4, 4, 1536) (z=None, y=(22, 2)) -> (22, 4, 4, 1536)
I0408 03:08:28.302242 139967323350912 resnet_biggan.py:403] [Discriminator] before final processing: (22, 4, 4, 1536)
I0408 03:08:28.313953 139967323350912 resnet_biggan.py:407] [Discriminator] after final processing: (22, 4, 4, 1536)
I0408 03:08:28.320492 139967323350912 resnet_biggan.py:422] [Discriminator] embedded_y for projection: (22, 1536)
I0408 03:08:28.334521 139967323350912 s3gan.py:133] [Discriminator] rotation head (22, 1536) -> Tensor("discriminator_rotation/score_classify/add:0", shape=(22, 4), dtype=float32)
I0408 03:08:28.348304 139967323350912 s3gan.py:154] [Discriminator] (22, 2) -> aux_logits=(22, 2), y_predicted=(22, 2)
---------------------------------------------------s3gan.py/get_class_embedding,s
I0408 03:08:28.354814 139967323350912 s3gan.py:175] [Discriminator] embedded_y for projection: (22, 1536)
---------------------------------------------------s3gan.py/get_class_embedding,e
---------------------------------------------------s3gan.py/discriminator_with_additonal_heads,e
---------------------------------------------------s3gan.py/create_loss,e
---------------------------------------------------modular_gan.py/create_logits,e
################################################## mode == tf.estimator.ModeKeys.EVAL  ########################
INFO:tensorflow:Done calling model_fn.
I0408 03:08:28.467786 139967323350912 estimator.py:1171] Done calling model_fn.
INFO:tensorflow:Starting evaluation at 2020-04-08T03:08:28Z
I0408 03:08:28.486958 139967323350912 evaluation.py:255] Starting evaluation at 2020-04-08T03:08:28Z
INFO:tensorflow:Graph was finalized.
I0408 03:08:28.658787 139967323350912 monitored_session.py:246] Graph was finalized.
2020-04-08 03:08:28.660236: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-04-08 03:08:28.660538: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:00:04.0 name: Tesla P4 computeCapability: 6.1
coreClock: 1.1135GHz coreCount: 20 deviceMemorySize: 7.43GiB deviceMemoryBandwidth: 178.99GiB/s
2020-04-08 03:08:28.660602: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.1
2020-04-08 03:08:28.660637: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10
2020-04-08 03:08:28.660660: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcufft.so.10
2020-04-08 03:08:28.660682: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcurand.so.10
2020-04-08 03:08:28.660701: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusolver.so.10
2020-04-08 03:08:28.660750: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusparse.so.10
2020-04-08 03:08:28.660771: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudnn.so.7
2020-04-08 03:08:28.660866: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-04-08 03:08:28.661190: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-04-08 03:08:28.661426: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1703] Adding visible gpu devices: 0
2020-04-08 03:08:28.661479: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-04-08 03:08:28.661496: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      0 
2020-04-08 03:08:28.661509: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1121] 0:   N 
2020-04-08 03:08:28.661613: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-04-08 03:08:28.661926: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-04-08 03:08:28.662181: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1247] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 6850 MB memory) -> physical GPU (device: 0, name: Tesla P4, pci bus id: 0000:00:04.0, compute capability: 6.1)
INFO:tensorflow:Restoring parameters from /tmp/absl_testing/550760/model.ckpt-146
I0408 03:08:28.663431 139967323350912 saver.py:1293] Restoring parameters from /tmp/absl_testing/550760/model.ckpt-146
INFO:tensorflow:Running local_init_op.
I0408 03:08:29.116749 139967323350912 session_manager.py:505] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
I0408 03:08:29.141080 139967323350912 session_manager.py:508] Done running local_init_op.
INFO:tensorflow:Evaluation [5/50]
I0408 03:08:48.058716 139967323350912 evaluation.py:167] Evaluation [5/50]
INFO:tensorflow:Evaluation [10/50]
I0408 03:09:05.301883 139967323350912 evaluation.py:167] Evaluation [10/50]
INFO:tensorflow:Evaluation [15/50]
I0408 03:09:25.237566 139967323350912 evaluation.py:167] Evaluation [15/50]
INFO:tensorflow:Evaluation [20/50]
I0408 03:09:41.940393 139967323350912 evaluation.py:167] Evaluation [20/50]
INFO:tensorflow:Evaluation [25/50]
I0408 03:09:58.625807 139967323350912 evaluation.py:167] Evaluation [25/50]
INFO:tensorflow:Evaluation [30/50]
I0408 03:10:15.048967 139967323350912 evaluation.py:167] Evaluation [30/50]
INFO:tensorflow:Evaluation [35/50]
I0408 03:10:31.808244 139967323350912 evaluation.py:167] Evaluation [35/50]
INFO:tensorflow:Evaluation [40/50]
I0408 03:10:54.918165 139967323350912 evaluation.py:167] Evaluation [40/50]
INFO:tensorflow:Evaluation [45/50]
I0408 03:11:12.607844 139967323350912 evaluation.py:167] Evaluation [45/50]
INFO:tensorflow:Evaluation [50/50]
I0408 03:11:30.261888 139967323350912 evaluation.py:167] Evaluation [50/50]
INFO:tensorflow:Inference Time : 181.88857s
I0408 03:11:30.375758 139967323350912 evaluation.py:273] Inference Time : 181.88857s
INFO:tensorflow:Finished evaluation at 2020-04-08-03:11:30
I0408 03:11:30.375956 139967323350912 evaluation.py:276] Finished evaluation at 2020-04-08-03:11:30
INFO:tensorflow:Saving dict for global step 146: accuracy = 0.635, global_step = 146, loss = 0.6859584
I0408 03:11:30.376099 139967323350912 estimator.py:2066] Saving dict for global step 146: accuracy = 0.635, global_step = 146, loss = 0.6859584
INFO:tensorflow:Saving 'checkpoint_path' summary for global step 146: /tmp/absl_testing/550760/model.ckpt-146
I0408 03:11:30.602008 139967323350912 estimator.py:2127] Saving 'checkpoint_path' summary for global step 146: /tmp/absl_testing/550760/model.ckpt-146
INFO:tensorflow:global_step/sec: 0.174531
I0408 03:14:36.296250 139967323350912 basic_session_run_hooks.py:702] global_step/sec: 0.174531
INFO:tensorflow:loss = 1.1478127, step = 200 (572.963 sec)
I0408 03:14:36.297304 139967323350912 basic_session_run_hooks.py:260] loss = 1.1478127, step = 200 (572.963 sec)
INFO:tensorflow:Calling checkpoint listeners before saving checkpoint 260...
I0408 03:18:00.364420 139967323350912 basic_session_run_hooks.py:614] Calling checkpoint listeners before saving checkpoint 260...
INFO:tensorflow:Saving checkpoints for 260 into /tmp/absl_testing/550760/model.ckpt.
I0408 03:18:00.364673 139967323350912 basic_session_run_hooks.py:618] Saving checkpoints for 260 into /tmp/absl_testing/550760/model.ckpt.
INFO:tensorflow:Calling checkpoint listeners after saving checkpoint 260...
I0408 03:18:16.980011 139967323350912 basic_session_run_hooks.py:626] Calling checkpoint listeners after saving checkpoint 260...
--------------------------------------------datasets.py/eval_input_fn,s
W0408 03:18:18.214174 139967323350912 datasets.py:170] No TPUContext, using unmodified dataset seed 547.
I0408 03:18:18.214358 139967323350912 datasets.py:348] eval_input_fn(): params={'use_tpu': False, 'train_batch_size': 8, 'batch_size': 8} seed=547
--------befor self._load_dataset------------------split = validation self._eval_split= validation
--------------------------------------------datasets.py/_load_dataset,s
!!!!!!!!!!!!!!!!!!!!!!----load_local_datasets,  _local_test_ds_dir= /content/drive/My Drive/drive/gan/test
-----------------------------------------get_local_datasets,s
-----------------------------------------get_local_datasets,e
--------------------------------------------modular_gan.py/_preprocess_fn,s
I0408 03:18:19.678271 139967323350912 api.py:587] _preprocess_fn(): images=Tensor("args_0:0", shape=(128, 128, 3), dtype=float32), labels=Tensor("args_1:0", shape=(), dtype=int32), seed=547
--------------------------------------------modular_gan.py/_preprocess_fn,e
I0408 03:18:19.707961 139967323350912 api.py:587] Passing random offset: Tensor("Cast:0", shape=(), dtype=int32) with data ({'images': <tf.Tensor 'args_1:0' shape=(128, 128, 3) dtype=float32>, 'z': <tf.Tensor 'args_3:0' shape=(120,) dtype=float32>, 'sampled_labels': <tf.Tensor 'args_2:0' shape=() dtype=int32>}, <tf.Tensor 'args_4:0' shape=() dtype=int32>).
--------------------------------------------datasets.py/eval_input_fn,e
INFO:tensorflow:Calling model_fn.
I0408 03:18:19.724961 139967323350912 estimator.py:1169] Calling model_fn.
--------------------------------------------modular_gan.py/model_fn,s
I0408 03:18:19.725126 139967323350912 modular_gan.py:568] model_fn(): features={'images': <tf.Tensor 'IteratorGetNext:1' shape=(8, 128, 128, 3) dtype=float32>, 'z': <tf.Tensor 'IteratorGetNext:3' shape=(8, 120) dtype=float32>, 'sampled_labels': <tf.Tensor 'IteratorGetNext:2' shape=(8,) dtype=int32>, '_RANDOM_OFFSET': <tf.Tensor 'IteratorGetNext:0' shape=(8,) dtype=int32>}, labels=Tensor("IteratorGetNext:4", shape=(8,), dtype=int32),mode=eval, params={'use_tpu': False, 'train_batch_size': 8, 'batch_size': 8}
#Clean old summaries from previous calls to model_fn().
# Get features and labels for each sub-step.
--------------------------------------------modular_gan.py/_split_inputs_and_generate_samples,s
I0408 03:18:19.731882 139967323350912 resnet_biggan.py:236] [Generator] inputs are z=(8, 120), y=(8, 2)
I0408 03:18:19.742261 139967323350912 resnet_biggan.py:262] [Generator] z0=(8, 20), z_per_block=['(8, 20)', '(8, 20)', '(8, 20)', '(8, 20)', '(8, 20)'], y_per_block=['(8, 148)', '(8, 148)', '(8, 148)', '(8, 148)', '(8, 148)']
I0408 03:18:19.790704 139967323350912 resnet_biggan.py:150] [Block] (8, 4, 4, 1536) (z=(8, 20), y=(8, 148)) -> (8, 8, 8, 1536)
I0408 03:18:19.833790 139967323350912 resnet_biggan.py:150] [Block] (8, 8, 8, 1536) (z=(8, 20), y=(8, 148)) -> (8, 16, 16, 768)
I0408 03:18:19.877503 139967323350912 resnet_biggan.py:150] [Block] (8, 16, 16, 768) (z=(8, 20), y=(8, 148)) -> (8, 32, 32, 384)
I0408 03:18:19.924151 139967323350912 resnet_biggan.py:150] [Block] (8, 32, 32, 384) (z=(8, 20), y=(8, 148)) -> (8, 64, 64, 192)
I0408 03:18:19.924320 139967323350912 resnet_biggan.py:289] [Generator] Applying non-local block to (8, 64, 64, 192)
I0408 03:18:20.011255 139967323350912 resnet_biggan.py:150] [Block] (8, 64, 64, 192) (z=(8, 20), y=(8, 148)) -> (8, 128, 128, 96)
I0408 03:18:20.011428 139967323350912 resnet_biggan.py:294] [Generator] before final processing: (8, 128, 128, 96)
I0408 03:18:20.049985 139967323350912 resnet_biggan.py:300] [Generator] after final processing: (8, 128, 128, 3)
--------------------------------------------modular_gan.py/_split_inputs_and_generate_samples,e
---------------------------------------------------modular_gan.py/create_logits,s
I0408 03:18:20.054058 139967323350912 tpu_random.py:86] Got global random offset: Tensor("strided_slice:0", shape=(), dtype=int32)
---------------------------------------------------s3gan.py/create_loss,s
W0408 03:18:20.057150 139967323350912 s3gan.py:237] Computing fake images for every sub step separately.
I0408 03:18:20.057357 139967323350912 resnet_biggan.py:236] [Generator] inputs are z=(8, 120), y=(8, 2)
I0408 03:18:20.063750 139967323350912 resnet_biggan.py:262] [Generator] z0=(8, 20), z_per_block=['(8, 20)', '(8, 20)', '(8, 20)', '(8, 20)', '(8, 20)'], y_per_block=['(8, 148)', '(8, 148)', '(8, 148)', '(8, 148)', '(8, 148)']
I0408 03:18:20.084709 139967323350912 resnet_biggan.py:150] [Block] (8, 4, 4, 1536) (z=(8, 20), y=(8, 148)) -> (8, 8, 8, 1536)
I0408 03:18:20.103466 139967323350912 resnet_biggan.py:150] [Block] (8, 8, 8, 1536) (z=(8, 20), y=(8, 148)) -> (8, 16, 16, 768)
I0408 03:18:20.122753 139967323350912 resnet_biggan.py:150] [Block] (8, 16, 16, 768) (z=(8, 20), y=(8, 148)) -> (8, 32, 32, 384)
I0408 03:18:20.142297 139967323350912 resnet_biggan.py:150] [Block] (8, 32, 32, 384) (z=(8, 20), y=(8, 148)) -> (8, 64, 64, 192)
I0408 03:18:20.142461 139967323350912 resnet_biggan.py:289] [Generator] Applying non-local block to (8, 64, 64, 192)
I0408 03:18:20.178683 139967323350912 resnet_biggan.py:150] [Block] (8, 64, 64, 192) (z=(8, 20), y=(8, 148)) -> (8, 128, 128, 96)
I0408 03:18:20.178860 139967323350912 resnet_biggan.py:294] [Generator] before final processing: (8, 128, 128, 96)
I0408 03:18:20.194940 139967323350912 resnet_biggan.py:300] [Generator] after final processing: (8, 128, 128, 3)
I0408 03:18:20.196908 139967323350912 s3gan.py:249] bs=8, rotated_bs=4, num_rot_examples=1
---------------------------------------------------s3gan.py/merge_with_rotation_data,s
---------------------------------------------------s3gan.py/merge_with_rotation_data,e
--------------------------------------------------------------------s3gan.py/discriminator_with_additonal_heads,s
I0408 03:18:20.222742 139967323350912 resnet_biggan.py:379] [Discriminator] inputs are x=(22, 128, 128, 3), y=(22, 2)
I0408 03:18:20.255754 139967323350912 resnet_biggan.py:150] [Block] (22, 128, 128, 3) (z=None, y=(22, 2)) -> (22, 64, 64, 96)
I0408 03:18:20.255899 139967323350912 resnet_biggan.py:398] [Discriminator] Applying non-local block to (22, 64, 64, 96)
I0408 03:18:20.331266 139967323350912 resnet_biggan.py:150] [Block] (22, 64, 64, 96) (z=None, y=(22, 2)) -> (22, 32, 32, 192)
I0408 03:18:20.365343 139967323350912 resnet_biggan.py:150] [Block] (22, 32, 32, 192) (z=None, y=(22, 2)) -> (22, 16, 16, 384)
I0408 03:18:20.396459 139967323350912 resnet_biggan.py:150] [Block] (22, 16, 16, 384) (z=None, y=(22, 2)) -> (22, 8, 8, 768)
I0408 03:18:20.427869 139967323350912 resnet_biggan.py:150] [Block] (22, 8, 8, 768) (z=None, y=(22, 2)) -> (22, 4, 4, 1536)
I0408 03:18:20.447575 139967323350912 resnet_biggan.py:150] [Block] (22, 4, 4, 1536) (z=None, y=(22, 2)) -> (22, 4, 4, 1536)
I0408 03:18:20.447776 139967323350912 resnet_biggan.py:403] [Discriminator] before final processing: (22, 4, 4, 1536)
I0408 03:18:20.458239 139967323350912 resnet_biggan.py:407] [Discriminator] after final processing: (22, 4, 4, 1536)
I0408 03:18:20.464477 139967323350912 resnet_biggan.py:422] [Discriminator] embedded_y for projection: (22, 1536)
I0408 03:18:20.480493 139967323350912 s3gan.py:133] [Discriminator] rotation head (22, 1536) -> Tensor("discriminator_rotation/score_classify/add:0", shape=(22, 4), dtype=float32)
I0408 03:18:20.494820 139967323350912 s3gan.py:154] [Discriminator] (22, 2) -> aux_logits=(22, 2), y_predicted=(22, 2)
---------------------------------------------------s3gan.py/get_class_embedding,s
I0408 03:18:20.500932 139967323350912 s3gan.py:175] [Discriminator] embedded_y for projection: (22, 1536)
---------------------------------------------------s3gan.py/get_class_embedding,e
---------------------------------------------------s3gan.py/discriminator_with_additonal_heads,e
---------------------------------------------------s3gan.py/create_loss,e
---------------------------------------------------modular_gan.py/create_logits,e
################################################## mode == tf.estimator.ModeKeys.EVAL  ########################
INFO:tensorflow:Done calling model_fn.
I0408 03:18:20.608580 139967323350912 estimator.py:1171] Done calling model_fn.
INFO:tensorflow:Starting evaluation at 2020-04-08T03:18:20Z
I0408 03:18:20.625639 139967323350912 evaluation.py:255] Starting evaluation at 2020-04-08T03:18:20Z
INFO:tensorflow:Graph was finalized.
I0408 03:18:20.772424 139967323350912 monitored_session.py:246] Graph was finalized.
2020-04-08 03:18:20.773171: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-04-08 03:18:20.773490: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:00:04.0 name: Tesla P4 computeCapability: 6.1
coreClock: 1.1135GHz coreCount: 20 deviceMemorySize: 7.43GiB deviceMemoryBandwidth: 178.99GiB/s
2020-04-08 03:18:20.773539: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.1
2020-04-08 03:18:20.773573: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10
2020-04-08 03:18:20.773591: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcufft.so.10
2020-04-08 03:18:20.773606: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcurand.so.10
2020-04-08 03:18:20.773627: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusolver.so.10
2020-04-08 03:18:20.773687: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusparse.so.10
2020-04-08 03:18:20.773710: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudnn.so.7
2020-04-08 03:18:20.773788: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-04-08 03:18:20.774064: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-04-08 03:18:20.774294: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1703] Adding visible gpu devices: 0
2020-04-08 03:18:20.774344: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-04-08 03:18:20.774358: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      0 
2020-04-08 03:18:20.774368: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1121] 0:   N 
2020-04-08 03:18:20.774481: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-04-08 03:18:20.774770: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-04-08 03:18:20.774989: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1247] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 6850 MB memory) -> physical GPU (device: 0, name: Tesla P4, pci bus id: 0000:00:04.0, compute capability: 6.1)
INFO:tensorflow:Restoring parameters from /tmp/absl_testing/550760/model.ckpt-260
I0408 03:18:20.775875 139967323350912 saver.py:1293] Restoring parameters from /tmp/absl_testing/550760/model.ckpt-260
INFO:tensorflow:Running local_init_op.
I0408 03:18:21.204204 139967323350912 session_manager.py:505] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
I0408 03:18:21.227677 139967323350912 session_manager.py:508] Done running local_init_op.
INFO:tensorflow:Evaluation [5/50]
I0408 03:18:35.939629 139967323350912 evaluation.py:167] Evaluation [5/50]
INFO:tensorflow:Evaluation [10/50]
I0408 03:18:49.640461 139967323350912 evaluation.py:167] Evaluation [10/50]
INFO:tensorflow:Evaluation [15/50]
I0408 03:19:02.458674 139967323350912 evaluation.py:167] Evaluation [15/50]
INFO:tensorflow:Evaluation [20/50]
I0408 03:19:14.564055 139967323350912 evaluation.py:167] Evaluation [20/50]
INFO:tensorflow:Evaluation [25/50]
I0408 03:19:28.125452 139967323350912 evaluation.py:167] Evaluation [25/50]
INFO:tensorflow:Evaluation [30/50]
I0408 03:19:40.842714 139967323350912 evaluation.py:167] Evaluation [30/50]
INFO:tensorflow:Evaluation [35/50]
I0408 03:19:52.206012 139967323350912 evaluation.py:167] Evaluation [35/50]
INFO:tensorflow:Evaluation [40/50]
I0408 03:20:05.667585 139967323350912 evaluation.py:167] Evaluation [40/50]
INFO:tensorflow:Evaluation [45/50]
I0408 03:20:20.102273 139967323350912 evaluation.py:167] Evaluation [45/50]
INFO:tensorflow:Evaluation [50/50]
I0408 03:20:32.645460 139967323350912 evaluation.py:167] Evaluation [50/50]
INFO:tensorflow:Inference Time : 132.40052s
I0408 03:20:33.026363 139967323350912 evaluation.py:273] Inference Time : 132.40052s
INFO:tensorflow:Finished evaluation at 2020-04-08-03:20:33
I0408 03:20:33.026638 139967323350912 evaluation.py:276] Finished evaluation at 2020-04-08-03:20:33
INFO:tensorflow:Saving dict for global step 260: accuracy = 0.6125, global_step = 260, loss = 0.18358886
I0408 03:20:33.026834 139967323350912 estimator.py:2066] Saving dict for global step 260: accuracy = 0.6125, global_step = 260, loss = 0.18358886
INFO:tensorflow:Saving 'checkpoint_path' summary for global step 260: /tmp/absl_testing/550760/model.ckpt-260
I0408 03:20:33.028903 139967323350912 estimator.py:2127] Saving 'checkpoint_path' summary for global step 260: /tmp/absl_testing/550760/model.ckpt-260
INFO:tensorflow:global_step/sec: 0.206288
I0408 03:22:41.055511 139967323350912 basic_session_run_hooks.py:702] global_step/sec: 0.206288
INFO:tensorflow:loss = 0.31086767, step = 300 (484.760 sec)
I0408 03:22:41.056812 139967323350912 basic_session_run_hooks.py:260] loss = 0.31086767, step = 300 (484.760 sec)
INFO:tensorflow:Calling checkpoint listeners before saving checkpoint 393...
I0408 03:28:01.163636 139967323350912 basic_session_run_hooks.py:614] Calling checkpoint listeners before saving checkpoint 393...
INFO:tensorflow:Saving checkpoints for 393 into /tmp/absl_testing/550760/model.ckpt.
I0408 03:28:01.163967 139967323350912 basic_session_run_hooks.py:618] Saving checkpoints for 393 into /tmp/absl_testing/550760/model.ckpt.
INFO:tensorflow:Calling checkpoint listeners after saving checkpoint 393...
I0408 03:28:17.503382 139967323350912 basic_session_run_hooks.py:626] Calling checkpoint listeners after saving checkpoint 393...
--------------------------------------------datasets.py/eval_input_fn,s
W0408 03:28:17.510299 139967323350912 datasets.py:170] No TPUContext, using unmodified dataset seed 547.
I0408 03:28:17.510425 139967323350912 datasets.py:348] eval_input_fn(): params={'use_tpu': False, 'train_batch_size': 8, 'batch_size': 8} seed=547
--------befor self._load_dataset------------------split = validation self._eval_split= validation
--------------------------------------------datasets.py/_load_dataset,s
!!!!!!!!!!!!!!!!!!!!!!----load_local_datasets,  _local_test_ds_dir= /content/drive/My Drive/drive/gan/test
-----------------------------------------get_local_datasets,s
-----------------------------------------get_local_datasets,e
--------------------------------------------modular_gan.py/_preprocess_fn,s
I0408 03:28:19.523466 139967323350912 api.py:587] _preprocess_fn(): images=Tensor("args_0:0", shape=(128, 128, 3), dtype=float32), labels=Tensor("args_1:0", shape=(), dtype=int32), seed=547
--------------------------------------------modular_gan.py/_preprocess_fn,e
I0408 03:28:19.552707 139967323350912 api.py:587] Passing random offset: Tensor("Cast:0", shape=(), dtype=int32) with data ({'images': <tf.Tensor 'args_1:0' shape=(128, 128, 3) dtype=float32>, 'z': <tf.Tensor 'args_3:0' shape=(120,) dtype=float32>, 'sampled_labels': <tf.Tensor 'args_2:0' shape=() dtype=int32>}, <tf.Tensor 'args_4:0' shape=() dtype=int32>).
--------------------------------------------datasets.py/eval_input_fn,e
INFO:tensorflow:Calling model_fn.
I0408 03:28:19.569646 139967323350912 estimator.py:1169] Calling model_fn.
--------------------------------------------modular_gan.py/model_fn,s
I0408 03:28:19.569834 139967323350912 modular_gan.py:568] model_fn(): features={'images': <tf.Tensor 'IteratorGetNext:1' shape=(8, 128, 128, 3) dtype=float32>, 'z': <tf.Tensor 'IteratorGetNext:3' shape=(8, 120) dtype=float32>, 'sampled_labels': <tf.Tensor 'IteratorGetNext:2' shape=(8,) dtype=int32>, '_RANDOM_OFFSET': <tf.Tensor 'IteratorGetNext:0' shape=(8,) dtype=int32>}, labels=Tensor("IteratorGetNext:4", shape=(8,), dtype=int32),mode=eval, params={'use_tpu': False, 'train_batch_size': 8, 'batch_size': 8}
#Clean old summaries from previous calls to model_fn().
# Get features and labels for each sub-step.
--------------------------------------------modular_gan.py/_split_inputs_and_generate_samples,s
I0408 03:28:19.577474 139967323350912 resnet_biggan.py:236] [Generator] inputs are z=(8, 120), y=(8, 2)
I0408 03:28:19.587889 139967323350912 resnet_biggan.py:262] [Generator] z0=(8, 20), z_per_block=['(8, 20)', '(8, 20)', '(8, 20)', '(8, 20)', '(8, 20)'], y_per_block=['(8, 148)', '(8, 148)', '(8, 148)', '(8, 148)', '(8, 148)']
I0408 03:28:19.637597 139967323350912 resnet_biggan.py:150] [Block] (8, 4, 4, 1536) (z=(8, 20), y=(8, 148)) -> (8, 8, 8, 1536)
I0408 03:28:19.676190 139967323350912 resnet_biggan.py:150] [Block] (8, 8, 8, 1536) (z=(8, 20), y=(8, 148)) -> (8, 16, 16, 768)
I0408 03:28:19.718855 139967323350912 resnet_biggan.py:150] [Block] (8, 16, 16, 768) (z=(8, 20), y=(8, 148)) -> (8, 32, 32, 384)
I0408 03:28:19.766800 139967323350912 resnet_biggan.py:150] [Block] (8, 32, 32, 384) (z=(8, 20), y=(8, 148)) -> (8, 64, 64, 192)
I0408 03:28:19.766987 139967323350912 resnet_biggan.py:289] [Generator] Applying non-local block to (8, 64, 64, 192)
I0408 03:28:19.851678 139967323350912 resnet_biggan.py:150] [Block] (8, 64, 64, 192) (z=(8, 20), y=(8, 148)) -> (8, 128, 128, 96)
I0408 03:28:19.851852 139967323350912 resnet_biggan.py:294] [Generator] before final processing: (8, 128, 128, 96)
I0408 03:28:19.887619 139967323350912 resnet_biggan.py:300] [Generator] after final processing: (8, 128, 128, 3)
--------------------------------------------modular_gan.py/_split_inputs_and_generate_samples,e
---------------------------------------------------modular_gan.py/create_logits,s
I0408 03:28:19.891212 139967323350912 tpu_random.py:86] Got global random offset: Tensor("strided_slice:0", shape=(), dtype=int32)
---------------------------------------------------s3gan.py/create_loss,s
W0408 03:28:19.893776 139967323350912 s3gan.py:237] Computing fake images for every sub step separately.
I0408 03:28:19.893973 139967323350912 resnet_biggan.py:236] [Generator] inputs are z=(8, 120), y=(8, 2)
I0408 03:28:19.899643 139967323350912 resnet_biggan.py:262] [Generator] z0=(8, 20), z_per_block=['(8, 20)', '(8, 20)', '(8, 20)', '(8, 20)', '(8, 20)'], y_per_block=['(8, 148)', '(8, 148)', '(8, 148)', '(8, 148)', '(8, 148)']
I0408 03:28:19.918198 139967323350912 resnet_biggan.py:150] [Block] (8, 4, 4, 1536) (z=(8, 20), y=(8, 148)) -> (8, 8, 8, 1536)
I0408 03:28:19.934829 139967323350912 resnet_biggan.py:150] [Block] (8, 8, 8, 1536) (z=(8, 20), y=(8, 148)) -> (8, 16, 16, 768)
I0408 03:28:19.951668 139967323350912 resnet_biggan.py:150] [Block] (8, 16, 16, 768) (z=(8, 20), y=(8, 148)) -> (8, 32, 32, 384)
I0408 03:28:19.968391 139967323350912 resnet_biggan.py:150] [Block] (8, 32, 32, 384) (z=(8, 20), y=(8, 148)) -> (8, 64, 64, 192)
I0408 03:28:19.968537 139967323350912 resnet_biggan.py:289] [Generator] Applying non-local block to (8, 64, 64, 192)
I0408 03:28:20.007832 139967323350912 resnet_biggan.py:150] [Block] (8, 64, 64, 192) (z=(8, 20), y=(8, 148)) -> (8, 128, 128, 96)
I0408 03:28:20.007995 139967323350912 resnet_biggan.py:294] [Generator] before final processing: (8, 128, 128, 96)
I0408 03:28:20.022210 139967323350912 resnet_biggan.py:300] [Generator] after final processing: (8, 128, 128, 3)
I0408 03:28:20.024019 139967323350912 s3gan.py:249] bs=8, rotated_bs=4, num_rot_examples=1
---------------------------------------------------s3gan.py/merge_with_rotation_data,s
---------------------------------------------------s3gan.py/merge_with_rotation_data,e
--------------------------------------------------------------------s3gan.py/discriminator_with_additonal_heads,s
I0408 03:28:20.052684 139967323350912 resnet_biggan.py:379] [Discriminator] inputs are x=(22, 128, 128, 3), y=(22, 2)
I0408 03:28:20.083976 139967323350912 resnet_biggan.py:150] [Block] (22, 128, 128, 3) (z=None, y=(22, 2)) -> (22, 64, 64, 96)
I0408 03:28:20.084140 139967323350912 resnet_biggan.py:398] [Discriminator] Applying non-local block to (22, 64, 64, 96)
I0408 03:28:20.156872 139967323350912 resnet_biggan.py:150] [Block] (22, 64, 64, 96) (z=None, y=(22, 2)) -> (22, 32, 32, 192)
I0408 03:28:20.188875 139967323350912 resnet_biggan.py:150] [Block] (22, 32, 32, 192) (z=None, y=(22, 2)) -> (22, 16, 16, 384)
I0408 03:28:20.220827 139967323350912 resnet_biggan.py:150] [Block] (22, 16, 16, 384) (z=None, y=(22, 2)) -> (22, 8, 8, 768)
I0408 03:28:20.256494 139967323350912 resnet_biggan.py:150] [Block] (22, 8, 8, 768) (z=None, y=(22, 2)) -> (22, 4, 4, 1536)
I0408 03:28:20.278565 139967323350912 resnet_biggan.py:150] [Block] (22, 4, 4, 1536) (z=None, y=(22, 2)) -> (22, 4, 4, 1536)
I0408 03:28:20.278737 139967323350912 resnet_biggan.py:403] [Discriminator] before final processing: (22, 4, 4, 1536)
I0408 03:28:20.289943 139967323350912 resnet_biggan.py:407] [Discriminator] after final processing: (22, 4, 4, 1536)
I0408 03:28:20.296652 139967323350912 resnet_biggan.py:422] [Discriminator] embedded_y for projection: (22, 1536)
I0408 03:28:20.314326 139967323350912 s3gan.py:133] [Discriminator] rotation head (22, 1536) -> Tensor("discriminator_rotation/score_classify/add:0", shape=(22, 4), dtype=float32)
I0408 03:28:20.329112 139967323350912 s3gan.py:154] [Discriminator] (22, 2) -> aux_logits=(22, 2), y_predicted=(22, 2)
---------------------------------------------------s3gan.py/get_class_embedding,s
I0408 03:28:20.335888 139967323350912 s3gan.py:175] [Discriminator] embedded_y for projection: (22, 1536)
---------------------------------------------------s3gan.py/get_class_embedding,e
---------------------------------------------------s3gan.py/discriminator_with_additonal_heads,e
---------------------------------------------------s3gan.py/create_loss,e
---------------------------------------------------modular_gan.py/create_logits,e
################################################## mode == tf.estimator.ModeKeys.EVAL  ########################
INFO:tensorflow:Done calling model_fn.
I0408 03:28:20.438644 139967323350912 estimator.py:1171] Done calling model_fn.
INFO:tensorflow:Starting evaluation at 2020-04-08T03:28:20Z
I0408 03:28:20.459557 139967323350912 evaluation.py:255] Starting evaluation at 2020-04-08T03:28:20Z
INFO:tensorflow:Graph was finalized.
I0408 03:28:20.618804 139967323350912 monitored_session.py:246] Graph was finalized.
2020-04-08 03:28:20.619667: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-04-08 03:28:20.620050: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:00:04.0 name: Tesla P4 computeCapability: 6.1
coreClock: 1.1135GHz coreCount: 20 deviceMemorySize: 7.43GiB deviceMemoryBandwidth: 178.99GiB/s
2020-04-08 03:28:20.620136: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.1
2020-04-08 03:28:20.620167: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10
2020-04-08 03:28:20.620187: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcufft.so.10
2020-04-08 03:28:20.620204: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcurand.so.10
2020-04-08 03:28:20.620222: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusolver.so.10
2020-04-08 03:28:20.620278: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusparse.so.10
2020-04-08 03:28:20.620297: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudnn.so.7
2020-04-08 03:28:20.620387: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-04-08 03:28:20.620680: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-04-08 03:28:20.620897: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1703] Adding visible gpu devices: 0
2020-04-08 03:28:20.620943: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-04-08 03:28:20.620959: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      0 
2020-04-08 03:28:20.620972: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1121] 0:   N 
2020-04-08 03:28:20.621075: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-04-08 03:28:20.621376: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-04-08 03:28:20.621617: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1247] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 6850 MB memory) -> physical GPU (device: 0, name: Tesla P4, pci bus id: 0000:00:04.0, compute capability: 6.1)
INFO:tensorflow:Restoring parameters from /tmp/absl_testing/550760/model.ckpt-393
I0408 03:28:20.622677 139967323350912 saver.py:1293] Restoring parameters from /tmp/absl_testing/550760/model.ckpt-393
INFO:tensorflow:Running local_init_op.
I0408 03:28:21.077556 139967323350912 session_manager.py:505] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
I0408 03:28:21.102549 139967323350912 session_manager.py:508] Done running local_init_op.
INFO:tensorflow:Evaluation [5/50]
I0408 03:28:36.319031 139967323350912 evaluation.py:167] Evaluation [5/50]
INFO:tensorflow:Evaluation [10/50]
I0408 03:28:45.866836 139967323350912 evaluation.py:167] Evaluation [10/50]
INFO:tensorflow:Evaluation [15/50]
I0408 03:28:55.674755 139967323350912 evaluation.py:167] Evaluation [15/50]
INFO:tensorflow:Evaluation [20/50]
I0408 03:29:03.204257 139967323350912 evaluation.py:167] Evaluation [20/50]
INFO:tensorflow:Evaluation [25/50]
I0408 03:29:13.643408 139967323350912 evaluation.py:167] Evaluation [25/50]
INFO:tensorflow:Evaluation [30/50]
I0408 03:29:22.935033 139967323350912 evaluation.py:167] Evaluation [30/50]
INFO:tensorflow:Evaluation [35/50]
I0408 03:29:32.857176 139967323350912 evaluation.py:167] Evaluation [35/50]
INFO:tensorflow:Evaluation [40/50]
I0408 03:29:41.988173 139967323350912 evaluation.py:167] Evaluation [40/50]
INFO:tensorflow:Evaluation [45/50]
I0408 03:29:51.674686 139967323350912 evaluation.py:167] Evaluation [45/50]
INFO:tensorflow:Evaluation [50/50]
I0408 03:30:03.256013 139967323350912 evaluation.py:167] Evaluation [50/50]
INFO:tensorflow:Inference Time : 102.94091s
I0408 03:30:03.400695 139967323350912 evaluation.py:273] Inference Time : 102.94091s
INFO:tensorflow:Finished evaluation at 2020-04-08-03:30:03
I0408 03:30:03.400941 139967323350912 evaluation.py:276] Finished evaluation at 2020-04-08-03:30:03
INFO:tensorflow:Saving dict for global step 393: accuracy = 0.645, global_step = 393, loss = 0.2516889
I0408 03:30:03.401185 139967323350912 estimator.py:2066] Saving dict for global step 393: accuracy = 0.645, global_step = 393, loss = 0.2516889
INFO:tensorflow:Saving 'checkpoint_path' summary for global step 393: /tmp/absl_testing/550760/model.ckpt-393
I0408 03:30:03.405261 139967323350912 estimator.py:2127] Saving 'checkpoint_path' summary for global step 393: /tmp/absl_testing/550760/model.ckpt-393
INFO:tensorflow:global_step/sec: 0.220283
I0408 03:30:15.016222 139967323350912 basic_session_run_hooks.py:702] global_step/sec: 0.220283
INFO:tensorflow:loss = 0.8045213, step = 400 (453.960 sec)
I0408 03:30:15.017252 139967323350912 basic_session_run_hooks.py:260] loss = 0.8045213, step = 400 (453.960 sec)
INFO:tensorflow:global_step/sec: 0.297929
I0408 03:35:50.666993 139967323350912 basic_session_run_hooks.py:702] global_step/sec: 0.297929
INFO:tensorflow:loss = 0.07526408, step = 500 (335.651 sec)
I0408 03:35:50.668156 139967323350912 basic_session_run_hooks.py:260] loss = 0.07526408, step = 500 (335.651 sec)
INFO:tensorflow:Calling checkpoint listeners before saving checkpoint 540...
I0408 03:38:03.681508 139967323350912 basic_session_run_hooks.py:614] Calling checkpoint listeners before saving checkpoint 540...
INFO:tensorflow:Saving checkpoints for 540 into /tmp/absl_testing/550760/model.ckpt.
I0408 03:38:03.681767 139967323350912 basic_session_run_hooks.py:618] Saving checkpoints for 540 into /tmp/absl_testing/550760/model.ckpt.
INFO:tensorflow:Calling checkpoint listeners after saving checkpoint 540...
I0408 03:38:22.589550 139967323350912 basic_session_run_hooks.py:626] Calling checkpoint listeners after saving checkpoint 540...
--------------------------------------------datasets.py/eval_input_fn,s
W0408 03:38:23.223333 139967323350912 datasets.py:170] No TPUContext, using unmodified dataset seed 547.
I0408 03:38:23.223476 139967323350912 datasets.py:348] eval_input_fn(): params={'use_tpu': False, 'train_batch_size': 8, 'batch_size': 8} seed=547
--------befor self._load_dataset------------------split = validation self._eval_split= validation
--------------------------------------------datasets.py/_load_dataset,s
!!!!!!!!!!!!!!!!!!!!!!----load_local_datasets,  _local_test_ds_dir= /content/drive/My Drive/drive/gan/test
-----------------------------------------get_local_datasets,s
-----------------------------------------get_local_datasets,e
--------------------------------------------modular_gan.py/_preprocess_fn,s
I0408 03:38:23.312343 139967323350912 api.py:587] _preprocess_fn(): images=Tensor("args_0:0", shape=(128, 128, 3), dtype=float32), labels=Tensor("args_1:0", shape=(), dtype=int32), seed=547
--------------------------------------------modular_gan.py/_preprocess_fn,e
I0408 03:38:23.352379 139967323350912 api.py:587] Passing random offset: Tensor("Cast:0", shape=(), dtype=int32) with data ({'images': <tf.Tensor 'args_1:0' shape=(128, 128, 3) dtype=float32>, 'z': <tf.Tensor 'args_3:0' shape=(120,) dtype=float32>, 'sampled_labels': <tf.Tensor 'args_2:0' shape=() dtype=int32>}, <tf.Tensor 'args_4:0' shape=() dtype=int32>).
--------------------------------------------datasets.py/eval_input_fn,e
INFO:tensorflow:Calling model_fn.
I0408 03:38:23.370396 139967323350912 estimator.py:1169] Calling model_fn.
--------------------------------------------modular_gan.py/model_fn,s
I0408 03:38:23.370586 139967323350912 modular_gan.py:568] model_fn(): features={'images': <tf.Tensor 'IteratorGetNext:1' shape=(8, 128, 128, 3) dtype=float32>, 'z': <tf.Tensor 'IteratorGetNext:3' shape=(8, 120) dtype=float32>, 'sampled_labels': <tf.Tensor 'IteratorGetNext:2' shape=(8,) dtype=int32>, '_RANDOM_OFFSET': <tf.Tensor 'IteratorGetNext:0' shape=(8,) dtype=int32>}, labels=Tensor("IteratorGetNext:4", shape=(8,), dtype=int32),mode=eval, params={'use_tpu': False, 'train_batch_size': 8, 'batch_size': 8}
#Clean old summaries from previous calls to model_fn().
# Get features and labels for each sub-step.
--------------------------------------------modular_gan.py/_split_inputs_and_generate_samples,s
I0408 03:38:23.379003 139967323350912 resnet_biggan.py:236] [Generator] inputs are z=(8, 120), y=(8, 2)
I0408 03:38:23.391393 139967323350912 resnet_biggan.py:262] [Generator] z0=(8, 20), z_per_block=['(8, 20)', '(8, 20)', '(8, 20)', '(8, 20)', '(8, 20)'], y_per_block=['(8, 148)', '(8, 148)', '(8, 148)', '(8, 148)', '(8, 148)']
I0408 03:38:23.453325 139967323350912 resnet_biggan.py:150] [Block] (8, 4, 4, 1536) (z=(8, 20), y=(8, 148)) -> (8, 8, 8, 1536)
I0408 03:38:23.497315 139967323350912 resnet_biggan.py:150] [Block] (8, 8, 8, 1536) (z=(8, 20), y=(8, 148)) -> (8, 16, 16, 768)
I0408 03:38:23.549005 139967323350912 resnet_biggan.py:150] [Block] (8, 16, 16, 768) (z=(8, 20), y=(8, 148)) -> (8, 32, 32, 384)
I0408 03:38:23.595269 139967323350912 resnet_biggan.py:150] [Block] (8, 32, 32, 384) (z=(8, 20), y=(8, 148)) -> (8, 64, 64, 192)
I0408 03:38:23.595439 139967323350912 resnet_biggan.py:289] [Generator] Applying non-local block to (8, 64, 64, 192)
I0408 03:38:23.681515 139967323350912 resnet_biggan.py:150] [Block] (8, 64, 64, 192) (z=(8, 20), y=(8, 148)) -> (8, 128, 128, 96)
I0408 03:38:23.681706 139967323350912 resnet_biggan.py:294] [Generator] before final processing: (8, 128, 128, 96)
I0408 03:38:23.718070 139967323350912 resnet_biggan.py:300] [Generator] after final processing: (8, 128, 128, 3)
--------------------------------------------modular_gan.py/_split_inputs_and_generate_samples,e
---------------------------------------------------modular_gan.py/create_logits,s
I0408 03:38:23.722052 139967323350912 tpu_random.py:86] Got global random offset: Tensor("strided_slice:0", shape=(), dtype=int32)
---------------------------------------------------s3gan.py/create_loss,s
W0408 03:38:23.725025 139967323350912 s3gan.py:237] Computing fake images for every sub step separately.
I0408 03:38:23.725284 139967323350912 resnet_biggan.py:236] [Generator] inputs are z=(8, 120), y=(8, 2)
I0408 03:38:23.731278 139967323350912 resnet_biggan.py:262] [Generator] z0=(8, 20), z_per_block=['(8, 20)', '(8, 20)', '(8, 20)', '(8, 20)', '(8, 20)'], y_per_block=['(8, 148)', '(8, 148)', '(8, 148)', '(8, 148)', '(8, 148)']
I0408 03:38:23.752016 139967323350912 resnet_biggan.py:150] [Block] (8, 4, 4, 1536) (z=(8, 20), y=(8, 148)) -> (8, 8, 8, 1536)
I0408 03:38:23.769717 139967323350912 resnet_biggan.py:150] [Block] (8, 8, 8, 1536) (z=(8, 20), y=(8, 148)) -> (8, 16, 16, 768)
I0408 03:38:23.788850 139967323350912 resnet_biggan.py:150] [Block] (8, 16, 16, 768) (z=(8, 20), y=(8, 148)) -> (8, 32, 32, 384)
I0408 03:38:23.809226 139967323350912 resnet_biggan.py:150] [Block] (8, 32, 32, 384) (z=(8, 20), y=(8, 148)) -> (8, 64, 64, 192)
I0408 03:38:23.809385 139967323350912 resnet_biggan.py:289] [Generator] Applying non-local block to (8, 64, 64, 192)
I0408 03:38:23.845691 139967323350912 resnet_biggan.py:150] [Block] (8, 64, 64, 192) (z=(8, 20), y=(8, 148)) -> (8, 128, 128, 96)
I0408 03:38:23.845943 139967323350912 resnet_biggan.py:294] [Generator] before final processing: (8, 128, 128, 96)
I0408 03:38:23.863611 139967323350912 resnet_biggan.py:300] [Generator] after final processing: (8, 128, 128, 3)
I0408 03:38:23.865596 139967323350912 s3gan.py:249] bs=8, rotated_bs=4, num_rot_examples=1
---------------------------------------------------s3gan.py/merge_with_rotation_data,s
---------------------------------------------------s3gan.py/merge_with_rotation_data,e
--------------------------------------------------------------------s3gan.py/discriminator_with_additonal_heads,s
I0408 03:38:23.893894 139967323350912 resnet_biggan.py:379] [Discriminator] inputs are x=(22, 128, 128, 3), y=(22, 2)
I0408 03:38:23.934879 139967323350912 resnet_biggan.py:150] [Block] (22, 128, 128, 3) (z=None, y=(22, 2)) -> (22, 64, 64, 96)
I0408 03:38:23.935102 139967323350912 resnet_biggan.py:398] [Discriminator] Applying non-local block to (22, 64, 64, 96)
I0408 03:38:24.022854 139967323350912 resnet_biggan.py:150] [Block] (22, 64, 64, 96) (z=None, y=(22, 2)) -> (22, 32, 32, 192)
I0408 03:38:24.056899 139967323350912 resnet_biggan.py:150] [Block] (22, 32, 32, 192) (z=None, y=(22, 2)) -> (22, 16, 16, 384)
I0408 03:38:24.091361 139967323350912 resnet_biggan.py:150] [Block] (22, 16, 16, 384) (z=None, y=(22, 2)) -> (22, 8, 8, 768)
I0408 03:38:24.126667 139967323350912 resnet_biggan.py:150] [Block] (22, 8, 8, 768) (z=None, y=(22, 2)) -> (22, 4, 4, 1536)
I0408 03:38:24.147981 139967323350912 resnet_biggan.py:150] [Block] (22, 4, 4, 1536) (z=None, y=(22, 2)) -> (22, 4, 4, 1536)
I0408 03:38:24.148170 139967323350912 resnet_biggan.py:403] [Discriminator] before final processing: (22, 4, 4, 1536)
I0408 03:38:24.159612 139967323350912 resnet_biggan.py:407] [Discriminator] after final processing: (22, 4, 4, 1536)
I0408 03:38:24.166136 139967323350912 resnet_biggan.py:422] [Discriminator] embedded_y for projection: (22, 1536)
I0408 03:38:24.181247 139967323350912 s3gan.py:133] [Discriminator] rotation head (22, 1536) -> Tensor("discriminator_rotation/score_classify/add:0", shape=(22, 4), dtype=float32)
I0408 03:38:24.195197 139967323350912 s3gan.py:154] [Discriminator] (22, 2) -> aux_logits=(22, 2), y_predicted=(22, 2)
---------------------------------------------------s3gan.py/get_class_embedding,s
I0408 03:38:24.201892 139967323350912 s3gan.py:175] [Discriminator] embedded_y for projection: (22, 1536)
---------------------------------------------------s3gan.py/get_class_embedding,e
---------------------------------------------------s3gan.py/discriminator_with_additonal_heads,e
---------------------------------------------------s3gan.py/create_loss,e
---------------------------------------------------modular_gan.py/create_logits,e
################################################## mode == tf.estimator.ModeKeys.EVAL  ########################
INFO:tensorflow:Done calling model_fn.
I0408 03:38:24.308308 139967323350912 estimator.py:1171] Done calling model_fn.
INFO:tensorflow:Starting evaluation at 2020-04-08T03:38:24Z
I0408 03:38:24.323838 139967323350912 evaluation.py:255] Starting evaluation at 2020-04-08T03:38:24Z
INFO:tensorflow:Graph was finalized.
I0408 03:38:24.481222 139967323350912 monitored_session.py:246] Graph was finalized.
2020-04-08 03:38:24.484532: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-04-08 03:38:24.484859: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:00:04.0 name: Tesla P4 computeCapability: 6.1
coreClock: 1.1135GHz coreCount: 20 deviceMemorySize: 7.43GiB deviceMemoryBandwidth: 178.99GiB/s
2020-04-08 03:38:24.484912: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.1
2020-04-08 03:38:24.484941: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10
2020-04-08 03:38:24.484964: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcufft.so.10
2020-04-08 03:38:24.484983: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcurand.so.10
2020-04-08 03:38:24.485001: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusolver.so.10
2020-04-08 03:38:24.487793: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusparse.so.10
2020-04-08 03:38:24.487842: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudnn.so.7
2020-04-08 03:38:24.487946: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-04-08 03:38:24.488289: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-04-08 03:38:24.488519: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1703] Adding visible gpu devices: 0
2020-04-08 03:38:24.488609: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-04-08 03:38:24.488624: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      0 
2020-04-08 03:38:24.488634: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1121] 0:   N 
2020-04-08 03:38:24.488759: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-04-08 03:38:24.489030: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-04-08 03:38:24.489318: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1247] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 6850 MB memory) -> physical GPU (device: 0, name: Tesla P4, pci bus id: 0000:00:04.0, compute capability: 6.1)
INFO:tensorflow:Restoring parameters from /tmp/absl_testing/550760/model.ckpt-540
I0408 03:38:24.490452 139967323350912 saver.py:1293] Restoring parameters from /tmp/absl_testing/550760/model.ckpt-540
INFO:tensorflow:Running local_init_op.
I0408 03:38:24.910084 139967323350912 session_manager.py:505] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
I0408 03:38:24.933780 139967323350912 session_manager.py:508] Done running local_init_op.
INFO:tensorflow:Evaluation [5/50]
I0408 03:38:33.003249 139967323350912 evaluation.py:167] Evaluation [5/50]
INFO:tensorflow:Evaluation [10/50]
I0408 03:38:42.227838 139967323350912 evaluation.py:167] Evaluation [10/50]
INFO:tensorflow:Evaluation [15/50]
I0408 03:38:48.925209 139967323350912 evaluation.py:167] Evaluation [15/50]
INFO:tensorflow:Evaluation [20/50]
I0408 03:38:58.060227 139967323350912 evaluation.py:167] Evaluation [20/50]
INFO:tensorflow:Evaluation [25/50]
I0408 03:39:04.670305 139967323350912 evaluation.py:167] Evaluation [25/50]
INFO:tensorflow:Evaluation [30/50]
I0408 03:39:10.795102 139967323350912 evaluation.py:167] Evaluation [30/50]
INFO:tensorflow:Evaluation [35/50]
I0408 03:39:19.105240 139967323350912 evaluation.py:167] Evaluation [35/50]
INFO:tensorflow:Evaluation [40/50]
I0408 03:39:23.215901 139967323350912 evaluation.py:167] Evaluation [40/50]
INFO:tensorflow:Evaluation [45/50]
I0408 03:39:28.313895 139967323350912 evaluation.py:167] Evaluation [45/50]
INFO:tensorflow:Evaluation [50/50]
I0408 03:39:35.791975 139967323350912 evaluation.py:167] Evaluation [50/50]
INFO:tensorflow:Inference Time : 71.65646s
I0408 03:39:35.980462 139967323350912 evaluation.py:273] Inference Time : 71.65646s
INFO:tensorflow:Finished evaluation at 2020-04-08-03:39:35
I0408 03:39:35.980674 139967323350912 evaluation.py:276] Finished evaluation at 2020-04-08-03:39:35
INFO:tensorflow:Saving dict for global step 540: accuracy = 0.605, global_step = 540, loss = 0.12934159
I0408 03:39:35.980827 139967323350912 estimator.py:2066] Saving dict for global step 540: accuracy = 0.605, global_step = 540, loss = 0.12934159
INFO:tensorflow:Saving 'checkpoint_path' summary for global step 540: /tmp/absl_testing/550760/model.ckpt-540
I0408 03:39:35.981283 139967323350912 estimator.py:2127] Saving 'checkpoint_path' summary for global step 540: /tmp/absl_testing/550760/model.ckpt-540
INFO:tensorflow:global_step/sec: 0.263314
I0408 03:42:10.441145 139967323350912 basic_session_run_hooks.py:702] global_step/sec: 0.263314
INFO:tensorflow:loss = 0.04813937, step = 600 (379.774 sec)
I0408 03:42:10.442186 139967323350912 basic_session_run_hooks.py:260] loss = 0.04813937, step = 600 (379.774 sec)
INFO:tensorflow:global_step/sec: 0.283773
I0408 03:48:02.835653 139967323350912 basic_session_run_hooks.py:702] global_step/sec: 0.283773
INFO:tensorflow:loss = 0.73220426, step = 700 (352.395 sec)
I0408 03:48:02.837314 139967323350912 basic_session_run_hooks.py:260] loss = 0.73220426, step = 700 (352.395 sec)
INFO:tensorflow:Calling checkpoint listeners before saving checkpoint 702...
I0408 03:48:06.159273 139967323350912 basic_session_run_hooks.py:614] Calling checkpoint listeners before saving checkpoint 702...
INFO:tensorflow:Saving checkpoints for 702 into /tmp/absl_testing/550760/model.ckpt.
I0408 03:48:06.159515 139967323350912 basic_session_run_hooks.py:618] Saving checkpoints for 702 into /tmp/absl_testing/550760/model.ckpt.
WARNING:tensorflow:From /usr/local/lib/python3.6/dist-packages/tensorflow/python/training/saver.py:971: remove_checkpoint (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to delete files with this prefix.
W0408 03:48:21.431600 139967323350912 deprecation.py:323] From /usr/local/lib/python3.6/dist-packages/tensorflow/python/training/saver.py:971: remove_checkpoint (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to delete files with this prefix.
INFO:tensorflow:Calling checkpoint listeners after saving checkpoint 702...
I0408 03:48:21.844719 139967323350912 basic_session_run_hooks.py:626] Calling checkpoint listeners after saving checkpoint 702...
INFO:tensorflow:Skip the current checkpoint eval due to throttle secs (600 secs).
I0408 03:48:21.845015 139967323350912 training.py:528] Skip the current checkpoint eval due to throttle secs (600 secs).
INFO:tensorflow:global_step/sec: 0.281086
I0408 03:53:58.597851 139967323350912 basic_session_run_hooks.py:702] global_step/sec: 0.281086
INFO:tensorflow:loss = 0.20367754, step = 800 (355.762 sec)
I0408 03:53:58.598985 139967323350912 basic_session_run_hooks.py:260] loss = 0.20367754, step = 800 (355.762 sec)
INFO:tensorflow:Calling checkpoint listeners before saving checkpoint 874...
I0408 03:58:08.362964 139967323350912 basic_session_run_hooks.py:614] Calling checkpoint listeners before saving checkpoint 874...
INFO:tensorflow:Saving checkpoints for 874 into /tmp/absl_testing/550760/model.ckpt.
I0408 03:58:08.363255 139967323350912 basic_session_run_hooks.py:618] Saving checkpoints for 874 into /tmp/absl_testing/550760/model.ckpt.
INFO:tensorflow:Calling checkpoint listeners after saving checkpoint 874...
I0408 03:58:25.122043 139967323350912 basic_session_run_hooks.py:626] Calling checkpoint listeners after saving checkpoint 874...
--------------------------------------------datasets.py/eval_input_fn,s
W0408 03:58:25.814896 139967323350912 datasets.py:170] No TPUContext, using unmodified dataset seed 547.
I0408 03:58:25.815141 139967323350912 datasets.py:348] eval_input_fn(): params={'use_tpu': False, 'train_batch_size': 8, 'batch_size': 8} seed=547
--------befor self._load_dataset------------------split = validation self._eval_split= validation
--------------------------------------------datasets.py/_load_dataset,s
!!!!!!!!!!!!!!!!!!!!!!----load_local_datasets,  _local_test_ds_dir= /content/drive/My Drive/drive/gan/test
-----------------------------------------get_local_datasets,s
-----------------------------------------get_local_datasets,e
--------------------------------------------modular_gan.py/_preprocess_fn,s
I0408 03:58:25.922941 139967323350912 api.py:587] _preprocess_fn(): images=Tensor("args_0:0", shape=(128, 128, 3), dtype=float32), labels=Tensor("args_1:0", shape=(), dtype=int32), seed=547
--------------------------------------------modular_gan.py/_preprocess_fn,e
I0408 03:58:25.955147 139967323350912 api.py:587] Passing random offset: Tensor("Cast:0", shape=(), dtype=int32) with data ({'images': <tf.Tensor 'args_1:0' shape=(128, 128, 3) dtype=float32>, 'z': <tf.Tensor 'args_3:0' shape=(120,) dtype=float32>, 'sampled_labels': <tf.Tensor 'args_2:0' shape=() dtype=int32>}, <tf.Tensor 'args_4:0' shape=() dtype=int32>).
--------------------------------------------datasets.py/eval_input_fn,e
INFO:tensorflow:Calling model_fn.
I0408 03:58:25.972422 139967323350912 estimator.py:1169] Calling model_fn.
--------------------------------------------modular_gan.py/model_fn,s
I0408 03:58:25.972599 139967323350912 modular_gan.py:568] model_fn(): features={'images': <tf.Tensor 'IteratorGetNext:1' shape=(8, 128, 128, 3) dtype=float32>, 'z': <tf.Tensor 'IteratorGetNext:3' shape=(8, 120) dtype=float32>, 'sampled_labels': <tf.Tensor 'IteratorGetNext:2' shape=(8,) dtype=int32>, '_RANDOM_OFFSET': <tf.Tensor 'IteratorGetNext:0' shape=(8,) dtype=int32>}, labels=Tensor("IteratorGetNext:4", shape=(8,), dtype=int32),mode=eval, params={'use_tpu': False, 'train_batch_size': 8, 'batch_size': 8}
#Clean old summaries from previous calls to model_fn().
# Get features and labels for each sub-step.
--------------------------------------------modular_gan.py/_split_inputs_and_generate_samples,s
I0408 03:58:25.980474 139967323350912 resnet_biggan.py:236] [Generator] inputs are z=(8, 120), y=(8, 2)
I0408 03:58:25.992299 139967323350912 resnet_biggan.py:262] [Generator] z0=(8, 20), z_per_block=['(8, 20)', '(8, 20)', '(8, 20)', '(8, 20)', '(8, 20)'], y_per_block=['(8, 148)', '(8, 148)', '(8, 148)', '(8, 148)', '(8, 148)']
I0408 03:58:26.051313 139967323350912 resnet_biggan.py:150] [Block] (8, 4, 4, 1536) (z=(8, 20), y=(8, 148)) -> (8, 8, 8, 1536)
I0408 03:58:26.096450 139967323350912 resnet_biggan.py:150] [Block] (8, 8, 8, 1536) (z=(8, 20), y=(8, 148)) -> (8, 16, 16, 768)
I0408 03:58:26.140248 139967323350912 resnet_biggan.py:150] [Block] (8, 16, 16, 768) (z=(8, 20), y=(8, 148)) -> (8, 32, 32, 384)
I0408 03:58:26.183219 139967323350912 resnet_biggan.py:150] [Block] (8, 32, 32, 384) (z=(8, 20), y=(8, 148)) -> (8, 64, 64, 192)
I0408 03:58:26.183377 139967323350912 resnet_biggan.py:289] [Generator] Applying non-local block to (8, 64, 64, 192)
I0408 03:58:26.268160 139967323350912 resnet_biggan.py:150] [Block] (8, 64, 64, 192) (z=(8, 20), y=(8, 148)) -> (8, 128, 128, 96)
I0408 03:58:26.268360 139967323350912 resnet_biggan.py:294] [Generator] before final processing: (8, 128, 128, 96)
I0408 03:58:26.300791 139967323350912 resnet_biggan.py:300] [Generator] after final processing: (8, 128, 128, 3)
--------------------------------------------modular_gan.py/_split_inputs_and_generate_samples,e
---------------------------------------------------modular_gan.py/create_logits,s
I0408 03:58:26.304502 139967323350912 tpu_random.py:86] Got global random offset: Tensor("strided_slice:0", shape=(), dtype=int32)
---------------------------------------------------s3gan.py/create_loss,s
W0408 03:58:26.307296 139967323350912 s3gan.py:237] Computing fake images for every sub step separately.
I0408 03:58:26.307536 139967323350912 resnet_biggan.py:236] [Generator] inputs are z=(8, 120), y=(8, 2)
I0408 03:58:26.313397 139967323350912 resnet_biggan.py:262] [Generator] z0=(8, 20), z_per_block=['(8, 20)', '(8, 20)', '(8, 20)', '(8, 20)', '(8, 20)'], y_per_block=['(8, 148)', '(8, 148)', '(8, 148)', '(8, 148)', '(8, 148)']
I0408 03:58:26.340679 139967323350912 resnet_biggan.py:150] [Block] (8, 4, 4, 1536) (z=(8, 20), y=(8, 148)) -> (8, 8, 8, 1536)
I0408 03:58:26.359823 139967323350912 resnet_biggan.py:150] [Block] (8, 8, 8, 1536) (z=(8, 20), y=(8, 148)) -> (8, 16, 16, 768)
I0408 03:58:26.379580 139967323350912 resnet_biggan.py:150] [Block] (8, 16, 16, 768) (z=(8, 20), y=(8, 148)) -> (8, 32, 32, 384)
I0408 03:58:26.404000 139967323350912 resnet_biggan.py:150] [Block] (8, 32, 32, 384) (z=(8, 20), y=(8, 148)) -> (8, 64, 64, 192)
I0408 03:58:26.404224 139967323350912 resnet_biggan.py:289] [Generator] Applying non-local block to (8, 64, 64, 192)
I0408 03:58:26.452192 139967323350912 resnet_biggan.py:150] [Block] (8, 64, 64, 192) (z=(8, 20), y=(8, 148)) -> (8, 128, 128, 96)
I0408 03:58:26.452415 139967323350912 resnet_biggan.py:294] [Generator] before final processing: (8, 128, 128, 96)
I0408 03:58:26.472312 139967323350912 resnet_biggan.py:300] [Generator] after final processing: (8, 128, 128, 3)
I0408 03:58:26.474478 139967323350912 s3gan.py:249] bs=8, rotated_bs=4, num_rot_examples=1
---------------------------------------------------s3gan.py/merge_with_rotation_data,s
---------------------------------------------------s3gan.py/merge_with_rotation_data,e
--------------------------------------------------------------------s3gan.py/discriminator_with_additonal_heads,s
I0408 03:58:26.504642 139967323350912 resnet_biggan.py:379] [Discriminator] inputs are x=(22, 128, 128, 3), y=(22, 2)
I0408 03:58:26.542341 139967323350912 resnet_biggan.py:150] [Block] (22, 128, 128, 3) (z=None, y=(22, 2)) -> (22, 64, 64, 96)
I0408 03:58:26.542510 139967323350912 resnet_biggan.py:398] [Discriminator] Applying non-local block to (22, 64, 64, 96)
I0408 03:58:26.625652 139967323350912 resnet_biggan.py:150] [Block] (22, 64, 64, 96) (z=None, y=(22, 2)) -> (22, 32, 32, 192)
I0408 03:58:26.662422 139967323350912 resnet_biggan.py:150] [Block] (22, 32, 32, 192) (z=None, y=(22, 2)) -> (22, 16, 16, 384)
I0408 03:58:26.699783 139967323350912 resnet_biggan.py:150] [Block] (22, 16, 16, 384) (z=None, y=(22, 2)) -> (22, 8, 8, 768)
I0408 03:58:26.737328 139967323350912 resnet_biggan.py:150] [Block] (22, 8, 8, 768) (z=None, y=(22, 2)) -> (22, 4, 4, 1536)
I0408 03:58:26.762792 139967323350912 resnet_biggan.py:150] [Block] (22, 4, 4, 1536) (z=None, y=(22, 2)) -> (22, 4, 4, 1536)
I0408 03:58:26.762974 139967323350912 resnet_biggan.py:403] [Discriminator] before final processing: (22, 4, 4, 1536)
I0408 03:58:26.775663 139967323350912 resnet_biggan.py:407] [Discriminator] after final processing: (22, 4, 4, 1536)
I0408 03:58:26.782663 139967323350912 resnet_biggan.py:422] [Discriminator] embedded_y for projection: (22, 1536)
I0408 03:58:26.801795 139967323350912 s3gan.py:133] [Discriminator] rotation head (22, 1536) -> Tensor("discriminator_rotation/score_classify/add:0", shape=(22, 4), dtype=float32)
I0408 03:58:26.817676 139967323350912 s3gan.py:154] [Discriminator] (22, 2) -> aux_logits=(22, 2), y_predicted=(22, 2)
---------------------------------------------------s3gan.py/get_class_embedding,s
I0408 03:58:26.825724 139967323350912 s3gan.py:175] [Discriminator] embedded_y for projection: (22, 1536)
---------------------------------------------------s3gan.py/get_class_embedding,e
---------------------------------------------------s3gan.py/discriminator_with_additonal_heads,e
---------------------------------------------------s3gan.py/create_loss,e
---------------------------------------------------modular_gan.py/create_logits,e
################################################## mode == tf.estimator.ModeKeys.EVAL  ########################
INFO:tensorflow:Done calling model_fn.
I0408 03:58:26.942643 139967323350912 estimator.py:1171] Done calling model_fn.
INFO:tensorflow:Starting evaluation at 2020-04-08T03:58:26Z
I0408 03:58:26.964649 139967323350912 evaluation.py:255] Starting evaluation at 2020-04-08T03:58:26Z
INFO:tensorflow:Graph was finalized.
I0408 03:58:27.140535 139967323350912 monitored_session.py:246] Graph was finalized.
2020-04-08 03:58:27.141315: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-04-08 03:58:27.141701: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:00:04.0 name: Tesla P4 computeCapability: 6.1
coreClock: 1.1135GHz coreCount: 20 deviceMemorySize: 7.43GiB deviceMemoryBandwidth: 178.99GiB/s
2020-04-08 03:58:27.141756: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.1
2020-04-08 03:58:27.141784: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10
2020-04-08 03:58:27.141807: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcufft.so.10
2020-04-08 03:58:27.141829: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcurand.so.10
2020-04-08 03:58:27.141848: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusolver.so.10
2020-04-08 03:58:27.141902: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusparse.so.10
2020-04-08 03:58:27.141923: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudnn.so.7
2020-04-08 03:58:27.142022: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-04-08 03:58:27.142403: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-04-08 03:58:27.142663: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1703] Adding visible gpu devices: 0
2020-04-08 03:58:27.142715: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-04-08 03:58:27.142733: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      0 
2020-04-08 03:58:27.142751: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1121] 0:   N 
2020-04-08 03:58:27.142865: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-04-08 03:58:27.143212: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-04-08 03:58:27.143500: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1247] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 6850 MB memory) -> physical GPU (device: 0, name: Tesla P4, pci bus id: 0000:00:04.0, compute capability: 6.1)
INFO:tensorflow:Restoring parameters from /tmp/absl_testing/550760/model.ckpt-874
I0408 03:58:27.144746 139967323350912 saver.py:1293] Restoring parameters from /tmp/absl_testing/550760/model.ckpt-874
INFO:tensorflow:Running local_init_op.
I0408 03:58:27.587762 139967323350912 session_manager.py:505] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
I0408 03:58:27.613309 139967323350912 session_manager.py:508] Done running local_init_op.
INFO:tensorflow:Evaluation [5/50]
I0408 03:58:35.487933 139967323350912 evaluation.py:167] Evaluation [5/50]
INFO:tensorflow:Evaluation [10/50]
I0408 03:58:43.413062 139967323350912 evaluation.py:167] Evaluation [10/50]
INFO:tensorflow:Evaluation [15/50]
I0408 03:58:49.855710 139967323350912 evaluation.py:167] Evaluation [15/50]
INFO:tensorflow:Evaluation [20/50]
I0408 03:58:56.798983 139967323350912 evaluation.py:167] Evaluation [20/50]
INFO:tensorflow:Evaluation [25/50]
I0408 03:59:01.523020 139967323350912 evaluation.py:167] Evaluation [25/50]
INFO:tensorflow:Evaluation [30/50]
I0408 03:59:05.390687 139967323350912 evaluation.py:167] Evaluation [30/50]
INFO:tensorflow:Evaluation [35/50]
I0408 03:59:11.388694 139967323350912 evaluation.py:167] Evaluation [35/50]
INFO:tensorflow:Evaluation [40/50]
I0408 03:59:16.250554 139967323350912 evaluation.py:167] Evaluation [40/50]
INFO:tensorflow:Evaluation [45/50]
I0408 03:59:21.874812 139967323350912 evaluation.py:167] Evaluation [45/50]
INFO:tensorflow:Evaluation [50/50]
I0408 03:59:27.620720 139967323350912 evaluation.py:167] Evaluation [50/50]
INFO:tensorflow:Inference Time : 61.03229s
I0408 03:59:27.997150 139967323350912 evaluation.py:273] Inference Time : 61.03229s
INFO:tensorflow:Finished evaluation at 2020-04-08-03:59:27
I0408 03:59:27.997375 139967323350912 evaluation.py:276] Finished evaluation at 2020-04-08-03:59:27
INFO:tensorflow:Saving dict for global step 874: accuracy = 0.625, global_step = 874, loss = 0.023016656
I0408 03:59:27.997534 139967323350912 estimator.py:2066] Saving dict for global step 874: accuracy = 0.625, global_step = 874, loss = 0.023016656
INFO:tensorflow:Saving 'checkpoint_path' summary for global step 874: /tmp/absl_testing/550760/model.ckpt-874
I0408 03:59:27.998986 139967323350912 estimator.py:2127] Saving 'checkpoint_path' summary for global step 874: /tmp/absl_testing/550760/model.ckpt-874
INFO:tensorflow:global_step/sec: 0.271034
I0408 04:00:07.555500 139967323350912 basic_session_run_hooks.py:702] global_step/sec: 0.271034
INFO:tensorflow:loss = 0.1829958, step = 900 (368.958 sec)
I0408 04:00:07.556595 139967323350912 basic_session_run_hooks.py:260] loss = 0.1829958, step = 900 (368.958 sec)
INFO:tensorflow:global_step/sec: 0.307584
I0408 04:05:32.669473 139967323350912 basic_session_run_hooks.py:702] global_step/sec: 0.307584
INFO:tensorflow:loss = 0.003940141, step = 1000 (325.114 sec)
I0408 04:05:32.670562 139967323350912 basic_session_run_hooks.py:260] loss = 0.003940141, step = 1000 (325.114 sec)
INFO:tensorflow:Calling checkpoint listeners before saving checkpoint 1046...
I0408 04:08:09.658510 139967323350912 basic_session_run_hooks.py:614] Calling checkpoint listeners before saving checkpoint 1046...
INFO:tensorflow:Saving checkpoints for 1046 into /tmp/absl_testing/550760/model.ckpt.
I0408 04:08:09.658789 139967323350912 basic_session_run_hooks.py:618] Saving checkpoints for 1046 into /tmp/absl_testing/550760/model.ckpt.
INFO:tensorflow:Calling checkpoint listeners after saving checkpoint 1046...
I0408 04:08:29.141804 139967323350912 basic_session_run_hooks.py:626] Calling checkpoint listeners after saving checkpoint 1046...
--------------------------------------------datasets.py/eval_input_fn,s
W0408 04:08:29.151570 139967323350912 datasets.py:170] No TPUContext, using unmodified dataset seed 547.
I0408 04:08:29.151715 139967323350912 datasets.py:348] eval_input_fn(): params={'use_tpu': False, 'train_batch_size': 8, 'batch_size': 8} seed=547
--------befor self._load_dataset------------------split = validation self._eval_split= validation
--------------------------------------------datasets.py/_load_dataset,s
!!!!!!!!!!!!!!!!!!!!!!----load_local_datasets,  _local_test_ds_dir= /content/drive/My Drive/drive/gan/test
-----------------------------------------get_local_datasets,s
-----------------------------------------get_local_datasets,e
--------------------------------------------modular_gan.py/_preprocess_fn,s
I0408 04:08:29.252408 139967323350912 api.py:587] _preprocess_fn(): images=Tensor("args_0:0", shape=(128, 128, 3), dtype=float32), labels=Tensor("args_1:0", shape=(), dtype=int32), seed=547
--------------------------------------------modular_gan.py/_preprocess_fn,e
I0408 04:08:29.285273 139967323350912 api.py:587] Passing random offset: Tensor("Cast:0", shape=(), dtype=int32) with data ({'images': <tf.Tensor 'args_1:0' shape=(128, 128, 3) dtype=float32>, 'z': <tf.Tensor 'args_3:0' shape=(120,) dtype=float32>, 'sampled_labels': <tf.Tensor 'args_2:0' shape=() dtype=int32>}, <tf.Tensor 'args_4:0' shape=() dtype=int32>).
--------------------------------------------datasets.py/eval_input_fn,e
INFO:tensorflow:Calling model_fn.
I0408 04:08:29.303296 139967323350912 estimator.py:1169] Calling model_fn.
--------------------------------------------modular_gan.py/model_fn,s
I0408 04:08:29.303474 139967323350912 modular_gan.py:568] model_fn(): features={'images': <tf.Tensor 'IteratorGetNext:1' shape=(8, 128, 128, 3) dtype=float32>, 'z': <tf.Tensor 'IteratorGetNext:3' shape=(8, 120) dtype=float32>, 'sampled_labels': <tf.Tensor 'IteratorGetNext:2' shape=(8,) dtype=int32>, '_RANDOM_OFFSET': <tf.Tensor 'IteratorGetNext:0' shape=(8,) dtype=int32>}, labels=Tensor("IteratorGetNext:4", shape=(8,), dtype=int32),mode=eval, params={'use_tpu': False, 'train_batch_size': 8, 'batch_size': 8}
#Clean old summaries from previous calls to model_fn().
# Get features and labels for each sub-step.
--------------------------------------------modular_gan.py/_split_inputs_and_generate_samples,s
I0408 04:08:29.311733 139967323350912 resnet_biggan.py:236] [Generator] inputs are z=(8, 120), y=(8, 2)
I0408 04:08:29.324442 139967323350912 resnet_biggan.py:262] [Generator] z0=(8, 20), z_per_block=['(8, 20)', '(8, 20)', '(8, 20)', '(8, 20)', '(8, 20)'], y_per_block=['(8, 148)', '(8, 148)', '(8, 148)', '(8, 148)', '(8, 148)']
I0408 04:08:29.386018 139967323350912 resnet_biggan.py:150] [Block] (8, 4, 4, 1536) (z=(8, 20), y=(8, 148)) -> (8, 8, 8, 1536)
I0408 04:08:29.426884 139967323350912 resnet_biggan.py:150] [Block] (8, 8, 8, 1536) (z=(8, 20), y=(8, 148)) -> (8, 16, 16, 768)
I0408 04:08:29.477193 139967323350912 resnet_biggan.py:150] [Block] (8, 16, 16, 768) (z=(8, 20), y=(8, 148)) -> (8, 32, 32, 384)
I0408 04:08:29.524971 139967323350912 resnet_biggan.py:150] [Block] (8, 32, 32, 384) (z=(8, 20), y=(8, 148)) -> (8, 64, 64, 192)
I0408 04:08:29.525169 139967323350912 resnet_biggan.py:289] [Generator] Applying non-local block to (8, 64, 64, 192)
I0408 04:08:29.615881 139967323350912 resnet_biggan.py:150] [Block] (8, 64, 64, 192) (z=(8, 20), y=(8, 148)) -> (8, 128, 128, 96)
I0408 04:08:29.616064 139967323350912 resnet_biggan.py:294] [Generator] before final processing: (8, 128, 128, 96)
I0408 04:08:29.656369 139967323350912 resnet_biggan.py:300] [Generator] after final processing: (8, 128, 128, 3)
--------------------------------------------modular_gan.py/_split_inputs_and_generate_samples,e
---------------------------------------------------modular_gan.py/create_logits,s
I0408 04:08:29.660431 139967323350912 tpu_random.py:86] Got global random offset: Tensor("strided_slice:0", shape=(), dtype=int32)
---------------------------------------------------s3gan.py/create_loss,s
W0408 04:08:29.663423 139967323350912 s3gan.py:237] Computing fake images for every sub step separately.
I0408 04:08:29.663662 139967323350912 resnet_biggan.py:236] [Generator] inputs are z=(8, 120), y=(8, 2)
I0408 04:08:29.669777 139967323350912 resnet_biggan.py:262] [Generator] z0=(8, 20), z_per_block=['(8, 20)', '(8, 20)', '(8, 20)', '(8, 20)', '(8, 20)'], y_per_block=['(8, 148)', '(8, 148)', '(8, 148)', '(8, 148)', '(8, 148)']
I0408 04:08:29.692480 139967323350912 resnet_biggan.py:150] [Block] (8, 4, 4, 1536) (z=(8, 20), y=(8, 148)) -> (8, 8, 8, 1536)
I0408 04:08:29.710917 139967323350912 resnet_biggan.py:150] [Block] (8, 8, 8, 1536) (z=(8, 20), y=(8, 148)) -> (8, 16, 16, 768)
I0408 04:08:29.730952 139967323350912 resnet_biggan.py:150] [Block] (8, 16, 16, 768) (z=(8, 20), y=(8, 148)) -> (8, 32, 32, 384)
I0408 04:08:29.748896 139967323350912 resnet_biggan.py:150] [Block] (8, 32, 32, 384) (z=(8, 20), y=(8, 148)) -> (8, 64, 64, 192)
I0408 04:08:29.749043 139967323350912 resnet_biggan.py:289] [Generator] Applying non-local block to (8, 64, 64, 192)
I0408 04:08:29.784984 139967323350912 resnet_biggan.py:150] [Block] (8, 64, 64, 192) (z=(8, 20), y=(8, 148)) -> (8, 128, 128, 96)
I0408 04:08:29.785164 139967323350912 resnet_biggan.py:294] [Generator] before final processing: (8, 128, 128, 96)
I0408 04:08:29.801396 139967323350912 resnet_biggan.py:300] [Generator] after final processing: (8, 128, 128, 3)
I0408 04:08:29.803317 139967323350912 s3gan.py:249] bs=8, rotated_bs=4, num_rot_examples=1
---------------------------------------------------s3gan.py/merge_with_rotation_data,s
---------------------------------------------------s3gan.py/merge_with_rotation_data,e
--------------------------------------------------------------------s3gan.py/discriminator_with_additonal_heads,s
I0408 04:08:29.833920 139967323350912 resnet_biggan.py:379] [Discriminator] inputs are x=(22, 128, 128, 3), y=(22, 2)
I0408 04:08:29.867879 139967323350912 resnet_biggan.py:150] [Block] (22, 128, 128, 3) (z=None, y=(22, 2)) -> (22, 64, 64, 96)
I0408 04:08:29.868060 139967323350912 resnet_biggan.py:398] [Discriminator] Applying non-local block to (22, 64, 64, 96)
I0408 04:08:29.945580 139967323350912 resnet_biggan.py:150] [Block] (22, 64, 64, 96) (z=None, y=(22, 2)) -> (22, 32, 32, 192)
I0408 04:08:29.982261 139967323350912 resnet_biggan.py:150] [Block] (22, 32, 32, 192) (z=None, y=(22, 2)) -> (22, 16, 16, 384)
I0408 04:08:30.017626 139967323350912 resnet_biggan.py:150] [Block] (22, 16, 16, 384) (z=None, y=(22, 2)) -> (22, 8, 8, 768)
I0408 04:08:30.052540 139967323350912 resnet_biggan.py:150] [Block] (22, 8, 8, 768) (z=None, y=(22, 2)) -> (22, 4, 4, 1536)
I0408 04:08:30.074622 139967323350912 resnet_biggan.py:150] [Block] (22, 4, 4, 1536) (z=None, y=(22, 2)) -> (22, 4, 4, 1536)
I0408 04:08:30.074790 139967323350912 resnet_biggan.py:403] [Discriminator] before final processing: (22, 4, 4, 1536)
I0408 04:08:30.086435 139967323350912 resnet_biggan.py:407] [Discriminator] after final processing: (22, 4, 4, 1536)
I0408 04:08:30.093509 139967323350912 resnet_biggan.py:422] [Discriminator] embedded_y for projection: (22, 1536)
I0408 04:08:30.107971 139967323350912 s3gan.py:133] [Discriminator] rotation head (22, 1536) -> Tensor("discriminator_rotation/score_classify/add:0", shape=(22, 4), dtype=float32)
I0408 04:08:30.122561 139967323350912 s3gan.py:154] [Discriminator] (22, 2) -> aux_logits=(22, 2), y_predicted=(22, 2)
---------------------------------------------------s3gan.py/get_class_embedding,s
I0408 04:08:30.129540 139967323350912 s3gan.py:175] [Discriminator] embedded_y for projection: (22, 1536)
---------------------------------------------------s3gan.py/get_class_embedding,e
---------------------------------------------------s3gan.py/discriminator_with_additonal_heads,e
---------------------------------------------------s3gan.py/create_loss,e
---------------------------------------------------modular_gan.py/create_logits,e
################################################## mode == tf.estimator.ModeKeys.EVAL  ########################
INFO:tensorflow:Done calling model_fn.
I0408 04:08:30.239418 139967323350912 estimator.py:1171] Done calling model_fn.
INFO:tensorflow:Starting evaluation at 2020-04-08T04:08:30Z
I0408 04:08:30.259886 139967323350912 evaluation.py:255] Starting evaluation at 2020-04-08T04:08:30Z
INFO:tensorflow:Graph was finalized.
I0408 04:08:30.413300 139967323350912 monitored_session.py:246] Graph was finalized.
2020-04-08 04:08:30.414043: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-04-08 04:08:30.414454: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:00:04.0 name: Tesla P4 computeCapability: 6.1
coreClock: 1.1135GHz coreCount: 20 deviceMemorySize: 7.43GiB deviceMemoryBandwidth: 178.99GiB/s
2020-04-08 04:08:30.414512: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.1
2020-04-08 04:08:30.414545: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10
2020-04-08 04:08:30.414570: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcufft.so.10
2020-04-08 04:08:30.414593: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcurand.so.10
2020-04-08 04:08:30.414616: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusolver.so.10
2020-04-08 04:08:30.414671: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusparse.so.10
2020-04-08 04:08:30.414693: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudnn.so.7
2020-04-08 04:08:30.414785: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-04-08 04:08:30.415136: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-04-08 04:08:30.415407: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1703] Adding visible gpu devices: 0
2020-04-08 04:08:30.415457: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-04-08 04:08:30.415489: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      0 
2020-04-08 04:08:30.415505: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1121] 0:   N 
2020-04-08 04:08:30.415632: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-04-08 04:08:30.415927: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-04-08 04:08:30.416191: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1247] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 6850 MB memory) -> physical GPU (device: 0, name: Tesla P4, pci bus id: 0000:00:04.0, compute capability: 6.1)
INFO:tensorflow:Restoring parameters from /tmp/absl_testing/550760/model.ckpt-1046
I0408 04:08:30.417232 139967323350912 saver.py:1293] Restoring parameters from /tmp/absl_testing/550760/model.ckpt-1046
INFO:tensorflow:Running local_init_op.
I0408 04:08:30.847069 139967323350912 session_manager.py:505] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
I0408 04:08:30.871244 139967323350912 session_manager.py:508] Done running local_init_op.
INFO:tensorflow:Evaluation [5/50]
I0408 04:08:39.935979 139967323350912 evaluation.py:167] Evaluation [5/50]
INFO:tensorflow:Evaluation [10/50]
I0408 04:08:48.491450 139967323350912 evaluation.py:167] Evaluation [10/50]
INFO:tensorflow:Evaluation [15/50]
I0408 04:08:56.747380 139967323350912 evaluation.py:167] Evaluation [15/50]
INFO:tensorflow:Evaluation [20/50]
I0408 04:09:02.127931 139967323350912 evaluation.py:167] Evaluation [20/50]
INFO:tensorflow:Evaluation [25/50]
I0408 04:09:05.102384 139967323350912 evaluation.py:167] Evaluation [25/50]
INFO:tensorflow:Evaluation [30/50]
I0408 04:09:09.306225 139967323350912 evaluation.py:167] Evaluation [30/50]
INFO:tensorflow:Evaluation [35/50]
I0408 04:09:15.184527 139967323350912 evaluation.py:167] Evaluation [35/50]
INFO:tensorflow:Evaluation [40/50]
I0408 04:09:19.072794 139967323350912 evaluation.py:167] Evaluation [40/50]
INFO:tensorflow:Evaluation [45/50]
I0408 04:09:23.839833 139967323350912 evaluation.py:167] Evaluation [45/50]
INFO:tensorflow:Evaluation [50/50]
I0408 04:09:29.217035 139967323350912 evaluation.py:167] Evaluation [50/50]
INFO:tensorflow:Inference Time : 59.59666s
I0408 04:09:29.856717 139967323350912 evaluation.py:273] Inference Time : 59.59666s
INFO:tensorflow:Finished evaluation at 2020-04-08-04:09:29
I0408 04:09:29.856943 139967323350912 evaluation.py:276] Finished evaluation at 2020-04-08-04:09:29
INFO:tensorflow:Saving dict for global step 1046: accuracy = 0.6225, global_step = 1046, loss = 0.030044042
I0408 04:09:29.857093 139967323350912 estimator.py:2066] Saving dict for global step 1046: accuracy = 0.6225, global_step = 1046, loss = 0.030044042
INFO:tensorflow:Saving 'checkpoint_path' summary for global step 1046: /tmp/absl_testing/550760/model.ckpt-1046
I0408 04:09:29.857558 139967323350912 estimator.py:2127] Saving 'checkpoint_path' summary for global step 1046: /tmp/absl_testing/550760/model.ckpt-1046
INFO:tensorflow:global_step/sec: 0.284171
I0408 04:11:24.570884 139967323350912 basic_session_run_hooks.py:702] global_step/sec: 0.284171
INFO:tensorflow:loss = 0.16499898, step = 1100 (351.901 sec)
I0408 04:11:24.572062 139967323350912 basic_session_run_hooks.py:260] loss = 0.16499898, step = 1100 (351.901 sec)
INFO:tensorflow:global_step/sec: 0.285827
I0408 04:17:14.433372 139967323350912 basic_session_run_hooks.py:702] global_step/sec: 0.285827
INFO:tensorflow:loss = 0.19301446, step = 1200 (349.863 sec)
I0408 04:17:14.435443 139967323350912 basic_session_run_hooks.py:260] loss = 0.19301446, step = 1200 (349.863 sec)
INFO:tensorflow:Calling checkpoint listeners before saving checkpoint 1217...
I0408 04:18:09.852782 139967323350912 basic_session_run_hooks.py:614] Calling checkpoint listeners before saving checkpoint 1217...
INFO:tensorflow:Saving checkpoints for 1217 into /tmp/absl_testing/550760/model.ckpt.
I0408 04:18:09.853106 139967323350912 basic_session_run_hooks.py:618] Saving checkpoints for 1217 into /tmp/absl_testing/550760/model.ckpt.
INFO:tensorflow:Calling checkpoint listeners after saving checkpoint 1217...
I0408 04:18:27.863980 139967323350912 basic_session_run_hooks.py:626] Calling checkpoint listeners after saving checkpoint 1217...
INFO:tensorflow:Skip the current checkpoint eval due to throttle secs (600 secs).
I0408 04:18:27.864307 139967323350912 training.py:528] Skip the current checkpoint eval due to throttle secs (600 secs).
INFO:tensorflow:global_step/sec: 0.286876
I0408 04:23:03.016057 139967323350912 basic_session_run_hooks.py:702] global_step/sec: 0.286876
INFO:tensorflow:loss = 0.040518943, step = 1300 (348.589 sec)
I0408 04:23:03.024811 139967323350912 basic_session_run_hooks.py:260] loss = 0.040518943, step = 1300 (348.589 sec)
INFO:tensorflow:Calling checkpoint listeners before saving checkpoint 1388...
I0408 04:28:11.188361 139967323350912 basic_session_run_hooks.py:614] Calling checkpoint listeners before saving checkpoint 1388...
INFO:tensorflow:Saving checkpoints for 1388 into /tmp/absl_testing/550760/model.ckpt.
I0408 04:28:11.188637 139967323350912 basic_session_run_hooks.py:618] Saving checkpoints for 1388 into /tmp/absl_testing/550760/model.ckpt.
INFO:tensorflow:Calling checkpoint listeners after saving checkpoint 1388...
I0408 04:28:26.830619 139967323350912 basic_session_run_hooks.py:626] Calling checkpoint listeners after saving checkpoint 1388...
--------------------------------------------datasets.py/eval_input_fn,s
W0408 04:28:26.838097 139967323350912 datasets.py:170] No TPUContext, using unmodified dataset seed 547.
I0408 04:28:26.838277 139967323350912 datasets.py:348] eval_input_fn(): params={'use_tpu': False, 'train_batch_size': 8, 'batch_size': 8} seed=547
--------befor self._load_dataset------------------split = validation self._eval_split= validation
--------------------------------------------datasets.py/_load_dataset,s
!!!!!!!!!!!!!!!!!!!!!!----load_local_datasets,  _local_test_ds_dir= /content/drive/My Drive/drive/gan/test
-----------------------------------------get_local_datasets,s
-----------------------------------------get_local_datasets,e
--------------------------------------------modular_gan.py/_preprocess_fn,s
I0408 04:28:26.932938 139967323350912 api.py:587] _preprocess_fn(): images=Tensor("args_0:0", shape=(128, 128, 3), dtype=float32), labels=Tensor("args_1:0", shape=(), dtype=int32), seed=547
--------------------------------------------modular_gan.py/_preprocess_fn,e
I0408 04:28:26.967336 139967323350912 api.py:587] Passing random offset: Tensor("Cast:0", shape=(), dtype=int32) with data ({'images': <tf.Tensor 'args_1:0' shape=(128, 128, 3) dtype=float32>, 'z': <tf.Tensor 'args_3:0' shape=(120,) dtype=float32>, 'sampled_labels': <tf.Tensor 'args_2:0' shape=() dtype=int32>}, <tf.Tensor 'args_4:0' shape=() dtype=int32>).
--------------------------------------------datasets.py/eval_input_fn,e
INFO:tensorflow:Calling model_fn.
I0408 04:28:26.987536 139967323350912 estimator.py:1169] Calling model_fn.
--------------------------------------------modular_gan.py/model_fn,s
I0408 04:28:26.987724 139967323350912 modular_gan.py:568] model_fn(): features={'images': <tf.Tensor 'IteratorGetNext:1' shape=(8, 128, 128, 3) dtype=float32>, 'z': <tf.Tensor 'IteratorGetNext:3' shape=(8, 120) dtype=float32>, 'sampled_labels': <tf.Tensor 'IteratorGetNext:2' shape=(8,) dtype=int32>, '_RANDOM_OFFSET': <tf.Tensor 'IteratorGetNext:0' shape=(8,) dtype=int32>}, labels=Tensor("IteratorGetNext:4", shape=(8,), dtype=int32),mode=eval, params={'use_tpu': False, 'train_batch_size': 8, 'batch_size': 8}
#Clean old summaries from previous calls to model_fn().
# Get features and labels for each sub-step.
--------------------------------------------modular_gan.py/_split_inputs_and_generate_samples,s
I0408 04:28:26.996137 139967323350912 resnet_biggan.py:236] [Generator] inputs are z=(8, 120), y=(8, 2)
I0408 04:28:27.008293 139967323350912 resnet_biggan.py:262] [Generator] z0=(8, 20), z_per_block=['(8, 20)', '(8, 20)', '(8, 20)', '(8, 20)', '(8, 20)'], y_per_block=['(8, 148)', '(8, 148)', '(8, 148)', '(8, 148)', '(8, 148)']
I0408 04:28:27.132209 139967323350912 resnet_biggan.py:150] [Block] (8, 4, 4, 1536) (z=(8, 20), y=(8, 148)) -> (8, 8, 8, 1536)
I0408 04:28:27.226161 139967323350912 resnet_biggan.py:150] [Block] (8, 8, 8, 1536) (z=(8, 20), y=(8, 148)) -> (8, 16, 16, 768)
I0408 04:28:27.271924 139967323350912 resnet_biggan.py:150] [Block] (8, 16, 16, 768) (z=(8, 20), y=(8, 148)) -> (8, 32, 32, 384)
I0408 04:28:27.315993 139967323350912 resnet_biggan.py:150] [Block] (8, 32, 32, 384) (z=(8, 20), y=(8, 148)) -> (8, 64, 64, 192)
I0408 04:28:27.316186 139967323350912 resnet_biggan.py:289] [Generator] Applying non-local block to (8, 64, 64, 192)
I0408 04:28:27.408092 139967323350912 resnet_biggan.py:150] [Block] (8, 64, 64, 192) (z=(8, 20), y=(8, 148)) -> (8, 128, 128, 96)
I0408 04:28:27.408307 139967323350912 resnet_biggan.py:294] [Generator] before final processing: (8, 128, 128, 96)
I0408 04:28:27.442295 139967323350912 resnet_biggan.py:300] [Generator] after final processing: (8, 128, 128, 3)
--------------------------------------------modular_gan.py/_split_inputs_and_generate_samples,e
---------------------------------------------------modular_gan.py/create_logits,s
I0408 04:28:27.446158 139967323350912 tpu_random.py:86] Got global random offset: Tensor("strided_slice:0", shape=(), dtype=int32)
---------------------------------------------------s3gan.py/create_loss,s
W0408 04:28:27.448887 139967323350912 s3gan.py:237] Computing fake images for every sub step separately.
I0408 04:28:27.449159 139967323350912 resnet_biggan.py:236] [Generator] inputs are z=(8, 120), y=(8, 2)
I0408 04:28:27.455106 139967323350912 resnet_biggan.py:262] [Generator] z0=(8, 20), z_per_block=['(8, 20)', '(8, 20)', '(8, 20)', '(8, 20)', '(8, 20)'], y_per_block=['(8, 148)', '(8, 148)', '(8, 148)', '(8, 148)', '(8, 148)']
I0408 04:28:27.479472 139967323350912 resnet_biggan.py:150] [Block] (8, 4, 4, 1536) (z=(8, 20), y=(8, 148)) -> (8, 8, 8, 1536)
I0408 04:28:27.503153 139967323350912 resnet_biggan.py:150] [Block] (8, 8, 8, 1536) (z=(8, 20), y=(8, 148)) -> (8, 16, 16, 768)
I0408 04:28:27.523097 139967323350912 resnet_biggan.py:150] [Block] (8, 16, 16, 768) (z=(8, 20), y=(8, 148)) -> (8, 32, 32, 384)
I0408 04:28:27.544760 139967323350912 resnet_biggan.py:150] [Block] (8, 32, 32, 384) (z=(8, 20), y=(8, 148)) -> (8, 64, 64, 192)
I0408 04:28:27.544919 139967323350912 resnet_biggan.py:289] [Generator] Applying non-local block to (8, 64, 64, 192)
I0408 04:28:27.840961 139967323350912 resnet_biggan.py:150] [Block] (8, 64, 64, 192) (z=(8, 20), y=(8, 148)) -> (8, 128, 128, 96)
I0408 04:28:27.841220 139967323350912 resnet_biggan.py:294] [Generator] before final processing: (8, 128, 128, 96)
I0408 04:28:27.857408 139967323350912 resnet_biggan.py:300] [Generator] after final processing: (8, 128, 128, 3)
I0408 04:28:27.860449 139967323350912 s3gan.py:249] bs=8, rotated_bs=4, num_rot_examples=1
---------------------------------------------------s3gan.py/merge_with_rotation_data,s
---------------------------------------------------s3gan.py/merge_with_rotation_data,e
--------------------------------------------------------------------s3gan.py/discriminator_with_additonal_heads,s
I0408 04:28:27.890647 139967323350912 resnet_biggan.py:379] [Discriminator] inputs are x=(22, 128, 128, 3), y=(22, 2)
I0408 04:28:27.928595 139967323350912 resnet_biggan.py:150] [Block] (22, 128, 128, 3) (z=None, y=(22, 2)) -> (22, 64, 64, 96)
I0408 04:28:27.928760 139967323350912 resnet_biggan.py:398] [Discriminator] Applying non-local block to (22, 64, 64, 96)
I0408 04:28:28.012818 139967323350912 resnet_biggan.py:150] [Block] (22, 64, 64, 96) (z=None, y=(22, 2)) -> (22, 32, 32, 192)
I0408 04:28:28.050391 139967323350912 resnet_biggan.py:150] [Block] (22, 32, 32, 192) (z=None, y=(22, 2)) -> (22, 16, 16, 384)
I0408 04:28:28.086402 139967323350912 resnet_biggan.py:150] [Block] (22, 16, 16, 384) (z=None, y=(22, 2)) -> (22, 8, 8, 768)
I0408 04:28:28.126875 139967323350912 resnet_biggan.py:150] [Block] (22, 8, 8, 768) (z=None, y=(22, 2)) -> (22, 4, 4, 1536)
I0408 04:28:28.151228 139967323350912 resnet_biggan.py:150] [Block] (22, 4, 4, 1536) (z=None, y=(22, 2)) -> (22, 4, 4, 1536)
I0408 04:28:28.151401 139967323350912 resnet_biggan.py:403] [Discriminator] before final processing: (22, 4, 4, 1536)
I0408 04:28:28.163484 139967323350912 resnet_biggan.py:407] [Discriminator] after final processing: (22, 4, 4, 1536)
I0408 04:28:28.170540 139967323350912 resnet_biggan.py:422] [Discriminator] embedded_y for projection: (22, 1536)
I0408 04:28:28.184848 139967323350912 s3gan.py:133] [Discriminator] rotation head (22, 1536) -> Tensor("discriminator_rotation/score_classify/add:0", shape=(22, 4), dtype=float32)
I0408 04:28:28.199947 139967323350912 s3gan.py:154] [Discriminator] (22, 2) -> aux_logits=(22, 2), y_predicted=(22, 2)
---------------------------------------------------s3gan.py/get_class_embedding,s
I0408 04:28:28.206728 139967323350912 s3gan.py:175] [Discriminator] embedded_y for projection: (22, 1536)
---------------------------------------------------s3gan.py/get_class_embedding,e
---------------------------------------------------s3gan.py/discriminator_with_additonal_heads,e
---------------------------------------------------s3gan.py/create_loss,e
---------------------------------------------------modular_gan.py/create_logits,e
################################################## mode == tf.estimator.ModeKeys.EVAL  ########################
INFO:tensorflow:Done calling model_fn.
I0408 04:28:28.311881 139967323350912 estimator.py:1171] Done calling model_fn.
INFO:tensorflow:Starting evaluation at 2020-04-08T04:28:28Z
I0408 04:28:28.330801 139967323350912 evaluation.py:255] Starting evaluation at 2020-04-08T04:28:28Z
INFO:tensorflow:Graph was finalized.
I0408 04:28:28.505189 139967323350912 monitored_session.py:246] Graph was finalized.
2020-04-08 04:28:28.505994: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-04-08 04:28:28.506368: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:00:04.0 name: Tesla P4 computeCapability: 6.1
coreClock: 1.1135GHz coreCount: 20 deviceMemorySize: 7.43GiB deviceMemoryBandwidth: 178.99GiB/s
2020-04-08 04:28:28.506443: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.1
2020-04-08 04:28:28.506472: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10
2020-04-08 04:28:28.506495: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcufft.so.10
2020-04-08 04:28:28.506517: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcurand.so.10
2020-04-08 04:28:28.506535: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusolver.so.10
2020-04-08 04:28:28.506592: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusparse.so.10
2020-04-08 04:28:28.506611: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudnn.so.7
2020-04-08 04:28:28.506712: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-04-08 04:28:28.507099: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-04-08 04:28:28.507387: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1703] Adding visible gpu devices: 0
2020-04-08 04:28:28.507476: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-04-08 04:28:28.507495: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      0 
2020-04-08 04:28:28.507513: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1121] 0:   N 
2020-04-08 04:28:28.507630: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-04-08 04:28:28.507953: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-04-08 04:28:28.508269: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1247] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 6850 MB memory) -> physical GPU (device: 0, name: Tesla P4, pci bus id: 0000:00:04.0, compute capability: 6.1)
INFO:tensorflow:Restoring parameters from /tmp/absl_testing/550760/model.ckpt-1388
I0408 04:28:28.509565 139967323350912 saver.py:1293] Restoring parameters from /tmp/absl_testing/550760/model.ckpt-1388
INFO:tensorflow:Running local_init_op.
I0408 04:28:28.957093 139967323350912 session_manager.py:505] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
I0408 04:28:28.982340 139967323350912 session_manager.py:508] Done running local_init_op.
INFO:tensorflow:Evaluation [5/50]
I0408 04:28:36.050497 139967323350912 evaluation.py:167] Evaluation [5/50]
INFO:tensorflow:Evaluation [10/50]
I0408 04:28:40.670444 139967323350912 evaluation.py:167] Evaluation [10/50]
INFO:tensorflow:Evaluation [15/50]
I0408 04:28:42.948705 139967323350912 evaluation.py:167] Evaluation [15/50]
INFO:tensorflow:Evaluation [20/50]
I0408 04:28:46.201953 139967323350912 evaluation.py:167] Evaluation [20/50]
INFO:tensorflow:Evaluation [25/50]
I0408 04:28:48.578243 139967323350912 evaluation.py:167] Evaluation [25/50]
INFO:tensorflow:Evaluation [30/50]
I0408 04:28:53.654109 139967323350912 evaluation.py:167] Evaluation [30/50]
INFO:tensorflow:Evaluation [35/50]
I0408 04:28:57.498975 139967323350912 evaluation.py:167] Evaluation [35/50]
INFO:tensorflow:Evaluation [40/50]
I0408 04:29:00.063648 139967323350912 evaluation.py:167] Evaluation [40/50]
INFO:tensorflow:Evaluation [45/50]
I0408 04:29:04.752734 139967323350912 evaluation.py:167] Evaluation [45/50]
INFO:tensorflow:Evaluation [50/50]
I0408 04:29:06.843755 139967323350912 evaluation.py:167] Evaluation [50/50]
INFO:tensorflow:Inference Time : 38.84174s
I0408 04:29:07.172706 139967323350912 evaluation.py:273] Inference Time : 38.84174s
INFO:tensorflow:Finished evaluation at 2020-04-08-04:29:07
I0408 04:29:07.172908 139967323350912 evaluation.py:276] Finished evaluation at 2020-04-08-04:29:07
INFO:tensorflow:Saving dict for global step 1388: accuracy = 0.6325, global_step = 1388, loss = 0.031692795
I0408 04:29:07.173049 139967323350912 estimator.py:2066] Saving dict for global step 1388: accuracy = 0.6325, global_step = 1388, loss = 0.031692795
INFO:tensorflow:Saving 'checkpoint_path' summary for global step 1388: /tmp/absl_testing/550760/model.ckpt-1388
I0408 04:29:07.174471 139967323350912 estimator.py:2127] Saving 'checkpoint_path' summary for global step 1388: /tmp/absl_testing/550760/model.ckpt-1388
INFO:tensorflow:global_step/sec: 0.26094
I0408 04:29:26.245800 139967323350912 basic_session_run_hooks.py:702] global_step/sec: 0.26094
INFO:tensorflow:loss = 0.0027569814, step = 1400 (383.222 sec)
I0408 04:29:26.246850 139967323350912 basic_session_run_hooks.py:260] loss = 0.0027569814, step = 1400 (383.222 sec)
INFO:tensorflow:global_step/sec: 0.309076
I0408 04:34:49.790729 139967323350912 basic_session_run_hooks.py:702] global_step/sec: 0.309076
INFO:tensorflow:loss = 0.05097521, step = 1500 (323.545 sec)
I0408 04:34:49.791890 139967323350912 basic_session_run_hooks.py:260] loss = 0.05097521, step = 1500 (323.545 sec)
INFO:tensorflow:Calling checkpoint listeners before saving checkpoint 1561...
I0408 04:38:14.108852 139967323350912 basic_session_run_hooks.py:614] Calling checkpoint listeners before saving checkpoint 1561...
INFO:tensorflow:Saving checkpoints for 1561 into /tmp/absl_testing/550760/model.ckpt.
I0408 04:38:14.109183 139967323350912 basic_session_run_hooks.py:618] Saving checkpoints for 1561 into /tmp/absl_testing/550760/model.ckpt.
INFO:tensorflow:Calling checkpoint listeners after saving checkpoint 1561...
I0408 04:38:30.344786 139967323350912 basic_session_run_hooks.py:626] Calling checkpoint listeners after saving checkpoint 1561...
--------------------------------------------datasets.py/eval_input_fn,s
W0408 04:38:34.004251 139967323350912 datasets.py:170] No TPUContext, using unmodified dataset seed 547.
I0408 04:38:34.004404 139967323350912 datasets.py:348] eval_input_fn(): params={'use_tpu': False, 'train_batch_size': 8, 'batch_size': 8} seed=547
--------befor self._load_dataset------------------split = validation self._eval_split= validation
--------------------------------------------datasets.py/_load_dataset,s
!!!!!!!!!!!!!!!!!!!!!!----load_local_datasets,  _local_test_ds_dir= /content/drive/My Drive/drive/gan/test
-----------------------------------------get_local_datasets,s
-----------------------------------------get_local_datasets,e
--------------------------------------------modular_gan.py/_preprocess_fn,s
I0408 04:38:34.113985 139967323350912 api.py:587] _preprocess_fn(): images=Tensor("args_0:0", shape=(128, 128, 3), dtype=float32), labels=Tensor("args_1:0", shape=(), dtype=int32), seed=547
--------------------------------------------modular_gan.py/_preprocess_fn,e
I0408 04:38:34.151650 139967323350912 api.py:587] Passing random offset: Tensor("Cast:0", shape=(), dtype=int32) with data ({'images': <tf.Tensor 'args_1:0' shape=(128, 128, 3) dtype=float32>, 'z': <tf.Tensor 'args_3:0' shape=(120,) dtype=float32>, 'sampled_labels': <tf.Tensor 'args_2:0' shape=() dtype=int32>}, <tf.Tensor 'args_4:0' shape=() dtype=int32>).
--------------------------------------------datasets.py/eval_input_fn,e
INFO:tensorflow:Calling model_fn.
I0408 04:38:34.172986 139967323350912 estimator.py:1169] Calling model_fn.
--------------------------------------------modular_gan.py/model_fn,s
I0408 04:38:34.173176 139967323350912 modular_gan.py:568] model_fn(): features={'images': <tf.Tensor 'IteratorGetNext:1' shape=(8, 128, 128, 3) dtype=float32>, 'z': <tf.Tensor 'IteratorGetNext:3' shape=(8, 120) dtype=float32>, 'sampled_labels': <tf.Tensor 'IteratorGetNext:2' shape=(8,) dtype=int32>, '_RANDOM_OFFSET': <tf.Tensor 'IteratorGetNext:0' shape=(8,) dtype=int32>}, labels=Tensor("IteratorGetNext:4", shape=(8,), dtype=int32),mode=eval, params={'use_tpu': False, 'train_batch_size': 8, 'batch_size': 8}
#Clean old summaries from previous calls to model_fn().
# Get features and labels for each sub-step.
--------------------------------------------modular_gan.py/_split_inputs_and_generate_samples,s
I0408 04:38:34.181063 139967323350912 resnet_biggan.py:236] [Generator] inputs are z=(8, 120), y=(8, 2)
I0408 04:38:34.192085 139967323350912 resnet_biggan.py:262] [Generator] z0=(8, 20), z_per_block=['(8, 20)', '(8, 20)', '(8, 20)', '(8, 20)', '(8, 20)'], y_per_block=['(8, 148)', '(8, 148)', '(8, 148)', '(8, 148)', '(8, 148)']
I0408 04:38:34.240750 139967323350912 resnet_biggan.py:150] [Block] (8, 4, 4, 1536) (z=(8, 20), y=(8, 148)) -> (8, 8, 8, 1536)
I0408 04:38:34.280617 139967323350912 resnet_biggan.py:150] [Block] (8, 8, 8, 1536) (z=(8, 20), y=(8, 148)) -> (8, 16, 16, 768)
I0408 04:38:34.318374 139967323350912 resnet_biggan.py:150] [Block] (8, 16, 16, 768) (z=(8, 20), y=(8, 148)) -> (8, 32, 32, 384)
I0408 04:38:34.356031 139967323350912 resnet_biggan.py:150] [Block] (8, 32, 32, 384) (z=(8, 20), y=(8, 148)) -> (8, 64, 64, 192)
I0408 04:38:34.356191 139967323350912 resnet_biggan.py:289] [Generator] Applying non-local block to (8, 64, 64, 192)
I0408 04:38:34.432920 139967323350912 resnet_biggan.py:150] [Block] (8, 64, 64, 192) (z=(8, 20), y=(8, 148)) -> (8, 128, 128, 96)
I0408 04:38:34.433083 139967323350912 resnet_biggan.py:294] [Generator] before final processing: (8, 128, 128, 96)
I0408 04:38:34.463677 139967323350912 resnet_biggan.py:300] [Generator] after final processing: (8, 128, 128, 3)
--------------------------------------------modular_gan.py/_split_inputs_and_generate_samples,e
---------------------------------------------------modular_gan.py/create_logits,s
I0408 04:38:34.467092 139967323350912 tpu_random.py:86] Got global random offset: Tensor("strided_slice:0", shape=(), dtype=int32)
---------------------------------------------------s3gan.py/create_loss,s
W0408 04:38:34.469615 139967323350912 s3gan.py:237] Computing fake images for every sub step separately.
I0408 04:38:34.469810 139967323350912 resnet_biggan.py:236] [Generator] inputs are z=(8, 120), y=(8, 2)
I0408 04:38:34.475202 139967323350912 resnet_biggan.py:262] [Generator] z0=(8, 20), z_per_block=['(8, 20)', '(8, 20)', '(8, 20)', '(8, 20)', '(8, 20)'], y_per_block=['(8, 148)', '(8, 148)', '(8, 148)', '(8, 148)', '(8, 148)']
I0408 04:38:34.498649 139967323350912 resnet_biggan.py:150] [Block] (8, 4, 4, 1536) (z=(8, 20), y=(8, 148)) -> (8, 8, 8, 1536)
I0408 04:38:34.514363 139967323350912 resnet_biggan.py:150] [Block] (8, 8, 8, 1536) (z=(8, 20), y=(8, 148)) -> (8, 16, 16, 768)
I0408 04:38:34.530296 139967323350912 resnet_biggan.py:150] [Block] (8, 16, 16, 768) (z=(8, 20), y=(8, 148)) -> (8, 32, 32, 384)
I0408 04:38:34.545822 139967323350912 resnet_biggan.py:150] [Block] (8, 32, 32, 384) (z=(8, 20), y=(8, 148)) -> (8, 64, 64, 192)
I0408 04:38:34.545970 139967323350912 resnet_biggan.py:289] [Generator] Applying non-local block to (8, 64, 64, 192)
I0408 04:38:34.581380 139967323350912 resnet_biggan.py:150] [Block] (8, 64, 64, 192) (z=(8, 20), y=(8, 148)) -> (8, 128, 128, 96)
I0408 04:38:34.581539 139967323350912 resnet_biggan.py:294] [Generator] before final processing: (8, 128, 128, 96)
I0408 04:38:34.595248 139967323350912 resnet_biggan.py:300] [Generator] after final processing: (8, 128, 128, 3)
I0408 04:38:34.596904 139967323350912 s3gan.py:249] bs=8, rotated_bs=4, num_rot_examples=1
---------------------------------------------------s3gan.py/merge_with_rotation_data,s
---------------------------------------------------s3gan.py/merge_with_rotation_data,e
--------------------------------------------------------------------s3gan.py/discriminator_with_additonal_heads,s
I0408 04:38:34.624358 139967323350912 resnet_biggan.py:379] [Discriminator] inputs are x=(22, 128, 128, 3), y=(22, 2)
I0408 04:38:34.660205 139967323350912 resnet_biggan.py:150] [Block] (22, 128, 128, 3) (z=None, y=(22, 2)) -> (22, 64, 64, 96)
I0408 04:38:34.660353 139967323350912 resnet_biggan.py:398] [Discriminator] Applying non-local block to (22, 64, 64, 96)
I0408 04:38:34.735670 139967323350912 resnet_biggan.py:150] [Block] (22, 64, 64, 96) (z=None, y=(22, 2)) -> (22, 32, 32, 192)
I0408 04:38:34.771301 139967323350912 resnet_biggan.py:150] [Block] (22, 32, 32, 192) (z=None, y=(22, 2)) -> (22, 16, 16, 384)
I0408 04:38:34.809317 139967323350912 resnet_biggan.py:150] [Block] (22, 16, 16, 384) (z=None, y=(22, 2)) -> (22, 8, 8, 768)
I0408 04:38:34.849584 139967323350912 resnet_biggan.py:150] [Block] (22, 8, 8, 768) (z=None, y=(22, 2)) -> (22, 4, 4, 1536)
I0408 04:38:34.874456 139967323350912 resnet_biggan.py:150] [Block] (22, 4, 4, 1536) (z=None, y=(22, 2)) -> (22, 4, 4, 1536)
I0408 04:38:34.874629 139967323350912 resnet_biggan.py:403] [Discriminator] before final processing: (22, 4, 4, 1536)
I0408 04:38:34.886390 139967323350912 resnet_biggan.py:407] [Discriminator] after final processing: (22, 4, 4, 1536)
I0408 04:38:34.892720 139967323350912 resnet_biggan.py:422] [Discriminator] embedded_y for projection: (22, 1536)
I0408 04:38:34.905802 139967323350912 s3gan.py:133] [Discriminator] rotation head (22, 1536) -> Tensor("discriminator_rotation/score_classify/add:0", shape=(22, 4), dtype=float32)
I0408 04:38:34.920936 139967323350912 s3gan.py:154] [Discriminator] (22, 2) -> aux_logits=(22, 2), y_predicted=(22, 2)
---------------------------------------------------s3gan.py/get_class_embedding,s
I0408 04:38:34.928356 139967323350912 s3gan.py:175] [Discriminator] embedded_y for projection: (22, 1536)
---------------------------------------------------s3gan.py/get_class_embedding,e
---------------------------------------------------s3gan.py/discriminator_with_additonal_heads,e
---------------------------------------------------s3gan.py/create_loss,e
---------------------------------------------------modular_gan.py/create_logits,e
################################################## mode == tf.estimator.ModeKeys.EVAL  ########################
INFO:tensorflow:Done calling model_fn.
I0408 04:38:35.038910 139967323350912 estimator.py:1171] Done calling model_fn.
INFO:tensorflow:Starting evaluation at 2020-04-08T04:38:35Z
I0408 04:38:35.057233 139967323350912 evaluation.py:255] Starting evaluation at 2020-04-08T04:38:35Z
INFO:tensorflow:Graph was finalized.
I0408 04:38:35.217613 139967323350912 monitored_session.py:246] Graph was finalized.
2020-04-08 04:38:35.218209: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-04-08 04:38:35.218490: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:00:04.0 name: Tesla P4 computeCapability: 6.1
coreClock: 1.1135GHz coreCount: 20 deviceMemorySize: 7.43GiB deviceMemoryBandwidth: 178.99GiB/s
2020-04-08 04:38:35.218538: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.1
2020-04-08 04:38:35.218561: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10
2020-04-08 04:38:35.218578: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcufft.so.10
2020-04-08 04:38:35.218593: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcurand.so.10
2020-04-08 04:38:35.218607: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusolver.so.10
2020-04-08 04:38:35.218653: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusparse.so.10
2020-04-08 04:38:35.218669: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudnn.so.7
2020-04-08 04:38:35.218743: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-04-08 04:38:35.219015: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-04-08 04:38:35.219280: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1703] Adding visible gpu devices: 0
2020-04-08 04:38:35.219327: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-04-08 04:38:35.219345: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      0 
2020-04-08 04:38:35.219354: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1121] 0:   N 
2020-04-08 04:38:35.219453: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-04-08 04:38:35.219746: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-04-08 04:38:35.219989: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1247] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 6850 MB memory) -> physical GPU (device: 0, name: Tesla P4, pci bus id: 0000:00:04.0, compute capability: 6.1)
INFO:tensorflow:Restoring parameters from /tmp/absl_testing/550760/model.ckpt-1561
I0408 04:38:35.220914 139967323350912 saver.py:1293] Restoring parameters from /tmp/absl_testing/550760/model.ckpt-1561
INFO:tensorflow:Running local_init_op.
I0408 04:38:35.625821 139967323350912 session_manager.py:505] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
I0408 04:38:35.647797 139967323350912 session_manager.py:508] Done running local_init_op.
INFO:tensorflow:Evaluation [5/50]
I0408 04:38:40.961840 139967323350912 evaluation.py:167] Evaluation [5/50]
INFO:tensorflow:Evaluation [10/50]
I0408 04:38:44.216068 139967323350912 evaluation.py:167] Evaluation [10/50]
INFO:tensorflow:Evaluation [15/50]
I0408 04:38:47.756246 139967323350912 evaluation.py:167] Evaluation [15/50]
INFO:tensorflow:Evaluation [20/50]
I0408 04:38:50.037899 139967323350912 evaluation.py:167] Evaluation [20/50]
INFO:tensorflow:Evaluation [25/50]
I0408 04:38:51.934780 139967323350912 evaluation.py:167] Evaluation [25/50]
INFO:tensorflow:Evaluation [30/50]
I0408 04:38:55.160181 139967323350912 evaluation.py:167] Evaluation [30/50]
INFO:tensorflow:Evaluation [35/50]
I0408 04:38:57.852080 139967323350912 evaluation.py:167] Evaluation [35/50]
INFO:tensorflow:Evaluation [40/50]
I0408 04:39:01.924293 139967323350912 evaluation.py:167] Evaluation [40/50]
INFO:tensorflow:Evaluation [45/50]
I0408 04:39:05.385017 139967323350912 evaluation.py:167] Evaluation [45/50]
INFO:tensorflow:Evaluation [50/50]
I0408 04:39:07.800637 139967323350912 evaluation.py:167] Evaluation [50/50]
INFO:tensorflow:Inference Time : 33.10268s
I0408 04:39:08.160095 139967323350912 evaluation.py:273] Inference Time : 33.10268s
INFO:tensorflow:Finished evaluation at 2020-04-08-04:39:08
I0408 04:39:08.160330 139967323350912 evaluation.py:276] Finished evaluation at 2020-04-08-04:39:08
INFO:tensorflow:Saving dict for global step 1561: accuracy = 0.61, global_step = 1561, loss = 0.031426944
I0408 04:39:08.160472 139967323350912 estimator.py:2066] Saving dict for global step 1561: accuracy = 0.61, global_step = 1561, loss = 0.031426944
INFO:tensorflow:Saving 'checkpoint_path' summary for global step 1561: /tmp/absl_testing/550760/model.ckpt-1561
I0408 04:39:08.160851 139967323350912 estimator.py:2127] Saving 'checkpoint_path' summary for global step 1561: /tmp/absl_testing/550760/model.ckpt-1561
INFO:tensorflow:global_step/sec: 0.283248
I0408 04:40:42.838438 139967323350912 basic_session_run_hooks.py:702] global_step/sec: 0.283248
INFO:tensorflow:loss = 0.036902823, step = 1600 (353.048 sec)
I0408 04:40:42.839550 139967323350912 basic_session_run_hooks.py:260] loss = 0.036902823, step = 1600 (353.048 sec)
INFO:tensorflow:global_step/sec: 0.506226
I0408 04:44:00.378882 139967323350912 basic_session_run_hooks.py:702] global_step/sec: 0.506226
INFO:tensorflow:loss = 0.47849792, step = 1700 (197.540 sec)
I0408 04:44:00.379869 139967323350912 basic_session_run_hooks.py:260] loss = 0.47849792, step = 1700 (197.540 sec)
INFO:tensorflow:global_step/sec: 0.682729
I0408 04:46:26.849820 139967323350912 basic_session_run_hooks.py:702] global_step/sec: 0.682729
INFO:tensorflow:loss = 0.28890076, step = 1800 (146.471 sec)
I0408 04:46:26.850924 139967323350912 basic_session_run_hooks.py:260] loss = 0.28890076, step = 1800 (146.471 sec)
INFO:tensorflow:Calling checkpoint listeners before saving checkpoint 1875...
I0408 04:48:15.346636 139967323350912 basic_session_run_hooks.py:614] Calling checkpoint listeners before saving checkpoint 1875...
INFO:tensorflow:Saving checkpoints for 1875 into /tmp/absl_testing/550760/model.ckpt.
I0408 04:48:15.346890 139967323350912 basic_session_run_hooks.py:618] Saving checkpoints for 1875 into /tmp/absl_testing/550760/model.ckpt.
INFO:tensorflow:Calling checkpoint listeners after saving checkpoint 1875...
I0408 04:48:30.800882 139967323350912 basic_session_run_hooks.py:626] Calling checkpoint listeners after saving checkpoint 1875...
--------------------------------------------datasets.py/eval_input_fn,s
W0408 04:48:30.808221 139967323350912 datasets.py:170] No TPUContext, using unmodified dataset seed 547.
I0408 04:48:30.808375 139967323350912 datasets.py:348] eval_input_fn(): params={'use_tpu': False, 'train_batch_size': 8, 'batch_size': 8} seed=547
--------befor self._load_dataset------------------split = validation self._eval_split= validation
--------------------------------------------datasets.py/_load_dataset,s
!!!!!!!!!!!!!!!!!!!!!!----load_local_datasets,  _local_test_ds_dir= /content/drive/My Drive/drive/gan/test
-----------------------------------------get_local_datasets,s
-----------------------------------------get_local_datasets,e
--------------------------------------------modular_gan.py/_preprocess_fn,s
I0408 04:48:30.894384 139967323350912 api.py:587] _preprocess_fn(): images=Tensor("args_0:0", shape=(128, 128, 3), dtype=float32), labels=Tensor("args_1:0", shape=(), dtype=int32), seed=547
--------------------------------------------modular_gan.py/_preprocess_fn,e
I0408 04:48:30.928139 139967323350912 api.py:587] Passing random offset: Tensor("Cast:0", shape=(), dtype=int32) with data ({'images': <tf.Tensor 'args_1:0' shape=(128, 128, 3) dtype=float32>, 'z': <tf.Tensor 'args_3:0' shape=(120,) dtype=float32>, 'sampled_labels': <tf.Tensor 'args_2:0' shape=() dtype=int32>}, <tf.Tensor 'args_4:0' shape=() dtype=int32>).
--------------------------------------------datasets.py/eval_input_fn,e
INFO:tensorflow:Calling model_fn.
I0408 04:48:30.945823 139967323350912 estimator.py:1169] Calling model_fn.
--------------------------------------------modular_gan.py/model_fn,s
I0408 04:48:30.945995 139967323350912 modular_gan.py:568] model_fn(): features={'images': <tf.Tensor 'IteratorGetNext:1' shape=(8, 128, 128, 3) dtype=float32>, 'z': <tf.Tensor 'IteratorGetNext:3' shape=(8, 120) dtype=float32>, 'sampled_labels': <tf.Tensor 'IteratorGetNext:2' shape=(8,) dtype=int32>, '_RANDOM_OFFSET': <tf.Tensor 'IteratorGetNext:0' shape=(8,) dtype=int32>}, labels=Tensor("IteratorGetNext:4", shape=(8,), dtype=int32),mode=eval, params={'use_tpu': False, 'train_batch_size': 8, 'batch_size': 8}
#Clean old summaries from previous calls to model_fn().
# Get features and labels for each sub-step.
--------------------------------------------modular_gan.py/_split_inputs_and_generate_samples,s
I0408 04:48:30.953464 139967323350912 resnet_biggan.py:236] [Generator] inputs are z=(8, 120), y=(8, 2)
I0408 04:48:30.964604 139967323350912 resnet_biggan.py:262] [Generator] z0=(8, 20), z_per_block=['(8, 20)', '(8, 20)', '(8, 20)', '(8, 20)', '(8, 20)'], y_per_block=['(8, 148)', '(8, 148)', '(8, 148)', '(8, 148)', '(8, 148)']
I0408 04:48:31.017754 139967323350912 resnet_biggan.py:150] [Block] (8, 4, 4, 1536) (z=(8, 20), y=(8, 148)) -> (8, 8, 8, 1536)
I0408 04:48:31.098314 139967323350912 resnet_biggan.py:150] [Block] (8, 8, 8, 1536) (z=(8, 20), y=(8, 148)) -> (8, 16, 16, 768)
I0408 04:48:31.194534 139967323350912 resnet_biggan.py:150] [Block] (8, 16, 16, 768) (z=(8, 20), y=(8, 148)) -> (8, 32, 32, 384)
I0408 04:48:31.237716 139967323350912 resnet_biggan.py:150] [Block] (8, 32, 32, 384) (z=(8, 20), y=(8, 148)) -> (8, 64, 64, 192)
I0408 04:48:31.237913 139967323350912 resnet_biggan.py:289] [Generator] Applying non-local block to (8, 64, 64, 192)
I0408 04:48:31.324890 139967323350912 resnet_biggan.py:150] [Block] (8, 64, 64, 192) (z=(8, 20), y=(8, 148)) -> (8, 128, 128, 96)
I0408 04:48:31.325098 139967323350912 resnet_biggan.py:294] [Generator] before final processing: (8, 128, 128, 96)
I0408 04:48:31.359277 139967323350912 resnet_biggan.py:300] [Generator] after final processing: (8, 128, 128, 3)
--------------------------------------------modular_gan.py/_split_inputs_and_generate_samples,e
---------------------------------------------------modular_gan.py/create_logits,s
I0408 04:48:31.363021 139967323350912 tpu_random.py:86] Got global random offset: Tensor("strided_slice:0", shape=(), dtype=int32)
---------------------------------------------------s3gan.py/create_loss,s
W0408 04:48:31.365782 139967323350912 s3gan.py:237] Computing fake images for every sub step separately.
I0408 04:48:31.366003 139967323350912 resnet_biggan.py:236] [Generator] inputs are z=(8, 120), y=(8, 2)
I0408 04:48:31.371848 139967323350912 resnet_biggan.py:262] [Generator] z0=(8, 20), z_per_block=['(8, 20)', '(8, 20)', '(8, 20)', '(8, 20)', '(8, 20)'], y_per_block=['(8, 148)', '(8, 148)', '(8, 148)', '(8, 148)', '(8, 148)']
I0408 04:48:31.392197 139967323350912 resnet_biggan.py:150] [Block] (8, 4, 4, 1536) (z=(8, 20), y=(8, 148)) -> (8, 8, 8, 1536)
I0408 04:48:31.409841 139967323350912 resnet_biggan.py:150] [Block] (8, 8, 8, 1536) (z=(8, 20), y=(8, 148)) -> (8, 16, 16, 768)
I0408 04:48:31.429324 139967323350912 resnet_biggan.py:150] [Block] (8, 16, 16, 768) (z=(8, 20), y=(8, 148)) -> (8, 32, 32, 384)
I0408 04:48:31.448530 139967323350912 resnet_biggan.py:150] [Block] (8, 32, 32, 384) (z=(8, 20), y=(8, 148)) -> (8, 64, 64, 192)
I0408 04:48:31.448680 139967323350912 resnet_biggan.py:289] [Generator] Applying non-local block to (8, 64, 64, 192)
I0408 04:48:31.484562 139967323350912 resnet_biggan.py:150] [Block] (8, 64, 64, 192) (z=(8, 20), y=(8, 148)) -> (8, 128, 128, 96)
I0408 04:48:31.484736 139967323350912 resnet_biggan.py:294] [Generator] before final processing: (8, 128, 128, 96)
I0408 04:48:31.501720 139967323350912 resnet_biggan.py:300] [Generator] after final processing: (8, 128, 128, 3)
I0408 04:48:31.503531 139967323350912 s3gan.py:249] bs=8, rotated_bs=4, num_rot_examples=1
---------------------------------------------------s3gan.py/merge_with_rotation_data,s
---------------------------------------------------s3gan.py/merge_with_rotation_data,e
--------------------------------------------------------------------s3gan.py/discriminator_with_additonal_heads,s
I0408 04:48:31.533267 139967323350912 resnet_biggan.py:379] [Discriminator] inputs are x=(22, 128, 128, 3), y=(22, 2)
I0408 04:48:31.570584 139967323350912 resnet_biggan.py:150] [Block] (22, 128, 128, 3) (z=None, y=(22, 2)) -> (22, 64, 64, 96)
I0408 04:48:31.570742 139967323350912 resnet_biggan.py:398] [Discriminator] Applying non-local block to (22, 64, 64, 96)
I0408 04:48:31.650686 139967323350912 resnet_biggan.py:150] [Block] (22, 64, 64, 96) (z=None, y=(22, 2)) -> (22, 32, 32, 192)
I0408 04:48:31.686603 139967323350912 resnet_biggan.py:150] [Block] (22, 32, 32, 192) (z=None, y=(22, 2)) -> (22, 16, 16, 384)
I0408 04:48:31.726071 139967323350912 resnet_biggan.py:150] [Block] (22, 16, 16, 384) (z=None, y=(22, 2)) -> (22, 8, 8, 768)
I0408 04:48:31.762156 139967323350912 resnet_biggan.py:150] [Block] (22, 8, 8, 768) (z=None, y=(22, 2)) -> (22, 4, 4, 1536)
I0408 04:48:31.783063 139967323350912 resnet_biggan.py:150] [Block] (22, 4, 4, 1536) (z=None, y=(22, 2)) -> (22, 4, 4, 1536)
I0408 04:48:31.783251 139967323350912 resnet_biggan.py:403] [Discriminator] before final processing: (22, 4, 4, 1536)
I0408 04:48:31.794417 139967323350912 resnet_biggan.py:407] [Discriminator] after final processing: (22, 4, 4, 1536)
I0408 04:48:31.801467 139967323350912 resnet_biggan.py:422] [Discriminator] embedded_y for projection: (22, 1536)
I0408 04:48:31.816547 139967323350912 s3gan.py:133] [Discriminator] rotation head (22, 1536) -> Tensor("discriminator_rotation/score_classify/add:0", shape=(22, 4), dtype=float32)
I0408 04:48:31.830280 139967323350912 s3gan.py:154] [Discriminator] (22, 2) -> aux_logits=(22, 2), y_predicted=(22, 2)
---------------------------------------------------s3gan.py/get_class_embedding,s
I0408 04:48:31.836673 139967323350912 s3gan.py:175] [Discriminator] embedded_y for projection: (22, 1536)
---------------------------------------------------s3gan.py/get_class_embedding,e
---------------------------------------------------s3gan.py/discriminator_with_additonal_heads,e
---------------------------------------------------s3gan.py/create_loss,e
---------------------------------------------------modular_gan.py/create_logits,e
################################################## mode == tf.estimator.ModeKeys.EVAL  ########################
INFO:tensorflow:Done calling model_fn.
I0408 04:48:31.948080 139967323350912 estimator.py:1171] Done calling model_fn.
INFO:tensorflow:Starting evaluation at 2020-04-08T04:48:31Z
I0408 04:48:31.965688 139967323350912 evaluation.py:255] Starting evaluation at 2020-04-08T04:48:31Z
INFO:tensorflow:Graph was finalized.
I0408 04:48:32.121961 139967323350912 monitored_session.py:246] Graph was finalized.
2020-04-08 04:48:32.122655: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-04-08 04:48:32.123003: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:00:04.0 name: Tesla P4 computeCapability: 6.1
coreClock: 1.1135GHz coreCount: 20 deviceMemorySize: 7.43GiB deviceMemoryBandwidth: 178.99GiB/s
2020-04-08 04:48:32.123060: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.1
2020-04-08 04:48:32.123086: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10
2020-04-08 04:48:32.123108: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcufft.so.10
2020-04-08 04:48:32.123146: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcurand.so.10
2020-04-08 04:48:32.123165: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusolver.so.10
2020-04-08 04:48:32.123215: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusparse.so.10
2020-04-08 04:48:32.123235: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudnn.so.7
2020-04-08 04:48:32.123326: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-04-08 04:48:32.123633: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-04-08 04:48:32.123876: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1703] Adding visible gpu devices: 0
2020-04-08 04:48:32.123927: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-04-08 04:48:32.123944: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      0 
2020-04-08 04:48:32.123959: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1121] 0:   N 
2020-04-08 04:48:32.124064: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-04-08 04:48:32.124374: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-04-08 04:48:32.124708: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1247] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 6850 MB memory) -> physical GPU (device: 0, name: Tesla P4, pci bus id: 0000:00:04.0, compute capability: 6.1)
INFO:tensorflow:Restoring parameters from /tmp/absl_testing/550760/model.ckpt-1875
I0408 04:48:32.126154 139967323350912 saver.py:1293] Restoring parameters from /tmp/absl_testing/550760/model.ckpt-1875
INFO:tensorflow:Running local_init_op.
I0408 04:48:32.560746 139967323350912 session_manager.py:505] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
I0408 04:48:32.585208 139967323350912 session_manager.py:508] Done running local_init_op.
INFO:tensorflow:Evaluation [5/50]
I0408 04:48:36.528748 139967323350912 evaluation.py:167] Evaluation [5/50]
INFO:tensorflow:Evaluation [10/50]
I0408 04:48:38.273333 139967323350912 evaluation.py:167] Evaluation [10/50]
INFO:tensorflow:Evaluation [15/50]
I0408 04:48:39.728774 139967323350912 evaluation.py:167] Evaluation [15/50]
INFO:tensorflow:Evaluation [20/50]
I0408 04:48:41.387708 139967323350912 evaluation.py:167] Evaluation [20/50]
INFO:tensorflow:Evaluation [25/50]
I0408 04:48:42.807916 139967323350912 evaluation.py:167] Evaluation [25/50]
INFO:tensorflow:Evaluation [30/50]
I0408 04:48:44.227023 139967323350912 evaluation.py:167] Evaluation [30/50]
INFO:tensorflow:Evaluation [35/50]
I0408 04:48:45.645538 139967323350912 evaluation.py:167] Evaluation [35/50]
INFO:tensorflow:Evaluation [40/50]
I0408 04:48:47.051722 139967323350912 evaluation.py:167] Evaluation [40/50]
INFO:tensorflow:Evaluation [45/50]
I0408 04:48:49.465893 139967323350912 evaluation.py:167] Evaluation [45/50]
INFO:tensorflow:Evaluation [50/50]
I0408 04:48:50.888328 139967323350912 evaluation.py:167] Evaluation [50/50]
INFO:tensorflow:Inference Time : 19.31126s
I0408 04:48:51.277144 139967323350912 evaluation.py:273] Inference Time : 19.31126s
INFO:tensorflow:Finished evaluation at 2020-04-08-04:48:51
I0408 04:48:51.277361 139967323350912 evaluation.py:276] Finished evaluation at 2020-04-08-04:48:51
INFO:tensorflow:Saving dict for global step 1875: accuracy = 0.6125, global_step = 1875, loss = 0.01323722
I0408 04:48:51.277507 139967323350912 estimator.py:2066] Saving dict for global step 1875: accuracy = 0.6125, global_step = 1875, loss = 0.01323722
INFO:tensorflow:Saving 'checkpoint_path' summary for global step 1875: /tmp/absl_testing/550760/model.ckpt-1875
I0408 04:48:51.279314 139967323350912 estimator.py:2127] Saving 'checkpoint_path' summary for global step 1875: /tmp/absl_testing/550760/model.ckpt-1875
INFO:tensorflow:global_step/sec: 0.547617
I0408 04:49:29.459185 139967323350912 basic_session_run_hooks.py:702] global_step/sec: 0.547617
INFO:tensorflow:loss = 0.4541879, step = 1900 (182.609 sec)
I0408 04:49:29.460209 139967323350912 basic_session_run_hooks.py:260] loss = 0.4541879, step = 1900 (182.609 sec)
INFO:tensorflow:global_step/sec: 0.682172
I0408 04:51:56.049638 139967323350912 basic_session_run_hooks.py:702] global_step/sec: 0.682172
INFO:tensorflow:loss = 0.044108134, step = 2000 (146.591 sec)
I0408 04:51:56.050838 139967323350912 basic_session_run_hooks.py:260] loss = 0.044108134, step = 2000 (146.591 sec)
INFO:tensorflow:global_step/sec: 0.6824
I0408 04:54:22.591223 139967323350912 basic_session_run_hooks.py:702] global_step/sec: 0.6824
INFO:tensorflow:loss = 0.0029193382, step = 2100 (146.542 sec)
I0408 04:54:22.592379 139967323350912 basic_session_run_hooks.py:260] loss = 0.0029193382, step = 2100 (146.542 sec)
INFO:tensorflow:global_step/sec: 0.683239
I0408 04:56:48.952798 139967323350912 basic_session_run_hooks.py:702] global_step/sec: 0.683239
INFO:tensorflow:loss = 8.077199e-05, step = 2200 (146.362 sec)
I0408 04:56:48.953974 139967323350912 basic_session_run_hooks.py:260] loss = 8.077199e-05, step = 2200 (146.362 sec)
INFO:tensorflow:Calling checkpoint listeners before saving checkpoint 2260...
I0408 04:58:15.390831 139967323350912 basic_session_run_hooks.py:614] Calling checkpoint listeners before saving checkpoint 2260...
INFO:tensorflow:Saving checkpoints for 2260 into /tmp/absl_testing/550760/model.ckpt.
I0408 04:58:15.391186 139967323350912 basic_session_run_hooks.py:618] Saving checkpoints for 2260 into /tmp/absl_testing/550760/model.ckpt.
INFO:tensorflow:Calling checkpoint listeners after saving checkpoint 2260...
I0408 04:58:31.345066 139967323350912 basic_session_run_hooks.py:626] Calling checkpoint listeners after saving checkpoint 2260...
--------------------------------------------datasets.py/eval_input_fn,s
W0408 04:58:31.351716 139967323350912 datasets.py:170] No TPUContext, using unmodified dataset seed 547.
I0408 04:58:31.351853 139967323350912 datasets.py:348] eval_input_fn(): params={'use_tpu': False, 'train_batch_size': 8, 'batch_size': 8} seed=547
--------befor self._load_dataset------------------split = validation self._eval_split= validation
--------------------------------------------datasets.py/_load_dataset,s
!!!!!!!!!!!!!!!!!!!!!!----load_local_datasets,  _local_test_ds_dir= /content/drive/My Drive/drive/gan/test
-----------------------------------------get_local_datasets,s
-----------------------------------------get_local_datasets,e
--------------------------------------------modular_gan.py/_preprocess_fn,s
I0408 04:58:31.434174 139967323350912 api.py:587] _preprocess_fn(): images=Tensor("args_0:0", shape=(128, 128, 3), dtype=float32), labels=Tensor("args_1:0", shape=(), dtype=int32), seed=547
--------------------------------------------modular_gan.py/_preprocess_fn,e
I0408 04:58:31.462908 139967323350912 api.py:587] Passing random offset: Tensor("Cast:0", shape=(), dtype=int32) with data ({'images': <tf.Tensor 'args_1:0' shape=(128, 128, 3) dtype=float32>, 'z': <tf.Tensor 'args_3:0' shape=(120,) dtype=float32>, 'sampled_labels': <tf.Tensor 'args_2:0' shape=() dtype=int32>}, <tf.Tensor 'args_4:0' shape=() dtype=int32>).
--------------------------------------------datasets.py/eval_input_fn,e
INFO:tensorflow:Calling model_fn.
I0408 04:58:31.479466 139967323350912 estimator.py:1169] Calling model_fn.
--------------------------------------------modular_gan.py/model_fn,s
I0408 04:58:31.479614 139967323350912 modular_gan.py:568] model_fn(): features={'images': <tf.Tensor 'IteratorGetNext:1' shape=(8, 128, 128, 3) dtype=float32>, 'z': <tf.Tensor 'IteratorGetNext:3' shape=(8, 120) dtype=float32>, 'sampled_labels': <tf.Tensor 'IteratorGetNext:2' shape=(8,) dtype=int32>, '_RANDOM_OFFSET': <tf.Tensor 'IteratorGetNext:0' shape=(8,) dtype=int32>}, labels=Tensor("IteratorGetNext:4", shape=(8,), dtype=int32),mode=eval, params={'use_tpu': False, 'train_batch_size': 8, 'batch_size': 8}
#Clean old summaries from previous calls to model_fn().
# Get features and labels for each sub-step.
--------------------------------------------modular_gan.py/_split_inputs_and_generate_samples,s
I0408 04:58:31.486612 139967323350912 resnet_biggan.py:236] [Generator] inputs are z=(8, 120), y=(8, 2)
I0408 04:58:31.496733 139967323350912 resnet_biggan.py:262] [Generator] z0=(8, 20), z_per_block=['(8, 20)', '(8, 20)', '(8, 20)', '(8, 20)', '(8, 20)'], y_per_block=['(8, 148)', '(8, 148)', '(8, 148)', '(8, 148)', '(8, 148)']
I0408 04:58:31.544086 139967323350912 resnet_biggan.py:150] [Block] (8, 4, 4, 1536) (z=(8, 20), y=(8, 148)) -> (8, 8, 8, 1536)
I0408 04:58:31.587489 139967323350912 resnet_biggan.py:150] [Block] (8, 8, 8, 1536) (z=(8, 20), y=(8, 148)) -> (8, 16, 16, 768)
I0408 04:58:31.631057 139967323350912 resnet_biggan.py:150] [Block] (8, 16, 16, 768) (z=(8, 20), y=(8, 148)) -> (8, 32, 32, 384)
I0408 04:58:31.671753 139967323350912 resnet_biggan.py:150] [Block] (8, 32, 32, 384) (z=(8, 20), y=(8, 148)) -> (8, 64, 64, 192)
I0408 04:58:31.671901 139967323350912 resnet_biggan.py:289] [Generator] Applying non-local block to (8, 64, 64, 192)
I0408 04:58:31.764232 139967323350912 resnet_biggan.py:150] [Block] (8, 64, 64, 192) (z=(8, 20), y=(8, 148)) -> (8, 128, 128, 96)
I0408 04:58:31.764402 139967323350912 resnet_biggan.py:294] [Generator] before final processing: (8, 128, 128, 96)
I0408 04:58:31.800557 139967323350912 resnet_biggan.py:300] [Generator] after final processing: (8, 128, 128, 3)
--------------------------------------------modular_gan.py/_split_inputs_and_generate_samples,e
---------------------------------------------------modular_gan.py/create_logits,s
I0408 04:58:31.804360 139967323350912 tpu_random.py:86] Got global random offset: Tensor("strided_slice:0", shape=(), dtype=int32)
---------------------------------------------------s3gan.py/create_loss,s
W0408 04:58:31.807177 139967323350912 s3gan.py:237] Computing fake images for every sub step separately.
I0408 04:58:31.807406 139967323350912 resnet_biggan.py:236] [Generator] inputs are z=(8, 120), y=(8, 2)
I0408 04:58:31.813402 139967323350912 resnet_biggan.py:262] [Generator] z0=(8, 20), z_per_block=['(8, 20)', '(8, 20)', '(8, 20)', '(8, 20)', '(8, 20)'], y_per_block=['(8, 148)', '(8, 148)', '(8, 148)', '(8, 148)', '(8, 148)']
I0408 04:58:31.835307 139967323350912 resnet_biggan.py:150] [Block] (8, 4, 4, 1536) (z=(8, 20), y=(8, 148)) -> (8, 8, 8, 1536)
I0408 04:58:31.852756 139967323350912 resnet_biggan.py:150] [Block] (8, 8, 8, 1536) (z=(8, 20), y=(8, 148)) -> (8, 16, 16, 768)
I0408 04:58:31.870950 139967323350912 resnet_biggan.py:150] [Block] (8, 16, 16, 768) (z=(8, 20), y=(8, 148)) -> (8, 32, 32, 384)
I0408 04:58:31.889534 139967323350912 resnet_biggan.py:150] [Block] (8, 32, 32, 384) (z=(8, 20), y=(8, 148)) -> (8, 64, 64, 192)
I0408 04:58:31.889686 139967323350912 resnet_biggan.py:289] [Generator] Applying non-local block to (8, 64, 64, 192)
I0408 04:58:31.924677 139967323350912 resnet_biggan.py:150] [Block] (8, 64, 64, 192) (z=(8, 20), y=(8, 148)) -> (8, 128, 128, 96)
I0408 04:58:31.924840 139967323350912 resnet_biggan.py:294] [Generator] before final processing: (8, 128, 128, 96)
I0408 04:58:31.941088 139967323350912 resnet_biggan.py:300] [Generator] after final processing: (8, 128, 128, 3)
I0408 04:58:31.942940 139967323350912 s3gan.py:249] bs=8, rotated_bs=4, num_rot_examples=1
---------------------------------------------------s3gan.py/merge_with_rotation_data,s
---------------------------------------------------s3gan.py/merge_with_rotation_data,e
--------------------------------------------------------------------s3gan.py/discriminator_with_additonal_heads,s
I0408 04:58:31.969659 139967323350912 resnet_biggan.py:379] [Discriminator] inputs are x=(22, 128, 128, 3), y=(22, 2)
I0408 04:58:32.004606 139967323350912 resnet_biggan.py:150] [Block] (22, 128, 128, 3) (z=None, y=(22, 2)) -> (22, 64, 64, 96)
I0408 04:58:32.004766 139967323350912 resnet_biggan.py:398] [Discriminator] Applying non-local block to (22, 64, 64, 96)
I0408 04:58:32.081411 139967323350912 resnet_biggan.py:150] [Block] (22, 64, 64, 96) (z=None, y=(22, 2)) -> (22, 32, 32, 192)
I0408 04:58:32.114534 139967323350912 resnet_biggan.py:150] [Block] (22, 32, 32, 192) (z=None, y=(22, 2)) -> (22, 16, 16, 384)
I0408 04:58:32.148801 139967323350912 resnet_biggan.py:150] [Block] (22, 16, 16, 384) (z=None, y=(22, 2)) -> (22, 8, 8, 768)
I0408 04:58:32.184371 139967323350912 resnet_biggan.py:150] [Block] (22, 8, 8, 768) (z=None, y=(22, 2)) -> (22, 4, 4, 1536)
I0408 04:58:32.208564 139967323350912 resnet_biggan.py:150] [Block] (22, 4, 4, 1536) (z=None, y=(22, 2)) -> (22, 4, 4, 1536)
I0408 04:58:32.208732 139967323350912 resnet_biggan.py:403] [Discriminator] before final processing: (22, 4, 4, 1536)
I0408 04:58:32.219950 139967323350912 resnet_biggan.py:407] [Discriminator] after final processing: (22, 4, 4, 1536)
I0408 04:58:32.227764 139967323350912 resnet_biggan.py:422] [Discriminator] embedded_y for projection: (22, 1536)
I0408 04:58:32.242403 139967323350912 s3gan.py:133] [Discriminator] rotation head (22, 1536) -> Tensor("discriminator_rotation/score_classify/add:0", shape=(22, 4), dtype=float32)
I0408 04:58:32.256015 139967323350912 s3gan.py:154] [Discriminator] (22, 2) -> aux_logits=(22, 2), y_predicted=(22, 2)
---------------------------------------------------s3gan.py/get_class_embedding,s
I0408 04:58:32.263222 139967323350912 s3gan.py:175] [Discriminator] embedded_y for projection: (22, 1536)
---------------------------------------------------s3gan.py/get_class_embedding,e
---------------------------------------------------s3gan.py/discriminator_with_additonal_heads,e
---------------------------------------------------s3gan.py/create_loss,e
---------------------------------------------------modular_gan.py/create_logits,e
################################################## mode == tf.estimator.ModeKeys.EVAL  ########################
INFO:tensorflow:Done calling model_fn.
I0408 04:58:32.367975 139967323350912 estimator.py:1171] Done calling model_fn.
INFO:tensorflow:Starting evaluation at 2020-04-08T04:58:32Z
I0408 04:58:32.384520 139967323350912 evaluation.py:255] Starting evaluation at 2020-04-08T04:58:32Z
INFO:tensorflow:Graph was finalized.
I0408 04:58:32.544598 139967323350912 monitored_session.py:246] Graph was finalized.
2020-04-08 04:58:32.545230: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-04-08 04:58:32.545537: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:00:04.0 name: Tesla P4 computeCapability: 6.1
coreClock: 1.1135GHz coreCount: 20 deviceMemorySize: 7.43GiB deviceMemoryBandwidth: 178.99GiB/s
2020-04-08 04:58:32.545584: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.1
2020-04-08 04:58:32.545611: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10
2020-04-08 04:58:32.545630: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcufft.so.10
2020-04-08 04:58:32.545648: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcurand.so.10
2020-04-08 04:58:32.545662: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusolver.so.10
2020-04-08 04:58:32.545714: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusparse.so.10
2020-04-08 04:58:32.545729: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudnn.so.7
2020-04-08 04:58:32.545813: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-04-08 04:58:32.546135: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-04-08 04:58:32.546363: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1703] Adding visible gpu devices: 0
2020-04-08 04:58:32.546414: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-04-08 04:58:32.546428: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      0 
2020-04-08 04:58:32.546437: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1121] 0:   N 
2020-04-08 04:58:32.546537: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-04-08 04:58:32.546806: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-04-08 04:58:32.547056: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1247] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 6850 MB memory) -> physical GPU (device: 0, name: Tesla P4, pci bus id: 0000:00:04.0, compute capability: 6.1)
INFO:tensorflow:Restoring parameters from /tmp/absl_testing/550760/model.ckpt-2260
I0408 04:58:32.548035 139967323350912 saver.py:1293] Restoring parameters from /tmp/absl_testing/550760/model.ckpt-2260
INFO:tensorflow:Running local_init_op.
I0408 04:58:32.984200 139967323350912 session_manager.py:505] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
I0408 04:58:33.009407 139967323350912 session_manager.py:508] Done running local_init_op.
INFO:tensorflow:Evaluation [5/50]
I0408 04:58:37.862724 139967323350912 evaluation.py:167] Evaluation [5/50]
INFO:tensorflow:Evaluation [10/50]
I0408 04:58:39.929948 139967323350912 evaluation.py:167] Evaluation [10/50]
INFO:tensorflow:Evaluation [15/50]
I0408 04:58:41.618914 139967323350912 evaluation.py:167] Evaluation [15/50]
INFO:tensorflow:Evaluation [20/50]
I0408 04:58:43.116705 139967323350912 evaluation.py:167] Evaluation [20/50]
INFO:tensorflow:Evaluation [25/50]
I0408 04:58:44.533790 139967323350912 evaluation.py:167] Evaluation [25/50]
INFO:tensorflow:Evaluation [30/50]
I0408 04:58:46.670831 139967323350912 evaluation.py:167] Evaluation [30/50]
INFO:tensorflow:Evaluation [35/50]
I0408 04:58:48.607184 139967323350912 evaluation.py:167] Evaluation [35/50]
INFO:tensorflow:Evaluation [40/50]
I0408 04:58:50.736170 139967323350912 evaluation.py:167] Evaluation [40/50]
INFO:tensorflow:Evaluation [45/50]
I0408 04:58:52.600852 139967323350912 evaluation.py:167] Evaluation [45/50]
INFO:tensorflow:Evaluation [50/50]
I0408 04:58:55.215251 139967323350912 evaluation.py:167] Evaluation [50/50]
INFO:tensorflow:Inference Time : 23.12358s
I0408 04:58:55.508254 139967323350912 evaluation.py:273] Inference Time : 23.12358s
INFO:tensorflow:Finished evaluation at 2020-04-08-04:58:55
I0408 04:58:55.508450 139967323350912 evaluation.py:276] Finished evaluation at 2020-04-08-04:58:55
INFO:tensorflow:Saving dict for global step 2260: accuracy = 0.6525, global_step = 2260, loss = 0.016205365
I0408 04:58:55.508586 139967323350912 estimator.py:2066] Saving dict for global step 2260: accuracy = 0.6525, global_step = 2260, loss = 0.016205365
INFO:tensorflow:Saving 'checkpoint_path' summary for global step 2260: /tmp/absl_testing/550760/model.ckpt-2260
I0408 04:58:55.508995 139967323350912 estimator.py:2127] Saving 'checkpoint_path' summary for global step 2260: /tmp/absl_testing/550760/model.ckpt-2260
INFO:tensorflow:global_step/sec: 0.535896
I0408 04:59:55.556205 139967323350912 basic_session_run_hooks.py:702] global_step/sec: 0.535896
INFO:tensorflow:loss = 0.6134231, step = 2300 (186.629 sec)
I0408 04:59:55.583110 139967323350912 basic_session_run_hooks.py:260] loss = 0.6134231, step = 2300 (186.629 sec)
INFO:tensorflow:global_step/sec: 0.682716
I0408 05:02:22.029921 139967323350912 basic_session_run_hooks.py:702] global_step/sec: 0.682716
INFO:tensorflow:loss = 0.010519505, step = 2400 (146.448 sec)
I0408 05:02:22.030955 139967323350912 basic_session_run_hooks.py:260] loss = 0.010519505, step = 2400 (146.448 sec)
INFO:tensorflow:global_step/sec: 0.681866
I0408 05:04:48.686343 139967323350912 basic_session_run_hooks.py:702] global_step/sec: 0.681866
INFO:tensorflow:loss = 0.04337968, step = 2500 (146.657 sec)
I0408 05:04:48.687951 139967323350912 basic_session_run_hooks.py:260] loss = 0.04337968, step = 2500 (146.657 sec)
INFO:tensorflow:global_step/sec: 0.682802
I0408 05:07:15.141741 139967323350912 basic_session_run_hooks.py:702] global_step/sec: 0.682802
INFO:tensorflow:loss = 0.3590351, step = 2600 (146.455 sec)
I0408 05:07:15.142777 139967323350912 basic_session_run_hooks.py:260] loss = 0.3590351, step = 2600 (146.455 sec)
INFO:tensorflow:Calling checkpoint listeners before saving checkpoint 2643...
I0408 05:08:16.593896 139967323350912 basic_session_run_hooks.py:614] Calling checkpoint listeners before saving checkpoint 2643...
INFO:tensorflow:Saving checkpoints for 2643 into /tmp/absl_testing/550760/model.ckpt.
I0408 05:08:16.594173 139967323350912 basic_session_run_hooks.py:618] Saving checkpoints for 2643 into /tmp/absl_testing/550760/model.ckpt.
INFO:tensorflow:Calling checkpoint listeners after saving checkpoint 2643...
I0408 05:08:35.106001 139967323350912 basic_session_run_hooks.py:626] Calling checkpoint listeners after saving checkpoint 2643...
--------------------------------------------datasets.py/eval_input_fn,s
W0408 05:08:35.112702 139967323350912 datasets.py:170] No TPUContext, using unmodified dataset seed 547.
I0408 05:08:35.112835 139967323350912 datasets.py:348] eval_input_fn(): params={'use_tpu': False, 'train_batch_size': 8, 'batch_size': 8} seed=547
--------befor self._load_dataset------------------split = validation self._eval_split= validation
--------------------------------------------datasets.py/_load_dataset,s
!!!!!!!!!!!!!!!!!!!!!!----load_local_datasets,  _local_test_ds_dir= /content/drive/My Drive/drive/gan/test
-----------------------------------------get_local_datasets,s
-----------------------------------------get_local_datasets,e
--------------------------------------------modular_gan.py/_preprocess_fn,s
I0408 05:08:35.213990 139967323350912 api.py:587] _preprocess_fn(): images=Tensor("args_0:0", shape=(128, 128, 3), dtype=float32), labels=Tensor("args_1:0", shape=(), dtype=int32), seed=547
--------------------------------------------modular_gan.py/_preprocess_fn,e
I0408 05:08:35.243654 139967323350912 api.py:587] Passing random offset: Tensor("Cast:0", shape=(), dtype=int32) with data ({'images': <tf.Tensor 'args_1:0' shape=(128, 128, 3) dtype=float32>, 'z': <tf.Tensor 'args_3:0' shape=(120,) dtype=float32>, 'sampled_labels': <tf.Tensor 'args_2:0' shape=() dtype=int32>}, <tf.Tensor 'args_4:0' shape=() dtype=int32>).
--------------------------------------------datasets.py/eval_input_fn,e
INFO:tensorflow:Calling model_fn.
I0408 05:08:35.260299 139967323350912 estimator.py:1169] Calling model_fn.
--------------------------------------------modular_gan.py/model_fn,s
I0408 05:08:35.260467 139967323350912 modular_gan.py:568] model_fn(): features={'images': <tf.Tensor 'IteratorGetNext:1' shape=(8, 128, 128, 3) dtype=float32>, 'z': <tf.Tensor 'IteratorGetNext:3' shape=(8, 120) dtype=float32>, 'sampled_labels': <tf.Tensor 'IteratorGetNext:2' shape=(8,) dtype=int32>, '_RANDOM_OFFSET': <tf.Tensor 'IteratorGetNext:0' shape=(8,) dtype=int32>}, labels=Tensor("IteratorGetNext:4", shape=(8,), dtype=int32),mode=eval, params={'use_tpu': False, 'train_batch_size': 8, 'batch_size': 8}
#Clean old summaries from previous calls to model_fn().
# Get features and labels for each sub-step.
--------------------------------------------modular_gan.py/_split_inputs_and_generate_samples,s
I0408 05:08:35.267802 139967323350912 resnet_biggan.py:236] [Generator] inputs are z=(8, 120), y=(8, 2)
I0408 05:08:35.278685 139967323350912 resnet_biggan.py:262] [Generator] z0=(8, 20), z_per_block=['(8, 20)', '(8, 20)', '(8, 20)', '(8, 20)', '(8, 20)'], y_per_block=['(8, 148)', '(8, 148)', '(8, 148)', '(8, 148)', '(8, 148)']
I0408 05:08:35.329135 139967323350912 resnet_biggan.py:150] [Block] (8, 4, 4, 1536) (z=(8, 20), y=(8, 148)) -> (8, 8, 8, 1536)
I0408 05:08:35.370247 139967323350912 resnet_biggan.py:150] [Block] (8, 8, 8, 1536) (z=(8, 20), y=(8, 148)) -> (8, 16, 16, 768)
I0408 05:08:35.415034 139967323350912 resnet_biggan.py:150] [Block] (8, 16, 16, 768) (z=(8, 20), y=(8, 148)) -> (8, 32, 32, 384)
I0408 05:08:35.457515 139967323350912 resnet_biggan.py:150] [Block] (8, 32, 32, 384) (z=(8, 20), y=(8, 148)) -> (8, 64, 64, 192)
I0408 05:08:35.457685 139967323350912 resnet_biggan.py:289] [Generator] Applying non-local block to (8, 64, 64, 192)
I0408 05:08:35.542998 139967323350912 resnet_biggan.py:150] [Block] (8, 64, 64, 192) (z=(8, 20), y=(8, 148)) -> (8, 128, 128, 96)
I0408 05:08:35.543180 139967323350912 resnet_biggan.py:294] [Generator] before final processing: (8, 128, 128, 96)
I0408 05:08:35.576238 139967323350912 resnet_biggan.py:300] [Generator] after final processing: (8, 128, 128, 3)
--------------------------------------------modular_gan.py/_split_inputs_and_generate_samples,e
---------------------------------------------------modular_gan.py/create_logits,s
I0408 05:08:35.579907 139967323350912 tpu_random.py:86] Got global random offset: Tensor("strided_slice:0", shape=(), dtype=int32)
---------------------------------------------------s3gan.py/create_loss,s
W0408 05:08:35.582738 139967323350912 s3gan.py:237] Computing fake images for every sub step separately.
I0408 05:08:35.582945 139967323350912 resnet_biggan.py:236] [Generator] inputs are z=(8, 120), y=(8, 2)
I0408 05:08:35.589612 139967323350912 resnet_biggan.py:262] [Generator] z0=(8, 20), z_per_block=['(8, 20)', '(8, 20)', '(8, 20)', '(8, 20)', '(8, 20)'], y_per_block=['(8, 148)', '(8, 148)', '(8, 148)', '(8, 148)', '(8, 148)']
I0408 05:08:35.615224 139967323350912 resnet_biggan.py:150] [Block] (8, 4, 4, 1536) (z=(8, 20), y=(8, 148)) -> (8, 8, 8, 1536)
I0408 05:08:35.633027 139967323350912 resnet_biggan.py:150] [Block] (8, 8, 8, 1536) (z=(8, 20), y=(8, 148)) -> (8, 16, 16, 768)
I0408 05:08:35.650457 139967323350912 resnet_biggan.py:150] [Block] (8, 16, 16, 768) (z=(8, 20), y=(8, 148)) -> (8, 32, 32, 384)
I0408 05:08:35.667654 139967323350912 resnet_biggan.py:150] [Block] (8, 32, 32, 384) (z=(8, 20), y=(8, 148)) -> (8, 64, 64, 192)
I0408 05:08:35.667808 139967323350912 resnet_biggan.py:289] [Generator] Applying non-local block to (8, 64, 64, 192)
I0408 05:08:35.702468 139967323350912 resnet_biggan.py:150] [Block] (8, 64, 64, 192) (z=(8, 20), y=(8, 148)) -> (8, 128, 128, 96)
I0408 05:08:35.702627 139967323350912 resnet_biggan.py:294] [Generator] before final processing: (8, 128, 128, 96)
I0408 05:08:35.717616 139967323350912 resnet_biggan.py:300] [Generator] after final processing: (8, 128, 128, 3)
I0408 05:08:35.719565 139967323350912 s3gan.py:249] bs=8, rotated_bs=4, num_rot_examples=1
---------------------------------------------------s3gan.py/merge_with_rotation_data,s
---------------------------------------------------s3gan.py/merge_with_rotation_data,e
--------------------------------------------------------------------s3gan.py/discriminator_with_additonal_heads,s
I0408 05:08:35.747145 139967323350912 resnet_biggan.py:379] [Discriminator] inputs are x=(22, 128, 128, 3), y=(22, 2)
I0408 05:08:35.781328 139967323350912 resnet_biggan.py:150] [Block] (22, 128, 128, 3) (z=None, y=(22, 2)) -> (22, 64, 64, 96)
I0408 05:08:35.781478 139967323350912 resnet_biggan.py:398] [Discriminator] Applying non-local block to (22, 64, 64, 96)
I0408 05:08:35.863815 139967323350912 resnet_biggan.py:150] [Block] (22, 64, 64, 96) (z=None, y=(22, 2)) -> (22, 32, 32, 192)
I0408 05:08:35.896305 139967323350912 resnet_biggan.py:150] [Block] (22, 32, 32, 192) (z=None, y=(22, 2)) -> (22, 16, 16, 384)
I0408 05:08:35.929396 139967323350912 resnet_biggan.py:150] [Block] (22, 16, 16, 384) (z=None, y=(22, 2)) -> (22, 8, 8, 768)
I0408 05:08:35.962257 139967323350912 resnet_biggan.py:150] [Block] (22, 8, 8, 768) (z=None, y=(22, 2)) -> (22, 4, 4, 1536)
I0408 05:08:35.982791 139967323350912 resnet_biggan.py:150] [Block] (22, 4, 4, 1536) (z=None, y=(22, 2)) -> (22, 4, 4, 1536)
I0408 05:08:35.982944 139967323350912 resnet_biggan.py:403] [Discriminator] before final processing: (22, 4, 4, 1536)
I0408 05:08:35.994304 139967323350912 resnet_biggan.py:407] [Discriminator] after final processing: (22, 4, 4, 1536)
I0408 05:08:36.004376 139967323350912 resnet_biggan.py:422] [Discriminator] embedded_y for projection: (22, 1536)
I0408 05:08:36.019859 139967323350912 s3gan.py:133] [Discriminator] rotation head (22, 1536) -> Tensor("discriminator_rotation/score_classify/add:0", shape=(22, 4), dtype=float32)
I0408 05:08:36.036344 139967323350912 s3gan.py:154] [Discriminator] (22, 2) -> aux_logits=(22, 2), y_predicted=(22, 2)
---------------------------------------------------s3gan.py/get_class_embedding,s
I0408 05:08:36.048154 139967323350912 s3gan.py:175] [Discriminator] embedded_y for projection: (22, 1536)
---------------------------------------------------s3gan.py/get_class_embedding,e
---------------------------------------------------s3gan.py/discriminator_with_additonal_heads,e
---------------------------------------------------s3gan.py/create_loss,e
---------------------------------------------------modular_gan.py/create_logits,e
################################################## mode == tf.estimator.ModeKeys.EVAL  ########################
INFO:tensorflow:Done calling model_fn.
I0408 05:08:36.167695 139967323350912 estimator.py:1171] Done calling model_fn.
INFO:tensorflow:Starting evaluation at 2020-04-08T05:08:36Z
I0408 05:08:36.185096 139967323350912 evaluation.py:255] Starting evaluation at 2020-04-08T05:08:36Z
INFO:tensorflow:Graph was finalized.
I0408 05:08:36.585924 139967323350912 monitored_session.py:246] Graph was finalized.
2020-04-08 05:08:36.586663: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-04-08 05:08:36.587008: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:00:04.0 name: Tesla P4 computeCapability: 6.1
coreClock: 1.1135GHz coreCount: 20 deviceMemorySize: 7.43GiB deviceMemoryBandwidth: 178.99GiB/s
2020-04-08 05:08:36.587067: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.1
2020-04-08 05:08:36.587094: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10
2020-04-08 05:08:36.587114: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcufft.so.10
2020-04-08 05:08:36.587153: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcurand.so.10
2020-04-08 05:08:36.587171: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusolver.so.10
2020-04-08 05:08:36.587223: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusparse.so.10
2020-04-08 05:08:36.587242: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudnn.so.7
2020-04-08 05:08:36.587342: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-04-08 05:08:36.587636: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-04-08 05:08:36.587849: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1703] Adding visible gpu devices: 0
2020-04-08 05:08:36.587895: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-04-08 05:08:36.587913: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      0 
2020-04-08 05:08:36.587934: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1121] 0:   N 
2020-04-08 05:08:36.588051: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-04-08 05:08:36.588357: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-04-08 05:08:36.588593: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1247] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 6850 MB memory) -> physical GPU (device: 0, name: Tesla P4, pci bus id: 0000:00:04.0, compute capability: 6.1)
INFO:tensorflow:Restoring parameters from /tmp/absl_testing/550760/model.ckpt-2643
I0408 05:08:36.590059 139967323350912 saver.py:1293] Restoring parameters from /tmp/absl_testing/550760/model.ckpt-2643
INFO:tensorflow:Running local_init_op.
I0408 05:08:37.024385 139967323350912 session_manager.py:505] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
I0408 05:08:37.053881 139967323350912 session_manager.py:508] Done running local_init_op.
INFO:tensorflow:Evaluation [5/50]
I0408 05:08:40.141507 139967323350912 evaluation.py:167] Evaluation [5/50]
INFO:tensorflow:Evaluation [10/50]
I0408 05:08:41.552708 139967323350912 evaluation.py:167] Evaluation [10/50]
INFO:tensorflow:Evaluation [15/50]
I0408 05:08:43.163925 139967323350912 evaluation.py:167] Evaluation [15/50]
INFO:tensorflow:Evaluation [20/50]
I0408 05:08:46.077469 139967323350912 evaluation.py:167] Evaluation [20/50]
INFO:tensorflow:Evaluation [25/50]
I0408 05:08:48.077944 139967323350912 evaluation.py:167] Evaluation [25/50]
INFO:tensorflow:Evaluation [30/50]
I0408 05:08:49.504881 139967323350912 evaluation.py:167] Evaluation [30/50]
INFO:tensorflow:Evaluation [35/50]
I0408 05:08:50.953039 139967323350912 evaluation.py:167] Evaluation [35/50]
INFO:tensorflow:Evaluation [40/50]
I0408 05:08:52.391706 139967323350912 evaluation.py:167] Evaluation [40/50]
INFO:tensorflow:Evaluation [45/50]
I0408 05:08:53.815752 139967323350912 evaluation.py:167] Evaluation [45/50]
INFO:tensorflow:Evaluation [50/50]
I0408 05:08:55.256927 139967323350912 evaluation.py:167] Evaluation [50/50]
INFO:tensorflow:Inference Time : 19.13092s
I0408 05:08:55.316219 139967323350912 evaluation.py:273] Inference Time : 19.13092s
INFO:tensorflow:Finished evaluation at 2020-04-08-05:08:55
I0408 05:08:55.316474 139967323350912 evaluation.py:276] Finished evaluation at 2020-04-08-05:08:55
INFO:tensorflow:Saving dict for global step 2643: accuracy = 0.64, global_step = 2643, loss = 0.020589089
I0408 05:08:55.316641 139967323350912 estimator.py:2066] Saving dict for global step 2643: accuracy = 0.64, global_step = 2643, loss = 0.020589089
INFO:tensorflow:Saving 'checkpoint_path' summary for global step 2643: /tmp/absl_testing/550760/model.ckpt-2643
I0408 05:08:55.353078 139967323350912 estimator.py:2127] Saving 'checkpoint_path' summary for global step 2643: /tmp/absl_testing/550760/model.ckpt-2643
INFO:tensorflow:global_step/sec: 0.53972
I0408 05:10:20.422823 139967323350912 basic_session_run_hooks.py:702] global_step/sec: 0.53972
INFO:tensorflow:loss = 0.72364694, step = 2700 (185.282 sec)
I0408 05:10:20.424833 139967323350912 basic_session_run_hooks.py:260] loss = 0.72364694, step = 2700 (185.282 sec)
INFO:tensorflow:global_step/sec: 0.682144
I0408 05:12:47.019384 139967323350912 basic_session_run_hooks.py:702] global_step/sec: 0.682144
INFO:tensorflow:loss = 0.0028940265, step = 2800 (146.596 sec)
I0408 05:12:47.020515 139967323350912 basic_session_run_hooks.py:260] loss = 0.0028940265, step = 2800 (146.596 sec)
INFO:tensorflow:global_step/sec: 0.683101
I0408 05:15:13.410808 139967323350912 basic_session_run_hooks.py:702] global_step/sec: 0.683101
INFO:tensorflow:loss = 0.0024273284, step = 2900 (146.392 sec)
I0408 05:15:13.412156 139967323350912 basic_session_run_hooks.py:260] loss = 0.0024273284, step = 2900 (146.392 sec)
INFO:tensorflow:global_step/sec: 0.682329
I0408 05:17:39.967455 139967323350912 basic_session_run_hooks.py:702] global_step/sec: 0.682329
INFO:tensorflow:loss = 0.044174477, step = 3000 (146.556 sec)
I0408 05:17:39.968605 139967323350912 basic_session_run_hooks.py:260] loss = 0.044174477, step = 3000 (146.556 sec)
INFO:tensorflow:Calling checkpoint listeners before saving checkpoint 3027...
I0408 05:18:18.040488 139967323350912 basic_session_run_hooks.py:614] Calling checkpoint listeners before saving checkpoint 3027...
INFO:tensorflow:Saving checkpoints for 3027 into /tmp/absl_testing/550760/model.ckpt.
I0408 05:18:18.040769 139967323350912 basic_session_run_hooks.py:618] Saving checkpoints for 3027 into /tmp/absl_testing/550760/model.ckpt.
INFO:tensorflow:Calling checkpoint listeners after saving checkpoint 3027...
I0408 05:18:36.976076 139967323350912 basic_session_run_hooks.py:626] Calling checkpoint listeners after saving checkpoint 3027...
--------------------------------------------datasets.py/eval_input_fn,s
W0408 05:18:36.982788 139967323350912 datasets.py:170] No TPUContext, using unmodified dataset seed 547.
I0408 05:18:36.982924 139967323350912 datasets.py:348] eval_input_fn(): params={'use_tpu': False, 'train_batch_size': 8, 'batch_size': 8} seed=547
--------befor self._load_dataset------------------split = validation self._eval_split= validation
--------------------------------------------datasets.py/_load_dataset,s
!!!!!!!!!!!!!!!!!!!!!!----load_local_datasets,  _local_test_ds_dir= /content/drive/My Drive/drive/gan/test
-----------------------------------------get_local_datasets,s
-----------------------------------------get_local_datasets,e
--------------------------------------------modular_gan.py/_preprocess_fn,s
I0408 05:18:37.067836 139967323350912 api.py:587] _preprocess_fn(): images=Tensor("args_0:0", shape=(128, 128, 3), dtype=float32), labels=Tensor("args_1:0", shape=(), dtype=int32), seed=547
--------------------------------------------modular_gan.py/_preprocess_fn,e
I0408 05:18:37.097614 139967323350912 api.py:587] Passing random offset: Tensor("Cast:0", shape=(), dtype=int32) with data ({'images': <tf.Tensor 'args_1:0' shape=(128, 128, 3) dtype=float32>, 'z': <tf.Tensor 'args_3:0' shape=(120,) dtype=float32>, 'sampled_labels': <tf.Tensor 'args_2:0' shape=() dtype=int32>}, <tf.Tensor 'args_4:0' shape=() dtype=int32>).
--------------------------------------------datasets.py/eval_input_fn,e
INFO:tensorflow:Calling model_fn.
I0408 05:18:37.114026 139967323350912 estimator.py:1169] Calling model_fn.
--------------------------------------------modular_gan.py/model_fn,s
I0408 05:18:37.114214 139967323350912 modular_gan.py:568] model_fn(): features={'images': <tf.Tensor 'IteratorGetNext:1' shape=(8, 128, 128, 3) dtype=float32>, 'z': <tf.Tensor 'IteratorGetNext:3' shape=(8, 120) dtype=float32>, 'sampled_labels': <tf.Tensor 'IteratorGetNext:2' shape=(8,) dtype=int32>, '_RANDOM_OFFSET': <tf.Tensor 'IteratorGetNext:0' shape=(8,) dtype=int32>}, labels=Tensor("IteratorGetNext:4", shape=(8,), dtype=int32),mode=eval, params={'use_tpu': False, 'train_batch_size': 8, 'batch_size': 8}
#Clean old summaries from previous calls to model_fn().
# Get features and labels for each sub-step.
--------------------------------------------modular_gan.py/_split_inputs_and_generate_samples,s
I0408 05:18:37.121595 139967323350912 resnet_biggan.py:236] [Generator] inputs are z=(8, 120), y=(8, 2)
I0408 05:18:37.132827 139967323350912 resnet_biggan.py:262] [Generator] z0=(8, 20), z_per_block=['(8, 20)', '(8, 20)', '(8, 20)', '(8, 20)', '(8, 20)'], y_per_block=['(8, 148)', '(8, 148)', '(8, 148)', '(8, 148)', '(8, 148)']
I0408 05:18:37.183571 139967323350912 resnet_biggan.py:150] [Block] (8, 4, 4, 1536) (z=(8, 20), y=(8, 148)) -> (8, 8, 8, 1536)
I0408 05:18:37.226322 139967323350912 resnet_biggan.py:150] [Block] (8, 8, 8, 1536) (z=(8, 20), y=(8, 148)) -> (8, 16, 16, 768)
I0408 05:18:37.267528 139967323350912 resnet_biggan.py:150] [Block] (8, 16, 16, 768) (z=(8, 20), y=(8, 148)) -> (8, 32, 32, 384)
I0408 05:18:37.306984 139967323350912 resnet_biggan.py:150] [Block] (8, 32, 32, 384) (z=(8, 20), y=(8, 148)) -> (8, 64, 64, 192)
I0408 05:18:37.307150 139967323350912 resnet_biggan.py:289] [Generator] Applying non-local block to (8, 64, 64, 192)
I0408 05:18:37.386497 139967323350912 resnet_biggan.py:150] [Block] (8, 64, 64, 192) (z=(8, 20), y=(8, 148)) -> (8, 128, 128, 96)
I0408 05:18:37.386655 139967323350912 resnet_biggan.py:294] [Generator] before final processing: (8, 128, 128, 96)
I0408 05:18:37.419389 139967323350912 resnet_biggan.py:300] [Generator] after final processing: (8, 128, 128, 3)
--------------------------------------------modular_gan.py/_split_inputs_and_generate_samples,e
---------------------------------------------------modular_gan.py/create_logits,s
I0408 05:18:37.422766 139967323350912 tpu_random.py:86] Got global random offset: Tensor("strided_slice:0", shape=(), dtype=int32)
---------------------------------------------------s3gan.py/create_loss,s
W0408 05:18:37.425515 139967323350912 s3gan.py:237] Computing fake images for every sub step separately.
I0408 05:18:37.425710 139967323350912 resnet_biggan.py:236] [Generator] inputs are z=(8, 120), y=(8, 2)
I0408 05:18:37.431207 139967323350912 resnet_biggan.py:262] [Generator] z0=(8, 20), z_per_block=['(8, 20)', '(8, 20)', '(8, 20)', '(8, 20)', '(8, 20)'], y_per_block=['(8, 148)', '(8, 148)', '(8, 148)', '(8, 148)', '(8, 148)']
I0408 05:18:37.449257 139967323350912 resnet_biggan.py:150] [Block] (8, 4, 4, 1536) (z=(8, 20), y=(8, 148)) -> (8, 8, 8, 1536)
I0408 05:18:37.464803 139967323350912 resnet_biggan.py:150] [Block] (8, 8, 8, 1536) (z=(8, 20), y=(8, 148)) -> (8, 16, 16, 768)
I0408 05:18:37.480472 139967323350912 resnet_biggan.py:150] [Block] (8, 16, 16, 768) (z=(8, 20), y=(8, 148)) -> (8, 32, 32, 384)
I0408 05:18:37.496407 139967323350912 resnet_biggan.py:150] [Block] (8, 32, 32, 384) (z=(8, 20), y=(8, 148)) -> (8, 64, 64, 192)
I0408 05:18:37.496551 139967323350912 resnet_biggan.py:289] [Generator] Applying non-local block to (8, 64, 64, 192)
I0408 05:18:37.530569 139967323350912 resnet_biggan.py:150] [Block] (8, 64, 64, 192) (z=(8, 20), y=(8, 148)) -> (8, 128, 128, 96)
I0408 05:18:37.530751 139967323350912 resnet_biggan.py:294] [Generator] before final processing: (8, 128, 128, 96)
I0408 05:18:37.544893 139967323350912 resnet_biggan.py:300] [Generator] after final processing: (8, 128, 128, 3)
I0408 05:18:37.546549 139967323350912 s3gan.py:249] bs=8, rotated_bs=4, num_rot_examples=1
---------------------------------------------------s3gan.py/merge_with_rotation_data,s
---------------------------------------------------s3gan.py/merge_with_rotation_data,e
--------------------------------------------------------------------s3gan.py/discriminator_with_additonal_heads,s
I0408 05:18:37.570670 139967323350912 resnet_biggan.py:379] [Discriminator] inputs are x=(22, 128, 128, 3), y=(22, 2)
I0408 05:18:37.602723 139967323350912 resnet_biggan.py:150] [Block] (22, 128, 128, 3) (z=None, y=(22, 2)) -> (22, 64, 64, 96)
I0408 05:18:37.602868 139967323350912 resnet_biggan.py:398] [Discriminator] Applying non-local block to (22, 64, 64, 96)
I0408 05:18:37.670047 139967323350912 resnet_biggan.py:150] [Block] (22, 64, 64, 96) (z=None, y=(22, 2)) -> (22, 32, 32, 192)
I0408 05:18:37.700683 139967323350912 resnet_biggan.py:150] [Block] (22, 32, 32, 192) (z=None, y=(22, 2)) -> (22, 16, 16, 384)
I0408 05:18:37.735205 139967323350912 resnet_biggan.py:150] [Block] (22, 16, 16, 384) (z=None, y=(22, 2)) -> (22, 8, 8, 768)
I0408 05:18:37.768293 139967323350912 resnet_biggan.py:150] [Block] (22, 8, 8, 768) (z=None, y=(22, 2)) -> (22, 4, 4, 1536)
I0408 05:18:37.790524 139967323350912 resnet_biggan.py:150] [Block] (22, 4, 4, 1536) (z=None, y=(22, 2)) -> (22, 4, 4, 1536)
I0408 05:18:37.790695 139967323350912 resnet_biggan.py:403] [Discriminator] before final processing: (22, 4, 4, 1536)
I0408 05:18:37.804601 139967323350912 resnet_biggan.py:407] [Discriminator] after final processing: (22, 4, 4, 1536)
I0408 05:18:37.810984 139967323350912 resnet_biggan.py:422] [Discriminator] embedded_y for projection: (22, 1536)
I0408 05:18:37.825823 139967323350912 s3gan.py:133] [Discriminator] rotation head (22, 1536) -> Tensor("discriminator_rotation/score_classify/add:0", shape=(22, 4), dtype=float32)
I0408 05:18:37.839550 139967323350912 s3gan.py:154] [Discriminator] (22, 2) -> aux_logits=(22, 2), y_predicted=(22, 2)
---------------------------------------------------s3gan.py/get_class_embedding,s
I0408 05:18:37.845966 139967323350912 s3gan.py:175] [Discriminator] embedded_y for projection: (22, 1536)
---------------------------------------------------s3gan.py/get_class_embedding,e
---------------------------------------------------s3gan.py/discriminator_with_additonal_heads,e
---------------------------------------------------s3gan.py/create_loss,e
---------------------------------------------------modular_gan.py/create_logits,e
################################################## mode == tf.estimator.ModeKeys.EVAL  ########################
INFO:tensorflow:Done calling model_fn.
I0408 05:18:37.952677 139967323350912 estimator.py:1171] Done calling model_fn.
INFO:tensorflow:Starting evaluation at 2020-04-08T05:18:37Z
I0408 05:18:37.969680 139967323350912 evaluation.py:255] Starting evaluation at 2020-04-08T05:18:37Z
INFO:tensorflow:Graph was finalized.
I0408 05:18:38.119395 139967323350912 monitored_session.py:246] Graph was finalized.
2020-04-08 05:18:38.120022: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-04-08 05:18:38.120373: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:00:04.0 name: Tesla P4 computeCapability: 6.1
coreClock: 1.1135GHz coreCount: 20 deviceMemorySize: 7.43GiB deviceMemoryBandwidth: 178.99GiB/s
2020-04-08 05:18:38.120427: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.1
2020-04-08 05:18:38.120454: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10
2020-04-08 05:18:38.120481: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcufft.so.10
2020-04-08 05:18:38.120502: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcurand.so.10
2020-04-08 05:18:38.120517: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusolver.so.10
2020-04-08 05:18:38.120575: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusparse.so.10
2020-04-08 05:18:38.120596: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudnn.so.7
2020-04-08 05:18:38.120690: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-04-08 05:18:38.120974: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-04-08 05:18:38.121208: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1703] Adding visible gpu devices: 0
2020-04-08 05:18:38.121254: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-04-08 05:18:38.121270: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      0 
2020-04-08 05:18:38.121282: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1121] 0:   N 
2020-04-08 05:18:38.121388: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-04-08 05:18:38.121674: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-04-08 05:18:38.121966: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1247] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 6850 MB memory) -> physical GPU (device: 0, name: Tesla P4, pci bus id: 0000:00:04.0, compute capability: 6.1)
INFO:tensorflow:Restoring parameters from /tmp/absl_testing/550760/model.ckpt-3027
I0408 05:18:38.123398 139967323350912 saver.py:1293] Restoring parameters from /tmp/absl_testing/550760/model.ckpt-3027
INFO:tensorflow:Running local_init_op.
I0408 05:18:38.569671 139967323350912 session_manager.py:505] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
I0408 05:18:38.593110 139967323350912 session_manager.py:508] Done running local_init_op.
INFO:tensorflow:Evaluation [5/50]
I0408 05:18:42.055426 139967323350912 evaluation.py:167] Evaluation [5/50]
INFO:tensorflow:Evaluation [10/50]
I0408 05:18:44.035926 139967323350912 evaluation.py:167] Evaluation [10/50]
INFO:tensorflow:Evaluation [15/50]
I0408 05:18:45.448859 139967323350912 evaluation.py:167] Evaluation [15/50]
INFO:tensorflow:Evaluation [20/50]
I0408 05:18:47.035797 139967323350912 evaluation.py:167] Evaluation [20/50]
INFO:tensorflow:Evaluation [25/50]
I0408 05:18:48.720396 139967323350912 evaluation.py:167] Evaluation [25/50]
INFO:tensorflow:Evaluation [30/50]
I0408 05:18:50.136537 139967323350912 evaluation.py:167] Evaluation [30/50]
INFO:tensorflow:Evaluation [35/50]
I0408 05:18:51.536046 139967323350912 evaluation.py:167] Evaluation [35/50]
INFO:tensorflow:Evaluation [40/50]
I0408 05:18:52.950484 139967323350912 evaluation.py:167] Evaluation [40/50]
INFO:tensorflow:Evaluation [45/50]
I0408 05:18:54.356559 139967323350912 evaluation.py:167] Evaluation [45/50]
INFO:tensorflow:Evaluation [50/50]
I0408 05:18:55.766728 139967323350912 evaluation.py:167] Evaluation [50/50]
INFO:tensorflow:Inference Time : 18.00212s
I0408 05:18:55.971972 139967323350912 evaluation.py:273] Inference Time : 18.00212s
INFO:tensorflow:Finished evaluation at 2020-04-08-05:18:55
I0408 05:18:55.972226 139967323350912 evaluation.py:276] Finished evaluation at 2020-04-08-05:18:55
INFO:tensorflow:Saving dict for global step 3027: accuracy = 0.65, global_step = 3027, loss = 0.07052995
I0408 05:18:55.972380 139967323350912 estimator.py:2066] Saving dict for global step 3027: accuracy = 0.65, global_step = 3027, loss = 0.07052995
INFO:tensorflow:Saving 'checkpoint_path' summary for global step 3027: /tmp/absl_testing/550760/model.ckpt-3027
I0408 05:18:55.972796 139967323350912 estimator.py:2127] Saving 'checkpoint_path' summary for global step 3027: /tmp/absl_testing/550760/model.ckpt-3027
INFO:tensorflow:global_step/sec: 0.542074
I0408 05:20:44.444257 139967323350912 basic_session_run_hooks.py:702] global_step/sec: 0.542074
INFO:tensorflow:loss = 1.2869087, step = 3100 (184.478 sec)
I0408 05:20:44.446498 139967323350912 basic_session_run_hooks.py:260] loss = 1.2869087, step = 3100 (184.478 sec)
INFO:tensorflow:global_step/sec: 0.682689
I0408 05:23:10.923872 139967323350912 basic_session_run_hooks.py:702] global_step/sec: 0.682689
INFO:tensorflow:loss = 0.0070383046, step = 3200 (146.479 sec)
I0408 05:23:10.925022 139967323350912 basic_session_run_hooks.py:260] loss = 0.0070383046, step = 3200 (146.479 sec)
INFO:tensorflow:global_step/sec: 0.682478
I0408 05:25:37.448613 139967323350912 basic_session_run_hooks.py:702] global_step/sec: 0.682478
INFO:tensorflow:loss = 0.049301397, step = 3300 (146.525 sec)
I0408 05:25:37.449784 139967323350912 basic_session_run_hooks.py:260] loss = 0.049301397, step = 3300 (146.525 sec)
INFO:tensorflow:global_step/sec: 0.683023
I0408 05:28:03.856571 139967323350912 basic_session_run_hooks.py:702] global_step/sec: 0.683023
INFO:tensorflow:loss = 0.0024888937, step = 3400 (146.408 sec)
I0408 05:28:03.857767 139967323350912 basic_session_run_hooks.py:260] loss = 0.0024888937, step = 3400 (146.408 sec)
INFO:tensorflow:Calling checkpoint listeners before saving checkpoint 3411...
I0408 05:28:18.494076 139967323350912 basic_session_run_hooks.py:614] Calling checkpoint listeners before saving checkpoint 3411...
INFO:tensorflow:Saving checkpoints for 3411 into /tmp/absl_testing/550760/model.ckpt.
I0408 05:28:18.494340 139967323350912 basic_session_run_hooks.py:618] Saving checkpoints for 3411 into /tmp/absl_testing/550760/model.ckpt.
INFO:tensorflow:Calling checkpoint listeners after saving checkpoint 3411...
I0408 05:28:35.812857 139967323350912 basic_session_run_hooks.py:626] Calling checkpoint listeners after saving checkpoint 3411...
INFO:tensorflow:Skip the current checkpoint eval due to throttle secs (600 secs).
I0408 05:28:35.813210 139967323350912 training.py:528] Skip the current checkpoint eval due to throttle secs (600 secs).
INFO:tensorflow:global_step/sec: 0.610842
I0408 05:30:47.565139 139967323350912 basic_session_run_hooks.py:702] global_step/sec: 0.610842
INFO:tensorflow:loss = 0.16146113, step = 3500 (163.708 sec)
I0408 05:30:47.566181 139967323350912 basic_session_run_hooks.py:260] loss = 0.16146113, step = 3500 (163.708 sec)
INFO:tensorflow:global_step/sec: 0.683339
I0408 05:33:13.905381 139967323350912 basic_session_run_hooks.py:702] global_step/sec: 0.683339
INFO:tensorflow:loss = 0.3763828, step = 3600 (146.340 sec)
I0408 05:33:13.906583 139967323350912 basic_session_run_hooks.py:260] loss = 0.3763828, step = 3600 (146.340 sec)
INFO:tensorflow:global_step/sec: 0.682043
I0408 05:35:40.523764 139967323350912 basic_session_run_hooks.py:702] global_step/sec: 0.682043
INFO:tensorflow:loss = 0.0010316873, step = 3700 (146.618 sec)
I0408 05:35:40.524929 139967323350912 basic_session_run_hooks.py:260] loss = 0.0010316873, step = 3700 (146.618 sec)
INFO:tensorflow:global_step/sec: 0.68302
I0408 05:38:06.932362 139967323350912 basic_session_run_hooks.py:702] global_step/sec: 0.68302
INFO:tensorflow:loss = 0.33782858, step = 3800 (146.409 sec)
I0408 05:38:06.933555 139967323350912 basic_session_run_hooks.py:260] loss = 0.33782858, step = 3800 (146.409 sec)
INFO:tensorflow:Calling checkpoint listeners before saving checkpoint 3809...
I0408 05:38:18.651798 139967323350912 basic_session_run_hooks.py:614] Calling checkpoint listeners before saving checkpoint 3809...
INFO:tensorflow:Saving checkpoints for 3809 into /tmp/absl_testing/550760/model.ckpt.
I0408 05:38:18.652089 139967323350912 basic_session_run_hooks.py:618] Saving checkpoints for 3809 into /tmp/absl_testing/550760/model.ckpt.
INFO:tensorflow:Calling checkpoint listeners after saving checkpoint 3809...
I0408 05:38:33.938748 139967323350912 basic_session_run_hooks.py:626] Calling checkpoint listeners after saving checkpoint 3809...
--------------------------------------------datasets.py/eval_input_fn,s
W0408 05:38:33.945366 139967323350912 datasets.py:170] No TPUContext, using unmodified dataset seed 547.
I0408 05:38:33.945511 139967323350912 datasets.py:348] eval_input_fn(): params={'use_tpu': False, 'train_batch_size': 8, 'batch_size': 8} seed=547
--------befor self._load_dataset------------------split = validation self._eval_split= validation
--------------------------------------------datasets.py/_load_dataset,s
!!!!!!!!!!!!!!!!!!!!!!----load_local_datasets,  _local_test_ds_dir= /content/drive/My Drive/drive/gan/test
-----------------------------------------get_local_datasets,s
-----------------------------------------get_local_datasets,e
--------------------------------------------modular_gan.py/_preprocess_fn,s
I0408 05:38:34.028908 139967323350912 api.py:587] _preprocess_fn(): images=Tensor("args_0:0", shape=(128, 128, 3), dtype=float32), labels=Tensor("args_1:0", shape=(), dtype=int32), seed=547
--------------------------------------------modular_gan.py/_preprocess_fn,e
I0408 05:38:34.057025 139967323350912 api.py:587] Passing random offset: Tensor("Cast:0", shape=(), dtype=int32) with data ({'images': <tf.Tensor 'args_1:0' shape=(128, 128, 3) dtype=float32>, 'z': <tf.Tensor 'args_3:0' shape=(120,) dtype=float32>, 'sampled_labels': <tf.Tensor 'args_2:0' shape=() dtype=int32>}, <tf.Tensor 'args_4:0' shape=() dtype=int32>).
--------------------------------------------datasets.py/eval_input_fn,e
INFO:tensorflow:Calling model_fn.
I0408 05:38:34.073547 139967323350912 estimator.py:1169] Calling model_fn.
--------------------------------------------modular_gan.py/model_fn,s
I0408 05:38:34.073698 139967323350912 modular_gan.py:568] model_fn(): features={'images': <tf.Tensor 'IteratorGetNext:1' shape=(8, 128, 128, 3) dtype=float32>, 'z': <tf.Tensor 'IteratorGetNext:3' shape=(8, 120) dtype=float32>, 'sampled_labels': <tf.Tensor 'IteratorGetNext:2' shape=(8,) dtype=int32>, '_RANDOM_OFFSET': <tf.Tensor 'IteratorGetNext:0' shape=(8,) dtype=int32>}, labels=Tensor("IteratorGetNext:4", shape=(8,), dtype=int32),mode=eval, params={'use_tpu': False, 'train_batch_size': 8, 'batch_size': 8}
#Clean old summaries from previous calls to model_fn().
# Get features and labels for each sub-step.
--------------------------------------------modular_gan.py/_split_inputs_and_generate_samples,s
I0408 05:38:34.080323 139967323350912 resnet_biggan.py:236] [Generator] inputs are z=(8, 120), y=(8, 2)
I0408 05:38:34.090266 139967323350912 resnet_biggan.py:262] [Generator] z0=(8, 20), z_per_block=['(8, 20)', '(8, 20)', '(8, 20)', '(8, 20)', '(8, 20)'], y_per_block=['(8, 148)', '(8, 148)', '(8, 148)', '(8, 148)', '(8, 148)']
I0408 05:38:34.137062 139967323350912 resnet_biggan.py:150] [Block] (8, 4, 4, 1536) (z=(8, 20), y=(8, 148)) -> (8, 8, 8, 1536)
I0408 05:38:34.177576 139967323350912 resnet_biggan.py:150] [Block] (8, 8, 8, 1536) (z=(8, 20), y=(8, 148)) -> (8, 16, 16, 768)
I0408 05:38:34.219700 139967323350912 resnet_biggan.py:150] [Block] (8, 16, 16, 768) (z=(8, 20), y=(8, 148)) -> (8, 32, 32, 384)
I0408 05:38:34.257421 139967323350912 resnet_biggan.py:150] [Block] (8, 32, 32, 384) (z=(8, 20), y=(8, 148)) -> (8, 64, 64, 192)
I0408 05:38:34.257574 139967323350912 resnet_biggan.py:289] [Generator] Applying non-local block to (8, 64, 64, 192)
I0408 05:38:34.334010 139967323350912 resnet_biggan.py:150] [Block] (8, 64, 64, 192) (z=(8, 20), y=(8, 148)) -> (8, 128, 128, 96)
I0408 05:38:34.334199 139967323350912 resnet_biggan.py:294] [Generator] before final processing: (8, 128, 128, 96)
I0408 05:38:34.365466 139967323350912 resnet_biggan.py:300] [Generator] after final processing: (8, 128, 128, 3)
--------------------------------------------modular_gan.py/_split_inputs_and_generate_samples,e
---------------------------------------------------modular_gan.py/create_logits,s
I0408 05:38:34.370646 139967323350912 tpu_random.py:86] Got global random offset: Tensor("strided_slice:0", shape=(), dtype=int32)
---------------------------------------------------s3gan.py/create_loss,s
W0408 05:38:34.373517 139967323350912 s3gan.py:237] Computing fake images for every sub step separately.
I0408 05:38:34.373713 139967323350912 resnet_biggan.py:236] [Generator] inputs are z=(8, 120), y=(8, 2)
I0408 05:38:34.379236 139967323350912 resnet_biggan.py:262] [Generator] z0=(8, 20), z_per_block=['(8, 20)', '(8, 20)', '(8, 20)', '(8, 20)', '(8, 20)'], y_per_block=['(8, 148)', '(8, 148)', '(8, 148)', '(8, 148)', '(8, 148)']
I0408 05:38:34.397668 139967323350912 resnet_biggan.py:150] [Block] (8, 4, 4, 1536) (z=(8, 20), y=(8, 148)) -> (8, 8, 8, 1536)
I0408 05:38:34.413444 139967323350912 resnet_biggan.py:150] [Block] (8, 8, 8, 1536) (z=(8, 20), y=(8, 148)) -> (8, 16, 16, 768)
I0408 05:38:34.430054 139967323350912 resnet_biggan.py:150] [Block] (8, 16, 16, 768) (z=(8, 20), y=(8, 148)) -> (8, 32, 32, 384)
I0408 05:38:34.446060 139967323350912 resnet_biggan.py:150] [Block] (8, 32, 32, 384) (z=(8, 20), y=(8, 148)) -> (8, 64, 64, 192)
I0408 05:38:34.446218 139967323350912 resnet_biggan.py:289] [Generator] Applying non-local block to (8, 64, 64, 192)
I0408 05:38:34.478959 139967323350912 resnet_biggan.py:150] [Block] (8, 64, 64, 192) (z=(8, 20), y=(8, 148)) -> (8, 128, 128, 96)
I0408 05:38:34.479141 139967323350912 resnet_biggan.py:294] [Generator] before final processing: (8, 128, 128, 96)
I0408 05:38:34.493187 139967323350912 resnet_biggan.py:300] [Generator] after final processing: (8, 128, 128, 3)
I0408 05:38:34.494824 139967323350912 s3gan.py:249] bs=8, rotated_bs=4, num_rot_examples=1
---------------------------------------------------s3gan.py/merge_with_rotation_data,s
---------------------------------------------------s3gan.py/merge_with_rotation_data,e
--------------------------------------------------------------------s3gan.py/discriminator_with_additonal_heads,s
I0408 05:38:34.520337 139967323350912 resnet_biggan.py:379] [Discriminator] inputs are x=(22, 128, 128, 3), y=(22, 2)
I0408 05:38:34.552420 139967323350912 resnet_biggan.py:150] [Block] (22, 128, 128, 3) (z=None, y=(22, 2)) -> (22, 64, 64, 96)
I0408 05:38:34.552572 139967323350912 resnet_biggan.py:398] [Discriminator] Applying non-local block to (22, 64, 64, 96)
I0408 05:38:34.642793 139967323350912 resnet_biggan.py:150] [Block] (22, 64, 64, 96) (z=None, y=(22, 2)) -> (22, 32, 32, 192)
I0408 05:38:34.677655 139967323350912 resnet_biggan.py:150] [Block] (22, 32, 32, 192) (z=None, y=(22, 2)) -> (22, 16, 16, 384)
I0408 05:38:34.710314 139967323350912 resnet_biggan.py:150] [Block] (22, 16, 16, 384) (z=None, y=(22, 2)) -> (22, 8, 8, 768)
I0408 05:38:34.745751 139967323350912 resnet_biggan.py:150] [Block] (22, 8, 8, 768) (z=None, y=(22, 2)) -> (22, 4, 4, 1536)
I0408 05:38:34.766963 139967323350912 resnet_biggan.py:150] [Block] (22, 4, 4, 1536) (z=None, y=(22, 2)) -> (22, 4, 4, 1536)
I0408 05:38:34.767142 139967323350912 resnet_biggan.py:403] [Discriminator] before final processing: (22, 4, 4, 1536)
I0408 05:38:34.779541 139967323350912 resnet_biggan.py:407] [Discriminator] after final processing: (22, 4, 4, 1536)
I0408 05:38:34.787026 139967323350912 resnet_biggan.py:422] [Discriminator] embedded_y for projection: (22, 1536)
I0408 05:38:34.800905 139967323350912 s3gan.py:133] [Discriminator] rotation head (22, 1536) -> Tensor("discriminator_rotation/score_classify/add:0", shape=(22, 4), dtype=float32)
I0408 05:38:34.815930 139967323350912 s3gan.py:154] [Discriminator] (22, 2) -> aux_logits=(22, 2), y_predicted=(22, 2)
---------------------------------------------------s3gan.py/get_class_embedding,s
I0408 05:38:34.824030 139967323350912 s3gan.py:175] [Discriminator] embedded_y for projection: (22, 1536)
---------------------------------------------------s3gan.py/get_class_embedding,e
---------------------------------------------------s3gan.py/discriminator_with_additonal_heads,e
---------------------------------------------------s3gan.py/create_loss,e
---------------------------------------------------modular_gan.py/create_logits,e
################################################## mode == tf.estimator.ModeKeys.EVAL  ########################
INFO:tensorflow:Done calling model_fn.
I0408 05:38:34.942074 139967323350912 estimator.py:1171] Done calling model_fn.
INFO:tensorflow:Starting evaluation at 2020-04-08T05:38:34Z
I0408 05:38:34.958955 139967323350912 evaluation.py:255] Starting evaluation at 2020-04-08T05:38:34Z
INFO:tensorflow:Graph was finalized.
I0408 05:38:35.184834 139967323350912 monitored_session.py:246] Graph was finalized.
2020-04-08 05:38:35.185677: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-04-08 05:38:35.186017: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:00:04.0 name: Tesla P4 computeCapability: 6.1
coreClock: 1.1135GHz coreCount: 20 deviceMemorySize: 7.43GiB deviceMemoryBandwidth: 178.99GiB/s
2020-04-08 05:38:35.186081: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.1
2020-04-08 05:38:35.186109: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10
2020-04-08 05:38:35.186157: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcufft.so.10
2020-04-08 05:38:35.186176: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcurand.so.10
2020-04-08 05:38:35.186195: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusolver.so.10
2020-04-08 05:38:35.186246: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusparse.so.10
2020-04-08 05:38:35.186266: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudnn.so.7
2020-04-08 05:38:35.186352: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-04-08 05:38:35.186652: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-04-08 05:38:35.186872: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1703] Adding visible gpu devices: 0
2020-04-08 05:38:35.186937: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-04-08 05:38:35.186953: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      0 
2020-04-08 05:38:35.186966: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1121] 0:   N 
2020-04-08 05:38:35.187076: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-04-08 05:38:35.187366: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-04-08 05:38:35.187610: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1247] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 6850 MB memory) -> physical GPU (device: 0, name: Tesla P4, pci bus id: 0000:00:04.0, compute capability: 6.1)
INFO:tensorflow:Restoring parameters from /tmp/absl_testing/550760/model.ckpt-3809
I0408 05:38:35.188620 139967323350912 saver.py:1293] Restoring parameters from /tmp/absl_testing/550760/model.ckpt-3809
INFO:tensorflow:Running local_init_op.
I0408 05:38:35.590538 139967323350912 session_manager.py:505] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
I0408 05:38:35.612606 139967323350912 session_manager.py:508] Done running local_init_op.
INFO:tensorflow:Evaluation [5/50]
I0408 05:38:39.767968 139967323350912 evaluation.py:167] Evaluation [5/50]
INFO:tensorflow:Evaluation [10/50]
I0408 05:38:41.184519 139967323350912 evaluation.py:167] Evaluation [10/50]
INFO:tensorflow:Evaluation [15/50]
I0408 05:38:42.604033 139967323350912 evaluation.py:167] Evaluation [15/50]
INFO:tensorflow:Evaluation [20/50]
I0408 05:38:44.024868 139967323350912 evaluation.py:167] Evaluation [20/50]
INFO:tensorflow:Evaluation [25/50]
I0408 05:38:45.455434 139967323350912 evaluation.py:167] Evaluation [25/50]
INFO:tensorflow:Evaluation [30/50]
I0408 05:38:46.872699 139967323350912 evaluation.py:167] Evaluation [30/50]
INFO:tensorflow:Evaluation [35/50]
I0408 05:38:48.307423 139967323350912 evaluation.py:167] Evaluation [35/50]
INFO:tensorflow:Evaluation [40/50]
I0408 05:38:49.720733 139967323350912 evaluation.py:167] Evaluation [40/50]
INFO:tensorflow:Evaluation [45/50]
I0408 05:38:51.133846 139967323350912 evaluation.py:167] Evaluation [45/50]
INFO:tensorflow:Evaluation [50/50]
I0408 05:38:52.555312 139967323350912 evaluation.py:167] Evaluation [50/50]
INFO:tensorflow:Inference Time : 17.64828s
I0408 05:38:52.607411 139967323350912 evaluation.py:273] Inference Time : 17.64828s
INFO:tensorflow:Finished evaluation at 2020-04-08-05:38:52
I0408 05:38:52.607643 139967323350912 evaluation.py:276] Finished evaluation at 2020-04-08-05:38:52
INFO:tensorflow:Saving dict for global step 3809: accuracy = 0.65, global_step = 3809, loss = 0.21925695
I0408 05:38:52.607797 139967323350912 estimator.py:2066] Saving dict for global step 3809: accuracy = 0.65, global_step = 3809, loss = 0.21925695
INFO:tensorflow:Saving 'checkpoint_path' summary for global step 3809: /tmp/absl_testing/550760/model.ckpt-3809
I0408 05:38:52.626166 139967323350912 estimator.py:2127] Saving 'checkpoint_path' summary for global step 3809: /tmp/absl_testing/550760/model.ckpt-3809
INFO:tensorflow:global_step/sec: 0.554099
I0408 05:41:07.405546 139967323350912 basic_session_run_hooks.py:702] global_step/sec: 0.554099
INFO:tensorflow:loss = 0.1396707, step = 3900 (180.483 sec)
I0408 05:41:07.416637 139967323350912 basic_session_run_hooks.py:260] loss = 0.1396707, step = 3900 (180.483 sec)
INFO:tensorflow:global_step/sec: 0.683271
I0408 05:43:33.760469 139967323350912 basic_session_run_hooks.py:702] global_step/sec: 0.683271
INFO:tensorflow:loss = 0.012049771, step = 4000 (146.348 sec)
I0408 05:43:33.764970 139967323350912 basic_session_run_hooks.py:260] loss = 0.012049771, step = 4000 (146.348 sec)
INFO:tensorflow:global_step/sec: 0.68306
I0408 05:46:00.160555 139967323350912 basic_session_run_hooks.py:702] global_step/sec: 0.68306
INFO:tensorflow:loss = 0.0050767562, step = 4100 (146.397 sec)
I0408 05:46:00.161680 139967323350912 basic_session_run_hooks.py:260] loss = 0.0050767562, step = 4100 (146.397 sec)
INFO:tensorflow:Calling checkpoint listeners before saving checkpoint 4196...
I0408 05:48:19.279037 139967323350912 basic_session_run_hooks.py:614] Calling checkpoint listeners before saving checkpoint 4196...
INFO:tensorflow:Saving checkpoints for 4196 into /tmp/absl_testing/550760/model.ckpt.
I0408 05:48:19.279296 139967323350912 basic_session_run_hooks.py:618] Saving checkpoints for 4196 into /tmp/absl_testing/550760/model.ckpt.
INFO:tensorflow:Calling checkpoint listeners after saving checkpoint 4196...
I0408 05:48:35.221478 139967323350912 basic_session_run_hooks.py:626] Calling checkpoint listeners after saving checkpoint 4196...
--------------------------------------------datasets.py/eval_input_fn,s
W0408 05:48:35.227614 139967323350912 datasets.py:170] No TPUContext, using unmodified dataset seed 547.
I0408 05:48:35.227746 139967323350912 datasets.py:348] eval_input_fn(): params={'use_tpu': False, 'train_batch_size': 8, 'batch_size': 8} seed=547
--------befor self._load_dataset------------------split = validation self._eval_split= validation
--------------------------------------------datasets.py/_load_dataset,s
!!!!!!!!!!!!!!!!!!!!!!----load_local_datasets,  _local_test_ds_dir= /content/drive/My Drive/drive/gan/test
-----------------------------------------get_local_datasets,s
-----------------------------------------get_local_datasets,e
--------------------------------------------modular_gan.py/_preprocess_fn,s
I0408 05:48:35.307550 139967323350912 api.py:587] _preprocess_fn(): images=Tensor("args_0:0", shape=(128, 128, 3), dtype=float32), labels=Tensor("args_1:0", shape=(), dtype=int32), seed=547
--------------------------------------------modular_gan.py/_preprocess_fn,e
I0408 05:48:35.336550 139967323350912 api.py:587] Passing random offset: Tensor("Cast:0", shape=(), dtype=int32) with data ({'images': <tf.Tensor 'args_1:0' shape=(128, 128, 3) dtype=float32>, 'z': <tf.Tensor 'args_3:0' shape=(120,) dtype=float32>, 'sampled_labels': <tf.Tensor 'args_2:0' shape=() dtype=int32>}, <tf.Tensor 'args_4:0' shape=() dtype=int32>).
--------------------------------------------datasets.py/eval_input_fn,e
INFO:tensorflow:Calling model_fn.
I0408 05:48:35.352151 139967323350912 estimator.py:1169] Calling model_fn.
--------------------------------------------modular_gan.py/model_fn,s
I0408 05:48:35.352310 139967323350912 modular_gan.py:568] model_fn(): features={'images': <tf.Tensor 'IteratorGetNext:1' shape=(8, 128, 128, 3) dtype=float32>, 'z': <tf.Tensor 'IteratorGetNext:3' shape=(8, 120) dtype=float32>, 'sampled_labels': <tf.Tensor 'IteratorGetNext:2' shape=(8,) dtype=int32>, '_RANDOM_OFFSET': <tf.Tensor 'IteratorGetNext:0' shape=(8,) dtype=int32>}, labels=Tensor("IteratorGetNext:4", shape=(8,), dtype=int32),mode=eval, params={'use_tpu': False, 'train_batch_size': 8, 'batch_size': 8}
#Clean old summaries from previous calls to model_fn().
# Get features and labels for each sub-step.
--------------------------------------------modular_gan.py/_split_inputs_and_generate_samples,s
I0408 05:48:35.358946 139967323350912 resnet_biggan.py:236] [Generator] inputs are z=(8, 120), y=(8, 2)
I0408 05:48:35.369306 139967323350912 resnet_biggan.py:262] [Generator] z0=(8, 20), z_per_block=['(8, 20)', '(8, 20)', '(8, 20)', '(8, 20)', '(8, 20)'], y_per_block=['(8, 148)', '(8, 148)', '(8, 148)', '(8, 148)', '(8, 148)']
I0408 05:48:35.415926 139967323350912 resnet_biggan.py:150] [Block] (8, 4, 4, 1536) (z=(8, 20), y=(8, 148)) -> (8, 8, 8, 1536)
I0408 05:48:35.456670 139967323350912 resnet_biggan.py:150] [Block] (8, 8, 8, 1536) (z=(8, 20), y=(8, 148)) -> (8, 16, 16, 768)
I0408 05:48:35.494158 139967323350912 resnet_biggan.py:150] [Block] (8, 16, 16, 768) (z=(8, 20), y=(8, 148)) -> (8, 32, 32, 384)
I0408 05:48:35.532576 139967323350912 resnet_biggan.py:150] [Block] (8, 32, 32, 384) (z=(8, 20), y=(8, 148)) -> (8, 64, 64, 192)
I0408 05:48:35.532741 139967323350912 resnet_biggan.py:289] [Generator] Applying non-local block to (8, 64, 64, 192)
I0408 05:48:35.616672 139967323350912 resnet_biggan.py:150] [Block] (8, 64, 64, 192) (z=(8, 20), y=(8, 148)) -> (8, 128, 128, 96)
I0408 05:48:35.616847 139967323350912 resnet_biggan.py:294] [Generator] before final processing: (8, 128, 128, 96)
I0408 05:48:35.653480 139967323350912 resnet_biggan.py:300] [Generator] after final processing: (8, 128, 128, 3)
--------------------------------------------modular_gan.py/_split_inputs_and_generate_samples,e
---------------------------------------------------modular_gan.py/create_logits,s
I0408 05:48:35.657146 139967323350912 tpu_random.py:86] Got global random offset: Tensor("strided_slice:0", shape=(), dtype=int32)
---------------------------------------------------s3gan.py/create_loss,s
W0408 05:48:35.659965 139967323350912 s3gan.py:237] Computing fake images for every sub step separately.
I0408 05:48:35.660192 139967323350912 resnet_biggan.py:236] [Generator] inputs are z=(8, 120), y=(8, 2)
I0408 05:48:35.666065 139967323350912 resnet_biggan.py:262] [Generator] z0=(8, 20), z_per_block=['(8, 20)', '(8, 20)', '(8, 20)', '(8, 20)', '(8, 20)'], y_per_block=['(8, 148)', '(8, 148)', '(8, 148)', '(8, 148)', '(8, 148)']
I0408 05:48:35.685823 139967323350912 resnet_biggan.py:150] [Block] (8, 4, 4, 1536) (z=(8, 20), y=(8, 148)) -> (8, 8, 8, 1536)
I0408 05:48:35.703256 139967323350912 resnet_biggan.py:150] [Block] (8, 8, 8, 1536) (z=(8, 20), y=(8, 148)) -> (8, 16, 16, 768)
I0408 05:48:35.720712 139967323350912 resnet_biggan.py:150] [Block] (8, 16, 16, 768) (z=(8, 20), y=(8, 148)) -> (8, 32, 32, 384)
I0408 05:48:35.738878 139967323350912 resnet_biggan.py:150] [Block] (8, 32, 32, 384) (z=(8, 20), y=(8, 148)) -> (8, 64, 64, 192)
I0408 05:48:35.739027 139967323350912 resnet_biggan.py:289] [Generator] Applying non-local block to (8, 64, 64, 192)
I0408 05:48:35.773473 139967323350912 resnet_biggan.py:150] [Block] (8, 64, 64, 192) (z=(8, 20), y=(8, 148)) -> (8, 128, 128, 96)
I0408 05:48:35.773633 139967323350912 resnet_biggan.py:294] [Generator] before final processing: (8, 128, 128, 96)
I0408 05:48:35.788702 139967323350912 resnet_biggan.py:300] [Generator] after final processing: (8, 128, 128, 3)
I0408 05:48:35.790736 139967323350912 s3gan.py:249] bs=8, rotated_bs=4, num_rot_examples=1
---------------------------------------------------s3gan.py/merge_with_rotation_data,s
---------------------------------------------------s3gan.py/merge_with_rotation_data,e
--------------------------------------------------------------------s3gan.py/discriminator_with_additonal_heads,s
I0408 05:48:35.819228 139967323350912 resnet_biggan.py:379] [Discriminator] inputs are x=(22, 128, 128, 3), y=(22, 2)
I0408 05:48:35.860554 139967323350912 resnet_biggan.py:150] [Block] (22, 128, 128, 3) (z=None, y=(22, 2)) -> (22, 64, 64, 96)
I0408 05:48:35.860718 139967323350912 resnet_biggan.py:398] [Discriminator] Applying non-local block to (22, 64, 64, 96)
I0408 05:48:35.945444 139967323350912 resnet_biggan.py:150] [Block] (22, 64, 64, 96) (z=None, y=(22, 2)) -> (22, 32, 32, 192)
I0408 05:48:35.979309 139967323350912 resnet_biggan.py:150] [Block] (22, 32, 32, 192) (z=None, y=(22, 2)) -> (22, 16, 16, 384)
I0408 05:48:36.012761 139967323350912 resnet_biggan.py:150] [Block] (22, 16, 16, 384) (z=None, y=(22, 2)) -> (22, 8, 8, 768)
I0408 05:48:36.045842 139967323350912 resnet_biggan.py:150] [Block] (22, 8, 8, 768) (z=None, y=(22, 2)) -> (22, 4, 4, 1536)
I0408 05:48:36.066806 139967323350912 resnet_biggan.py:150] [Block] (22, 4, 4, 1536) (z=None, y=(22, 2)) -> (22, 4, 4, 1536)
I0408 05:48:36.066962 139967323350912 resnet_biggan.py:403] [Discriminator] before final processing: (22, 4, 4, 1536)
I0408 05:48:36.077730 139967323350912 resnet_biggan.py:407] [Discriminator] after final processing: (22, 4, 4, 1536)
I0408 05:48:36.083979 139967323350912 resnet_biggan.py:422] [Discriminator] embedded_y for projection: (22, 1536)
I0408 05:48:36.097071 139967323350912 s3gan.py:133] [Discriminator] rotation head (22, 1536) -> Tensor("discriminator_rotation/score_classify/add:0", shape=(22, 4), dtype=float32)
I0408 05:48:36.110924 139967323350912 s3gan.py:154] [Discriminator] (22, 2) -> aux_logits=(22, 2), y_predicted=(22, 2)
---------------------------------------------------s3gan.py/get_class_embedding,s
I0408 05:48:36.117365 139967323350912 s3gan.py:175] [Discriminator] embedded_y for projection: (22, 1536)
---------------------------------------------------s3gan.py/get_class_embedding,e
---------------------------------------------------s3gan.py/discriminator_with_additonal_heads,e
---------------------------------------------------s3gan.py/create_loss,e
---------------------------------------------------modular_gan.py/create_logits,e
################################################## mode == tf.estimator.ModeKeys.EVAL  ########################
INFO:tensorflow:Done calling model_fn.
I0408 05:48:36.236407 139967323350912 estimator.py:1171] Done calling model_fn.
INFO:tensorflow:Starting evaluation at 2020-04-08T05:48:36Z
I0408 05:48:36.252985 139967323350912 evaluation.py:255] Starting evaluation at 2020-04-08T05:48:36Z
INFO:tensorflow:Graph was finalized.
I0408 05:48:36.389501 139967323350912 monitored_session.py:246] Graph was finalized.
2020-04-08 05:48:36.390129: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-04-08 05:48:36.390446: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:00:04.0 name: Tesla P4 computeCapability: 6.1
coreClock: 1.1135GHz coreCount: 20 deviceMemorySize: 7.43GiB deviceMemoryBandwidth: 178.99GiB/s
2020-04-08 05:48:36.390499: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.1
2020-04-08 05:48:36.390522: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10
2020-04-08 05:48:36.390539: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcufft.so.10
2020-04-08 05:48:36.390555: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcurand.so.10
2020-04-08 05:48:36.390569: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusolver.so.10
2020-04-08 05:48:36.390615: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusparse.so.10
2020-04-08 05:48:36.390631: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudnn.so.7
2020-04-08 05:48:36.390711: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-04-08 05:48:36.390976: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-04-08 05:48:36.391212: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1703] Adding visible gpu devices: 0
2020-04-08 05:48:36.391263: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-04-08 05:48:36.391278: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      0 
2020-04-08 05:48:36.391288: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1121] 0:   N 
2020-04-08 05:48:36.391386: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-04-08 05:48:36.391649: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-04-08 05:48:36.391866: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1247] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 6850 MB memory) -> physical GPU (device: 0, name: Tesla P4, pci bus id: 0000:00:04.0, compute capability: 6.1)
INFO:tensorflow:Restoring parameters from /tmp/absl_testing/550760/model.ckpt-4196
I0408 05:48:36.392922 139967323350912 saver.py:1293] Restoring parameters from /tmp/absl_testing/550760/model.ckpt-4196
INFO:tensorflow:Running local_init_op.
I0408 05:48:36.829411 139967323350912 session_manager.py:505] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
I0408 05:48:36.853904 139967323350912 session_manager.py:508] Done running local_init_op.
INFO:tensorflow:Evaluation [5/50]
I0408 05:48:41.088420 139967323350912 evaluation.py:167] Evaluation [5/50]
INFO:tensorflow:Evaluation [10/50]
I0408 05:48:42.495511 139967323350912 evaluation.py:167] Evaluation [10/50]
INFO:tensorflow:Evaluation [15/50]
I0408 05:48:43.905020 139967323350912 evaluation.py:167] Evaluation [15/50]
INFO:tensorflow:Evaluation [20/50]
I0408 05:48:45.323279 139967323350912 evaluation.py:167] Evaluation [20/50]
INFO:tensorflow:Evaluation [25/50]
I0408 05:48:47.128853 139967323350912 evaluation.py:167] Evaluation [25/50]
INFO:tensorflow:Evaluation [30/50]
I0408 05:48:48.558078 139967323350912 evaluation.py:167] Evaluation [30/50]
INFO:tensorflow:Evaluation [35/50]
I0408 05:48:49.969107 139967323350912 evaluation.py:167] Evaluation [35/50]
INFO:tensorflow:Evaluation [40/50]
I0408 05:48:51.387512 139967323350912 evaluation.py:167] Evaluation [40/50]
INFO:tensorflow:Evaluation [45/50]
I0408 05:48:52.804154 139967323350912 evaluation.py:167] Evaluation [45/50]
INFO:tensorflow:Evaluation [50/50]
I0408 05:48:54.219644 139967323350912 evaluation.py:167] Evaluation [50/50]
INFO:tensorflow:Inference Time : 18.01452s
I0408 05:48:54.267670 139967323350912 evaluation.py:273] Inference Time : 18.01452s
INFO:tensorflow:Finished evaluation at 2020-04-08-05:48:54
I0408 05:48:54.267858 139967323350912 evaluation.py:276] Finished evaluation at 2020-04-08-05:48:54
INFO:tensorflow:Saving dict for global step 4196: accuracy = 0.645, global_step = 4196, loss = 0.02378651
I0408 05:48:54.267988 139967323350912 estimator.py:2066] Saving dict for global step 4196: accuracy = 0.645, global_step = 4196, loss = 0.02378651
INFO:tensorflow:Saving 'checkpoint_path' summary for global step 4196: /tmp/absl_testing/550760/model.ckpt-4196
I0408 05:48:54.268422 139967323350912 estimator.py:2127] Saving 'checkpoint_path' summary for global step 4196: /tmp/absl_testing/550760/model.ckpt-4196
INFO:tensorflow:global_step/sec: 0.551264
I0408 05:49:01.561888 139967323350912 basic_session_run_hooks.py:702] global_step/sec: 0.551264
INFO:tensorflow:loss = 0.0009312619, step = 4200 (181.401 sec)
I0408 05:49:01.562904 139967323350912 basic_session_run_hooks.py:260] loss = 0.0009312619, step = 4200 (181.401 sec)
INFO:tensorflow:global_step/sec: 0.682625
I0408 05:51:28.055342 139967323350912 basic_session_run_hooks.py:702] global_step/sec: 0.682625
INFO:tensorflow:loss = 0.019976925, step = 4300 (146.493 sec)
I0408 05:51:28.056371 139967323350912 basic_session_run_hooks.py:260] loss = 0.019976925, step = 4300 (146.493 sec)
INFO:tensorflow:global_step/sec: 0.682656
I0408 05:53:54.542346 139967323350912 basic_session_run_hooks.py:702] global_step/sec: 0.682656
INFO:tensorflow:loss = 0.00030159115, step = 4400 (146.488 sec)
I0408 05:53:54.544062 139967323350912 basic_session_run_hooks.py:260] loss = 0.00030159115, step = 4400 (146.488 sec)
INFO:tensorflow:global_step/sec: 0.682686
I0408 05:56:21.022224 139967323350912 basic_session_run_hooks.py:702] global_step/sec: 0.682686
INFO:tensorflow:loss = 0.002322589, step = 4500 (146.479 sec)
I0408 05:56:21.023402 139967323350912 basic_session_run_hooks.py:260] loss = 0.002322589, step = 4500 (146.479 sec)
INFO:tensorflow:Calling checkpoint listeners before saving checkpoint 4582...
I0408 05:58:19.725396 139967323350912 basic_session_run_hooks.py:614] Calling checkpoint listeners before saving checkpoint 4582...
INFO:tensorflow:Saving checkpoints for 4582 into /tmp/absl_testing/550760/model.ckpt.
I0408 05:58:19.725720 139967323350912 basic_session_run_hooks.py:618] Saving checkpoints for 4582 into /tmp/absl_testing/550760/model.ckpt.
INFO:tensorflow:Calling checkpoint listeners after saving checkpoint 4582...
I0408 05:58:38.190817 139967323350912 basic_session_run_hooks.py:626] Calling checkpoint listeners after saving checkpoint 4582...
--------------------------------------------datasets.py/eval_input_fn,s
W0408 05:58:38.202462 139967323350912 datasets.py:170] No TPUContext, using unmodified dataset seed 547.
I0408 05:58:38.202609 139967323350912 datasets.py:348] eval_input_fn(): params={'use_tpu': False, 'train_batch_size': 8, 'batch_size': 8} seed=547
--------befor self._load_dataset------------------split = validation self._eval_split= validation
--------------------------------------------datasets.py/_load_dataset,s
!!!!!!!!!!!!!!!!!!!!!!----load_local_datasets,  _local_test_ds_dir= /content/drive/My Drive/drive/gan/test
-----------------------------------------get_local_datasets,s
-----------------------------------------get_local_datasets,e
--------------------------------------------modular_gan.py/_preprocess_fn,s
I0408 05:58:38.288406 139967323350912 api.py:587] _preprocess_fn(): images=Tensor("args_0:0", shape=(128, 128, 3), dtype=float32), labels=Tensor("args_1:0", shape=(), dtype=int32), seed=547
--------------------------------------------modular_gan.py/_preprocess_fn,e
I0408 05:58:38.319602 139967323350912 api.py:587] Passing random offset: Tensor("Cast:0", shape=(), dtype=int32) with data ({'images': <tf.Tensor 'args_1:0' shape=(128, 128, 3) dtype=float32>, 'z': <tf.Tensor 'args_3:0' shape=(120,) dtype=float32>, 'sampled_labels': <tf.Tensor 'args_2:0' shape=() dtype=int32>}, <tf.Tensor 'args_4:0' shape=() dtype=int32>).
--------------------------------------------datasets.py/eval_input_fn,e
INFO:tensorflow:Calling model_fn.
I0408 05:58:38.335289 139967323350912 estimator.py:1169] Calling model_fn.
--------------------------------------------modular_gan.py/model_fn,s
I0408 05:58:38.335444 139967323350912 modular_gan.py:568] model_fn(): features={'images': <tf.Tensor 'IteratorGetNext:1' shape=(8, 128, 128, 3) dtype=float32>, 'z': <tf.Tensor 'IteratorGetNext:3' shape=(8, 120) dtype=float32>, 'sampled_labels': <tf.Tensor 'IteratorGetNext:2' shape=(8,) dtype=int32>, '_RANDOM_OFFSET': <tf.Tensor 'IteratorGetNext:0' shape=(8,) dtype=int32>}, labels=Tensor("IteratorGetNext:4", shape=(8,), dtype=int32),mode=eval, params={'use_tpu': False, 'train_batch_size': 8, 'batch_size': 8}
#Clean old summaries from previous calls to model_fn().
# Get features and labels for each sub-step.
--------------------------------------------modular_gan.py/_split_inputs_and_generate_samples,s
I0408 05:58:38.342103 139967323350912 resnet_biggan.py:236] [Generator] inputs are z=(8, 120), y=(8, 2)
I0408 05:58:38.351989 139967323350912 resnet_biggan.py:262] [Generator] z0=(8, 20), z_per_block=['(8, 20)', '(8, 20)', '(8, 20)', '(8, 20)', '(8, 20)'], y_per_block=['(8, 148)', '(8, 148)', '(8, 148)', '(8, 148)', '(8, 148)']
I0408 05:58:38.398175 139967323350912 resnet_biggan.py:150] [Block] (8, 4, 4, 1536) (z=(8, 20), y=(8, 148)) -> (8, 8, 8, 1536)
I0408 05:58:38.435040 139967323350912 resnet_biggan.py:150] [Block] (8, 8, 8, 1536) (z=(8, 20), y=(8, 148)) -> (8, 16, 16, 768)
I0408 05:58:38.475857 139967323350912 resnet_biggan.py:150] [Block] (8, 16, 16, 768) (z=(8, 20), y=(8, 148)) -> (8, 32, 32, 384)
I0408 05:58:38.519631 139967323350912 resnet_biggan.py:150] [Block] (8, 32, 32, 384) (z=(8, 20), y=(8, 148)) -> (8, 64, 64, 192)
I0408 05:58:38.519817 139967323350912 resnet_biggan.py:289] [Generator] Applying non-local block to (8, 64, 64, 192)
I0408 05:58:38.607195 139967323350912 resnet_biggan.py:150] [Block] (8, 64, 64, 192) (z=(8, 20), y=(8, 148)) -> (8, 128, 128, 96)
I0408 05:58:38.607355 139967323350912 resnet_biggan.py:294] [Generator] before final processing: (8, 128, 128, 96)
I0408 05:58:38.640528 139967323350912 resnet_biggan.py:300] [Generator] after final processing: (8, 128, 128, 3)
--------------------------------------------modular_gan.py/_split_inputs_and_generate_samples,e
---------------------------------------------------modular_gan.py/create_logits,s
I0408 05:58:38.644234 139967323350912 tpu_random.py:86] Got global random offset: Tensor("strided_slice:0", shape=(), dtype=int32)
---------------------------------------------------s3gan.py/create_loss,s
W0408 05:58:38.647009 139967323350912 s3gan.py:237] Computing fake images for every sub step separately.
I0408 05:58:38.647240 139967323350912 resnet_biggan.py:236] [Generator] inputs are z=(8, 120), y=(8, 2)
I0408 05:58:38.653088 139967323350912 resnet_biggan.py:262] [Generator] z0=(8, 20), z_per_block=['(8, 20)', '(8, 20)', '(8, 20)', '(8, 20)', '(8, 20)'], y_per_block=['(8, 148)', '(8, 148)', '(8, 148)', '(8, 148)', '(8, 148)']
I0408 05:58:38.674932 139967323350912 resnet_biggan.py:150] [Block] (8, 4, 4, 1536) (z=(8, 20), y=(8, 148)) -> (8, 8, 8, 1536)
I0408 05:58:38.691941 139967323350912 resnet_biggan.py:150] [Block] (8, 8, 8, 1536) (z=(8, 20), y=(8, 148)) -> (8, 16, 16, 768)
I0408 05:58:38.709106 139967323350912 resnet_biggan.py:150] [Block] (8, 16, 16, 768) (z=(8, 20), y=(8, 148)) -> (8, 32, 32, 384)
I0408 05:58:38.726593 139967323350912 resnet_biggan.py:150] [Block] (8, 32, 32, 384) (z=(8, 20), y=(8, 148)) -> (8, 64, 64, 192)
I0408 05:58:38.726742 139967323350912 resnet_biggan.py:289] [Generator] Applying non-local block to (8, 64, 64, 192)
I0408 05:58:38.760953 139967323350912 resnet_biggan.py:150] [Block] (8, 64, 64, 192) (z=(8, 20), y=(8, 148)) -> (8, 128, 128, 96)
I0408 05:58:38.761158 139967323350912 resnet_biggan.py:294] [Generator] before final processing: (8, 128, 128, 96)
I0408 05:58:38.776733 139967323350912 resnet_biggan.py:300] [Generator] after final processing: (8, 128, 128, 3)
I0408 05:58:38.778561 139967323350912 s3gan.py:249] bs=8, rotated_bs=4, num_rot_examples=1
---------------------------------------------------s3gan.py/merge_with_rotation_data,s
---------------------------------------------------s3gan.py/merge_with_rotation_data,e
--------------------------------------------------------------------s3gan.py/discriminator_with_additonal_heads,s
I0408 05:58:38.806307 139967323350912 resnet_biggan.py:379] [Discriminator] inputs are x=(22, 128, 128, 3), y=(22, 2)
I0408 05:58:38.841512 139967323350912 resnet_biggan.py:150] [Block] (22, 128, 128, 3) (z=None, y=(22, 2)) -> (22, 64, 64, 96)
I0408 05:58:38.841674 139967323350912 resnet_biggan.py:398] [Discriminator] Applying non-local block to (22, 64, 64, 96)
I0408 05:58:38.917207 139967323350912 resnet_biggan.py:150] [Block] (22, 64, 64, 96) (z=None, y=(22, 2)) -> (22, 32, 32, 192)
I0408 05:58:38.951777 139967323350912 resnet_biggan.py:150] [Block] (22, 32, 32, 192) (z=None, y=(22, 2)) -> (22, 16, 16, 384)
I0408 05:58:38.984938 139967323350912 resnet_biggan.py:150] [Block] (22, 16, 16, 384) (z=None, y=(22, 2)) -> (22, 8, 8, 768)
I0408 05:58:39.017481 139967323350912 resnet_biggan.py:150] [Block] (22, 8, 8, 768) (z=None, y=(22, 2)) -> (22, 4, 4, 1536)
I0408 05:58:39.038255 139967323350912 resnet_biggan.py:150] [Block] (22, 4, 4, 1536) (z=None, y=(22, 2)) -> (22, 4, 4, 1536)
I0408 05:58:39.038414 139967323350912 resnet_biggan.py:403] [Discriminator] before final processing: (22, 4, 4, 1536)
I0408 05:58:39.049279 139967323350912 resnet_biggan.py:407] [Discriminator] after final processing: (22, 4, 4, 1536)
I0408 05:58:39.055728 139967323350912 resnet_biggan.py:422] [Discriminator] embedded_y for projection: (22, 1536)
I0408 05:58:39.070766 139967323350912 s3gan.py:133] [Discriminator] rotation head (22, 1536) -> Tensor("discriminator_rotation/score_classify/add:0", shape=(22, 4), dtype=float32)
I0408 05:58:39.084465 139967323350912 s3gan.py:154] [Discriminator] (22, 2) -> aux_logits=(22, 2), y_predicted=(22, 2)
---------------------------------------------------s3gan.py/get_class_embedding,s
I0408 05:58:39.090913 139967323350912 s3gan.py:175] [Discriminator] embedded_y for projection: (22, 1536)
---------------------------------------------------s3gan.py/get_class_embedding,e
---------------------------------------------------s3gan.py/discriminator_with_additonal_heads,e
---------------------------------------------------s3gan.py/create_loss,e
---------------------------------------------------modular_gan.py/create_logits,e
################################################## mode == tf.estimator.ModeKeys.EVAL  ########################
INFO:tensorflow:Done calling model_fn.
I0408 05:58:39.196299 139967323350912 estimator.py:1171] Done calling model_fn.
INFO:tensorflow:Starting evaluation at 2020-04-08T05:58:39Z
I0408 05:58:39.213997 139967323350912 evaluation.py:255] Starting evaluation at 2020-04-08T05:58:39Z
INFO:tensorflow:Graph was finalized.
I0408 05:58:39.578935 139967323350912 monitored_session.py:246] Graph was finalized.
2020-04-08 05:58:39.579624: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-04-08 05:58:39.579917: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:00:04.0 name: Tesla P4 computeCapability: 6.1
coreClock: 1.1135GHz coreCount: 20 deviceMemorySize: 7.43GiB deviceMemoryBandwidth: 178.99GiB/s
2020-04-08 05:58:39.579968: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.1
2020-04-08 05:58:39.579995: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10
2020-04-08 05:58:39.580013: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcufft.so.10
2020-04-08 05:58:39.580030: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcurand.so.10
2020-04-08 05:58:39.580044: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusolver.so.10
2020-04-08 05:58:39.580096: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusparse.so.10
2020-04-08 05:58:39.580112: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudnn.so.7
2020-04-08 05:58:39.580213: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-04-08 05:58:39.580476: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-04-08 05:58:39.580679: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1703] Adding visible gpu devices: 0
2020-04-08 05:58:39.580721: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-04-08 05:58:39.580735: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      0 
2020-04-08 05:58:39.580745: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1121] 0:   N 
2020-04-08 05:58:39.580837: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-04-08 05:58:39.581103: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-04-08 05:58:39.581334: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1247] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 6850 MB memory) -> physical GPU (device: 0, name: Tesla P4, pci bus id: 0000:00:04.0, compute capability: 6.1)
INFO:tensorflow:Restoring parameters from /tmp/absl_testing/550760/model.ckpt-4582
I0408 05:58:39.582380 139967323350912 saver.py:1293] Restoring parameters from /tmp/absl_testing/550760/model.ckpt-4582
INFO:tensorflow:Running local_init_op.
I0408 05:58:40.054894 139967323350912 session_manager.py:505] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
I0408 05:58:40.079398 139967323350912 session_manager.py:508] Done running local_init_op.
INFO:tensorflow:Evaluation [5/50]
I0408 05:58:42.939586 139967323350912 evaluation.py:167] Evaluation [5/50]
INFO:tensorflow:Evaluation [10/50]
I0408 05:58:44.344408 139967323350912 evaluation.py:167] Evaluation [10/50]
INFO:tensorflow:Evaluation [15/50]
I0408 05:58:45.747103 139967323350912 evaluation.py:167] Evaluation [15/50]
INFO:tensorflow:Evaluation [20/50]
I0408 05:58:47.175527 139967323350912 evaluation.py:167] Evaluation [20/50]
INFO:tensorflow:Evaluation [25/50]
I0408 05:58:48.599945 139967323350912 evaluation.py:167] Evaluation [25/50]
INFO:tensorflow:Evaluation [30/50]
I0408 05:58:50.023165 139967323350912 evaluation.py:167] Evaluation [30/50]
INFO:tensorflow:Evaluation [35/50]
I0408 05:58:51.456280 139967323350912 evaluation.py:167] Evaluation [35/50]
INFO:tensorflow:Evaluation [40/50]
I0408 05:58:53.123927 139967323350912 evaluation.py:167] Evaluation [40/50]
INFO:tensorflow:Evaluation [45/50]
I0408 05:58:54.554947 139967323350912 evaluation.py:167] Evaluation [45/50]
INFO:tensorflow:Evaluation [50/50]
I0408 05:58:56.031528 139967323350912 evaluation.py:167] Evaluation [50/50]
INFO:tensorflow:Inference Time : 17.19856s
I0408 05:58:56.412777 139967323350912 evaluation.py:273] Inference Time : 17.19856s
INFO:tensorflow:Finished evaluation at 2020-04-08-05:58:56
I0408 05:58:56.412974 139967323350912 evaluation.py:276] Finished evaluation at 2020-04-08-05:58:56
INFO:tensorflow:Saving dict for global step 4582: accuracy = 0.615, global_step = 4582, loss = 0.03449844
I0408 05:58:56.413111 139967323350912 estimator.py:2066] Saving dict for global step 4582: accuracy = 0.615, global_step = 4582, loss = 0.03449844
INFO:tensorflow:Saving 'checkpoint_path' summary for global step 4582: /tmp/absl_testing/550760/model.ckpt-4582
I0408 05:58:56.414527 139967323350912 estimator.py:2127] Saving 'checkpoint_path' summary for global step 4582: /tmp/absl_testing/550760/model.ckpt-4582
INFO:tensorflow:global_step/sec: 0.545634
I0408 05:59:24.295320 139967323350912 basic_session_run_hooks.py:702] global_step/sec: 0.545634
INFO:tensorflow:loss = 0.0052368697, step = 4600 (183.273 sec)
I0408 05:59:24.296301 139967323350912 basic_session_run_hooks.py:260] loss = 0.0052368697, step = 4600 (183.273 sec)
INFO:tensorflow:global_step/sec: 0.682132
I0408 06:01:50.894694 139967323350912 basic_session_run_hooks.py:702] global_step/sec: 0.682132
INFO:tensorflow:loss = 0.0008026386, step = 4700 (146.600 sec)
I0408 06:01:50.895936 139967323350912 basic_session_run_hooks.py:260] loss = 0.0008026386, step = 4700 (146.600 sec)
INFO:tensorflow:global_step/sec: 0.68244
I0408 06:04:17.427522 139967323350912 basic_session_run_hooks.py:702] global_step/sec: 0.68244
INFO:tensorflow:loss = 0.0001382121, step = 4800 (146.533 sec)
I0408 06:04:17.428715 139967323350912 basic_session_run_hooks.py:260] loss = 0.0001382121, step = 4800 (146.533 sec)
INFO:tensorflow:global_step/sec: 0.68262
I0408 06:06:43.921964 139967323350912 basic_session_run_hooks.py:702] global_step/sec: 0.68262
INFO:tensorflow:loss = 0.000338828, step = 4900 (146.494 sec)
I0408 06:06:43.923155 139967323350912 basic_session_run_hooks.py:260] loss = 0.000338828, step = 4900 (146.494 sec)
INFO:tensorflow:Calling checkpoint listeners before saving checkpoint 4967...
I0408 06:08:20.740344 139967323350912 basic_session_run_hooks.py:614] Calling checkpoint listeners before saving checkpoint 4967...
INFO:tensorflow:Saving checkpoints for 4967 into /tmp/absl_testing/550760/model.ckpt.
I0408 06:08:20.740628 139967323350912 basic_session_run_hooks.py:618] Saving checkpoints for 4967 into /tmp/absl_testing/550760/model.ckpt.
INFO:tensorflow:Calling checkpoint listeners after saving checkpoint 4967...
I0408 06:08:39.231366 139967323350912 basic_session_run_hooks.py:626] Calling checkpoint listeners after saving checkpoint 4967...
--------------------------------------------datasets.py/eval_input_fn,s
W0408 06:08:39.237842 139967323350912 datasets.py:170] No TPUContext, using unmodified dataset seed 547.
I0408 06:08:39.237987 139967323350912 datasets.py:348] eval_input_fn(): params={'use_tpu': False, 'train_batch_size': 8, 'batch_size': 8} seed=547
--------befor self._load_dataset------------------split = validation self._eval_split= validation
--------------------------------------------datasets.py/_load_dataset,s
!!!!!!!!!!!!!!!!!!!!!!----load_local_datasets,  _local_test_ds_dir= /content/drive/My Drive/drive/gan/test
-----------------------------------------get_local_datasets,s
-----------------------------------------get_local_datasets,e
--------------------------------------------modular_gan.py/_preprocess_fn,s
I0408 06:08:39.318750 139967323350912 api.py:587] _preprocess_fn(): images=Tensor("args_0:0", shape=(128, 128, 3), dtype=float32), labels=Tensor("args_1:0", shape=(), dtype=int32), seed=547
--------------------------------------------modular_gan.py/_preprocess_fn,e
I0408 06:08:39.348088 139967323350912 api.py:587] Passing random offset: Tensor("Cast:0", shape=(), dtype=int32) with data ({'images': <tf.Tensor 'args_1:0' shape=(128, 128, 3) dtype=float32>, 'z': <tf.Tensor 'args_3:0' shape=(120,) dtype=float32>, 'sampled_labels': <tf.Tensor 'args_2:0' shape=() dtype=int32>}, <tf.Tensor 'args_4:0' shape=() dtype=int32>).
--------------------------------------------datasets.py/eval_input_fn,e
INFO:tensorflow:Calling model_fn.
I0408 06:08:39.363460 139967323350912 estimator.py:1169] Calling model_fn.
--------------------------------------------modular_gan.py/model_fn,s
I0408 06:08:39.363615 139967323350912 modular_gan.py:568] model_fn(): features={'images': <tf.Tensor 'IteratorGetNext:1' shape=(8, 128, 128, 3) dtype=float32>, 'z': <tf.Tensor 'IteratorGetNext:3' shape=(8, 120) dtype=float32>, 'sampled_labels': <tf.Tensor 'IteratorGetNext:2' shape=(8,) dtype=int32>, '_RANDOM_OFFSET': <tf.Tensor 'IteratorGetNext:0' shape=(8,) dtype=int32>}, labels=Tensor("IteratorGetNext:4", shape=(8,), dtype=int32),mode=eval, params={'use_tpu': False, 'train_batch_size': 8, 'batch_size': 8}
#Clean old summaries from previous calls to model_fn().
# Get features and labels for each sub-step.
--------------------------------------------modular_gan.py/_split_inputs_and_generate_samples,s
I0408 06:08:39.370380 139967323350912 resnet_biggan.py:236] [Generator] inputs are z=(8, 120), y=(8, 2)
I0408 06:08:39.380677 139967323350912 resnet_biggan.py:262] [Generator] z0=(8, 20), z_per_block=['(8, 20)', '(8, 20)', '(8, 20)', '(8, 20)', '(8, 20)'], y_per_block=['(8, 148)', '(8, 148)', '(8, 148)', '(8, 148)', '(8, 148)']
I0408 06:08:39.428436 139967323350912 resnet_biggan.py:150] [Block] (8, 4, 4, 1536) (z=(8, 20), y=(8, 148)) -> (8, 8, 8, 1536)
I0408 06:08:39.465030 139967323350912 resnet_biggan.py:150] [Block] (8, 8, 8, 1536) (z=(8, 20), y=(8, 148)) -> (8, 16, 16, 768)
I0408 06:08:39.501977 139967323350912 resnet_biggan.py:150] [Block] (8, 16, 16, 768) (z=(8, 20), y=(8, 148)) -> (8, 32, 32, 384)
I0408 06:08:39.545570 139967323350912 resnet_biggan.py:150] [Block] (8, 32, 32, 384) (z=(8, 20), y=(8, 148)) -> (8, 64, 64, 192)
I0408 06:08:39.545722 139967323350912 resnet_biggan.py:289] [Generator] Applying non-local block to (8, 64, 64, 192)
I0408 06:08:39.628243 139967323350912 resnet_biggan.py:150] [Block] (8, 64, 64, 192) (z=(8, 20), y=(8, 148)) -> (8, 128, 128, 96)
I0408 06:08:39.628417 139967323350912 resnet_biggan.py:294] [Generator] before final processing: (8, 128, 128, 96)
I0408 06:08:39.661910 139967323350912 resnet_biggan.py:300] [Generator] after final processing: (8, 128, 128, 3)
--------------------------------------------modular_gan.py/_split_inputs_and_generate_samples,e
---------------------------------------------------modular_gan.py/create_logits,s
I0408 06:08:39.665623 139967323350912 tpu_random.py:86] Got global random offset: Tensor("strided_slice:0", shape=(), dtype=int32)
---------------------------------------------------s3gan.py/create_loss,s
W0408 06:08:39.668377 139967323350912 s3gan.py:237] Computing fake images for every sub step separately.
I0408 06:08:39.668596 139967323350912 resnet_biggan.py:236] [Generator] inputs are z=(8, 120), y=(8, 2)
I0408 06:08:39.674480 139967323350912 resnet_biggan.py:262] [Generator] z0=(8, 20), z_per_block=['(8, 20)', '(8, 20)', '(8, 20)', '(8, 20)', '(8, 20)'], y_per_block=['(8, 148)', '(8, 148)', '(8, 148)', '(8, 148)', '(8, 148)']
I0408 06:08:39.694333 139967323350912 resnet_biggan.py:150] [Block] (8, 4, 4, 1536) (z=(8, 20), y=(8, 148)) -> (8, 8, 8, 1536)
I0408 06:08:39.711362 139967323350912 resnet_biggan.py:150] [Block] (8, 8, 8, 1536) (z=(8, 20), y=(8, 148)) -> (8, 16, 16, 768)
I0408 06:08:39.728800 139967323350912 resnet_biggan.py:150] [Block] (8, 16, 16, 768) (z=(8, 20), y=(8, 148)) -> (8, 32, 32, 384)
I0408 06:08:39.748076 139967323350912 resnet_biggan.py:150] [Block] (8, 32, 32, 384) (z=(8, 20), y=(8, 148)) -> (8, 64, 64, 192)
I0408 06:08:39.748246 139967323350912 resnet_biggan.py:289] [Generator] Applying non-local block to (8, 64, 64, 192)
I0408 06:08:39.783106 139967323350912 resnet_biggan.py:150] [Block] (8, 64, 64, 192) (z=(8, 20), y=(8, 148)) -> (8, 128, 128, 96)
I0408 06:08:39.783307 139967323350912 resnet_biggan.py:294] [Generator] before final processing: (8, 128, 128, 96)
I0408 06:08:39.798225 139967323350912 resnet_biggan.py:300] [Generator] after final processing: (8, 128, 128, 3)
I0408 06:08:39.799988 139967323350912 s3gan.py:249] bs=8, rotated_bs=4, num_rot_examples=1
---------------------------------------------------s3gan.py/merge_with_rotation_data,s
---------------------------------------------------s3gan.py/merge_with_rotation_data,e
--------------------------------------------------------------------s3gan.py/discriminator_with_additonal_heads,s
I0408 06:08:39.826600 139967323350912 resnet_biggan.py:379] [Discriminator] inputs are x=(22, 128, 128, 3), y=(22, 2)
I0408 06:08:39.860494 139967323350912 resnet_biggan.py:150] [Block] (22, 128, 128, 3) (z=None, y=(22, 2)) -> (22, 64, 64, 96)
I0408 06:08:39.860644 139967323350912 resnet_biggan.py:398] [Discriminator] Applying non-local block to (22, 64, 64, 96)
I0408 06:08:39.945382 139967323350912 resnet_biggan.py:150] [Block] (22, 64, 64, 96) (z=None, y=(22, 2)) -> (22, 32, 32, 192)
I0408 06:08:39.978090 139967323350912 resnet_biggan.py:150] [Block] (22, 32, 32, 192) (z=None, y=(22, 2)) -> (22, 16, 16, 384)
I0408 06:08:40.011314 139967323350912 resnet_biggan.py:150] [Block] (22, 16, 16, 384) (z=None, y=(22, 2)) -> (22, 8, 8, 768)
I0408 06:08:40.043838 139967323350912 resnet_biggan.py:150] [Block] (22, 8, 8, 768) (z=None, y=(22, 2)) -> (22, 4, 4, 1536)
I0408 06:08:40.063506 139967323350912 resnet_biggan.py:150] [Block] (22, 4, 4, 1536) (z=None, y=(22, 2)) -> (22, 4, 4, 1536)
I0408 06:08:40.063709 139967323350912 resnet_biggan.py:403] [Discriminator] before final processing: (22, 4, 4, 1536)
I0408 06:08:40.076317 139967323350912 resnet_biggan.py:407] [Discriminator] after final processing: (22, 4, 4, 1536)
I0408 06:08:40.083023 139967323350912 resnet_biggan.py:422] [Discriminator] embedded_y for projection: (22, 1536)
I0408 06:08:40.098011 139967323350912 s3gan.py:133] [Discriminator] rotation head (22, 1536) -> Tensor("discriminator_rotation/score_classify/add:0", shape=(22, 4), dtype=float32)
I0408 06:08:40.111627 139967323350912 s3gan.py:154] [Discriminator] (22, 2) -> aux_logits=(22, 2), y_predicted=(22, 2)
---------------------------------------------------s3gan.py/get_class_embedding,s
I0408 06:08:40.117940 139967323350912 s3gan.py:175] [Discriminator] embedded_y for projection: (22, 1536)
---------------------------------------------------s3gan.py/get_class_embedding,e
---------------------------------------------------s3gan.py/discriminator_with_additonal_heads,e
---------------------------------------------------s3gan.py/create_loss,e
---------------------------------------------------modular_gan.py/create_logits,e
################################################## mode == tf.estimator.ModeKeys.EVAL  ########################
INFO:tensorflow:Done calling model_fn.
I0408 06:08:40.222789 139967323350912 estimator.py:1171] Done calling model_fn.
INFO:tensorflow:Starting evaluation at 2020-04-08T06:08:40Z
I0408 06:08:40.239925 139967323350912 evaluation.py:255] Starting evaluation at 2020-04-08T06:08:40Z
INFO:tensorflow:Graph was finalized.
I0408 06:08:40.388379 139967323350912 monitored_session.py:246] Graph was finalized.
2020-04-08 06:08:40.389000: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-04-08 06:08:40.389341: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:00:04.0 name: Tesla P4 computeCapability: 6.1
coreClock: 1.1135GHz coreCount: 20 deviceMemorySize: 7.43GiB deviceMemoryBandwidth: 178.99GiB/s
2020-04-08 06:08:40.389392: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.1
2020-04-08 06:08:40.389421: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10
2020-04-08 06:08:40.389438: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcufft.so.10
2020-04-08 06:08:40.389454: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcurand.so.10
2020-04-08 06:08:40.389468: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusolver.so.10
2020-04-08 06:08:40.389514: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusparse.so.10
2020-04-08 06:08:40.389531: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudnn.so.7
2020-04-08 06:08:40.389608: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-04-08 06:08:40.389871: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-04-08 06:08:40.390078: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1703] Adding visible gpu devices: 0
2020-04-08 06:08:40.390139: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-04-08 06:08:40.390152: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      0 
2020-04-08 06:08:40.390162: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1121] 0:   N 
2020-04-08 06:08:40.390260: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-04-08 06:08:40.390532: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-04-08 06:08:40.390755: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1247] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 6850 MB memory) -> physical GPU (device: 0, name: Tesla P4, pci bus id: 0000:00:04.0, compute capability: 6.1)
INFO:tensorflow:Restoring parameters from /tmp/absl_testing/550760/model.ckpt-4967
I0408 06:08:40.391928 139967323350912 saver.py:1293] Restoring parameters from /tmp/absl_testing/550760/model.ckpt-4967
INFO:tensorflow:Running local_init_op.
I0408 06:08:40.825060 139967323350912 session_manager.py:505] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
I0408 06:08:40.848681 139967323350912 session_manager.py:508] Done running local_init_op.
INFO:tensorflow:Evaluation [5/50]
I0408 06:08:43.738710 139967323350912 evaluation.py:167] Evaluation [5/50]
INFO:tensorflow:Evaluation [10/50]
I0408 06:08:45.151982 139967323350912 evaluation.py:167] Evaluation [10/50]
INFO:tensorflow:Evaluation [15/50]
I0408 06:08:46.561033 139967323350912 evaluation.py:167] Evaluation [15/50]
INFO:tensorflow:Evaluation [20/50]
I0408 06:08:48.055312 139967323350912 evaluation.py:167] Evaluation [20/50]
INFO:tensorflow:Evaluation [25/50]
I0408 06:08:49.477725 139967323350912 evaluation.py:167] Evaluation [25/50]
INFO:tensorflow:Evaluation [30/50]
I0408 06:08:50.889639 139967323350912 evaluation.py:167] Evaluation [30/50]
INFO:tensorflow:Evaluation [35/50]
I0408 06:08:52.313331 139967323350912 evaluation.py:167] Evaluation [35/50]
INFO:tensorflow:Evaluation [40/50]
I0408 06:08:54.447975 139967323350912 evaluation.py:167] Evaluation [40/50]
INFO:tensorflow:Evaluation [45/50]
I0408 06:08:55.879673 139967323350912 evaluation.py:167] Evaluation [45/50]
INFO:tensorflow:Evaluation [50/50]
I0408 06:08:57.287258 139967323350912 evaluation.py:167] Evaluation [50/50]
INFO:tensorflow:Inference Time : 17.09857s
I0408 06:08:57.338667 139967323350912 evaluation.py:273] Inference Time : 17.09857s
INFO:tensorflow:Finished evaluation at 2020-04-08-06:08:57
I0408 06:08:57.338868 139967323350912 evaluation.py:276] Finished evaluation at 2020-04-08-06:08:57
INFO:tensorflow:Saving dict for global step 4967: accuracy = 0.6525, global_step = 4967, loss = 0.0028934863
I0408 06:08:57.339001 139967323350912 estimator.py:2066] Saving dict for global step 4967: accuracy = 0.6525, global_step = 4967, loss = 0.0028934863
INFO:tensorflow:Saving 'checkpoint_path' summary for global step 4967: /tmp/absl_testing/550760/model.ckpt-4967
I0408 06:08:57.340223 139967323350912 estimator.py:2127] Saving 'checkpoint_path' summary for global step 4967: /tmp/absl_testing/550760/model.ckpt-4967
INFO:tensorflow:Calling checkpoint listeners before saving checkpoint 5000...
I0408 06:09:45.776495 139967323350912 basic_session_run_hooks.py:614] Calling checkpoint listeners before saving checkpoint 5000...
INFO:tensorflow:Saving checkpoints for 5000 into /tmp/absl_testing/550760/model.ckpt.
I0408 06:09:45.776768 139967323350912 basic_session_run_hooks.py:618] Saving checkpoints for 5000 into /tmp/absl_testing/550760/model.ckpt.
INFO:tensorflow:Calling checkpoint listeners after saving checkpoint 5000...
I0408 06:10:04.445595 139967323350912 basic_session_run_hooks.py:626] Calling checkpoint listeners after saving checkpoint 5000...
INFO:tensorflow:Skip the current checkpoint eval due to throttle secs (600 secs).
I0408 06:10:04.445889 139967323350912 training.py:528] Skip the current checkpoint eval due to throttle secs (600 secs).
--------------------------------------------datasets.py/eval_input_fn,s
W0408 06:10:04.452935 139967323350912 datasets.py:170] No TPUContext, using unmodified dataset seed 547.
I0408 06:10:04.453070 139967323350912 datasets.py:348] eval_input_fn(): params={'use_tpu': False, 'train_batch_size': 8, 'batch_size': 8} seed=547
--------befor self._load_dataset------------------split = validation self._eval_split= validation
--------------------------------------------datasets.py/_load_dataset,s
!!!!!!!!!!!!!!!!!!!!!!----load_local_datasets,  _local_test_ds_dir= /content/drive/My Drive/drive/gan/test
-----------------------------------------get_local_datasets,s
-----------------------------------------get_local_datasets,e
--------------------------------------------modular_gan.py/_preprocess_fn,s
I0408 06:10:04.535624 139967323350912 api.py:587] _preprocess_fn(): images=Tensor("args_0:0", shape=(128, 128, 3), dtype=float32), labels=Tensor("args_1:0", shape=(), dtype=int32), seed=547
--------------------------------------------modular_gan.py/_preprocess_fn,e
I0408 06:10:04.565856 139967323350912 api.py:587] Passing random offset: Tensor("Cast:0", shape=(), dtype=int32) with data ({'images': <tf.Tensor 'args_1:0' shape=(128, 128, 3) dtype=float32>, 'z': <tf.Tensor 'args_3:0' shape=(120,) dtype=float32>, 'sampled_labels': <tf.Tensor 'args_2:0' shape=() dtype=int32>}, <tf.Tensor 'args_4:0' shape=() dtype=int32>).
--------------------------------------------datasets.py/eval_input_fn,e
INFO:tensorflow:Calling model_fn.
I0408 06:10:04.584648 139967323350912 estimator.py:1169] Calling model_fn.
--------------------------------------------modular_gan.py/model_fn,s
I0408 06:10:04.584848 139967323350912 modular_gan.py:568] model_fn(): features={'images': <tf.Tensor 'IteratorGetNext:1' shape=(8, 128, 128, 3) dtype=float32>, 'z': <tf.Tensor 'IteratorGetNext:3' shape=(8, 120) dtype=float32>, 'sampled_labels': <tf.Tensor 'IteratorGetNext:2' shape=(8,) dtype=int32>, '_RANDOM_OFFSET': <tf.Tensor 'IteratorGetNext:0' shape=(8,) dtype=int32>}, labels=Tensor("IteratorGetNext:4", shape=(8,), dtype=int32),mode=eval, params={'use_tpu': False, 'train_batch_size': 8, 'batch_size': 8}
#Clean old summaries from previous calls to model_fn().
# Get features and labels for each sub-step.
--------------------------------------------modular_gan.py/_split_inputs_and_generate_samples,s
I0408 06:10:04.592138 139967323350912 resnet_biggan.py:236] [Generator] inputs are z=(8, 120), y=(8, 2)
I0408 06:10:04.602896 139967323350912 resnet_biggan.py:262] [Generator] z0=(8, 20), z_per_block=['(8, 20)', '(8, 20)', '(8, 20)', '(8, 20)', '(8, 20)'], y_per_block=['(8, 148)', '(8, 148)', '(8, 148)', '(8, 148)', '(8, 148)']
I0408 06:10:04.653797 139967323350912 resnet_biggan.py:150] [Block] (8, 4, 4, 1536) (z=(8, 20), y=(8, 148)) -> (8, 8, 8, 1536)
I0408 06:10:04.698628 139967323350912 resnet_biggan.py:150] [Block] (8, 8, 8, 1536) (z=(8, 20), y=(8, 148)) -> (8, 16, 16, 768)
I0408 06:10:04.739773 139967323350912 resnet_biggan.py:150] [Block] (8, 16, 16, 768) (z=(8, 20), y=(8, 148)) -> (8, 32, 32, 384)
I0408 06:10:04.782099 139967323350912 resnet_biggan.py:150] [Block] (8, 32, 32, 384) (z=(8, 20), y=(8, 148)) -> (8, 64, 64, 192)
I0408 06:10:04.782300 139967323350912 resnet_biggan.py:289] [Generator] Applying non-local block to (8, 64, 64, 192)
I0408 06:10:04.887877 139967323350912 resnet_biggan.py:150] [Block] (8, 64, 64, 192) (z=(8, 20), y=(8, 148)) -> (8, 128, 128, 96)
I0408 06:10:04.888973 139967323350912 resnet_biggan.py:294] [Generator] before final processing: (8, 128, 128, 96)
I0408 06:10:04.929446 139967323350912 resnet_biggan.py:300] [Generator] after final processing: (8, 128, 128, 3)
--------------------------------------------modular_gan.py/_split_inputs_and_generate_samples,e
---------------------------------------------------modular_gan.py/create_logits,s
I0408 06:10:04.933271 139967323350912 tpu_random.py:86] Got global random offset: Tensor("strided_slice:0", shape=(), dtype=int32)
---------------------------------------------------s3gan.py/create_loss,s
W0408 06:10:04.936057 139967323350912 s3gan.py:237] Computing fake images for every sub step separately.
I0408 06:10:04.936301 139967323350912 resnet_biggan.py:236] [Generator] inputs are z=(8, 120), y=(8, 2)
I0408 06:10:04.942224 139967323350912 resnet_biggan.py:262] [Generator] z0=(8, 20), z_per_block=['(8, 20)', '(8, 20)', '(8, 20)', '(8, 20)', '(8, 20)'], y_per_block=['(8, 148)', '(8, 148)', '(8, 148)', '(8, 148)', '(8, 148)']
I0408 06:10:04.962244 139967323350912 resnet_biggan.py:150] [Block] (8, 4, 4, 1536) (z=(8, 20), y=(8, 148)) -> (8, 8, 8, 1536)
I0408 06:10:04.979642 139967323350912 resnet_biggan.py:150] [Block] (8, 8, 8, 1536) (z=(8, 20), y=(8, 148)) -> (8, 16, 16, 768)
I0408 06:10:04.997468 139967323350912 resnet_biggan.py:150] [Block] (8, 16, 16, 768) (z=(8, 20), y=(8, 148)) -> (8, 32, 32, 384)
I0408 06:10:05.015040 139967323350912 resnet_biggan.py:150] [Block] (8, 32, 32, 384) (z=(8, 20), y=(8, 148)) -> (8, 64, 64, 192)
I0408 06:10:05.015215 139967323350912 resnet_biggan.py:289] [Generator] Applying non-local block to (8, 64, 64, 192)
I0408 06:10:05.054093 139967323350912 resnet_biggan.py:150] [Block] (8, 64, 64, 192) (z=(8, 20), y=(8, 148)) -> (8, 128, 128, 96)
I0408 06:10:05.054300 139967323350912 resnet_biggan.py:294] [Generator] before final processing: (8, 128, 128, 96)
I0408 06:10:05.071272 139967323350912 resnet_biggan.py:300] [Generator] after final processing: (8, 128, 128, 3)
I0408 06:10:05.073060 139967323350912 s3gan.py:249] bs=8, rotated_bs=4, num_rot_examples=1
---------------------------------------------------s3gan.py/merge_with_rotation_data,s
---------------------------------------------------s3gan.py/merge_with_rotation_data,e
--------------------------------------------------------------------s3gan.py/discriminator_with_additonal_heads,s
I0408 06:10:05.106238 139967323350912 resnet_biggan.py:379] [Discriminator] inputs are x=(22, 128, 128, 3), y=(22, 2)
I0408 06:10:05.146197 139967323350912 resnet_biggan.py:150] [Block] (22, 128, 128, 3) (z=None, y=(22, 2)) -> (22, 64, 64, 96)
I0408 06:10:05.146350 139967323350912 resnet_biggan.py:398] [Discriminator] Applying non-local block to (22, 64, 64, 96)
I0408 06:10:05.222642 139967323350912 resnet_biggan.py:150] [Block] (22, 64, 64, 96) (z=None, y=(22, 2)) -> (22, 32, 32, 192)
I0408 06:10:05.255228 139967323350912 resnet_biggan.py:150] [Block] (22, 32, 32, 192) (z=None, y=(22, 2)) -> (22, 16, 16, 384)
I0408 06:10:05.287744 139967323350912 resnet_biggan.py:150] [Block] (22, 16, 16, 384) (z=None, y=(22, 2)) -> (22, 8, 8, 768)
I0408 06:10:05.320349 139967323350912 resnet_biggan.py:150] [Block] (22, 8, 8, 768) (z=None, y=(22, 2)) -> (22, 4, 4, 1536)
I0408 06:10:05.339356 139967323350912 resnet_biggan.py:150] [Block] (22, 4, 4, 1536) (z=None, y=(22, 2)) -> (22, 4, 4, 1536)
I0408 06:10:05.339504 139967323350912 resnet_biggan.py:403] [Discriminator] before final processing: (22, 4, 4, 1536)
I0408 06:10:05.349390 139967323350912 resnet_biggan.py:407] [Discriminator] after final processing: (22, 4, 4, 1536)
I0408 06:10:05.355343 139967323350912 resnet_biggan.py:422] [Discriminator] embedded_y for projection: (22, 1536)
I0408 06:10:05.367385 139967323350912 s3gan.py:133] [Discriminator] rotation head (22, 1536) -> Tensor("discriminator_rotation/score_classify/add:0", shape=(22, 4), dtype=float32)
I0408 06:10:05.380005 139967323350912 s3gan.py:154] [Discriminator] (22, 2) -> aux_logits=(22, 2), y_predicted=(22, 2)
---------------------------------------------------s3gan.py/get_class_embedding,s
I0408 06:10:05.385910 139967323350912 s3gan.py:175] [Discriminator] embedded_y for projection: (22, 1536)
---------------------------------------------------s3gan.py/get_class_embedding,e
---------------------------------------------------s3gan.py/discriminator_with_additonal_heads,e
---------------------------------------------------s3gan.py/create_loss,e
---------------------------------------------------modular_gan.py/create_logits,e
################################################## mode == tf.estimator.ModeKeys.EVAL  ########################
INFO:tensorflow:Done calling model_fn.
I0408 06:10:05.480031 139967323350912 estimator.py:1171] Done calling model_fn.
INFO:tensorflow:Starting evaluation at 2020-04-08T06:10:05Z
I0408 06:10:05.496160 139967323350912 evaluation.py:255] Starting evaluation at 2020-04-08T06:10:05Z
INFO:tensorflow:Graph was finalized.
I0408 06:10:05.634600 139967323350912 monitored_session.py:246] Graph was finalized.
2020-04-08 06:10:05.635221: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-04-08 06:10:05.635551: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:00:04.0 name: Tesla P4 computeCapability: 6.1
coreClock: 1.1135GHz coreCount: 20 deviceMemorySize: 7.43GiB deviceMemoryBandwidth: 178.99GiB/s
2020-04-08 06:10:05.635603: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.1
2020-04-08 06:10:05.635627: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10
2020-04-08 06:10:05.635644: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcufft.so.10
2020-04-08 06:10:05.635660: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcurand.so.10
2020-04-08 06:10:05.635674: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusolver.so.10
2020-04-08 06:10:05.635720: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusparse.so.10
2020-04-08 06:10:05.635736: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudnn.so.7
2020-04-08 06:10:05.635816: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-04-08 06:10:05.636078: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-04-08 06:10:05.636309: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1703] Adding visible gpu devices: 0
2020-04-08 06:10:05.636352: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-04-08 06:10:05.636366: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      0 
2020-04-08 06:10:05.636378: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1121] 0:   N 
2020-04-08 06:10:05.636466: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-04-08 06:10:05.636729: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-04-08 06:10:05.636944: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1247] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 6850 MB memory) -> physical GPU (device: 0, name: Tesla P4, pci bus id: 0000:00:04.0, compute capability: 6.1)
INFO:tensorflow:Restoring parameters from /tmp/absl_testing/550760/model.ckpt-5000
I0408 06:10:05.637887 139967323350912 saver.py:1293] Restoring parameters from /tmp/absl_testing/550760/model.ckpt-5000
INFO:tensorflow:Running local_init_op.
I0408 06:10:06.061221 139967323350912 session_manager.py:505] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
I0408 06:10:06.083148 139967323350912 session_manager.py:508] Done running local_init_op.
INFO:tensorflow:Evaluation [5/50]
I0408 06:10:08.907534 139967323350912 evaluation.py:167] Evaluation [5/50]
INFO:tensorflow:Evaluation [10/50]
I0408 06:10:10.324405 139967323350912 evaluation.py:167] Evaluation [10/50]
INFO:tensorflow:Evaluation [15/50]
I0408 06:10:11.743493 139967323350912 evaluation.py:167] Evaluation [15/50]
INFO:tensorflow:Evaluation [20/50]
I0408 06:10:13.179693 139967323350912 evaluation.py:167] Evaluation [20/50]
INFO:tensorflow:Evaluation [25/50]
I0408 06:10:14.595138 139967323350912 evaluation.py:167] Evaluation [25/50]
INFO:tensorflow:Evaluation [30/50]
I0408 06:10:16.004585 139967323350912 evaluation.py:167] Evaluation [30/50]
INFO:tensorflow:Evaluation [35/50]
I0408 06:10:17.429692 139967323350912 evaluation.py:167] Evaluation [35/50]
INFO:tensorflow:Evaluation [40/50]
I0408 06:10:18.836780 139967323350912 evaluation.py:167] Evaluation [40/50]
INFO:tensorflow:Evaluation [45/50]
I0408 06:10:20.302099 139967323350912 evaluation.py:167] Evaluation [45/50]
INFO:tensorflow:Evaluation [50/50]
I0408 06:10:21.735916 139967323350912 evaluation.py:167] Evaluation [50/50]
INFO:tensorflow:Inference Time : 16.29712s
I0408 06:10:21.793440 139967323350912 evaluation.py:273] Inference Time : 16.29712s
INFO:tensorflow:Finished evaluation at 2020-04-08-06:10:21
I0408 06:10:21.793639 139967323350912 evaluation.py:276] Finished evaluation at 2020-04-08-06:10:21
INFO:tensorflow:Saving dict for global step 5000: accuracy = 0.6475, global_step = 5000, loss = 0.033438288
I0408 06:10:21.793786 139967323350912 estimator.py:2066] Saving dict for global step 5000: accuracy = 0.6475, global_step = 5000, loss = 0.033438288
INFO:tensorflow:Saving 'checkpoint_path' summary for global step 5000: /tmp/absl_testing/550760/model.ckpt-5000
I0408 06:10:21.804624 139967323350912 estimator.py:2127] Saving 'checkpoint_path' summary for global step 5000: /tmp/absl_testing/550760/model.ckpt-5000
INFO:tensorflow:Loss for final step: 0.002196982.
I0408 06:10:21.893748 139967323350912 estimator.py:350] Loss for final step: 0.002196982.
-----------------------testSingleTrainingStepArchitectures,e
[       OK ] S3GANTest.testSingleTrainingStepArchitectures
[ RUN      ] S3GANTest.test_session
[  SKIPPED ] S3GANTest.test_session
----------------------------------------------------------------------
Ran 2 tests in 11582.382s

OK (skipped=1)